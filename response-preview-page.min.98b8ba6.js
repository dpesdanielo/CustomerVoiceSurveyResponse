(function(){var __webpack_modules__={26261:function(n,t,e){"use strict";e.d(t,{Vw:function(){return h},cS:function(){return c},cl:function(){return p},gV:function(){return d},iH:function(){return v},n5:function(){return f},oe:function(){return l},z_:function(){return m}});var r=e(63061);function i(n,t){return n?n+"."+t:t}function o(n,t,e,o,u){void 0===u&&(u=4),o&&n.push((0,r.dt)("".concat(i(t,e)),o,u))}function u(n,t,e,o){"boolean"==typeof o&&n.push((0,r.UL)("".concat(i(t,e)),o))}function s(n,t,e,o){"number"==typeof o&&n.push((0,r.Kq)("".concat(i(t,e)),o))}var a=function(n){var t="Activity.Result",e=[];return s(e,t,"Code",n.code),o(e,t,"Type",n.type),s(e,t,"Tag",n.tag),u(e,t,"IsExpected",n.isExpected),e.push((0,r.dt)("zC.Activity.Result","Office.System.Result")),e},c={contractName:"Office.System.Activity",getFields:function(n){var t="Activity",e=[];return o(e,t,"CV",n.cV),s(e,t,"Duration",n.duration),s(e,t,"Count",n.count),s(e,t,"AggMode",n.aggMode),u(e,t,"Success",n.success),n.result&&e.push.apply(e,a(n.result)),e.push((0,r.dt)("zC.Activity",this.contractName)),e}},f={getFields:function(n){var t="User",e=[];return o(e,t,"PrimaryIdentityHash",n.primaryIdentityHash),o(e,t,"PrimaryIdentitySpace",n.primaryIdentitySpace),o(e,t,"TenantId",n.tenantId,1),o(e,t,"TenantGroup",n.tenantGroup,1),u(e,t,"IsAnonymous",n.isAnonymous),e}},l={getFields:function(n,t){var e=[];return o(e,n,"Name",t.name),o(e,n,"State",t.state),e}},h={getFields:function(n){var t="UserAction",e=[];return s(e,t,"Id",n.id),o(e,t,"Name",n.name),o(e,t,"CommandSurface",n.commandSurface),o(e,t,"ParentName",n.parentName),o(e,t,"TriggerMethod",n.triggerMethod),s(e,t,"TimeOffsetMs",n.timeOffsetMs),e}},d={getFields:function(n){var t="App",e=[];return o(e,t,"Name",n.name,1),o(e,t,"Platform",n.platform,1),o(e,t,"Version",n.version,1),e}},m={getFields:function(n){var t="Session",e=[];return o(e,t,"Id",n.id,1),o(e,t,"EcsETag",n.ecsETag,1),e}},v={getFields:function(n){var t=[];return t.push((0,r.dt)("Pillar",n.pillar)),t.push((0,r.dt)("Veto",n.veto)),t.push((0,r.UL)("IsIntentional",n.isIntentional)),t.push((0,r.UL)("IsInternal",n.isInternal)),t.push((0,r.UL)("AlertOnPillar",n.alertOnPillar)),t.push((0,r.UL)("IsSessionEndingError",n.isSessionEndingError)),u(t,void 0,"InStaging",n.inStaging),t}},p={getFields:function(n){var t=[];return o(t,"Release","AudienceGroup",n.audienceGroup,1),t}}},63061:function(n,t,e){"use strict";function r(n,t,e){return a(n,1,t,e)}function i(n,t,e){return a(n,2,t,e)}function o(n,t,e){return a(n,3,t,e)}function u(n,t,e){return a(n,0,t,e)}function s(n,t,e){return a(n,4,t,e)}function a(n,t,e,r){return{name:n,dataType:t,value:e,classification:r||4}}e.d(t,{Kq:function(){return i},UL:function(){return r},b_:function(){return o},dt:function(){return u},xq:function(){return s}})},92560:function(n,t,e){"use strict";e.d(t,{H:function(){return s},kr:function(){return o},uf:function(){return u}});var r,i=(r=[],{fireEvent:function(n){r.forEach((function(t){return t(n)}))},addListener:function(n){n&&r.push(n)}});function o(){return i}function u(n,t,e){i.fireEvent({level:n,category:t,message:e})}function s(n,t,e){u(0,n,(function(){var n=e instanceof Error?e.message:"";return"".concat(t,": ").concat(n)}))}},97517:function(n,t,e){"use strict";e.d(t,{Dw:function(){return g},vE:function(){return p}});var r=function(){return r=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n},r.apply(this,arguments)};Object.create;Object.create;var i=e(92560),o={};function u(n,t){"Office."===n.substring(0,7)&&"."!==n[n.length-1]?o[n]?(t.ariaTenantToken&&(o[n].ariaTenantToken=t.ariaTenantToken),t.dnmToken&&(o[n].dnmToken=t.dnmToken)):o[n]=t:(0,i.uf)(0,0,(function(){return"Namespace: ".concat(n)}))}function s(n,t){for(var e=n.length;e>0;){var r=n.substr(0,e);if(o[r]){var i=o[r];return t.ariaTenantToken=i.ariaTenantToken,t.dnmToken=i.dnmToken,!0}e=n.lastIndexOf(".",e-1)}return!1}var a=9007199254740991,c=-a,f=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,l=/^[a-zA-Z0-9_\.]{1,95}$/;function h(n){if(!function(n){if(!n||n.length>98)return!1;return f.test(n)}(n.eventName))throw new Error("Invalid eventName");var t=n.eventContract;if(t){if(t.name&&!d(t.name))throw new Error("Invalid eventContract");m(t.dataFields)}m(n.dataFields)}function d(n){return l.test(n)}function m(n){n&&n.forEach((function(n){if("string"!=typeof n.name||!d(n.name))throw new Error("Invalid dataField name");2===n.dataType&&function(n){if("number"!=typeof n||!isFinite(n)||Math.floor(n)!==n||n<c||n>a)throw new Error("Invalid integer ".concat(JSON.stringify(n)))}(n.value)}))}var v=e(63061);function p(n){var t={eventName:n.eventName,eventFlags:n.eventFlags||{},telemetryProperties:n.telemetryProperties?r({},n.telemetryProperties):{},dataFields:n.dataFields?n.dataFields.slice():[],timestamp:n.timestamp||(new Date).getTime()};return n.eventContract&&(t.eventContract={name:n.eventContract.name,dataFields:n.eventContract.dataFields.slice()}),t}var g=function(){function n(n,t,e){var i,o,u;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=e||{},n&&(this.telemetrySinks=n.telemetrySinks,(i=this.persistentDataFields).push.apply(i,n.persistentDataFields),this.config=r(r({},n.getConfig()),this.config),(o=this.partAFields).push.apply(o,n.partAFields)),t&&(u=this.persistentDataFields).push.apply(u,t)}return n.prototype.addEventContentType=function(n,t){n.push((0,v.Kq)("EventContent.Type",t))},n.prototype.sendTelemetryEvent=function(n){var t=p(n),e=t.telemetryProperties;e.nexusTenantToken=-1;var r=e.ariaTenantToken;if(!r&&(!s(t.eventName,e)&&!r))return void(0,i.uf)(0,0,(function(){return"No tenant token: "+n.eventName}));this.sendTelemetryEventInternal(t,1)},n.prototype.sendCustomerContent=function(n){var t=p(n),e=t.telemetryProperties,r=e.customerContentVersion;return(!r||r>2)&&(e.customerContentVersion=2),e.ariaTenantToken=void 0,e.nexusTenantToken=void 0,e.dnmToken=void 0,this.addEventContentType(t.dataFields,2),this.sendTelemetryEventInternal(t,2)},n.prototype.sendDirectNumericEvent=function(n){var t=p(n),e=t.telemetryProperties;if(!e.dnmToken&&(!s(t.eventName,e)&&!e.dnmToken))return void(0,i.uf)(0,0,(function(){return"No dnm token: "+t.eventName}));this.addEventContentType(t.dataFields,1),this.sendTelemetryEventInternal(t,3)},n.prototype.sendTelemetryEventInternal=function(n,t){if(2===t||!n.telemetryProperties.customerContentVersion&&!n.telemetryProperties.customerContentType){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push([n,t]):(0,i.uf)(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(n,t)}catch(n){return void(0,i.H)(0,"SendTelemetryEvent",n)}this.telemetrySinks.forEach((function(e){try{3===t||2===t?e.sendNonStandardEvent&&e.sendNonStandardEvent(n,t):e.sendTelemetryEvent(n)}catch(n){}}))}else(0,i.uf)(0,0,(function(){return"Customer content"}))},n.prototype.processTelemetryEvent=function(n,t){var e,r,i;if(n.dataFields&&(null===(i=n.dataFields)||void 0===i||i.unshift((0,v.dt)("OTelJS.Version","4.13.14")),3!==t&&this.persistentDataFields&&(e=n.dataFields).unshift.apply(e,this.persistentDataFields)),this.partAFields.length>0){var o=n.eventContract||{name:"",dataFields:[]};(r=o.dataFields).push.apply(r,this.partAFields),n.eventContract=o}this.config.disableValidation||h(n)},n.prototype.addSink=function(n){this.telemetrySinks.push(n),this.flushQueue()},n.prototype.flushQueue=function(){var n=this.eventQueue;if(this.eventQueue=[],this.telemetrySinks.length>0)for(var t=0,e=n;t<e.length;t++){var r=e[t],i=r[0],o=r[1];this.sendTelemetryEventInternal(i,o)}},n.prototype.setTenantToken=function(n,t,e){u(n,{ariaTenantToken:t,nexusTenantToken:e})},n.prototype.setDNMToken=function(n,t){u(n,{dnmToken:t})},n.prototype.cloneEvent=function(n){return p(n)},n.prototype.getConfig=function(){return this.config},n}()},56117:function(){function n(n){return $.expr.filters.visible(n)&&!$(n).parents().addBack().filter((function(){return"hidden"===$.css(this,"visibility")})).length}$.extend($.expr[":"],{focusable:function(t){
/*!
 * jQuery UI Core @VERSION
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */
return function(t,e){var r,i,o,u=t.nodeName.toLowerCase();return"area"===u?(i=(r=t.parentNode).name,!(!t.href||!i||"map"!==r.nodeName.toLowerCase())&&!!(o=$("img[usemap=#"+i+"]")[0])&&n(o)):(/input|select|textarea|button|object/.test(u)?!t.disabled:"a"===u&&t.href||e)&&n(t)}(t,!isNaN($.attr(t,"tabindex")))}})},31699:function(n){
/*! @license DOMPurify | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.2.2/LICENSE */
n.exports=function(){"use strict";function n(n){if(Array.isArray(n)){for(var t=0,e=Array(n.length);t<n.length;t++)e[t]=n[t];return e}return Array.from(n)}var t=Object.hasOwnProperty,e=Object.setPrototypeOf,r=Object.isFrozen,i=Object.freeze,o=Object.seal,u=Object.create,s="undefined"!=typeof Reflect&&Reflect,a=s.apply,c=s.construct;a||(a=function(n,t,e){return n.apply(t,e)}),i||(i=function(n){return n}),o||(o=function(n){return n}),c||(c=function(t,e){return new(Function.prototype.bind.apply(t,[null].concat(n(e))))});var f=I(Array.prototype.forEach),l=I(Array.prototype.pop),h=I(Array.prototype.push),d=I(String.prototype.toLowerCase),m=I(String.prototype.match),v=I(String.prototype.replace),p=I(String.prototype.indexOf),g=I(String.prototype.trim),b=I(RegExp.prototype.test),w=y(TypeError);function I(n){return function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return a(n,t,r)}}function y(n){return function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return c(n,e)}}function S(n,t){e&&e(n,null);for(var i=t.length;i--;){var o=t[i];if("string"==typeof o){var u=d(o);u!==o&&(r(t)||(t[i]=u),o=u)}n[o]=!0}return n}function F(n){var e=u(null),r=void 0;for(r in n)a(t,n,[r])&&(e[r]=n[r]);return e}var C=i(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),_=i(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","audio","canvas","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","video","view","vkern"]),T=i(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),P=i(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),N=i(["#text"]),k=i(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns"]),E=i(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),R=i(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),O=i(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),D=o(/\{\{[\s\S]*|[\s\S]*\}\}/gm),x=o(/<%[\s\S]*|[\s\S]*%>/gm),L=o(/^data-[\-\w.\u00B7-\uFFFF]/),M=o(/^aria-[\-\w]+$/),q=o(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),A=o(/^(?:\w+script|data):/i),U=o(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};function G(n){if(Array.isArray(n)){for(var t=0,e=Array(n.length);t<n.length;t++)e[t]=n[t];return e}return Array.from(n)}var B=function(){return"undefined"==typeof window?null:window},z=function(n,t){if("object"!==(void 0===n?"undefined":V(n))||"function"!=typeof n.createPolicy)return null;var e=null,r="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(r)&&(e=t.currentScript.getAttribute(r));var i="dompurify"+(e?"#"+e:"");try{return n.createPolicy(i,{createHTML:function(n){return n}})}catch(n){return console.warn("TrustedTypes policy "+i+" could not be created."),null}};function j(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B(),t=function(n){return j(n)};if(t.version="2.2.3",t.removed=[],!n||!n.document||9!==n.document.nodeType)return t.isSupported=!1,t;var e=n.document,r=n.document,o=n.DocumentFragment,u=n.HTMLTemplateElement,s=n.Node,a=n.NodeFilter,c=n.NamedNodeMap,I=void 0===c?n.NamedNodeMap||n.MozNamedAttrMap:c,y=n.Text,Q=n.Comment,H=n.DOMParser,$=n.trustedTypes;if("function"==typeof u){var W=r.createElement("template");W.content&&W.content.ownerDocument&&(r=W.content.ownerDocument)}var J=z($,e),K=J&&kn?J.createHTML(""):"",X=r,Y=X.implementation,Z=X.createNodeIterator,nn=X.getElementsByTagName,tn=X.createDocumentFragment,en=e.importNode,rn={};try{rn=F(r).documentMode?r.documentMode:{}}catch(n){}var on={};t.isSupported=Y&&void 0!==Y.createHTMLDocument&&9!==rn;var un=D,sn=x,an=L,cn=M,fn=A,ln=U,hn=q,dn=null,mn=S({},[].concat(G(C),G(_),G(T),G(P),G(N))),vn=null,pn=S({},[].concat(G(k),G(E),G(R),G(O))),gn=null,bn=null,wn=!0,In=!0,yn=!1,Sn=!1,Fn=!1,Cn=!1,_n=!1,Tn=!1,Pn=!1,Nn=!0,kn=!1,En=!0,Rn=!0,On=!1,Dn={},xn=S({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","plaintext","script","style","svg","template","thead","title","video","xmp"]),Ln=null,Mn=S({},["audio","video","img","source","image","track"]),qn=null,An=S({},["alt","class","for","id","label","name","pattern","placeholder","summary","title","value","style","xmlns"]),Un=null,Vn=r.createElement("form"),Gn=function(n){Un&&Un===n||(n&&"object"===(void 0===n?"undefined":V(n))||(n={}),n=F(n),dn="ALLOWED_TAGS"in n?S({},n.ALLOWED_TAGS):mn,vn="ALLOWED_ATTR"in n?S({},n.ALLOWED_ATTR):pn,qn="ADD_URI_SAFE_ATTR"in n?S(F(An),n.ADD_URI_SAFE_ATTR):An,Ln="ADD_DATA_URI_TAGS"in n?S(F(Mn),n.ADD_DATA_URI_TAGS):Mn,gn="FORBID_TAGS"in n?S({},n.FORBID_TAGS):{},bn="FORBID_ATTR"in n?S({},n.FORBID_ATTR):{},Dn="USE_PROFILES"in n&&n.USE_PROFILES,wn=!1!==n.ALLOW_ARIA_ATTR,In=!1!==n.ALLOW_DATA_ATTR,yn=n.ALLOW_UNKNOWN_PROTOCOLS||!1,Sn=n.SAFE_FOR_TEMPLATES||!1,Fn=n.WHOLE_DOCUMENT||!1,Tn=n.RETURN_DOM||!1,Pn=n.RETURN_DOM_FRAGMENT||!1,Nn=!1!==n.RETURN_DOM_IMPORT,kn=n.RETURN_TRUSTED_TYPE||!1,_n=n.FORCE_BODY||!1,En=!1!==n.SANITIZE_DOM,Rn=!1!==n.KEEP_CONTENT,On=n.IN_PLACE||!1,hn=n.ALLOWED_URI_REGEXP||hn,Sn&&(In=!1),Pn&&(Tn=!0),Dn&&(dn=S({},[].concat(G(N))),vn=[],!0===Dn.html&&(S(dn,C),S(vn,k)),!0===Dn.svg&&(S(dn,_),S(vn,E),S(vn,O)),!0===Dn.svgFilters&&(S(dn,T),S(vn,E),S(vn,O)),!0===Dn.mathMl&&(S(dn,P),S(vn,R),S(vn,O))),n.ADD_TAGS&&(dn===mn&&(dn=F(dn)),S(dn,n.ADD_TAGS)),n.ADD_ATTR&&(vn===pn&&(vn=F(vn)),S(vn,n.ADD_ATTR)),n.ADD_URI_SAFE_ATTR&&S(qn,n.ADD_URI_SAFE_ATTR),Rn&&(dn["#text"]=!0),Fn&&S(dn,["html","head","body"]),dn.table&&(S(dn,["tbody"]),delete gn.tbody),i&&i(n),Un=n)},Bn=function(n){h(t.removed,{element:n});try{n.parentNode.removeChild(n)}catch(t){n.outerHTML=K}},zn=function(n,e){try{h(t.removed,{attribute:e.getAttributeNode(n),from:e})}catch(n){h(t.removed,{attribute:null,from:e})}e.removeAttribute(n)},jn=function(n){var t=void 0,e=void 0;if(_n)n="<remove></remove>"+n;else{var i=m(n,/^[\r\n\t ]+/);e=i&&i[0]}var o=J?J.createHTML(n):n;try{t=(new H).parseFromString(o,"text/html")}catch(n){}if(!t||!t.documentElement){var u=(t=Y.createHTMLDocument("")).body;u.parentNode.removeChild(u.parentNode.firstElementChild),u.outerHTML=o}return n&&e&&t.body.insertBefore(r.createTextNode(e),t.body.childNodes[0]||null),nn.call(t,Fn?"html":"body")[0]},Qn=function(n){return Z.call(n.ownerDocument||n,n,a.SHOW_ELEMENT|a.SHOW_COMMENT|a.SHOW_TEXT,(function(){return a.FILTER_ACCEPT}),!1)},Hn=function(n){return!(n instanceof y||n instanceof Q||"string"==typeof n.nodeName&&"string"==typeof n.textContent&&"function"==typeof n.removeChild&&n.attributes instanceof I&&"function"==typeof n.removeAttribute&&"function"==typeof n.setAttribute&&"string"==typeof n.namespaceURI)},$n=function(n){return"object"===(void 0===s?"undefined":V(s))?n instanceof s:n&&"object"===(void 0===n?"undefined":V(n))&&"number"==typeof n.nodeType&&"string"==typeof n.nodeName},Wn=function(n,e,r){on[n]&&f(on[n],(function(n){n.call(t,e,r,Un)}))},Jn=function(n){var e=void 0;if(Wn("beforeSanitizeElements",n,null),Hn(n))return Bn(n),!0;if(m(n.nodeName,/[\u0080-\uFFFF]/))return Bn(n),!0;var r=d(n.nodeName);if(Wn("uponSanitizeElement",n,{tagName:r,allowedTags:dn}),("svg"===r||"math"===r)&&0!==n.querySelectorAll("p, br, form, table, h1, h2, h3, h4, h5, h6").length)return Bn(n),!0;if(!$n(n.firstElementChild)&&(!$n(n.content)||!$n(n.content.firstElementChild))&&b(/<[/\w]/g,n.innerHTML)&&b(/<[/\w]/g,n.textContent))return Bn(n),!0;if(!dn[r]||gn[r]){if(Rn&&!xn[r]&&"function"==typeof n.insertAdjacentHTML)try{var i=n.innerHTML;n.insertAdjacentHTML("AfterEnd",J?J.createHTML(i):i)}catch(n){}return Bn(n),!0}return"noscript"!==r&&"noembed"!==r||!b(/<\/no(script|embed)/i,n.innerHTML)?(Sn&&3===n.nodeType&&(e=n.textContent,e=v(e,un," "),e=v(e,sn," "),n.textContent!==e&&(h(t.removed,{element:n.cloneNode()}),n.textContent=e)),Wn("afterSanitizeElements",n,null),!1):(Bn(n),!0)},Kn=function(n,t,e){if(En&&("id"===t||"name"===t)&&(e in r||e in Vn))return!1;if(In&&b(an,t));else if(wn&&b(cn,t));else{if(!vn[t]||bn[t])return!1;if(qn[t]);else if(b(hn,v(e,ln,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===n||0!==p(e,"data:")||!Ln[n])if(yn&&!b(fn,v(e,ln,"")));else if(e)return!1}return!0},Xn=function(n){var e=void 0,r=void 0,i=void 0,o=void 0;Wn("beforeSanitizeAttributes",n,null);var u=n.attributes;if(u){var s={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:vn};for(o=u.length;o--;){var a=e=u[o],c=a.name,f=a.namespaceURI;if(r=g(e.value),i=d(c),s.attrName=i,s.attrValue=r,s.keepAttr=!0,s.forceKeepAttr=void 0,Wn("uponSanitizeAttribute",n,s),r=s.attrValue,!s.forceKeepAttr&&(zn(c,n),s.keepAttr))if(b(/\/>/i,r))zn(c,n);else{Sn&&(r=v(r,un," "),r=v(r,sn," "));var h=n.nodeName.toLowerCase();if(Kn(h,i,r))try{f?n.setAttributeNS(f,c,r):n.setAttribute(c,r),l(t.removed)}catch(n){}}}Wn("afterSanitizeAttributes",n,null)}},Yn=function n(t){var e=void 0,r=Qn(t);for(Wn("beforeSanitizeShadowDOM",t,null);e=r.nextNode();)Wn("uponSanitizeShadowNode",e,null),Jn(e)||(e.content instanceof o&&n(e.content),Xn(e));Wn("afterSanitizeShadowDOM",t,null)};return t.sanitize=function(r,i){var u=void 0,a=void 0,c=void 0,f=void 0,l=void 0;if(r||(r="\x3c!--\x3e"),"string"!=typeof r&&!$n(r)){if("function"!=typeof r.toString)throw w("toString is not a function");if("string"!=typeof(r=r.toString()))throw w("dirty is not a string, aborting")}if(!t.isSupported){if("object"===V(n.toStaticHTML)||"function"==typeof n.toStaticHTML){if("string"==typeof r)return n.toStaticHTML(r);if($n(r))return n.toStaticHTML(r.outerHTML)}return r}if(Cn||Gn(i),t.removed=[],"string"==typeof r&&(On=!1),On);else if(r instanceof s)1===(a=(u=jn("\x3c!----\x3e")).ownerDocument.importNode(r,!0)).nodeType&&"BODY"===a.nodeName||"HTML"===a.nodeName?u=a:u.appendChild(a);else{if(!Tn&&!Sn&&!Fn&&-1===r.indexOf("<"))return J&&kn?J.createHTML(r):r;if(!(u=jn(r)))return Tn?null:K}u&&_n&&Bn(u.firstChild);for(var h=Qn(On?r:u);c=h.nextNode();)3===c.nodeType&&c===f||Jn(c)||(c.content instanceof o&&Yn(c.content),Xn(c),f=c);if(f=null,On)return r;if(Tn){if(Pn)for(l=tn.call(u.ownerDocument);u.firstChild;)l.appendChild(u.firstChild);else l=u;return Nn&&(l=en.call(e,l,!0)),l}var d=Fn?u.outerHTML:u.innerHTML;return Sn&&(d=v(d,un," "),d=v(d,sn," ")),J&&kn?J.createHTML(d):d},t.setConfig=function(n){Gn(n),Cn=!0},t.clearConfig=function(){Un=null,Cn=!1},t.isValidAttribute=function(n,t,e){Un||Gn({});var r=d(n),i=d(t);return Kn(r,i,e)},t.addHook=function(n,t){"function"==typeof t&&(on[n]=on[n]||[],h(on[n],t))},t.removeHook=function(n){on[n]&&l(on[n])},t.removeHooks=function(n){on[n]&&(on[n]=[])},t.removeAllHooks=function(){on={}},t}return j()}()},93641:function(n,t,e){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */
n.exports=function(){"use strict";function n(n){var t=typeof n;return null!==n&&("object"===t||"function"===t)}function t(n){return"function"==typeof n}var r=Array.isArray?Array.isArray:function(n){return"[object Array]"===Object.prototype.toString.call(n)},i=0,o=void 0,u=void 0,s=function(n,t){I[i]=n,I[i+1]=t,2===(i+=2)&&(u?u(y):F())};function a(n){u=n}function c(n){s=n}var f="undefined"!=typeof window?window:void 0,l=f||{},h=l.MutationObserver||l.WebKitMutationObserver,d="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),m="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function v(){return function(){return process.nextTick(y)}}function p(){return void 0!==o?function(){o(y)}:w()}function g(){var n=0,t=new h(y),e=document.createTextNode("");return t.observe(e,{characterData:!0}),function(){e.data=n=++n%2}}function b(){var n=new MessageChannel;return n.port1.onmessage=y,function(){return n.port2.postMessage(0)}}function w(){var n=setTimeout;return function(){return n(y,1)}}var I=new Array(1e3);function y(){for(var n=0;n<i;n+=2)(0,I[n])(I[n+1]),I[n]=void 0,I[n+1]=void 0;i=0}function S(){try{var n=Function("return this")().require("vertx");return o=n.runOnLoop||n.runOnContext,p()}catch(n){return w()}}var F=void 0;function C(n,t){var e=this,r=new this.constructor(P);void 0===r[T]&&$(r);var i=e._state;if(i){var o=arguments[i-1];s((function(){return z(i,r,o,e._result)}))}else G(e,r,n,t);return r}function _(n){var t=this;if(n&&"object"==typeof n&&n.constructor===t)return n;var e=new t(P);return q(e,n),e}F=d?v():h?g():m?b():void 0===f?S():w();var T=Math.random().toString(36).substring(2);function P(){}var N=void 0,k=1,E=2;function R(){return new TypeError("You cannot resolve a promise with itself")}function O(){return new TypeError("A promises callback cannot return that same promise.")}function D(n,t,e,r){try{n.call(t,e,r)}catch(n){return n}}function x(n,t,e){s((function(n){var r=!1,i=D(e,t,(function(e){r||(r=!0,t!==e?q(n,e):U(n,e))}),(function(t){r||(r=!0,V(n,t))}),"Settle: "+(n._label||" unknown promise"));!r&&i&&(r=!0,V(n,i))}),n)}function L(n,t){t._state===k?U(n,t._result):t._state===E?V(n,t._result):G(t,void 0,(function(t){return q(n,t)}),(function(t){return V(n,t)}))}function M(n,e,r){e.constructor===n.constructor&&r===C&&e.constructor.resolve===_?L(n,e):void 0===r?U(n,e):t(r)?x(n,e,r):U(n,e)}function q(t,e){if(t===e)V(t,R());else if(n(e)){var r=void 0;try{r=e.then}catch(n){return void V(t,n)}M(t,e,r)}else U(t,e)}function A(n){n._onerror&&n._onerror(n._result),B(n)}function U(n,t){n._state===N&&(n._result=t,n._state=k,0!==n._subscribers.length&&s(B,n))}function V(n,t){n._state===N&&(n._state=E,n._result=t,s(A,n))}function G(n,t,e,r){var i=n._subscribers,o=i.length;n._onerror=null,i[o]=t,i[o+k]=e,i[o+E]=r,0===o&&n._state&&s(B,n)}function B(n){var t=n._subscribers,e=n._state;if(0!==t.length){for(var r=void 0,i=void 0,o=n._result,u=0;u<t.length;u+=3)r=t[u],i=t[u+e],r?z(e,r,i,o):i(o);n._subscribers.length=0}}function z(n,e,r,i){var o=t(r),u=void 0,s=void 0,a=!0;if(o){try{u=r(i)}catch(n){a=!1,s=n}if(e===u)return void V(e,O())}else u=i;e._state!==N||(o&&a?q(e,u):!1===a?V(e,s):n===k?U(e,u):n===E&&V(e,u))}function j(n,t){try{t((function(t){q(n,t)}),(function(t){V(n,t)}))}catch(t){V(n,t)}}var Q=0;function H(){return Q++}function $(n){n[T]=Q++,n._state=void 0,n._result=void 0,n._subscribers=[]}function W(){return new Error("Array Methods must be provided an Array")}var J=function(){function n(n,t){this._instanceConstructor=n,this.promise=new n(P),this.promise[T]||$(this.promise),r(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?U(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&U(this.promise,this._result))):V(this.promise,W())}return n.prototype._enumerate=function(n){for(var t=0;this._state===N&&t<n.length;t++)this._eachEntry(n[t],t)},n.prototype._eachEntry=function(n,t){var e=this._instanceConstructor,r=e.resolve;if(r===_){var i=void 0,o=void 0,u=!1;try{i=n.then}catch(n){u=!0,o=n}if(i===C&&n._state!==N)this._settledAt(n._state,t,n._result);else if("function"!=typeof i)this._remaining--,this._result[t]=n;else if(e===tn){var s=new e(P);u?V(s,o):M(s,n,i),this._willSettleAt(s,t)}else this._willSettleAt(new e((function(t){return t(n)})),t)}else this._willSettleAt(r(n),t)},n.prototype._settledAt=function(n,t,e){var r=this.promise;r._state===N&&(this._remaining--,n===E?V(r,e):this._result[t]=e),0===this._remaining&&U(r,this._result)},n.prototype._willSettleAt=function(n,t){var e=this;G(n,void 0,(function(n){return e._settledAt(k,t,n)}),(function(n){return e._settledAt(E,t,n)}))},n}();function K(n){return new J(this,n).promise}function X(n){var t=this;return r(n)?new t((function(e,r){for(var i=n.length,o=0;o<i;o++)t.resolve(n[o]).then(e,r)})):new t((function(n,t){return t(new TypeError("You must pass an array to race."))}))}function Y(n){var t=new this(P);return V(t,n),t}function Z(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function nn(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var tn=function(){function n(t){this[T]=H(),this._result=this._state=void 0,this._subscribers=[],P!==t&&("function"!=typeof t&&Z(),this instanceof n?j(this,t):nn())}return n.prototype.catch=function(n){return this.then(null,n)},n.prototype.finally=function(n){var e=this,r=e.constructor;return t(n)?e.then((function(t){return r.resolve(n()).then((function(){return t}))}),(function(t){return r.resolve(n()).then((function(){throw t}))})):e.then(n,n)},n}();function en(){var n=void 0;if(void 0!==e.g)n=e.g;else if("undefined"!=typeof self)n=self;else try{n=Function("return this")()}catch(n){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=n.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(n){}if("[object Promise]"===r&&!t.cast)return}n.Promise=tn}return tn.prototype.then=C,tn.all=K,tn.race=X,tn.resolve=_,tn.reject=Y,tn._setScheduler=a,tn._setAsap=c,tn._asap=s,tn.polyfill=en,tn.Promise=tn,tn}()},58772:function(n,t,e){"use strict";var r=e(90331);function i(){}function o(){}o.resetWarningCache=i,n.exports=function(){function n(n,t,e,i,o,u){if(u!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return n}n.isRequired=n;var e={array:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:t,element:n,elementType:n,instanceOf:t,node:n,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return e.PropTypes=e,e}},23615:function(n,t,e){n.exports=e(58772)()},90331:function(n){"use strict";n.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},16586:function(n,t,e){"use strict";e.d(t,{Z9:function(){return o},ZL:function(){return u},wT:function(){return i}});var r=(0,e(4851).Rm)((function(){try{if(window.trustedTypes&&window.trustedTypes.createPolicy)return window.trustedTypes.createPolicy("formsTrustedTypePolicy",{createScriptURL:function(n){return n},createScript:function(n){return n},createHTML:function(n){return n}})}catch(n){return null}}));function i(n){var t=r();return t?t.createScriptURL(n):n}function o(n){var t=r();return t?t.createScript(n):n}function u(n){var t=r();return t?t.createHTML(n):n}},59749:function(n,t,e){"use strict";e.d(t,{M5:function(){return i},kM:function(){return u},uq:function(){return o}});var r=e(16586);function i(n,t){n.src=(0,r.wT)(t)}function o(n){return new Worker((0,r.wT)(n))}function u(n,t){n.innerHTML=(0,r.ZL)(t)}},69065:function(n,t,e){"use strict";e.d(t,{$W:function(){return f},Mk:function(){return h},en:function(){return o},hq:function(){return s},sL:function(){return l},zn:function(){return d}});function r(n){var t=[n.R,n.G,n.B].map((function(n){return(n/=255)<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4)}));return.2126*t[0]+.7152*t[1]+.0722*t[2]}function i(n){return(r({R:255,G:255,B:255})+.05)/(r(n)+.05)>4.5}function o(n){return i(n)?{R:255,G:255,B:255}:{R:0,G:0,B:0}}function u(n){var t=n.toString(16);return 1===t.length?"0".concat(t):t}function s(n){return"#".concat(u(n.R)).concat(u(n.G)).concat(u(n.B))}function a(n){var t,e=n.R,r=n.G,i=n.B,o=Math.max(e,r,i),u=Math.min(e,r,i),s=o-u,a=0===o?0:s/o,c=o/255;switch(o){case u:t=0;break;case e:t=r-i+s*(r<i?6:0),t/=6*s;break;case r:t=i-e+2*s,t/=6*s;break;case i:t=e-r+4*s,t/=6*s}return{H:t,S:a,V:c}}function c(n){var t,e,r,i,o,u,s,a,c=n.H,f=n.S,l=n.V;switch(u=l*(1-f),s=l*(1-(o=6*c-(i=Math.floor(6*c)))*f),a=l*(1-(1-o)*f),i%6){case 0:t=l,e=a,r=u;break;case 1:t=s,e=l,r=u;break;case 2:t=u,e=l,r=a;break;case 3:t=u,e=s,r=l;break;case 4:t=a,e=u,r=l;break;case 5:t=l,e=u,r=s}return{R:Math.round(255*t),G:Math.round(255*e),B:Math.round(255*r)}}function f(n){n.startsWith("#")&&(n=n.substring(1)),3===n.length&&(n=n.split("").map((function(n){return n+n})).join(""));var t=parseInt(n,16);return{R:t>>16&255,G:t>>8&255,B:255&t}}function l(n){var t=f(n),e=a(t);return r(t)>186&&(e.V=.45,t=c(e)),s(t)}function h(n){var t=a(f(n));return s(c({H:t.H,S:t.S,V:t.V>=.1?t.V-.1:0}))}function d(n){var t,e=a(f(n));return t=e.S>.05?.05:0,s(c({H:e.H,S:t,V:.95}))}},80820:function(n,t,e){"use strict";e.d(t,{B7:function(){return s},Ej:function(){return c},NF:function(){return o},UF:function(){return f},d0:function(){return a},lP:function(){return d},mr:function(){return r},oc:function(){return h},pN:function(){return i},ps:function(){return u},tu:function(){return l}});var r="#242424",i="#616161",o="#bdbdbd",u="#f0f0f0",s="#03787c",a="#014446",c="#fff",f="transparent",l=s,h=a,d="#e8f2f4"},32782:function(n,t,e){"use strict";var r=e(87363),i=r.Suspense;t.Z=function(n){var t=n.children,e=n.fallback;return r.createElement(i,{fallback:e||null},t)}},37944:function(n,t,e){"use strict";e.d(t,{H:function(){return u}});var r=e(59312),i=e(87363),o=e(70069),u=i.forwardRef((function(n,t){var e=n.$as,u=void 0===e?"span":e,s=n.$html,a=(0,r._T)(n,["$as","$html"]),c=u;return i.createElement(c,(0,r.pi)({},a,{dangerouslySetInnerHTML:{__html:(0,o.s)({$text:s})},ref:t}))}))},80439:function(n,t,e){"use strict";var r,i,o,u,s;e.d(t,{Ac:function(){return u},MQ:function(){return i},Ml:function(){return s},b_:function(){return o}}),function(n){n.Contact="Contact"}(r||(r={})),function(n){n[n.NotAvailable=1]="NotAvailable",n[n.NotAvailableDueToSettingChange=2]="NotAvailableDueToSettingChange",n[n.NotAvailableDueToCountryAvailablity=3]="NotAvailableDueToCountryAvailablity",n[n.ExhaustedPromocodes=4]="ExhaustedPromocodes",n[n.Available=5]="Available",n[n.Success=6]="Success",n[n.Failed=7]="Failed",n[n.SuccessWithNoData=8]="SuccessWithNoData"}(i||(i={})),function(n){n[n.EmbedInline=0]="EmbedInline",n[n.EmbedPopup=1]="EmbedPopup",n[n.EmbedButton=2]="EmbedButton"}(o||(o={})),function(n){n[n.Standard=0]="Standard",n[n.Compact=1]="Compact"}(u||(u={})),function(n){n.RuntimeCssVars="FormsRuntimeCssVars",n.RuntimeHtmlDataAttrs="FormsRuntimeHtmlDataAttrs"}(s||(s={}))},36476:function(n,t,e){"use strict";e.d(t,{$B:function(){return s},_k:function(){return u}});var r=e(94978),i=e(9947),o="/cdn";function u(){var n=(0,i.k0)();return"cdnEndpoint"in n?n.cdnEndpoint:(0,r.Gw)("CdnEndPoint")}function s(n){var t=u();return function(n,t,e){if(!n)return"";var r=n.toLowerCase();if(!t)return r;return(e||o)+r}(n,(0,i.k0)().isCdnEnabled,t)}},78587:function(n,t,e){"use strict";e.d(t,{Jn:function(){return s},oE:function(){return a}});var r=e(9947),i=e(36476),o="/FormsPro",u={defaultFolder:{css:"/css/dist/",js:"/Scripts/dists/"},vendorsFolder:{css:"/css/",js:"/Scripts/"}};function s(n){return n?(0,r.k0)().isCdnEnabled?(0,i.$B)(n):(0,r.k0)().addPrefixForProWhenNoCdn?o+n:n:""}function a(n,t){if(!n)return"";var e=n.split(".").pop();if("js"!==e&&"css"!==e)return n;var s=function(n,t){return(/^vendors\//i.test(n)?u.vendorsFolder:u.defaultFolder)[t]}(n,e)+n,a=(0,r.k0)().hashMapping,c=(0,r.k0)().isCdnEnabled;if(c&&void 0!==a){var f=a[n.toLowerCase()];if(void 0!==f){var l=s.replace(new RegExp(e+"$"),"".concat(f,".").concat(e));return(0,i.$B)(l)}}var h=s+(t?"?v="+(0,r.k0)().version:""),d=(0,r.k0)().ring;return!c&&d&&(h="".concat(h).concat(t?"&":"?","ring=").concat(d)),(0,r.k0)().addPrefixForProWhenNoCdn?o+h:h}},86353:function(n,t,e){"use strict";e.d(t,{$K:function(){return h},DP:function(){return l}});var r,i=e(59312),o=e(9947),u=e(90710),s=e(60211),a={settings:"",configIds:"",etag:""},c=!1;function f(){if(!c){var n="Unknown",t=(0,s.yv)()?0:2,e={IntelligenceExp1:n,IntelligencePollContentExp:n,IntelligencePollEngageExp:n,IntelligencePollIntentExp:n,IntelligencePollResponseViewExp:n,IntelligencePollChoiceResultViewExp:n,IntelligenceAutoExpandSuggestQuestions:t,SurveyContentIteration:n,ThemeRanker:0,SmartConvertMVP2:t,TimedForm:0,TeamsPollCreateNewExp:0,SdxDataSyncExp:0,ThanyouPageV2:0,LeaveSiteDialog:0,FormsAssistantMVP1:0,ActionSuggestionExp:0,IntelligenceUserTier:0,MathQuestionExp:0,DisableIntent:0,DropDavinci3:0,SpeedupPlanA:0,FREPlaygroundExp:0,ReuseQuestionExp:0,ThankYouPagePromotionV2:0,PlaygroundIterationExp:0,CreateFormImprovementExp:0,FormTitleEditGuidingExp:0,ShowTemplateForColdStart:0,FormsTutorExp:0,AddButtonUXExp:0,FooterBranding:0,LivePresentRefresh:0};r=(0,o.k0)().ecsConfigSettings||a,(0,i.pi)((0,i.pi)((0,i.pi)({},e),function(n){var t;try{t=JSON.parse(decodeURI(n||"{}"))}catch(n){t={}}return t}(r.settings)),function(){var n="fo",t=(0,u.NW)()[n];Array.isArray(t)&&(t=t[t.length-1]);var e={};t&&t.split(";").forEach((function(n){"!"!==n[0]?e[n]=!0:(n=n.substr(1),e[n]=!1)}));return e}()),c=!0}}function l(){return c||f(),r.configIds}function h(){return c||f(),"true"===r.isFirstRelease}},60211:function(n,t,e){"use strict";e.d(t,{kD:function(){return i},iI:function(){return p},Fc:function(){return u},rq:function(){return s},_7:function(){return g},Mr:function(){return d},bQ:function(){return m},j4:function(){return c},H5:function(){return w},Gd:function(){return I},yv:function(){return o},x8:function(){return a},H:function(){return h},Ke:function(){return l},u7:function(){return f},a4:function(){return v}});var r=e(9947);function i(){return(0,r.k0)().environmentType}function o(){return n=i(),/.*Prod$/.test(n)||"CVTip"===n||"CVFastfood"===n||"USNat"===n||"USSec"===n;var n}function u(){return function(n){switch(n){case"WWProd":case"MSProd":case"CVProd":case"CVTip":case"CVFastfood":return"9188040d-6c67-4c5b-b112-36a304b66dad";default:return"4925308c-f164-4d2d-bc7e-0631132e9375"}}(i())}function s(){return function(n){switch(n){case"WWProd":case"MSProd":case"CVProd":case"CVTip":case"CVFastfood":return"72f988bf-86f1-41af-91ab-2d7cd011db47";default:return"f686d426-8d16-42db-81b7-ab578e110ccd"}}(i())}function a(){return"USGovProd"===(n=i())||"USDoDProd"===n||"USGovGccProd"===n||"USNat"===n||"USSec"===n;var n}function c(){return"USGovProd"===(n=i())||"USDoDProd"===n||"USNat"===n||"USSec"===n;var n}function f(){return"USGovGccProd"===i()}function l(){return"USGovProd"===i()}function h(){return"USDoDProd"===i()}function d(){return"USNat"===i()}function m(){return"USSec"===i()}function v(){return"WWProd"===(n=i())||"MSProd"===n||"CVProd"===n||"CVTip"===n||"CVFastfood"===n;var n}function p(){return function(n){switch(n){case"WWProd":case"MSProd":case"CVProd":case"CVTip":case"CVFastfood":return["89d8a01e-e5db-493e-8720-b820d953ef20","b6338c92-533e-4f6d-a327-994263712399"];default:return["f686d426-8d16-42db-81b7-ab578e110ccd"]}}(i())}function g(){return function(n){switch(n){case"WWProd":return"https://c.office.com";case"MSProd":case"CVProd":case"CVTip":case"CVFastfood":return"https://c1.microsoft.com";case"Int":return"https://c.office-int.com";default:return null}}(i())}function b(){return window.location.host.toLocaleLowerCase()}function w(){return b().indexOf("forms.microsoft")>=0}function I(){return b().indexOf(".forms.osi.office.net")>0}},94290:function(n,t,e){"use strict";e.d(t,{A9:function(){return m},CE:function(){return x},Eh:function(){return F},GF:function(){return O},HI:function(){return q},HQ:function(){return G},Ig:function(){return V},Kw:function(){return k},QR:function(){return L},RQ:function(){return A},S0:function(){return R},W6:function(){return B},Wy:function(){return b},XF:function(){return y},_y:function(){return g},av:function(){return _},ft:function(){return M},gx:function(){return v},hj:function(){return p},jM:function(){return T},lS:function(){return U},mF:function(){return D},rh:function(){return S},s0:function(){return E},uV:function(){return N}});var r,i=e(63795),o=e(9947),u=e(90710);!function(n){n[n.signup=1]="signup"}(r||(r={}));var s,a,c,f,l,h,d="delegatepage.aspx",m="popupNotifyType",v="auth_pvr",p="platform",g="jsSdkVersion",b="id",w=null,I=!1;function y(){return c||F()}function S(){return h||(h=(0,u.NW)().appid)}function F(){var n=c||(0,u.NW)().Host||(0,u.$p)().Host;switch(n){case"Assignments":case"Bookings":case"EmbedTestPage":case"Excel":case"Excel_Win32":case"Fluid_Component":case"Loop":case"ODC":case"OneDrive":case"OneNote":case"OneNoteUwp":case"Outlook":case"Outlook_Web_App_Fluid":case"PowerPointContent":case"PowerPointTaskpane":case"ProjectShimla":case"Stream":case"StreamMobile":case"SupplyChainInsights":case"Teams":case"TeamsApproval":case"TeamsBot":case"TeamsPollTab":case"TeamsPollBubble":case"TeamsBotForLife":case"TeamsReports":case"TeamsTab":case"Union":case"Word_Web":case"Word_Web_Fluid":return n;default:return null}}function C(){return f||r[f&&r[f]||(0,u.NW)().redirectorigin||(0,u.$p)().redirectorigin]}function _(){return s||(0,u.NW)().groupId||(0,u.$p)().groupId}function T(){return a||(0,u.NW)().tid||(0,u.$p)().tid}function P(){return l}function N(){return!!F()||!!(0,o.k0)().isOembedSPO}function k(){var n=y();return("Teams"===n||"TeamsBot"===n||"TeamsPollTab"===n||"TeamsPollBubble"===n||"TeamsBotForLife"===n)&&"undefined"!=typeof microsoftTeams}function E(){return"Guest"===P()||"Anonymous"===P()}function R(){return"Bookings"===y()}function O(){return"Assignments"===y()}function D(){return"Union"===y()}function x(){return"/pages/assignmentsdesignpage.aspx"===window.location.pathname.toLowerCase()||"/pages/assignmentsresponsepage.aspx"===window.location.pathname.toLowerCase()}function L(){return k()||O()||"Stream"===y()||"StreamMobile"===y()||("Bookings"===(n=y())||"EmbedTestPage"===n||"Loop"===n||"PurView"===n||"SupplyChainInsights"===n||"Teams"===n||"TeamsApproval"===n||"TeamsReports"===n);var n}function M(){return"PowerPointTaskpane"===y()||"PowerPointContent"===y()||"PowerPointLive"===y()}function q(){return-1!==window.location.pathname.indexOf("FluidFormPage")}function A(){return C()===r.signup}function U(){if(null===w){var n=(0,i.Ee)(window.location.pathname,"/").toLowerCase();w=n.lastIndexOf(d)===n.length-d.length}return w}function V(){return I}function G(){return(0,u.NW)().cdsId}function B(){return(0,u.NW)().cdsRegion}},66676:function(n,t,e){"use strict";e.d(t,{K:function(){return o},t:function(){return u}});var r=e(9947),i=e(90710);function o(){var n=(0,r.k0)().cultureInfo;return n&&n.Name||(0,i.NW)().lang}function u(){return document&&document.body&&"rtl"===document.body.getAttribute("dir")}},34221:function(n,t,e){"use strict";e.d(t,{n:function(){return r}});var r=(0,e(4851).$7)(0)},43209:function(n,t,e){"use strict";e.d(t,{C2:function(){return i},_B:function(){return o},aK:function(){return u}});var r="/formspro";function i(n){var t=n&&n.toLowerCase()||window.location.pathname.toLowerCase();switch(u()&&(t=t.substring(r.length)),t){case"/pages/designpage.aspx":case"/pages/teamsdesignpage.aspx":case"/pages/onenoteaddinpage.aspx":case"/pages/delegatepage.aspx":case"/pages/teamsmeetingpollpage.aspx":case"/pages/designpagev2.aspx":return"Design";case"/pages/responsepage.aspx":case"/pages/teamsresponsepage.aspx":return"Response";case"/pages/analysispage.aspx":return"Analyze";case"/pages/teamsconfigpage.aspx":return"TeamsConfig";case"/pages/shareformpage.aspx":return"ShareForm";case"/pages/responsepreviewpage.aspx":return"ResponsePreviewPage";case"/pages/adminphishingreviewpage.aspx":return"AdminPhishingReviewPage";case"/pages/fluidformpage.aspx":return"Fluid";case"/pages/filedownloadpage.aspx":return"FileDownload";case"/pages/responsedetailpage.aspx":return"ResponseDetailPage";default:return"Unknown"}}function o(){var n=window.location.host.toLocaleLowerCase();return n.indexOf("cus-000.forms.osi.office.net")>=0||n.indexOf("tip.forms.office.com")>=0||n.indexOf("tip.customervoice.microsoft.com")>=0}function u(){return!!window.location.pathname.toLocaleLowerCase().startsWith(r)}},56010:function(n,t,e){"use strict";e.d(t,{hp:function(){return i}});var r=e(90710);function i(){var n=(0,r.NW)().route;if(n){var t=n.toLowerCase();switch(t){case"groupforms":case"myforms":case"officehome":case"start":case"templates":return t;default:return"others"}}}},29559:function(n,t,e){"use strict";e.d(t,{Dt:function(){return p},G6:function(){return v},K$:function(){return g},MG:function(){return b},c:function(){return w},gn:function(){return d},i7:function(){return f},lZ:function(){return s},rA:function(){return a},tH:function(){return h},tq:function(){return o},un:function(){return l},vh:function(){return m},w1:function(){return c}});var r=e(94978);function i(){return navigator.userAgent.toLocaleLowerCase()}function o(){var n=i();return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iPad|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(n.substr(0,4))}function u(){return window.innerWidth}function s(){return o()&&a()}function a(){return u()<=640}function c(){var n=i();return-1!==n.indexOf("msie")||-1!==n.indexOf("trident/")}function f(){var n=i();return-1!==n.indexOf("chrome/")&&-1===n.indexOf("edge/")}function l(){return-1!==i().indexOf("edge/")}function h(){return-1!==i().indexOf("firefox/")}function d(){return/ip(hone|od|ad)/.test(i())&&!window.MSStream}function m(){var n=i(),t=-1!==n.indexOf("version/9")||-1!==n.indexOf("version/13");return-1!==n.indexOf("mac os x")&&t&&-1!==n.indexOf("safari")}function v(){return i().indexOf("safari")>-1}function p(){return!!i().match(/android/i)}function g(){return-1!==i().indexOf("tbs/")}function b(){return-1!==i().indexOf("micromessenger/")}function w(){return-1!==navigator.platform.toLowerCase().indexOf("win")}(0,r.QJ)("SearchEngineBotList")},79552:function(n,t,e){"use strict";e.d(t,{WP:function(){return o},Y8:function(){return u},xP:function(){return i}});var r=e(89904);function i(n,t){var e=n;return!(e||n||!(0,r.AX)(n))||s(t,e&&e.type,e&&e.statusCode)}function o(n,t){return s(t,n&&n.failureType,n&&n.statusCode)}function u(n){var t=n;if(t&&t.statusCode)return JSON.stringify({correlationId:t.correlationId,innerCode:t.innerCode,innerMessage:t.innerMessage,isServerError:t.isServerError,statusCode:t.statusCode,statusText:t.statusText,type:t.type});var e=n;return e&&e.message?JSON.stringify({message:e.message,name:e.name,stack:a(e.stack)}):a(JSON.stringify(n||""))}function s(n,t,e){switch(n){case"Information":case"FormsProInformation":return!0;case"Error":return!1;default:switch(t){case"Failure":return!1;case"ExpectedFailure":return!0;default:if(e>=0&&e<500)return!0}}return!1}function a(n){return n&&"string"==typeof n&&n.toLowerCase().indexOf("auth_upn")<0&&n.toLowerCase().indexOf("token")<0?n:n?"Sanitized error":""}},46407:function(n,t,e){"use strict";e.d(t,{FP:function(){return r},kC:function(){return i}});var r="Customized Theme",i="Default Theme";"https://".concat("cdn.hubblecontent.osi.office.net","/")},687:function(n,t,e){"use strict";e.d(t,{FT:function(){return y},Fy:function(){return c},GC:function(){return w},HJ:function(){return a},HR:function(){return d},LY:function(){return u},NJ:function(){return o},R3:function(){return g},Rr:function(){return f},g1:function(){return b},gX:function(){return r},hN:function(){return v},ip:function(){return I},jm:function(){return m},kA:function(){return i},vM:function(){return s},vT:function(){return S},w_:function(){return l},xZ:function(){return p},yi:function(){return h}});var r=function(){return 200},i=function(){return 1e3},o=function(){return 4e3},u=function(){return 1e3},s=function(){return 800},a=function(){return 600},c=function(){return 719},f=function(){return 320},l=function(){return 240},h=function(){return 5242880},d=function(){return 422},m=function(){return 5242880},v=function(){return 4e3},p=function(){return 3e3},g=function(){return 5},b=function(){return 1e3},w=function(){return 200},I=function(){return 10},y=function(){return/^[\w+!#$%&'*+-/=?^_`{|}~.]+@[\w+.-]+\.[\w+.]+$/},S=function(){return 28}},9947:function(n,t,e){"use strict";e.d(t,{cm:function(){return s},k0:function(){return u}});var r=e(59312),i=e(9754),o=[];function u(){var n;return null!==(n=window.OfficeFormServerInfo)&&void 0!==n?n:{cultureInfo:{Name:navigator.language},environmentType:"WWProd",serverInfoFromPageHeaders:{},userInfo:{}}}function s(n){var t;t=(0,r.pi)((0,r.pi)({},window.OfficeFormServerInfo),n),window.OfficeFormServerInfo=t,o.forEach((function(n){"function"==typeof n&&n(window.OfficeFormServerInfo)})),n.ecsWebSettings&&(0,i.EG)(n.ecsWebSettings)}},41797:function(n,t,e){"use strict";function r(){return{context:{},iKey:"91531c5d891c486da00dddb1049c30a2-e90b69b1-4f29-40bb-8d25-66d7d26ede43-7437",disableAdvancedScans:!0}}e.d(t,{b:function(){return r}})},5809:function(n,t,e){"use strict";e.d(t,{DY:function(){return a},Lu:function(){return c},kI:function(){return s},zA:function(){return f}});var r=e(37076),i=e(5699),o=e(14327);function u(n){switch(n){case"WWProd":case"MSProd":case"CVProd":case"CVTip":case"CVFastfood":return"9188040d-6c67-4c5b-b112-36a304b66dad";default:return"4925308c-f164-4d2d-bc7e-0631132e9375"}}function s(n,t,e,o,s){var a=f(n),c=function(n,t,e,o,s){switch(n){case"Int":case"MSInt":case"CVInt":return i.uS;case"WWProd":case"MSProd":case"ProTip":case"CVTip":case"CVProd":case"CVFastfood":return o?i.$w:s?i.J9:function(n,t,e){if(n){var i=(0,r.kc)(n);return!!i.OrgId&&i.OrgId.toLowerCase()===u(e)}return function(n,t){return!!n&&n.toLowerCase()===u(t)}(t,e)}(t,e,n)?i.Tb:i.QA;case"USGovGccProd":return s?i.wc:i.f0;case"USGovProd":return i.lv;case"USDoDProd":return i.Hs;case"USNat":return i.bf;case"USSec":return i.zo;default:return i.Bv}}(n,t,e,o,s);return{EndpointUrl:a,AriaToken:c}}function a(n,t,e,r,u){var s,a=location.pathname.toLowerCase(),c=(0,o.Or)(a)?a:"[invalid_page_type]",f=((s={})[i.m0]=n.clientBuild,s[i.VZ]=t,s[i.iA]=e,s[i.Gy]=c,s[i.gU]=n.serverBuild,s[i.lV]=n.datacenter,s[i.L]=n.ring,s[i.Q_]=n.serverSessionId,s[i.iQ]=r?"Office FormsPro BrowserApp":u?"Office Forms Webdriver":"Office Forms BrowserApp",s);if(n.serverInfoFromPageHeaders){var l=n.serverInfoFromPageHeaders;f[i.nq]=l.routingBuild,f[i.ul]=l.routingDataCenter,f[i.Cm]=l.routingInstance,f[i.QM]=l.serverInstance}return f}function c(n,t,e){var r,o=n.userInfo,u=o.UserId,s=o.TenantId,a=o.IsMsa,c=o.PUID,f=((r={})[i.E1]=u,r[i.OP]=t,r[i.xM]=s,r);return s?(a?(f[i.rd]=c,f[i.i7]="MSAPUID"):(f[i.rd]=u,f[i.i7]="UserObjectId"),f[i.Qx]=s):f[i.gK]=e,f}function f(n){switch(n){case"USGovProd":return"https://tb.events.data.microsoft.com/OneCollector/1.0/";case"USDoDProd":return"https://pf.events.data.microsoft.com/OneCollector/1.0/";case"USNat":return"https://collector.azure.eaglex.ic.gov/OneCollector/1.0/";case"USSec":return"https://collector.azure.microsoft.scloud/OneCollector/1.0/"}return null}},82195:function(n,t,e){"use strict";e.d(t,{F:function(){return i},a:function(){return o}});var r=e(63061);function i(n,t,e,i,o){if(void 0!==e){var u=i,s=void 0;"boolean"==typeof e?s=(0,r.UL)(t,e,u):"number"==typeof e?s=Math.floor(e)===e?(0,r.Kq)(t,e,u):(0,r.b_)(t,e,u):"string"==typeof e&&(s=o?(0,r.xq)(t,e,u):(0,r.dt)(t,e,u)),s&&n.push(s)}}function o(n,t,e,r,o,u){i(n,t?t+"."+e:e,r,o,u)}},87260:function(n,t,e){"use strict";e.d(t,{I:function(){return i}});var r=e(73546);function i(){return new Promise((function(n){(0,r.j)().flushAndStop(n)}))}},94283:function(n,t,e){"use strict";e.d(t,{AC:function(){return u},OE:function(){return o},Zz:function(){return s}});var r=e(73546);function i(n){var t;n.$timestamp=null!==(t=n.$timestamp)&&void 0!==t?t:Date.now(),(0,r.j)().sendTelemetryEvent(n)}function o(n,t){i({$eventName:n,$eventType:2,$eventFlags:8,$eventData:t})}function u(n,t){i({$eventName:n,$eventType:8,$eventFlags:10,$eventData:t})}function s(n,t){i({$eventName:n,$eventType:6,$eventFlags:8,$eventData:t})}},916:function(n,t,e){"use strict";e.d(t,{o:function(){return a}});var r=e(49690),i=e(73546),o=e(85708),u=e(97265),s=e(2775),a=function(){function n(n,t){void 0===t&&(t=null),this.T={correlationId:t||(0,u.GW)(),duration:0,eventName:n,eventType:"qos_event",extraData:void 0,qosEventName:n},this.W=null}return Object.defineProperty(n.prototype,"CorrelationId",{get:function(){return this.T.correlationId},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ExtraData",{get:function(){return this.T.extraData},set:function(n){this.T.extraData=n},enumerable:!1,configurable:!0}),n.prototype.start=function(n){void 0===n&&(n=null),this.W=n||(0,o.dg)();var t=this.X(this.T,0);(0,i.j)().logData(t)},n.prototype.end=function(n){var t=this.X(n,1);return(0,i.j)().logData(t),t.duration},n.prototype.log=function(n){var t=this.X(n,2);(0,i.j)().logData(t)},n.prototype.X=function(n,t){var e=(0,s.d9)(this.T);switch(null!==this.W&&0!==t&&(e.duration=(0,o.dg)()-this.W),n.extraData&&(e.extraData=n.extraData),t){case 0:e.qosEventStatus="Start";break;case 2:e.qosEventStatus=(0,r.x)(["Logging",n.resultCode]);break;case 1:e.qosEventStatus=n.resultType}return e.eventName=(0,r.x)([e.eventName,e.qosEventStatus]),e},n}()},41480:function(n,t,e){"use strict";e.d(t,{k:function(){return u}});var r,i=e(9947),o=e(97265);function u(){if(r)return r;var n=(0,i.k0)().serverSessionId;return r=n||(0,o.GW)()}},42922:function(n,t,e){"use strict";e.d(t,{G:function(){return s},U:function(){return u}});var r,i=e(37890),o=e(9754);function u(n){a().resolve(n||(0,o.dR)("EventCollectorUri"))}function s(){return a().promise()}function a(){return r||(r=new i.wU),r}},78606:function(n,t,e){"use strict";var r=e(83390),i=["ajax.aspnetcdn.com","alcdn.msauth.net","amcdn.msftauth.net","apis.google.com","appsforoffice.microsoft.com","cdn.forms.office.net","cdn.office.net","js.monitor.azure.com","mem.gfx.ms",".office365.com","www.microsoft.com"],o=["cdnjs.cloudflare.com","localhost"],u=["chrome-extension:"];!function(){try{window.trustedTypes&&window.trustedTypes.createPolicy&&!window.trustedTypes.defaultPolicy&&window.trustedTypes.createPolicy("default",{createScriptURL:function(n){if(function(n){var t=new URL(n,window.origin),e=(0,r.xW)();return o.some((function(n){return t.host.endsWith(n)}))&&!e?e:i.some((function(n){return t.host.endsWith(n)}))||t.host===window.location.host||u.some((function(n){return n===t.protocol}))}(n))return n}})}catch(n){}}()},75827:function(n,t,e){"use strict";e.d(t,{$O:function(){return i}});var r=e(73252);function i(){return(0,r.cr)("EnableECSInFirstRelease")}},83894:function(n,t,e){"use strict";e.d(t,{Ak:function(){return a},Wh:function(){return s},ro:function(){return u}});var r=e(60211),i=e(9947),o=function(){return(0,i.k0)().userInfo.TenantId};function u(n){return!(!(n=n||o())||n.toLowerCase()!==(0,r.Fc)())}function s(n){return!(!(n=n||o())||n.toLowerCase()!==(0,r.rq)())}function a(n){return(n=n||o())&&-1!==(0,r.iI)().indexOf(n.toLowerCase())}},262:function(n,t,e){"use strict";function r(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var e=n.map((function(n){return n&&n.trim()})).filter((function(n){return!!n})).join(" ");return e||n.some((function(n){return""===n}))||(e=void 0),e}e.d(t,{j:function(){return r}})},72420:function(n,t,e){"use strict";function r(n){return"number"==typeof n}function i(n){return"string"==typeof n}e.d(t,{HD:function(){return i},hj:function(){return r}})},85708:function(n,t,e){"use strict";function r(){return Date.now||(Date.now=function(){return(new Date).getTime()}),Math.floor(Date.now())}e.d(t,{dg:function(){return r}})},83390:function(n,t,e){"use strict";e.d(t,{Xy:function(){return r},xW:function(){return i}});var r=function(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];if(i())switch(n){case 0:console.error.apply(console,t);break;case 1:console.warn.apply(console,t);break;case 2:console.log.apply(console,t);break;case 3:console.debug.apply(console,t)}},i=function(){return!1}},97265:function(n,t,e){"use strict";function r(){return n=[o()+o(),o(),o(),o(),o()+o()+o()].join("-"),t=parseInt(n.charAt(19),16),e=(t=3&t|8).toString(16),n=u(n,14,"4"),n=u(n,19,e);var n,t,e}function i(n){var t=n.match(/[0-9a-fA-F]*/g),e="";return t.map((function(n){return e+=n})),!n||/^[0-]*$/.test(n)}function o(){return function(n,t,e){for(var r=n.length,i=e.length;r<t;r+=i)n=e+n;return n}(Math.floor(65536*Math.random()).toString(16),4,"0")}function u(n,t,e){return n.substring(0,t)+e+n.substring(t+1)}e.d(t,{Ew:function(){return i},GW:function(){return r}})},81620:function(n,t,e){"use strict";e.d(t,{F1:function(){return c},Uy:function(){return o},jL:function(){return s},vu:function(){return u},y:function(){return a}});var r=e(90710),i=e(2775);function o(n){return"string"==typeof n&&(n=document.querySelector(n)),n?window.getComputedStyle?parseInt(window.getComputedStyle(n).height):n.clientHeight:0}function u(n,t,e){void 0===e&&(e=!1);var o=n.indexOf("#"),u=-1===o?"":n.substr(o),s=(n=-1===o?n:n.substr(0,o)).indexOf("?"),a=-1===s?"":n.substr(s);n=-1===s?n:n.substr(0,s);var c={};return a&&(c=(0,r.cO)(a.substr(1))),(0,i.l7)(c,t),"".concat(n,"?").concat(e?function(n){var t="";n&&"object"==typeof n&&(t=Object.keys(n).reduce((function(t,e){return t.push("".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(n[e]))),t}),[]).join("&"));return t}(c):$.param(c)).concat(u)}function s(n,t){if(n&&t)return n[t]||n[t.toLowerCase()]||void 0}function a(n,t,e){var r=n.indexOf("#"),i=-1===r?"":n.substr(r);n=-1===r?n:n.substr(0,r);var o=new RegExp("([?&])".concat(t,"=.*?(&|$)"),"i"),u=-1!==n.indexOf("?")?"&":"?";return(n=n.match(o)?n.replace(o,"$1".concat(t,"=").concat(e,"$2")):"".concat(n+u+t,"=").concat(e))+i}function c(n,t){void 0===t&&(t=!0);var e=n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;");return t&&(e=e.replace(/'/g,"&apos;")),e}},38174:function(n,t,e){"use strict";e.d(t,{Wz:function(){return r},y3:function(){return i}});function r(n,t){n&&n.focus({preventScroll:!!t})}function i(n){var t=n.nativeEvent&&n.nativeEvent.explicitOriginalTarget;return n.relatedTarget||t||document.activeElement}},84358:function(n,t,e){"use strict";function r(n){return/^(https ?\:\/\/)?((www\.)?youtube\.com|youtu\.?be)\/.+$/.test(n)}function i(n){return/^(https ?\:\/\/)?(?:msit|web)\.microsoftstream\.com\/.+$/.test(n)||/^(https ?\:\/\/)?(?:www\.)?(microsoft-my.sharepoint-df|microsoft.sharepoint)\.com\/.+$/.test(n)||/(https ?\:\/\/)[^\s]*.(sharepoint|sharepoint-df)\.com\/[^\s]*/.test(n)}function o(n){return r(n)||i(n)}function u(n){var t=document.createElement("a");return t.href=n,t.host&&t.host!==window.location.host}function s(n){var t,e=null==n?void 0:n.split(":"),r=null;if((null==e?void 0:e.length)>=2){var i=null===(t=e[1])||void 0===t?void 0:t.split("?");(null==i?void 0:i.length)>0&&(r=i[0])}return"mailto"===e[0]&&function(n){return n&&n.trim()&&/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(n)}(r)}e.d(t,{M4:function(){return i},xx:function(){return s},K2:function(){return u},eC:function(){return o},yk:function(){return r}})},92575:function(n,t,e){"use strict";e.d(t,{p:function(){return s}});var r=e(31699),i=e.n(r),o=e(59749),u=e(73252);function s(n,t){(0,o.kM)(n,function(n){if(!n)return"";if(!(0,u.cr)("EnableSanitizedHTML"))return n;try{return i().sanitize(n)}catch(t){return n}}(t))}},64459:function(n,t,e){"use strict";function r(n){try{return JSON.parse(n)}catch(t){return n}}e.d(t,{d:function(){return r}})},65274:function(n,t,e){"use strict";function r(n){var t=typeof n;return"function"===t||"object"===t&&!!n}function i(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return t.length<1||!r(n)||t.forEach((function(t){u(t).forEach((function(e){n[e]=t[e]}))})),n}function o(n){return r(n)?Array.isArray(n)?n.slice():i({},n):n}function u(n){return r(n)?Object.keys(n):[]}function s(n,t){Array.isArray(n)&&n.forEach(t),r(n)&&u(n).forEach((function(e){t(n[e],e)}))}function a(n,t,e,i){if(Array.isArray(n))return n.map((function(e,r){return a(e,t,r,n)}));if(r(n)){var o={};return u(n).forEach((function(e){o[e]=a(n[e],t,e,n)})),o}return t(n,e,i)}function c(n,t){return a(n,t)}e.d(t,{EL:function(){return l},Fh:function(){return c},S6:function(){return s},d9:function(){return o},l7:function(){return i}});var f,l=(f=0,function(n){return"".concat(n||"").concat(++f)});Date.now},65713:function(n,t,e){"use strict";e.d(t,{y:function(){return o}});var r=e(60211);function i(n){n+="=";var t=document.cookie.split(";").filter((function(t){return t.indexOf(n)>=0}));if(t.length>0){var e=t[0].trim();return e.substring(n.length,e.length)}return null}var o=function(){function n(){this.tn=null}return n.getInstance=function(){return null==n.instance&&(n.instance=new n),n.instance},n.prototype.getMuid=function(){return this.tn},n.prototype.ensureMuid=function(){var t=this;return null==this.sn&&(this.sn=new Promise((function(e){var r=i("MUID");if(r)return t.tn=r,void e(t.tn);n.loadMuid((function(){null!=(r=i("MUID"))?(t.tn=r,e(t.tn)):e()}))}))),this.sn},n.loadMuid=function(n){var t=(0,r._7)();if(t){var e=document.createElement("img");e.style.display="none",e.src=t+"/c.gif",e.hidden=!0,e["aria-hidden"]="true",e.onload=e.onerror=n}else n()},n.instance=null,n}()},84475:function(n,t,e){"use strict";e.d(t,{A:function(){return u}});var r=e(90710),i=e(94290),o=e(9947);function u(){var n="ms-formweb";if((0,i.uV)()){var t=(0,i.Eh)();t&&(n="ms-"+t.toLowerCase()),(0,o.k0)().isOembedSPO&&(n="forms-webpart")}return(0,o.k0)().isSonarServer&&(n="ms-sonar"),(0,o.k0)().isAntiPhishingTool&&(n="ms-antiphishingtool"),"OST"===(0,r.NW)().Host&&(n="ms-ost"),n}},37890:function(n,t,e){"use strict";function r(n){return new Promise((function(t,e){n.then(t,e)}))}function i(n){var t=function(){return Promise.resolve(null)};return n?n.then(t,t):t()}var o;e.d(t,{Bx:function(){return i},Cb:function(){return o},Ks:function(){return a},Px:function(){return r},bC:function(){return u},wU:function(){return s}}),function(n){n[n.Pending=0]="Pending",n[n.Resolved=1]="Resolved",n[n.Rejected=2]="Rejected"}(o||(o={}));var u=function(){function n(n){var t=this;n.then((function(){t.cn=o.Resolved}),(function(){t.cn=o.Rejected})),this.fn=n,this.cn=o.Pending}return n.prototype.promise=function(){return this.fn},n.prototype.states=function(){return this.cn},n}(),s=function(){function n(){var n=this;this.fn=new u(new Promise((function(t,e){n.ln=t,n.hn=e})))}return n.prototype.promise=function(){return this.fn.promise()},n.prototype.resolve=function(n){return this.ln(n),this},n.prototype.reject=function(n){return this.hn(n),this},n.prototype.states=function(){return this.fn.states()},n}();function a(n,t){var e,r=new Promise((function(n,r){e=setTimeout((function(){return r("Promise timed out")}),t)})),i=n.finally((function(){e&&clearTimeout(e)}));return Promise.race([i,r])}},90710:function(n,t,e){"use strict";function r(n,t){return void 0===t&&(t=!0),o(n||window.location.search.substring(1),t)}function i(n,t){return void 0===t&&(t=!0),o(n||window.location.hash.substring(1),t)}function o(n,t){void 0===t&&(t=!0);var e={};return n&&n.trim().split("&").forEach((function(n){var r=n.indexOf("=");-1===r&&(r=n.length);var i=n.substring(0,r).trim();if(i){var o=n.substring(r+1).trim();e[i]=t?decodeURIComponent(o).trim():o}})),e}e.d(t,{$p:function(){return i},NW:function(){return r},cO:function(){return o}})},88744:function(n,t,e){"use strict";function r(n,t){return function(e){n&&n(e),t&&t(e)}}e.d(t,{F:function(){return r}})},13877:function(n,t,e){"use strict";var r,i,o,u;e.d(t,{$o:function(){return f},G:function(){return l},ns:function(){return c}});var s=null,a=null;function c(){return r||(r=f())instanceof d&&(r=l()),r}function f(){return i||(i=function(){if(null==s)try{var n="officeforms.__storage_test__";window.localStorage.setItem(n,n),window.localStorage.removeItem(n),s=!0}catch(n){s=!1}return s}()?window.localStorage:h()),i}function l(){return o||(o=function(){if(null==a)try{var n="officeforms.__storage_test__";window.sessionStorage.setItem(n,n),window.sessionStorage.removeItem(n),a=!0}catch(n){a=!1}return a}()?window.sessionStorage:h()),o}function h(){return u||(u=new d),u}var d=function(){function n(){}return n.prototype.clear=function(){},n.prototype.getItem=function(n){},n.prototype.key=function(n){return null},n.prototype.removeItem=function(n){},n.prototype.setItem=function(n,t){},n}()},63795:function(n,t,e){"use strict";e.d(t,{Ee:function(){return u},WU:function(){return i},bC:function(){return o},r3:function(){return s}});var r=e(83390);function i(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return n?((0,r.xW)()&&t.includes("<")&&t.includes(">")&&((0,r.Xy)(1,"Format string contains HTML tag. Consider to refactor the string and use formatStringToRender instead."),(0,r.Xy)(1,"Original string: ".concat(n))),n.replace(/{(\d+)}/g,(function(n,e){return void 0!==t[e]&&null!==t[e]?t[e].toString():n}))):n}function o(n){return n&&"function"==typeof n.normalize?n.normalize("NFC"):n}function u(n,t){if(null==n||0===n.length)return n;for(var e=n.length;--e>=0&&!(t.indexOf(n.charAt(e))<0););return n.substr(0,e+1)}var s=function(n,t){return!(!n||!t||"string"!=typeof n||"string"!=typeof t)&&n.toLowerCase().indexOf(t.toLowerCase())>=0}},49690:function(n,t,e){"use strict";function r(n,t){return void 0===t&&(t="."),n.filter((function(n){return!!n})).join(t)}e.d(t,{x:function(){return r}})},4851:function(n,t,e){"use strict";function r(n){var t,e=!1,r=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return e?t:(e=!0,t=n.apply(void 0,r))};return r.reset=function(){e=!1,t=null},r}function i(n){var t=n;return function(n){return arguments.length&&(t=n),t}}e.d(t,{$7:function(){return i},Rm:function(){return r}})},70069:function(n,t,e){"use strict";e.d(t,{s:function(){return v}});var r,i=e(31699),o=e.n(i),u=e(73252),s=e(59312),a=e(92575),c=e(2775);function f(n){if(!n)return n;var t=document.createElement("div");return(0,a.p)(t,n),l(t),t.innerHTML}function l(n){var t;n&&(n.hasChildNodes&&n.hasChildNodes()?(0,c.S6)(n.childNodes,(function(n){l(n)})):"BR"===n.nodeName||n.textContent||null===(t=n.parentElement)||void 0===t||t.removeChild(n))}function h(n){if(!n)return"";var t=function(n){return n?n.replace(/(<\/?)(p|section|article|blockquote|nav|header|h1|h2|h3|h4|h5|h6)([^>]*>)/gi,"$1div$3"):n}(function(n){if(!n)return"";var t=n.replace(/\r/gi,"");return/<\/?[a-z][^>]*>/gi.test(t)?t.replace(/\n/gi," "):t.replace(/\n/gi,"<br>")}(o().sanitize(n))),e=f(t).split(/<div.*?>(.*?)<\/div>/gi).filter((function(n){return!!n}));return e.map((function(n,t){return t===e.length-1||function(n){var t=document.createElement("div");(0,a.p)(t,n);for(var e=t.lastChild;null==e?void 0:e.hasChildNodes();)e=e.lastChild;return"BR"===(null==e?void 0:e.nodeName)}(n)?n:n+"<br>"})).join("")}var d=[{PropertyName:"color",PropertyDisplayName:"color",AllowedValue:/\s?rgb\(/},{PropertyName:"fontSize",PropertyDisplayName:"font-size",AllowedValue:/(1.2|1|0.8|0.9|1.3)em/}];function m(n){if(n.hasAttribute("style")){for(var t,e=[],i=0,o=d;i<o.length;i++){var u=o[i],s=n.style[u.PropertyName];s&&u.AllowedValue.test(s)&&e.push("".concat(u.PropertyDisplayName,": ").concat(s,";"))}e.length&&((t=n.tagName)&&(r||(r="span|b|i|u".split("|")),r).includes(t.toLocaleLowerCase()))?n.setAttribute("style",e.join("")):n.removeAttribute("style")}}function v(n){var t=n.$isSanitizeRichTextHTMLBase,e=void 0!==t&&t,r=n.$removeLineBreaks,i=void 0!==r&&r,a=n.$text;if(e&&(a=function(n,t){void 0===t&&(t=!1),o().addHook("afterSanitizeAttributes",m);var e=["strong","em","u","b","i","ul","li","span","ol"],r=o().sanitize(h(n),{ALLOWED_ATTR:["style"],ALLOW_DATA_ATTR:!1,ALLOWED_TAGS:t?e:(0,s.ev)((0,s.ev)([],e,!0),["br"],!1)});return o().removeHook("afterSanitizeAttributes"),r}(a,i)),!a)return"";if(!(0,u.cr)("EnableSanitizedHTML"))return a;try{return o().sanitize(a)}catch(n){return a}}},48186:function(n,t,e){"use strict";function r(n){return null==n}e.d(t,{l:function(){return r}})},2775:function(n,t,e){"use strict";e.d(t,{CE:function(){return f},Kn:function(){return a},Ry:function(){return l},S6:function(){return i},XP:function(){return c},YU:function(){return u},d9:function(){return o},l7:function(){return s}});var r=e(12611),i=r.each,o=r.clone,u=r.escape,s=r.extend,a=r.isObject,c=r.keys,f=r.omit,l=(r.pick,r.object)},219:function(){"use strict";!function(){var n=function(){if(n.p)return n.p;var t,e,r=window.shellInfo,i=!1;if(r)i=!!(e=r.cdnEndpoint);else{var o=window.OfficeFormServerInfo||{};e=JSON.parse(decodeURIComponent(o.webSettings||"{}")).CdnEndPoint,i=o.isCdnEnabled}return i&&e&&location.search&&location.search.indexOf("nocdn=1")>-1&&(e="".concat(location.protocol,"//").concat(location.host,"/cdn")),t=i&&e?e+"/scripts/dists/":"".concat(location.protocol,"//").concat(location.host,"/Scripts/dists/"),n.p=t,n.isCdnEnabled=i,n.p};n.p=null,window.getChunkPath=n,window.replaceChunkSrc=function(n){n=n.toLowerCase();var t=window.OfficeFormServerInfo||window.shellInfo;return t&&t.ring&&!window.getChunkPath.isCdnEnabled?n+"?ring="+t.ring:n}}()},18145:function(n,t,e){"use strict";e.d(t,{D9:function(){return c},DR:function(){return a},hu:function(){return s},sq:function(){return f},vH:function(){return h},vq:function(){return u}});var r,i=e(78587),o=e(39455);function u(){return"Segoe UI"}function s(){return parseInt(o.Z.getSetting(o.G.CascadeSubQuesMaxLimit))}!function(n){n[n.SixHourly=0]="SixHourly",n[n.Daily=1]="Daily",n[n.Weekly=2]="Weekly",n[n.Monthly=3]="Monthly",n[n.Quarterly=4]="Quarterly",n[n.Yearly=5]="Yearly"}(r||(r={}));var a="api/GetAllSatisfactionMetricsByProject/",c="api/DeleteSatisfactionMetric/",f="api/CreateOrUpdate",l=[{BackgroundColor:"#FBE8E1",BackgroundImage:null,Name:"CV_Orange",PrimaryColor:"#D83B01",SecondaryColor:"#C33400",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/orange-thumbnail.png")},{BackgroundColor:"#FFF8E5",BackgroundImage:null,Name:"CV_Yellow",PrimaryColor:"#FFB900",SecondaryColor:"#E6A800",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/yellow-thumbnail.png")},{BackgroundColor:"#D1DBD1",BackgroundImage:null,Name:"CV_Green",PrimaryColor:"#107C10",SecondaryColor:"#0F700F",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/green-thumbnail.png")},{BackgroundColor:"#E7F2E7",BackgroundImage:null,Name:"CV_Teal",PrimaryColor:"#008575",SecondaryColor:"#007769",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/teal-thumbnail.png")},{BackgroundColor:"#E9F0FE",BackgroundImage:null,Name:"CV_Blue",PrimaryColor:"#2266E3",SecondaryColor:"#1F5BCC",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/blue-thumbnail.png")},{BackgroundColor:"#EFEFF6",BackgroundImage:null,Name:"CV_Purple",PrimaryColor:"#6264A7",SecondaryColor:"#585A95",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/purple-thumbnail.png")},{BackgroundColor:"#F0EAEA",BackgroundImage:null,Name:"CV_Dark_Orange",PrimaryColor:"#6B2929",SecondaryColor:"#602525",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/darkorange-thumbnail.png")},{BackgroundColor:"#E6EDE8",BackgroundImage:null,Name:"CV_Dark_Green",PrimaryColor:"#054B16",SecondaryColor:"#328647",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/darkgreen-thumbnail.png")},{BackgroundColor:"#E9EDED",BackgroundImage:null,Name:"CV_Dark_Teal",PrimaryColor:"#274B47",SecondaryColor:"#23433F",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/darkteal-thumbnail.png")},{BackgroundColor:"#E9EBEF",BackgroundImage:null,Name:"CV_Dark_Blue",PrimaryColor:"#243A5E",SecondaryColor:"#203455",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/darkblue-thumbnail.png")},{BackgroundColor:"#EAEEF5",BackgroundImage:null,Name:"CV_Sapphire",PrimaryColor:"#2B579A",SecondaryColor:"#274E8A",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/sapphire-thumbnail.png")},{BackgroundColor:"#EBEAEE",BackgroundImage:null,Name:"CV_Dark_Purple",PrimaryColor:"#3B2E58",SecondaryColor:"#362A50",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/darkpurple-thumbnail.png")},{BackgroundColor:"#EDECEC",BackgroundImage:null,Name:"CV_Black",PrimaryColor:"#000000",SecondaryColor:"#252525",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/black-thumbnail.png")},{BackgroundColor:"#EEEEEE",BackgroundImage:null,Name:"CV_Dark_Grey",PrimaryColor:"#2F2F2F",SecondaryColor:"#737373",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/darkgrey-thumbnail.png")},{BackgroundColor:"#FFF4ED",BackgroundImage:null,Name:"CV_Light_Orange",PrimaryColor:"#FF9349",SecondaryColor:"#E68443",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/lightorange-thumbnail.png")},{BackgroundColor:"#E5F8FE",BackgroundImage:null,Name:"CV_Light_Blue",PrimaryColor:"#00BCF2",SecondaryColor:"#00ABDA",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/lightblue-thumbnail.png")}];l.forEach((function(n,t){n=Object.freeze(n),l[t]=n}));var h="Request could not be completed"},81291:function(n,t,e){"use strict";e.d(t,{BM:function(){return b},D4:function(){return o},Ic:function(){return m},O8:function(){return s},VK:function(){return d},cL:function(){return u},lx:function(){return w},rV:function(){return h},x9:function(){return l}});var r,i,o,u,s,a=e(59312),c=e(78587),f=e(21607),l="Header Uploaded Image Custom Theme",h="Header Predefined Image Custom Theme",d="No Header Image Custom Theme",m="Compact Header Custom Theme";function v(){return{HeaderBackgroundImage:null,Name:"CV_SimpleStyle",HeaderBackgroundThumbnail:(0,c.Jn)("/Images/CustomerVoice/blue-thumbnail.png"),BackGroundPositionX:"0px",BackGroundPositionY:"0px",BackGroundPositionZ:"auto",LogoPositionX:"Left",LogoPositionY:"Mid",TitlePositionX:"Left",TitlePositionY:"Mid",LogoSize:"Medium"}}function p(){return i||(i=e.e(93).then(e.t.bind(e,334,19)).then((function(n){return n.default}))),i}function g(n){return r||(r=(0,f.UM)(n||v().Name).then(JSON.parse)),r}function b(n){return(0,a.mG)(this,void 0,Promise,(function(){return(0,a.Jh)(this,(function(t){switch(t.label){case 0:return[4,p()];case 1:return[2,I(t.sent()[n])||v()]}}))}))}function w(n){return(0,a.mG)(this,void 0,Promise,(function(){return(0,a.Jh)(this,(function(t){switch(t.label){case 0:return[4,g(n)];case 1:return[2,I(t.sent()[n])||v()]}}))}))}function I(n){if(!n)return n;var t=n.HeaderBackgroundImage,e=n.HeaderBackgroundThumbnail;return null!=t&&/^\/Images\//i.test(t)&&(n.HeaderBackgroundImage=(0,c.Jn)(t)),null!=e&&/^\/Images\//i.test(e)&&(n.HeaderBackgroundThumbnail=(0,c.Jn)(e)),n}!function(n){n.Left="Left",n.Mid="Mid",n.Right="Right"}(o||(o={})),function(n){n.Top="Top",n.Mid="Mid",n.Down="Down"}(u||(u={})),function(n){n.Small="Small",n.Medium="Medium",n.Large="Large"}(s||(s={}))},56077:function(n,t,e){"use strict";e.d(t,{v:function(){return i},z:function(){return o}});var r=e(26203);function i(n,t,e){if(!n||!t)return-1;var i=n.Model.Questions;if(i&&i.length>0){var o=r.d.convertToArray(i);o=e?o.filter((function(n){return!n.GroupId})):o;var u=n.getQuestionById(t);if(u){if(!u.Model.GroupId)return o.indexOf(u.Model);var s=n.getQuestionById(u.Model.GroupId);if(s)return o.indexOf(s.Model)}}return-1}function o(n,t){if(n&&t){var e=n.FormElementManager.SectionMasters;if(e&&e.length>0)return e.map((function(n){return n.Model.Id})).indexOf(t)}return-1}},39955:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{x:function(){return ExpressionEvaluator}});var underscore__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(12611),underscore__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(underscore__WEBPACK_IMPORTED_MODULE_0__),_Common_OfficeFormServerInfo__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(9947),_Forms_Common_EnvironmentConfig__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(6787),_Forms_Common_Utilities_FormsProUtility__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(11040),_Forms_Common_Utilities_MixinUtil__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(72467),_Forms_Telemetry_LogHandler__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(31442),_Nerve_Nerve__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(26203),ExpressionEvaluator=function(){function ExpressionEvaluator(){this.dn="answerof",this.mn="isselected",this.vn="isanswered",this.pn="surveyvar"}return ExpressionEvaluator.prototype.evaluate=function(expression,answerBase,allLikertSubList,form){null!=allLikertSubList&&allLikertSubList.length>0&&(expression=this.wn(expression,answerBase,allLikertSubList)),expression=this.In(expression,form),expression=this.yn(expression,answerBase),expression=this.Sn(expression,answerBase,form),expression=this.Fn(expression,answerBase);var tempRes=!1;try{return tempRes=eval(expression),tempRes}catch(n){(0,_Forms_Telemetry_LogHandler__WEBPACK_IMPORTED_MODULE_2__.JG)({type:(0,_Forms_Common_EnvironmentConfig__WEBPACK_IMPORTED_MODULE_4__.cT)()?"CV_BranchingExpressionEvalutorFailed":"MFPUI_BranchingExpressionEvalutorFailed",eventInfo:{Component:"ResponsePage",error:n,expression:expression,tenantId:(0,_Common_OfficeFormServerInfo__WEBPACK_IMPORTED_MODULE_5__.k0)().userInfo.TenantId,type:"unexpected"}})}return!1},ExpressionEvaluator.prototype.wn=function(n,t,e){var r,i=function(){if((r=n.indexOf(o.vn))<=0)return"break";var i=r+o.vn.length+1,u=n.substring(i,n.indexOf(")",i)),s=e.filter((function(n){return n.Question.Model.GroupId===u}));if(!(s.length>0))return"break";var a=void 0;if((a=t?t.filter((function(n){return s.filter((function(t){return t.Question.Model.Id===n.QuestionId})).length>0})):[]).length>0){var c=a.filter((function(n){return null!==n.Answer}));n=c.length>0?n.replaceAll(o.vn+"("+u+")","true"):n.replaceAll(o.vn+"("+u+")","false")}else n=n.replaceAll(o.vn+"("+u+")","false");r=n.indexOf(o.vn)},o=this;do{if("break"===i())break}while(r>=0);return n},ExpressionEvaluator.prototype.Sn=function(n,t,e){var r,i=function(){if((r=n.indexOf(o.dn))<=0)return"break";var i=r+o.dn.length+1,u=n.indexOf(")",i),s=n.substring(i,u),a=n.indexOf(")",u+1),c=n.substring(u+4,a).toString().trim(),f=c.substring(1,c.length-1);f=(0,_Forms_Common_Utilities_FormsProUtility__WEBPACK_IMPORTED_MODULE_1__.df)(f);var l=n.substring(r,a).trim(),h=n.substring(u+1,u+4).trim(),d=null,m=!1;if(t&&(d=t.filter((function(n){return n.QuestionId==s}))).length>0&&null!==d[0].Answer){var v="<"==h,p=">"==h,g=o.Cn(s,d[0].Answer,e,v||p);if(null!=g)if(m=!0,v||p){var b=o.Cn(s,f,e,!0),w=parseInt(b),I=parseInt(g);n=v&&I<w||p&&I>w?n.replaceAll(l,"true"):n.replaceAll(l,"false")}else{n="=="==h?n.replaceAll(l,f==g?"true":"false"):n.replaceAll(l,f!=g?"true":"false")}}m||(n=o.Tn(n,l)),r=n.indexOf(o.dn)},o=this;do{if("break"===i())break}while(r>=0);return n},ExpressionEvaluator.prototype.Tn=function(n,t){return n=n.indexOf("||")>=0?n.replaceAll(t,"false"):n.replaceAll(t,null)},ExpressionEvaluator.prototype.yn=function(n,t){var e,r=function(){if((e=n.indexOf(i.mn))<=0)return"break";var r=e+i.mn.length+1,o=n.substring(r,n.indexOf(")",r)),u=n.indexOf("==",r),s=n.indexOf(")",u),a=n.substring(u+2,s).toString().trim(),c=n.indexOf(")",u+a.length);a=a.substring(1,a.length-1),a=(0,_Forms_Common_Utilities_FormsProUtility__WEBPACK_IMPORTED_MODULE_1__.df)(a);var f=n.substring(e,c),l=void 0;if(t&&(l=t.filter((function(n){return n.QuestionId==o}))).length>0&&null!==l[0].Answer&&""!==l[0].Answer.toString().trim()){var h=(0,_Forms_Common_Utilities_FormsProUtility__WEBPACK_IMPORTED_MODULE_1__.df)(l[0].Answer),d="";try{d=JSON.parse(h)}catch(n){d=h,(0,_Forms_Telemetry_LogHandler__WEBPACK_IMPORTED_MODULE_2__.JG)({type:"CV_BranchingExpressionEvalutorOldResponse",eventInfo:{Component:"ResponsePage",message:"Single choice converted to multi choice and this response is old one for single choice",tenantId:(0,_Common_OfficeFormServerInfo__WEBPACK_IMPORTED_MODULE_5__.k0)().userInfo.TenantId,type:"expected"}})}var m=d.indexOf(a);n=n.replaceAll(f,-1!=m?"true":"false")}n=i.Tn(n,f),e=n.indexOf(i.mn)},i=this;do{if("break"===r())break}while(e>=0);return n},ExpressionEvaluator.prototype.Fn=function(n,t){var e,r=function(){if((e=n.indexOf(i.vn))<=0)return"break";var r=e+i.vn.length+1,o=n.substring(r,n.indexOf(")",r)),u=i.vn+"("+o+")",s=void 0,a=!1;t&&((s=t.filter((function(n){return n.QuestionId==o}))).length>0&&null!==s[0].Answer&&""!=s[0].Answer.toString().trim()&&(a=!0,n=n.replaceAll(u,"true")));a||(n=n.replaceAll(u,"false")),e=n.indexOf(i.vn)},i=this;do{if("break"===r())break}while(e>=0);return n},ExpressionEvaluator.prototype.Cn=function(n,t,e,r){if(null==t)return null;var i,o=e.getQuestionById(n);switch(o.Model.Type){case"Question.Choice":i=!0===r?underscore__WEBPACK_IMPORTED_MODULE_0__.map(o.Model.Choices,(function(n){return n.Description})).indexOf((0,_Forms_Common_Utilities_FormsProUtility__WEBPACK_IMPORTED_MODULE_1__.df)(t)):null!=t?(0,_Forms_Common_Utilities_FormsProUtility__WEBPACK_IMPORTED_MODULE_1__.df)(t.toString()):null;break;case"Question.MatrixChoice":var u=e.getQuestionById(o.Model.GroupId);if(!0===r)i=void 0===(i=t.id)?_Nerve_Nerve__WEBPACK_IMPORTED_MODULE_3__.d.convertToArray(u.Model.ChoiceGroup).map((function(n){return n.Description})).indexOf((0,_Forms_Common_Utilities_FormsProUtility__WEBPACK_IMPORTED_MODULE_1__.df)(t)):_Nerve_Nerve__WEBPACK_IMPORTED_MODULE_3__.d.convertToArray(u.Model.ChoiceGroup).map((function(n){return n.Id})).indexOf(i);else if(void 0===(i=t.id))i=(0,_Forms_Common_Utilities_FormsProUtility__WEBPACK_IMPORTED_MODULE_1__.df)(t);else(s=_Nerve_Nerve__WEBPACK_IMPORTED_MODULE_3__.d.convertToArray(u.Model.ChoiceGroup).filter((function(n){return n.Id==i}))).length>0&&(i=s[0].Description);break;case"Question.CascadeLevel":var s;if(!0===r)i=void 0===(i=t.id)?_Nerve_Nerve__WEBPACK_IMPORTED_MODULE_3__.d.convertToArray(o.Model.CascadeChoiceGroup).map((function(n){return n.displayText})).indexOf((0,_Forms_Common_Utilities_FormsProUtility__WEBPACK_IMPORTED_MODULE_1__.df)(t)):_Nerve_Nerve__WEBPACK_IMPORTED_MODULE_3__.d.convertToArray(o.Model.CascadeChoiceGroup).map((function(n){return n.id})).indexOf(i);else if(void 0===(i=t.id))i=(0,_Forms_Common_Utilities_FormsProUtility__WEBPACK_IMPORTED_MODULE_1__.df)(t);else(s=_Nerve_Nerve__WEBPACK_IMPORTED_MODULE_3__.d.convertToArray(o.Model.CascadeChoiceGroup).filter((function(n){return n.id==i}))).length>0&&(i=s[0].displayText);break;default:i=null!=t?t:null}return i},ExpressionEvaluator.prototype.In=function(n,t){var e,r,i,o,u,s,a=(0,_Forms_Common_Utilities_MixinUtil__WEBPACK_IMPORTED_MODULE_6__.f5)().Model,c="";u=JSON.parse(t.Model.PipesDetails);var f=function(){if((s=n.indexOf(l.pn))<=0)return"break";var f=s+l.pn.length+1,h=n.indexOf(")",f),d=n.substring(f,h),m=(0,_Forms_Common_Utilities_FormsProUtility__WEBPACK_IMPORTED_MODULE_1__.df)(d);0===a.ResponsePipeData.length?(u=JSON.parse(t.Model.PipesDetails),c=null===(r=null===(e=u.filter((function(n){return n.pipeName===m}))[0])||void 0===e?void 0:e.defaultValue)||void 0===r?void 0:r.toString().toLowerCase().trim()):c=null===(o=null===(i=a.ResponsePipeData.filter((function(n){return n.paramName===m}))[0])||void 0===i?void 0:i.paramValue)||void 0===o?void 0:o.toString().toLowerCase().trim();var v=n.indexOf(")",h+1),p=(0,_Forms_Common_Utilities_FormsProUtility__WEBPACK_IMPORTED_MODULE_1__.df)(n.substring(h+6,v-2).toString()).toLowerCase().trim(),g=n.substring(s,v);n="="===n.charAt(h+2)?n.replaceAll(g,c===p?"true":"false"):"!"===n.charAt(h+2)?n.replaceAll(g,c==p?"false":"true"):"i"===n.charAt(h+2)?n.replaceAll(g,(null==c?void 0:c.includes(p))?"true":"false"):n.replaceAll(g,"false"),s=n.indexOf(l.pn)},l=this;do{if("break"===f())break}while(s>=0);return n},ExpressionEvaluator}()},6666:function(n,t,e){"use strict";e.d(t,{$M:function(){return i},EP:function(){return b},Hw:function(){return v},XG:function(){return r},pd:function(){return m},qG:function(){return o}});var r,i,o,u=e(12611),s=e(687),a=e(7645),c=e(11040),f=e(97265),l=e(72467),h=e(56077),d=e(64092);function m(n){var t=!0;return n&&n.sourceId&&0!==n.sourceId.trim().length&&n.operator&&n.operatorLabel&&0!==n.operatorLabel.trim().length||(t=!1),parseInt(n.operator.toString())!==i.IsAnswered&&(n.answer&&0!==n.answer.trim().length||(t=!1)),t}!function(n){n[n.RULE_NO_OPERATOR=0]="RULE_NO_OPERATOR",n[n.RULE_AND_OPERATOR=1]="RULE_AND_OPERATOR",n[n.RULE_OR_OPERATOR=2]="RULE_OR_OPERATOR"}(r||(r={})),function(n){n[n.Equal=1]="Equal",n[n.NotEqual=2]="NotEqual",n[n.LessThan=3]="LessThan",n[n.GreaterThan=4]="GreaterThan",n[n.IsAnswered=5]="IsAnswered",n[n.IsSelected=6]="IsSelected",n[n.Contains=7]="Contains"}(i||(i={})),function(n){n[n.Question=1]="Question",n[n.SurveyVariable=2]="SurveyVariable"}(o||(o={}));var v=function(){function n(n,t,e,r,u,s){this.logicalOperator=n,this.sourceId=e||"",this.operator=r||i.Equal,this.answer=s||"",this.operatorLabel=u||"",this.conditionId=(0,f.GW)(),this.id,this.itemType=t||o.Question}return n.prototype.getExpression=function(){var n="",t=(0,c.Tq)(this.answer),e=encodeURIComponent(this.answer);return console.log(e),this.logicalOperator!=r.RULE_NO_OPERATOR&&(n+=" "+g(this.logicalOperator)+" "),this.operator==i.IsAnswered?n+="( isanswered("+this.sourceId+") )":this.operator==i.IsSelected?n+="( isselected("+this.sourceId+") == '"+t+"' )":-1!==(0,l.f5)().Model.FormMaster.Model.PipesDetails.indexOf(this.sourceId)?n+="( surveyvar("+(0,c.Tq)(this.sourceId)+") "+p(this.operator)+" '"+t+"' )":n+="( answerof("+this.sourceId+") "+p(this.operator)+" '"+t+"' )",n},n}();function p(n){var t="";switch(parseInt(n.toString())){case i.Equal:t="==";break;case i.GreaterThan:t=">";break;case i.IsAnswered:t="isanswered";break;case i.IsSelected:t="isselected";break;case i.Contains:t="in";break;case i.LessThan:t="<";break;case i.NotEqual:default:t="!="}return t}function g(n){var t="";switch(parseInt(n.toString())){case r.RULE_AND_OPERATOR:t="&&";break;case r.RULE_OR_OPERATOR:t="||";break;default:t=""}return t}var b=function(){function n(n,t){this.dn="answerof",this.mn="isselected",this.vn="isanswered",this.Pn="surveyvar",this.ruleId=n,this.backEndExpression=t,this.logicalOperator=r.RULE_NO_OPERATOR,this.conditionList=[],this.buildConditions(this.backEndExpression)}return n.prototype.getLogicalOperator=function(){return this.logicalOperator},n.prototype.getLogicalOperatorLabel=function(){var n="";switch(this.logicalOperator){case r.RULE_AND_OPERATOR:n=(0,a.pm)().BranchingRules_RuleOperatorList_AND;break;case r.RULE_OR_OPERATOR:n=(0,a.pm)().BranchingRules_RuleOperatorList_OR;break;default:n=""}return n},n.prototype.getInlineLogicalOperatorLabel=function(){var n="";switch(this.logicalOperator){case r.RULE_AND_OPERATOR:n=(0,a.pm)().Inline_Branching_And;break;case r.RULE_OR_OPERATOR:n=(0,a.pm)().Inline_Branching_Or;break;default:n=""}return n},n.prototype.buildConditions=function(n){var t=this;if(0!==n.trim().length){var e=g(r.RULE_AND_OPERATOR),i=n.indexOf(e);i<0?(e=g(r.RULE_OR_OPERATOR),i=n.indexOf(e),this.logicalOperator=i<0?r.RULE_NO_OPERATOR:r.RULE_OR_OPERATOR):this.logicalOperator=r.RULE_AND_OPERATOR;var o=n.split(e);u.forEach(o,(function(n,e){var i;i=new v(0===e?r.RULE_NO_OPERATOR:t.logicalOperator),t.Nn(i,n),t.addCondition(i)})),1===this.conditionList.length&&(this.logicalOperator=r.RULE_AND_OPERATOR)}},n.prototype.Nn=function(n,t){var e,r=this.dn;if((e=t.indexOf(r))<0&&(r=this.vn,(e=t.indexOf(r))<0&&(r=this.mn,(e=t.indexOf(r))<0&&(r=this.Pn,(e=t.indexOf(r))<0))))return"";var u,s,a=e+r.length+1,f=t.indexOf(")",a),l=t.substring(a,f);if(n.operatorLabel="",n.sourceId="",n.answer="",n.operator=i.Equal,n.itemType=o.Question,r===this.dn||r===this.Pn){n.sourceId=l;var h=t.substr(f+1,3).trim();n.operatorLabel=h,n.operator=("=="===(u=h)?s=i.Equal:"!="===u?s=i.NotEqual:">"===u?s=i.GreaterThan:"in"===u&&(s=i.Contains),"<"===u&&(s=i.LessThan),s),n.answer=(0,c.df)(this.kn(t,f)),r===this.Pn&&(n.itemType=o.SurveyVariable)}else r===this.mn?(n.sourceId=l,n.operator=i.IsSelected,n.operatorLabel=p(i.IsSelected),n.answer=(0,c.df)(this.kn(t,f))):(n.sourceId=l,n.operator=i.IsAnswered,n.operatorLabel=p(i.IsAnswered))},n.prototype.kn=function(n,t){var e=n.indexOf(")",t+4),r=n.substring(t+4,e).trim();return r.substring(1,r.length-1)},n.prototype.addCondition=function(n){this.conditionList.push(n)},n.prototype.deleteCondition=function(n){var t=this.conditionList.map((function(n){return n.conditionId})).indexOf(n.conditionId);if(t>=0){var e=[].concat(this.conditionList);e.splice(t,1),this.conditionList=e,0===t&&this.conditionList.length>0&&(this.conditionList[0].logicalOperator=r.RULE_NO_OPERATOR)}},n.prototype.deleteAllCondition=function(){this.conditionList=[]},n.prototype.getConditions=function(){return this.conditionList},n.prototype.buildExpression=function(){var n="";return u.forEach(this.conditionList,(function(t){n+=t.getExpression()})),n},n.prototype.getMappings=function(){var n=this,t=[];return u.forEach(this.conditionList,(function(e){if(0==t.filter((function(n){return e.sourceId==n.sourceId})).length){var r=new d.yF;r.sourceId=e.sourceId,r.targetRuleList=[],r.targetRuleList.push(n.ruleId),t.push(r)}})),t},n.prototype.updateLogicalOperator=function(n){this.logicalOperator=n,u.forEach(this.conditionList,(function(t,e){0!=e&&(t.logicalOperator=n)}))},n.prototype.ValidateConditions=function(){var n=!0;return u.forEach(this.conditionList,(function(t,e){0!==t.sourceId.trim().length&&0!==t.operatorLabel.trim().length||(n=!1),parseInt(t.operator.toString())!==i.IsAnswered&&0===t.answer.trim().length&&(n=!1)})),n},n.prototype.CheckThreshold=function(){var n=!0;return this.conditionList&&(n=this.conditionList.length<=(0,s.ip)()),n},n.prototype.getLastQuestionIndex=function(){var n=-1;return u.forEach(this.conditionList,(function(t){if(t.sourceId){var e=(0,h.v)((0,l.f5)().Model.FormMaster,t.sourceId);e>=0&&n<e&&(n=e)}})),n},n}();t.ZP=b},64092:function(n,t,e){"use strict";e.d(t,{Lm:function(){return r},N:function(){return I},Us:function(){return i},d_:function(){return C},eO:function(){return F},qd:function(){return b},rv:function(){return w},yF:function(){return y}});var r,i,o,u=e(12611),s=e(9947),a=e(6787),c=e(73252),f=e(687),l=e(7645),h=e(97265),d=e(31442),m=e(26203),v=e(81570),p=e(56077),g=e(6666);!function(n){n[n.NoTarget=0]="NoTarget",n[n.Question=1]="Question",n[n.Section=2]="Section",n[n.Page=3]="Page",n[n.EndOfSurvey=4]="EndOfSurvey",n[n.ChainedForm=5]="ChainedForm",n[n.Url=6]="Url",n[n.ThankYouMessage=7]="ThankYouMessage"}(r||(r={})),function(n){n[n.NoAction=0]="NoAction",n[n.Show=1]="Show",n[n.Hide=2]="Hide",n[n.Toggle=3]="Toggle",n[n.Navigate=4]="Navigate"}(i||(i={})),function(n){n[n.EmptyAction=0]="EmptyAction",n[n.MultipleNavigation=1]="MultipleNavigation",n[n.MaxLimitReached=2]="MaxLimitReached",n[n.ActionOrder=3]="ActionOrder",n[n.EmptyElse=4]="EmptyElse"}(o||(o={}));var b=function(){return function(){this.actionId=(0,h.GW)(),this.actionsequence="1",this.actionType=i.NoAction,this.targetId="",this.targetType=r.NoTarget}}(),w=function(){return function(){this.failureActions=[],this.successActions=[]}}(),I=function(){return function(){this.action=null,this.backendExpression="",this.description="",this.name="",this.ruleId=(0,h.GW)()}}(),y=function(){return function(){this.sourceId=null,this.targetRuleList=null}}(),S=function(){return function(){this.Simplified=new F,this.thankyouMessageRules=[],this.IsSimplified=!0}}(),F=function(){return function(){this.rules=[],this.mappings=[]}}();function C(n){return n?(_.instanceRef&&_.formId===n.Model.Id&&_.branchingData===n.Model.MfpBranchingData||(delete _.instanceRef,_.formId=n.Model.Id,_.branchingData=n.Model.MfpBranchingData,_.instanceRef=new _(n)),_.instanceRef):null}var _=function(){function n(n){this.En=null,this.Rn=n,this.On=this.On.bind(this),this.On()}return n.prototype.On=function(){var n=this.Rn.Model.MfpBranchingData;this.En=n?(0,v.Ur)(n):new F},n.prototype.hasRuleAssociated=function(n){return!(!this.getSimplifiedNavRule(n)&&!this.getSimplifiedShowHideRule(n))},n.prototype.getAllSimplifiedRules=function(n){var t=[];if(n){var e=this.getSimplifiedShowHideRule(n);e&&t.push(e);var r=this.getSimplifiedNavRules(n);r&&r.forEach((function(n){return t.push(n)}))}return t},n.prototype.getRuleCount=function(){return this.En?this.En.rules.length:0},n.prototype.updateRule=function(n,t,e,r){var i=this.getSimplifiedNavRule(n,t),o=!1;if(i){var u=new g.ZP(i.ruleId,i.backendExpression);if(u.getConditions().forEach((function(n){n.answer===t&&n.answer!==e&&(n.answer=e,o=!0)})),o){var s=u.buildExpression();this.updateBackendExpression(i,s),this.updateJson(r)}}},n.prototype.getSimplifiedNavRule=function(n,t){var e=this.En.rules.filter((function(t){return t.sourceQuestionId===n})).filter((function(n){if(n.action&&n.action.successActions&&n.action.successActions.length>0&&n.action.successActions.filter((function(n){return n.actionType===i.Navigate})).length>0)return!t||-1!=new g.ZP(n.ruleId,n.backendExpression).getConditions().findIndex((function(n){return n.answer===t}))}));return e.length>0?e[0]:null},n.prototype.getSimplifiedNavRules=function(n){var t=this.En.rules.filter((function(t){return t.sourceQuestionId===n})).filter((function(n){if(n.action&&n.action.successActions&&n.action.successActions.length>0)return n.action.successActions.filter((function(n){return n.actionType===i.Navigate})).length}));return t.length>0?t:null},n.prototype.getSimplifiedShowHideRule=function(n){var t=this.En.rules.filter((function(t){return t.sourceQuestionId===n})).filter((function(t){if(t.action&&t.action.successActions&&t.action.successActions.length>0&&t.action.successActions.filter((function(t){return t.actionType===i.Show&&t.targetId===n})).length>0)return!0}));return t.length>0?t[0]:null},n.prototype.getorCreateRuleHandle=function(n){this.On();var t=this.En.rules.filter((function(t){return t.ruleId==n}));return t.length>0?t[0]:new I},n.prototype.createSimplifiedRule=function(n,t,e,r){var o=new I;o.sourceQuestionId=n,o.name=this.Dn(n,t,e,r),o.action=new w;var u=new b;return u.actionType=e,u.targetType=t,u.targetId=e===i.Show?n:"",o.action.successActions.push(u),(0,d.JG)({type:"CV_SimplifiedBranching_AddLogic",eventInfo:{Component:"RuleConfigManager",pageName:"RuleConfigManager.createSimplifiedRule",formId:this.Rn.Model.Id,ruleType:e===i.Show?"DisplayRule":"SkipRule",tenantId:(0,s.k0)().userInfo.TenantId}}),o},n.prototype.addRule=function(n){this.En.rules.filter((function(t){return t.ruleId==n.ruleId})).length||this.En.rules.push(n)},n.prototype.xn=function(n,t){var e=this;n.forEach((function(n){n&&n.targetType==r.ChainedForm&&FormsPro.MFPDataProviderAdapter.deleteLinkedBrRule(n.targetId,t,e.Rn.Model.Id)}))},n.prototype.Ln=function(n){var t=this.En.rules.filter((function(t){return t.ruleId==n}));if(t&&t.length>0){var e=t[0];e.action&&(e.action.successActions&&this.xn(e.action.successActions,n),e.action.failureActions&&this.xn(e.action.failureActions,n))}},n.prototype.deleteRules=function(n,t){var e=this;if(n.length){var r=this.En.rules.filter((function(t){return n.includes(t.ruleId)}));if(r.length>0){r.forEach((function(n){e.Ln(n.ruleId)}));var i=this.En.rules.filter((function(t){return!n.includes(t.ruleId)}));0==i.length?(this.En.rules=[],this.En.mappings=[]):this.En.rules=i;for(var o=this.En.mappings,u=0;u<o.length;u++){var s=o[u].targetRuleList.filter((function(t){return!n.includes(t)}));s.length>0&&(o[u].targetRuleList=s),0==s.length&&o.splice(u,1)}this.En.mappings=o,this.updateJson(t)}}},n.prototype.updateRules=function(n,t){this.En.rules=n,this.updateJson(t)},n.prototype.updateRuleNames=function(n){var t=this,e=!1;this.En.rules.forEach((function(n){var r,i=null===(r=n.action)||void 0===r?void 0:r.successActions;if(i){var o=t.Dn(n.sourceQuestionId,i[0].targetType,i[0].actionType);o!==n.name&&(n.name=o,e=!0)}})),e&&this.updateJson(n)},n.prototype.qn=function(n){var t=this.En.rules.filter((function(t){return t.ruleId==n}));return t.length>0?t[0]:null},n.prototype.getRuleIndex=function(n){return this.En.rules.findIndex((function(t){return t.ruleId==n}))},n.prototype.addSuccessAction=function(n){this.An(n,!0)},n.prototype.addFailureAction=function(n){this.An(n,!1)},n.prototype.An=function(n,t){if(n){null==n.action&&(n.action=new w);var e=new b,r=t?n.action.successActions:n.action.failureActions;r.sort((function(n,t){return parseInt(n.actionsequence)-parseInt(t.actionsequence)}));var i=0;r.length>0&&(i=parseInt(r[r.length-1].actionsequence)),e.actionsequence=(i+1).toString(),r.push(e)}},n.prototype.deleteSuccessAction=function(n,t){this.deleteAction(n,t,!0)},n.prototype.deleteFailureAction=function(n,t){this.deleteAction(n,t,!1)},n.prototype.deleteAction=function(n,t,e){if(n){var r=e?n.action.successActions:n.action.failureActions;if(n&&n.action&&r){var i=r.map((function(n){return n.actionId})).indexOf(t.actionId);if(i>=0){var o=[].concat(r);o.splice(i,1),r=o}}e?n.action.successActions=r:n.action.failureActions=r}},n.prototype.getSuccessActions=function(n){return n&&n.action?n.action.successActions:[]},n.prototype.getFailureActions=function(n){return n&&n.action?n.action.failureActions:[]},n.prototype.updateBackendExpression=function(n,t){n&&(n.backendExpression=t)},n.prototype.updateRuleMappings=function(n){var t=this;if(0!=n.length){u.forEach(n,(function(n){var e=t.En.mappings.filter((function(t){return t.sourceId==n.sourceId}));e.length>0?e[0].targetRuleList=u.union(e[0].targetRuleList,n.targetRuleList):t.En.mappings.push(n)}));for(var e=n[0].targetRuleList[0],r=this.qn(e),i=this.En.mappings,o=0;o<i.length;o++){var s=i[o].targetRuleList;if(-1!=s.indexOf(e)&&-1===r.backendExpression.indexOf(i[o].sourceId)){var a=[].concat(s);a.splice(a.indexOf(e),1),a.length>0?i[o].targetRuleList=a:i.splice(o,1)}}}},n.prototype.updateJson=function(n){var t=JSON.stringify(this.En);if((0,c.cr)("CVSimplifiedBranching")&&n){var e=new S;e.Simplified.rules=this.En.rules,e.Simplified.mappings=this.En.mappings,this.En.thankyouMessageRules&&(e.thankyouMessageRules=this.En.thankyouMessageRules),t=JSON.stringify(e),this.logSimplifiedData()}this.Rn.Model.MfpBranchingData=t,this.logBranchingData(this.En,n)},n.prototype.logSimplifiedData=function(){var n=this;this.En.rules.forEach((function(t){var e,r,o,u,a=null===(e=t.action)||void 0===e?void 0:e.successActions[0];if(a)if(a.actionType===i.Show)o=null===(r=n.Rn.getElementById(a.targetId))||void 0===r?void 0:r.Model.Type.toString(),u=a.targetType.toString(),(0,d.JG)({type:"CV_SimplifiedBranching_DisplayRule_Details",eventInfo:{Component:"CVSimplifiedBranchingEditor",pageName:"RuleConfigManager.Save",formId:n.Rn.Model.Id,ruleId:t.ruleId,ShowOnElement:u,TypeOfElement:o,tenantId:(0,s.k0)().userInfo.TenantId}});else{var c=new g.ZP(t.ruleId,t.backendExpression).getConditions(),f="Variable";c.forEach((function(t){var e;t.itemType===g.qG.Question&&(f=null===(e=n.Rn.getElementById(t.sourceId))||void 0===e?void 0:e.Model.Type.toString())})),(0,d.JG)({type:"CV_SimplifiedBranching_SkipRule_Details",eventInfo:{Component:"CVSimplifiedBranchingEditor",pageName:"RuleConfigManager.Save",formId:n.Rn.Model.Id,ruleId:t.ruleId,SkipTo:a.targetType.toString(),SourceElement:f,tenantId:(0,s.k0)().userInfo.TenantId}})}}))},n.prototype.logBranchingData=function(n,t){(0,d.JG)({type:(0,a.cT)()?"CV_BranchingRuleCount":"MFPUI_BranchingRuleCount",eventInfo:{Component:(0,a.cT)()?"CVBranchingDesigner":"MFPBranchingDesigner",pageName:"RuleConfigManager.Save",formId:this.Rn.Model.Id,isSimplified:!!t,ruleCount:n.rules?n.rules.length:0,tenantId:(0,s.k0)().userInfo.TenantId}})},n.prototype.ValidateRule=function(n,t){if(n){if(null==n.action)return!0;var e=n.action.failureActions,r=n.action.successActions;if(0===e.length&&0===r.length)return!0;var i=parseInt(t.toString()),u=(0,f.ip)();switch(i){case o.EmptyAction:return this.Un(e)&&this.Un(r);case o.MultipleNavigation:return this.Vn(e)&&this.Vn(r);case o.MaxLimitReached:return e.length<=u&&r.length<=u;case o.ActionOrder:return this.Gn(r)&&this.Gn(e);case o.EmptyElse:return!(e.length>0&&0===r.length)}}return!0},n.prototype.ValidateLooping=function(n,t){if(t&&n>=0){if(null==t.action)return!0;var e=t.action.failureActions,r=t.action.successActions;if(0===e.length&&0===r.length)return!0;if(e.length>0&&!this.Bn(e,n))return!1;if(r.length>0&&!this.Bn(r,n))return!1}return!0},n.prototype.Vn=function(n){var t=n.filter((function(n){return parseInt(n.actionType.toString())===i.Navigate}));return!(t&&t.length>1)},n.prototype.Un=function(n){for(var t=/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/,e=0;e<n.length;e++){if(n[e].actionType===i.NoAction||n[e].targetType===r.NoTarget||n[e].actionType===i.Toggle||n[e].actionType.toString()===i.Navigate.toString()&&n[e].targetType.toString()===r.Url.toString()&&!t.test(n[e].targetId))return!1;if(n[e].targetType!=r.EndOfSurvey&&0===n[e].targetId.trim().length)return!1}return!0},n.prototype.Bn=function(n,t){var e=n.filter((function(n){return parseInt(n.targetType.toString())===r.Question})),i=this.Rn,o=i.Model.Questions,u=!0;if(i&&o&&o.length>0&&e&&e.length>=0){var s=m.d.convertToArray(o);e.forEach((function(n){var e=i.getQuestionById(n.targetId);if(e)if(e.Model.GroupId){var r=i.getQuestionById(e.Model.GroupId);if(r)if((o=s.indexOf(r.Model))>=0&&t>=o)return void(u=!1)}else{var o;if((o=s.indexOf(e.Model))>=0&&t>=o)return void(u=!1)}}))}return u},n.prototype.Gn=function(n){var t=this,e=-1,o=!0;if(n&&n.length>0){if(n.filter((function(n){return parseInt(n.actionType.toString())===i.Navigate})).forEach((function(i){var u=parseInt(i.targetType.toString());if(u!==r.ChainedForm&&u!==r.EndOfSurvey&&u!==r.Url){if(u===r.Question){var s=(0,p.v)(t.Rn,i.targetId);s>=0&&e<s&&(e=s)}}else o=1==n.length})),!o)return o;n.filter((function(n){var t=parseInt(n.actionType.toString());return t===i.Show||t===i.Hide})).forEach((function(n){var r=(0,p.v)(t.Rn,n.targetId);r>=0&&r<e&&(o=!1)}))}return o},n.prototype.updateDefaultVisibility=function(n,t){if(n){if(!n.action||!n.action.successActions||!n.action.successActions.length)return;var e=n.action.successActions.filter((function(n){return n.actionType===i.Show}));e.length&&(e[0].targetType===r.Question?this.Rn.getQuestionById(e[0].targetId).Model.Hidden=!t:this.Rn.getElementById(e[0].targetId).Model.Hidden=!t)}},n.prototype.convertToAdvanced=function(){if((0,c.cr)("CVSimplifiedBranching")){var n=new F;n.rules=this.En.rules,n.mappings=this.En.mappings,n.thankyouMessageRules=this.En.thankyouMessageRules;var t=JSON.stringify(n);this.Rn.Model.MfpBranchingData=t,this.logBranchingData(this.En,!1),(0,d.JG)({type:"CV_SimplifiedBranching_Import_To_Advanced",eventInfo:{Component:"RuleConfigManager",pageName:"RuleConfigManager.convertToAdvanced",formId:this.Rn.Model.Id,tenantId:(0,s.k0)().userInfo.TenantId}})}},n.prototype.Dn=function(n,t,e,o){var u=-1,s="",a="";return e===i.Show?(a=(0,l.pm)().SimplifiedBranching_Add_Display_Button,t===r.Question?(u=(0,p.v)(this.Rn,n),s=(0,l.pm)().CVSimplifiedBranching_RuleName_Question):(u=(0,p.z)(this.Rn,n),s=(0,l.pm)().CVSimplifiedBranching_RuleName_Section)):(s=(0,l.pm)().CVSimplifiedBranching_RuleName_Question,a=(0,l.pm)().SimplifiedBranching_Add_Skip_Button,u=(0,p.v)(this.Rn,n)),o?"{0}{1}, {2}, {3}".format(s,u+1,o,a):"{0}{1} {2}".format(s,u+1,a)},n}()},90638:function(n,t,e){"use strict";e.d(t,{hD:function(){return r},r1:function(){return l}});var r,i=e(73252),o=e(72467),u=e(26203),s=e(98190),a=e(81570),c=e(6666),f=e(64092);function l(n){return new h(n)}!function(n){n[n.None=1]="None",n[n.QuestionDeleted=2]="QuestionDeleted",n[n.QuestionEdited=3]="QuestionEdited",n[n.QuestionOrderChanged=4]="QuestionOrderChanged",n[n.SurveyVariableDeleted=5]="SurveyVariableDeleted",n[n.MultiPleReasons=6]="MultiPleReasons"}(r||(r={}));var h=function(){function n(n){this.En=null,this.jn={},this.Hn=(0,s.fP)(n),this.En=(0,a.Ur)(n.Model.MfpBranchingData)}return n.prototype.validateActions=function(n){var t=this;if(!n)return!0;var e=!0;return n.action&&(n.action.failureActions.forEach((function(n){!1===t.$n(n)&&(e=!1)})),n.action.successActions.forEach((function(n){!1===t.$n(n)&&(e=!1)}))),e},n.prototype.$n=function(n){return n.targetType===f.Lm.Question||n.targetType===f.Lm.Section?this.Wn(n.targetId):(0,i.cr)("CVSurveyDeletionWithBranchingPopup")&&Number(n.targetType)===f.Lm.ChainedForm?this.Xn(n.targetId):n.targetType!==f.Lm.ChainedForm||this.Xn(n.targetId)},n.prototype.validateSkipRuleActions=function(n,t){var e=this;if(!n)return r.None;var i=r.None;return n.action&&n.action.successActions.forEach((function(n){n.targetType!==f.Lm.Question&&n.targetType!==f.Lm.Section||(!e.Wn(n.targetId)||t&&!e.Wn(t)?i=i===r.None?r.QuestionDeleted:r.MultiPleReasons:r&&!e.Yn(n.targetId,t,!1)&&(i=i===r.None?r.QuestionOrderChanged:r.MultiPleReasons))})),i},n.prototype.validateConditions=function(n){if(!n)return!0;var t=new c.ZP(n.ruleId,n.backendExpression).getConditions();return this.checkConditions(t)},n.prototype.Zn=function(n,t){if(!n)return r.None;var e=new c.ZP(n.ruleId,n.backendExpression).getConditions();return this.deepConditionCheck(e,t)},n.prototype.checkConditions=function(n){return this.deepConditionCheck(n)===r.None},n.prototype.deepConditionCheck=function(n,t){var e=this,i=r.None,u=(0,o.f5)().Model.FormMaster;return n.forEach((function(n){if(n.itemType===c.qG.SurveyVariable)e.isSurveyVariable(n.sourceId)||(i=i===r.None?r.SurveyVariableDeleted:r.MultiPleReasons);else if(!e.Wn(n.sourceId)||t&&!e.Wn(t))i=i===r.None?r.QuestionDeleted:r.MultiPleReasons;else if(t&&!e.Yn(n.sourceId,t,!0))i=i===r.None?r.QuestionOrderChanged:r.MultiPleReasons;else if(n.answer&&""!==n.answer&&!1===e.nt(n.sourceId,n.answer))i=i===r.None?r.QuestionEdited:r.MultiPleReasons;else if(e.Hn.isTextQuestion(n.sourceId)){var o=e.Hn.isOperatorSupported(n.sourceId,n.operator);o&&Number(n.operator)!==c.$M.IsAnswered&&(o=e.Hn.isTextAnswerValid(u,n.sourceId,n.answer)),o||(i=i===r.None?r.QuestionEdited:r.MultiPleReasons)}})),i},n.prototype.validateUnSavedConditions=function(n){if(!n)return!0;var t=n.getConditions();return this.checkConditions(t)},n.prototype.Wn=function(n){var t=(0,o.f5)().Model.FormMaster;return!t.isFieldReady(t.Schema.Questions)||!!t.getElementById(n)},n.prototype.Yn=function(n,t,e){if(!(0,i.cr)("CVSimplifiedBranching"))return!1;var r=(0,o.f5)().Model.FormMaster,u=r.getElementById(t).Model.Order,s=r.getElementById(n).Model.Order;return e?u>s:u<s},n.prototype.nt=function(n,t){if(this.Hn.hasPredefinedOptions(n)&&this.Hn.getPredefinedOptions(n).indexOf(t)<0)return!1;return!0},n.prototype.isSurveyVariable=function(n){var t=(0,o.f5)().Model.FormMaster;if(t&&t.isFieldReady(t.Schema.PipesDetails))return JSON.parse(t.Model.PipesDetails).filter((function(t){return t.pipeName===n})).length>0;return!1},n.prototype.Xn=function(n){var t=(0,o.f5)().Model.FormList,e=(0,o.f5)().Model.FormMaster,r=(0,o.f5)().Model.AllProjects,s=!1;if((0,i.cr)("CVSurveyDeletionWithBranchingPopup")){for(var a=0;a<r.length;a++)for(var c=0;c<r[a].SurveyList.length;c++)r[a].SurveyList[c].SurveyId===n&&(s=!0);return s}return!(t&&t.length>0)||(!!(1===t.length&&e&&e.Model&&e.isFieldReady(e.Schema.Id)&&e.Model.Id===t[0].Model.Id)||u.d.convertToArray(t).map((function(n){return n.Model.Id})).indexOf(n)>=0)},n.prototype.runRuleValidation=function(n){var t=this;return void 0===n&&(n=!1),!1===n?this.jn:this.En&&this.En.rules?(this.En.rules.forEach((function(n){t.jn[n.ruleId]=t.validateConditions(n)&&t.validateActions(n)})),this.jn):this.jn},n.prototype.runSimplifiedRuleValidation=function(n){var t=this,e=(0,o.f5)().Model.FormMaster,i=(0,f.d_)(e),u=null==i?void 0:i.getAllSimplifiedRules(n),s=r.None;return null==u||u.forEach((function(e){e.action&&e.action.successActions.forEach((function(i){var o=r.None;parseInt(i.actionType.toString())===f.Us.Show?(o=t.Zn(e,n))!==r.None&&(s=s!==r.None?r.MultiPleReasons:o):parseInt(i.actionType.toString())===f.Us.Navigate&&(o=t.validateSkipRuleActions(e,n))!==r.None&&(s=s!==r.None?r.MultiPleReasons:o)}))})),s},n.prototype.optionReferred=function(n,t){var e=!1,r=(0,o.f5)().Model.FormMaster;if(!this.En||!this.En.rules)return!1;var i=null;if((0,a.f2)(r)){var u=(0,f.d_)(r),s=null==u?void 0:u.getSimplifiedNavRule(n,t);s&&(i=s.ruleId,u.deleteRules([i],!0))}return this.En.rules.forEach((function(r){r&&r.ruleId!==i&&new c.ZP(r.ruleId,r.backendExpression).getConditions().forEach((function(r,i){r.sourceId===n&&r.answer===t&&(e=!0)}))})),e},n.prototype.questionReferred=function(n){var t=!1;return!(!this.En||!this.En.rules)&&(this.En.rules.forEach((function(e){e&&(new c.ZP(e.ruleId,e.backendExpression).getConditions().forEach((function(e,r){e.sourceId===n&&(t=!0)})),!t&&e.action&&(e.action.successActions.forEach((function(e){parseInt(e.targetType.toString())===f.Lm.Question&&e.targetId===n&&(t=!0)})),t||e.action.failureActions.forEach((function(e){parseInt(e.targetType.toString())===f.Lm.Question&&e.targetId===n&&(t=!0)}))))})),t)},n}();FormsPro.getRuleValidator=l},98190:function(n,t,e){"use strict";e.d(t,{fP:function(){return s}});var r=e(12611),i=e(7645),o=e(72374),u=e(26203);function s(n,t){return new c(n,t)}var a;!function(n){n[n.Equal=1]="Equal",n[n.NotEqual=2]="NotEqual",n[n.LessThan=3]="LessThan",n[n.GreaterThan=4]="GreaterThan",n[n.IsAnswered=5]="IsAnswered",n[n.IsSelected=6]="IsSelected",n[n.Contains=7]="Contains"}(a||(a={}));var c=function(){function n(n,t){this.rt=t,this.ot=u.d.convertToArray(n.Model.Questions),this.getOperators=this.getOperators.bind(this),this.hasPredefinedOptions=this.hasPredefinedOptions.bind(this),this.getPredefinedOptions=this.getPredefinedOptions.bind(this),this.isSmileyRatingQuestion=this.isSmileyRatingQuestion.bind(this)}return n.prototype.getOperators=function(n,t){var e=null,r=this.rt?(0,i.pm)().SimplifiedBranching_ConditionOperatorList_isEqualTo:(0,i.pm)().BranchingRules_ConditionOperatorList_isEqualTo,u=this.rt?(0,i.pm)().SimplifiedBranching_ConditionOperatorList_notEqualTo:(0,i.pm)().BranchingRules_ConditionOperatorList_notEqualTo;if(t)return e=[{OperatorLabel:r,OperatorTypeCode:a.Equal},{OperatorLabel:u,OperatorTypeCode:a.NotEqual},{OperatorLabel:(0,i.pm)().RuleOperator_Contains,OperatorTypeCode:a.Contains}];if(n&&this.ot&&this.ot.length>0){var s=this.ut(n);if(s){var c=this.rt?this.ct(s.Type):(0,i.pm)().BranchingRules_ConditionOperatorList_isAnswered;switch(s.Type){case"Question.Choice":case"Question.MatrixChoice":case"Question.Rating":case"Question.TextField":case"Question.NPS":case"Question.CascadeLevel":e="Question.Choice"==s.Type&&s.ChoiceType==o.T6.MultiChoice?[{OperatorLabel:(0,i.pm)().BranchingRules_ConditionOperatorList_isSelected,OperatorTypeCode:a.IsSelected},{OperatorLabel:c,OperatorTypeCode:a.IsAnswered}]:"Question.TextField"!==s.Type||s.IsNumber?[{OperatorLabel:r,OperatorTypeCode:a.Equal},{OperatorLabel:u,OperatorTypeCode:a.NotEqual},{OperatorLabel:(0,i.pm)().RuleOperator_GreaterThan,OperatorTypeCode:a.GreaterThan},{OperatorLabel:(0,i.pm)().RuleOperator_LessThan,OperatorTypeCode:a.LessThan},{OperatorLabel:c,OperatorTypeCode:a.IsAnswered}]:[{OperatorLabel:r,OperatorTypeCode:a.Equal},{OperatorLabel:u,OperatorTypeCode:a.NotEqual},{OperatorLabel:c,OperatorTypeCode:a.IsAnswered}];break;default:e=[{OperatorLabel:c,OperatorTypeCode:a.IsAnswered}]}}}return e},n.prototype.ct=function(n){var t=(0,i.pm)().SimplifiedBranching_ConditionOperatorList_isAnswered;switch(n){case"Question.FileUpload":t=(0,i.pm)().SimplifiedBranching_ConditionOperatorList_FileUpload_isAnswered;break;case"Question.Choice":case"Question.MatrixChoice":case"Question.Rating":case"Question.Ranking":case"Question.MatrixChoiceGroup":case"Question.CascadeGroup":case"Question.CascadeLevel":t=(0,i.pm)().SimplifiedBranching_ConditionOperatorList_General_isAnswered}return t},n.prototype.hasPredefinedOptions=function(n){var t=!1;if(n&&this.ot&&this.ot.length>0){var e=this.ut(n);if(e)switch(e.Type){case"Question.Choice":case"Question.MatrixChoice":case"Question.Rating":case"Question.CascadeLevel":t=!0;break;default:t=!1}}return t},n.prototype.getPredefinedOptions=function(n){var t;if(n&&this.ot&&this.ot.length>0){var e=this.ut(n);if(e)switch(e.Type){case"Question.Choice":t=r.map(e.Choices,(function(n){return n.Description}));break;case"Question.MatrixChoice":var i=this.ut(e.GroupId);t=r.map(i.ChoiceGroup,(function(n){return n.Description}));break;case"Question.Rating":t=[];for(var o=1;o<=e.Length;o++)t.push(o.toString());break;case"Question.CascadeLevel":t=r.map(e.CascadeChoiceGroup,(function(n){return n.displayText}))}}return t},n.prototype.isTextQuestion=function(n){if(n&&this.ot&&this.ot.length>0){var t=this.ut(n);return t&&"Question.TextField"===t.Type}return!1},n.prototype.isOperatorSupported=function(n,t){if(n&&this.ot&&this.ot.length>0){var e=this.getOperators(n);if(e.length>0)return r.findIndex(e,(function(n){return n.OperatorTypeCode===parseInt(t.toString())}))>=0}return!1},n.prototype.isTextAnswerValid=function(n,t,e){return!!(n&&t&&this.ot&&this.ot.length>0)&&n.getQuestionById(t).verify(e)===o.ej.Success},n.prototype.isSmileyRatingQuestion=function(n){var t=!1,e=this.ut(n);if(e&&e.QuestionInfo){var r=JSON.parse(e.QuestionInfo);r&&"Smiley"===r.RatingShape&&(t=!0)}return t},n.prototype.ut=function(n){var t=this.ot.filter((function(t){return t.Id==n}));return t.length>0?t[0]:null},n}()},63001:function(n,t,e){"use strict";var r=e(60211),i=e(73252),o=e(72467),u=e(54740),s=e(39455);var a=function(){function n(){}return n.setMSRewardsFeatureAvailability=function(){n.isMSRewardsFeatureEnabledToUser().then((function(n){(0,o.f5)().Model.IsIncentiveEnabled=n}))},n.isMSRewardsFeatureEnabled=function(){return(0,i.cr)("FormsProMSRewardsIntegration")},n.isIncentiveResponsesEnabledOnTenant=function(){return(0,o.f5)().Model.FormsTenantSettings.InOrgSurveyIncentive},n.isMSRewardsFeatureEnabledToUser=function(){if(n.isMSRewardsFeatureEnabled()&&n.isIncentiveResponsesEnabledOnTenant()&&n.isMSRewardsFeatureAvailableInTenantCountry()){if("Int"===(0,r.kD)()||"DevHost"===(0,r.kD)())return Promise.resolve(!0);var t=(0,u.tW)(),e=(0,u.ge)();return Promise.all([t,e]).then((function(n){var t=n[0],e=n[1];return t||e}))}return Promise.resolve(!1)},n.isMSRewardsFeatureEnabledToC2User=function(){return n.isMSRewardsFeatureEnabled()&&n.isIncentiveResponsesEnabledOnTenant()},n.isMSRewardsFeatureAvailableInTenantCountry=function(){var n=(0,o.f5)().Model.TenantCountryCode;return null!=n&&""!=n&&s.Z.getSetting(s.G.FormsProMSRewardsAvailableCountryCodes).split(",").indexOf(n)>=0},n}();FormsPro.setMSRewardsFeatureAvailability=function(){return a.setMSRewardsFeatureAvailability()},FormsPro.isMSRewardsFeatureEnabled=function(){return a.isMSRewardsFeatureEnabled()},FormsPro.isIncentiveResponsesEnabledOnTenant=function(){return a.isIncentiveResponsesEnabledOnTenant()},FormsPro.isMSRewardsFeatureAvailableInTenantCountry=function(){return a.isMSRewardsFeatureAvailableInTenantCountry()},FormsPro.isMSRewardsFeatureEnabledToUser=function(){return a.isMSRewardsFeatureEnabledToUser()},FormsPro.isMSRewardsFeatureEnabledToC2User=function(){return a.isMSRewardsFeatureEnabledToC2User()}},85475:function(n,t,e){"use strict";e.d(t,{gA:function(){return a}});var r=e(84358),i=e(31699),o=e.n(i),u=e(64290);function s(n){if("A"===n.tagName){var t=n.getAttribute("href");!t||(0,r.K2)(t)||(0,r.xx)(t)||n.removeAttribute("href")}}function a(n){o().addHook("afterSanitizeAttributes",s);var t=o().sanitize(n,{ALLOWED_ATTR:["style","href","target","tabindex","aria-label","accesskey","charset","class","dir","download","id","lang","name","rel","title","type"],ALLOWED_TAGS:["span","strong","em","u","a"]});return o().removeHook("afterSanitizeAttributes"),t?t.toString():t}u.Xw.sanitizeRichTextHTML=a,u.Xw.sanitizeRichTextHTMLForTemplates=function(n){o().addHook("afterSanitizeAttributes",s);var t=o().sanitize(n);return o().removeHook("afterSanitizeAttributes"),t?t.toString():t},FormsPro.createUrlForSmallWindow=function(n,t){for(var e in n+=encodeURIComponent("id")+"="+encodeURIComponent(t.id),t)"id"!==e&&(n+="&"+encodeURIComponent(e)+"="+encodeURIComponent(t[e]));return n}},81570:function(n,t,e){"use strict";e.d(t,{JB:function(){return r},Ur:function(){return o},f2:function(){return u}});var r,i=e(73252);function o(n){var t=null;if(n){var e=JSON.parse(n);if((0,i.cr)("CVSimplifiedBranching")&&e.IsSimplified){var r=JSON.parse(n);(t=null==r?void 0:r.Simplified).thankyouMessageRules=null==r?void 0:r.thankyouMessageRules}else t=e}return t}function u(n){if(!n||!(0,i.cr)("CVSimplifiedBranching"))return!1;var t=n.Model.MfpBranchingData;if(!(n.isFieldReady(n.Schema.CVSimplifiedBranchingSupported)&&"true"===n.Model.CVSimplifiedBranchingSupported))return!1;if(t){var e=JSON.parse(t);if(!e.IsSimplified)return!e.rules.length}return!0}!function(n){n[n.TranslationOnly=0]="TranslationOnly",n[n.BranchingOnly=1]="BranchingOnly",n[n.Both=2]="Both"}(r||(r={}))},39455:function(n,t,e){"use strict";e.d(t,{G:function(){return r},Z:function(){return u}});var r,i=e(9947),o={};!function(n){n[n.ApiFacadeEndPoint=0]="ApiFacadeEndPoint",n[n.FormsProUIHost=1]="FormsProUIHost",n[n.FormsHomeUrl=2]="FormsHomeUrl",n[n.FormsSingleSignOnHomeUrl=3]="FormsSingleSignOnHomeUrl",n[n.FormsProCdnHomeUrl=4]="FormsProCdnHomeUrl",n[n.PreviewSettingsDefaultDate=5]="PreviewSettingsDefaultDate",n[n.FormsProGeo=6]="FormsProGeo",n[n.FormsProLicensingServiceEndPoint=7]="FormsProLicensingServiceEndPoint",n[n.FormsProSampleFormTenantId=8]="FormsProSampleFormTenantId",n[n.FormsProMSRewardsAvailableCountryCodes=9]="FormsProMSRewardsAvailableCountryCodes",n[n.FormsProCSATEndpoint=10]="FormsProCSATEndpoint",n[n.FormsProCSATTenant=11]="FormsProCSATTenant",n[n.FormsProResponseLimit=12]="FormsProResponseLimit",n[n.UIFacadeEndPoint=13]="UIFacadeEndPoint",n[n.ChatDistributionEndpoint=14]="ChatDistributionEndpoint",n[n.ProjectUIServiceEndpoint=15]="ProjectUIServiceEndpoint",n[n.FormsProResponseGridLimit=16]="FormsProResponseGridLimit",n[n.OrchestrationServiceEndpoint=17]="OrchestrationServiceEndpoint",n[n.FormsProRespondentGridMaxLimit=18]="FormsProRespondentGridMaxLimit",n[n.FormsProRespondentGridPageSize=19]="FormsProRespondentGridPageSize",n[n.SatisfactionMetricTrendAndAggregateDataUrl=20]="SatisfactionMetricTrendAndAggregateDataUrl",n[n.SatisfactionMetricMaxLimit=21]="SatisfactionMetricMaxLimit",n[n.CustomerVoiceProjectShareServiceEndpoint=22]="CustomerVoiceProjectShareServiceEndpoint",n[n.ExportCsvServiceEndpoint=23]="ExportCsvServiceEndpoint",n[n.CustomerVoiceSurveyUIServiceEndpoint=24]="CustomerVoiceSurveyUIServiceEndpoint",n[n.CurrentFlowEndpoint=25]="CurrentFlowEndpoint",n[n.CVFlowUIServiceEndPoint=26]="CVFlowUIServiceEndPoint",n[n.CVHomeVideoLinks=27]="CVHomeVideoLinks",n[n.CVDynamicsLink=28]="CVDynamicsLink",n[n.ProjectAlertServiceEndPoint=29]="ProjectAlertServiceEndPoint",n[n.CVReportingLimit=30]="CVReportingLimit",n[n.CustomerVoiceProjectShareServiceV2Endpoint=31]="CustomerVoiceProjectShareServiceV2Endpoint",n[n.CVCIServiceEndpoint=32]="CVCIServiceEndpoint",n[n.CVSurveyReportDateFilterRange=33]="CVSurveyReportDateFilterRange",n[n.DistributionServiceEndpoint=34]="DistributionServiceEndpoint",n[n.CVPauseResumeService=35]="CVPauseResumeService",n[n.InviteServiceEndpoint=36]="InviteServiceEndpoint",n[n.ShareV2StatusFetchDuration=37]="ShareV2StatusFetchDuration",n[n.CustomLinksExcelUploadLimit=38]="CustomLinksExcelUploadLimit",n[n.CustomLinksRecordsLimit=39]="CustomLinksRecordsLimit",n[n.CVReportServiceHostUrl=40]="CVReportServiceHostUrl",n[n.CascadeSubQuesMaxLimit=41]="CascadeSubQuesMaxLimit",n[n.CVRespondentGridPageSize=42]="CVRespondentGridPageSize",n[n.CVResponseDeletePerBatchLimit=43]="CVResponseDeletePerBatchLimit",n[n.CVProjectOperationFetchDuration=44]="CVProjectOperationFetchDuration",n[n.CVSurveyCountApproachingLimitFirstStage=45]="CVSurveyCountApproachingLimitFirstStage",n[n.CVSurveyCountApproachingLimitSecondStage=46]="CVSurveyCountApproachingLimitSecondStage",n[n.CVSurveyCountExceedLimit=47]="CVSurveyCountExceedLimit",n[n.ShareV2SurveyLimitToShowMessage=48]="ShareV2SurveyLimitToShowMessage",n[n.CVHomeVideoTitles=49]="CVHomeVideoTitles",n[n.CVRoleTemplateId=50]="CVRoleTemplateId",n[n.CVGetFormLimit=51]="CVGetFormLimit",n[n.CVCkEditorVersion=52]="CVCkEditorVersion",n[n.CVTransferOwnershipDocUrl=53]="CVTransferOwnershipDocUrl"}(r||(r={})),o[r.ApiFacadeEndPoint]="https://mfpapifacadefaint.azurewebsites.net/",o[r.UIFacadeEndPoint]="https://cvsurveyuiserviceint.azurewebsites.net",o[r.FormsProUIHost]="https://mfpuiwebappint.azurewebsites.net",o[r.FormsHomeUrl]="https://forms.office-int.com",o[r.FormsSingleSignOnHomeUrl]="https://forms.office-int.com/formspro",o[r.FormsProCdnHomeUrl]="https://mfpembedcdnint.azureedge.net/mfpembedcontint/",o[r.PreviewSettingsDefaultDate]="2019-02-08",o[r.FormsProGeo]="INT",o[r.FormsProLicensingServiceEndPoint]="https://mfplicensingservicefaint.azurewebsites.net/",o[r.FormsProSampleFormTenantId]="558a6a52-809d-4de8-8b01-01a51502c93f",o[r.FormsProMSRewardsAvailableCountryCodes]="US",o[r.FormsProCSATEndpoint]="https://nps.onyx.azure.net",o[r.FormsProCSATTenant]="formspro",o[r.FormsProResponseLimit]="50000",o[r.ChatDistributionEndpoint]="https://mfpuifacadeint.projectsshimlaint.com/",o[r.ProjectUIServiceEndpoint]="https://cvuiserviceatmint.projectsshimlaint.com/",o[r.ProjectAlertServiceEndPoint]="https://mfpprojectalertfaint.azurewebsites.net/",o[r.FormsProResponseGridLimit]="5000",o[r.OrchestrationServiceEndpoint]="https://cvtemplateorchfaint.azurewebsites.net/",o[r.FormsProRespondentGridMaxLimit]="500",o[r.FormsProRespondentGridPageSize]="50",o[r.SatisfactionMetricTrendAndAggregateDataUrl]="https://mfpsatisfactionmetricsapisfaint.azurewebsites.net/",o[r.SatisfactionMetricMaxLimit]="10",o[r.CustomerVoiceProjectShareServiceEndpoint]="https://cvuisharev2tm.projectsshimlaint.com/",o[r.ExportCsvServiceEndpoint]="https://mfpuasfaint.azurewebsites.net/",o[r.CustomerVoiceSurveyUIServiceEndpoint]="https://cvsurveyuiserviceint.azurewebsites.net/",o[r.CurrentFlowEndpoint]="https://us.tip1.flow.microsoft.com/",o[r.CVFlowUIServiceEndPoint]="https://cvflowfaint.azurewebsites.net/",o[r.CVHomeVideoLinks]="https://youtu.be/Mctc8pc6q_A,https://youtu.be/se5fCA9IptI,https://youtu.be/jLdw_TSqolA",o[r.CVHomeVideoTitles]="Introduction to Dynamics 365 Customer Voice,How to add branching rules to your survey in Dynamics 365 Customer Voice,Customer Feedback Management Solution for banks using Dynamics 365 Customer Voice",o[r.CVDynamicsLink]="https://dynamics.microsoft.com/en-us/customer-voice/overview/",o[r.CVReportingLimit]="500000",o[r.CustomerVoiceProjectShareServiceV2Endpoint]="https://cvuisharev2faint.azurewebsites.net/",o[r.CVCIServiceEndpoint]="https://cvcifaint.azurewebsites.net/",o[r.DistributionServiceEndpoint]="https://mfpdistfaint.azurewebsites.net/",o[r.CVSurveyReportDateFilterRange]="90",o[r.CVPauseResumeService]="https://mcvparfaint.azurewebsites.net/",o[r.InviteServiceEndpoint]="https://cvinviteservicefaint.azurewebsites.net/formapi/api/",o[r.ShareV2StatusFetchDuration]="5000",o[r.CustomLinksExcelUploadLimit]="10000",o[r.CustomLinksRecordsLimit]="10000",o[r.CVReportServiceHostUrl]="https://customervoicereportingapi.azurewebsites.net/",o[r.CascadeSubQuesMaxLimit]="3",o[r.CVRespondentGridPageSize]="500",o[r.CVResponseDeletePerBatchLimit]="500",o[r.CVProjectOperationFetchDuration]="5000",o[r.CVSurveyCountApproachingLimitFirstStage]="350",o[r.CVSurveyCountApproachingLimitSecondStage]="375",o[r.CVSurveyCountExceedLimit]="400",o[r.ShareV2SurveyLimitToShowMessage]="15",o[r.CVRoleTemplateId]="62e90394-69f5-4237-9190-012177145e10",o[r.CVGetFormLimit]="200",o[r.CVCkEditorVersion]="4.11.2-full",o[r.CVTransferOwnershipDocUrl]="https://docs.microsoft.com/en-us/dynamics365/customer-voice/manage-projects#share-a-project";var u=function(){function n(){}return n.getSetting=function(t){n.webSettingsJson||(n.webSettingsJson=decodeURI((0,i.k0)().webSettings||"{}")),n.webSettingsMap||(n.webSettingsMap=JSON.parse(n.webSettingsJson));var e=n.webSettingsMap[r[t].toString()];if(!e){var u=o[t];e=u||n.defaultValue}return e},n.defaultValue="",n}()},92528:function(n,t,e){"use strict";e.d(t,{y3:function(){return a},QY:function(){return s}});var r,i,o={$detectUserLoggedInAAD:"a",$getToken:"b",$lrpIoC:"c",$setIoCDelegator:"d"},u=new(e(37890).wU);function s(n){i=n}function a(){var n=function(){if("function"==typeof i)return i;var n=function(){r||(r={},Object.keys(o).forEach((function(n){var t=o[n];Object.defineProperty(r,n,{configurable:!1,enumerable:!0,get:function(){return window.formClientApi&&window.formClientApi[t]},set:function(){throw new Error("Please call setClientApi instead.")}})})));return r}().$getToken;if("function"==typeof n)return n;return}();return n?n().then((function(n){return u.resolve(n),n})).catch((function(n){throw u.reject(n),n})):Promise.reject("No addin access token getter is registered.")}},7614:function(n,t,e){"use strict";e.d(t,{r:function(){return f}});var r,i=e(42922),o=e(9947),u=e(72317),s=e(31442),a=e(21607),c=!1;function f(n){return r&&!c||(c=!1,r=(0,a.v9)(n).then((function(){return(0,s.$U)("RefreshInfo.Success"),(0,u.a)().Flighting.setFlights((0,o.k0)().flights),(0,i.U)(),!0})).catch((function(n){throw(0,s.$U)("RefreshInfo.Failed",{error:n}),c=!0,n}))),r}},67353:function(n,t,e){"use strict";e.d(t,{l8:function(){return E},LP:function(){return R},g$:function(){return k}});var r=e(94978),i=["https://forms.office.com","https://forms.office-int.com","https://forms.osi.apps.mil","https://forms.osi.office365.us","https://forms.microsoft.com","https://msit.microsoftstream.com","https://web.microsoftstream.com","https://microsoftapc.sharepoint.com","https://teams.microsoft.com","https://microsoft.sharepoint-df.com","https://www.onenote.com","https://sway.office.com","https://approvals.teams.microsoft.com","https://approvalsint.teams.microsoft.com","https://approvalsppe.teams.microsoft.com","https://approvals.gcc.teams.microsoft.com","https://healthcarestaging.teams.microsoft.com","https://healthcareppe.teams.microsoft.com","https://healthcaredev.teams.microsoft.com","https://healthcaredogfood.teams.microsoft.com","https://healthcare.teams.microsoft.com","https://outlook.office365.com","https://purview.azure-test.com","https://purview.azure.com","https://outlook-sdf.office.com","https://www.office.com","https://outlook.office.com","https://fa000000084.resources.office.net","https://fa000000096.resources.office.net","https://fluidhostwin32.azurewebsites.net","https://fluidhostwin32-dev.azurewebsites.net","https://dev.ch5.fluidpreview.office.net","https://dev.fluidpreview.office.net","https://fluidpreview.office.net","https://fluidhostwin32-staging.azurewebsites.net","https://office.com","https://reports.teams.microsoft.com","https://reports-ppe.teams.microsoft.com","https://reports-int.teams.microsoft.com","https://sci.local.dynamics.com","https://sci.test.dynamics.com","https://sci.us-cm100.gateway.test.cm.powerapps.com","https://ch5.fluidpreview.office.net","https://officefluidprdeployments.azurewebsites.net","https://df.loop.microsoft.com","https://dev.loop.microsoft.com","https://loop.microsoft.com","https://local.loop.microsoft.com","https://dev.whiteboard.microsoft.com","https://app.int.whiteboard.microsoft.com","https://whiteboard.office.com","https://whiteboard.microsoft.com","https://app.whiteboard.microsoft.com"];function o(n){return function(n){return-1!==i.indexOf(n.toLowerCase())}(n)||function(n){var t=(0,r.qA)("ParentOriginWhitelist");return!!t&&(-1!==t.indexOf(n.toLowerCase())||function(n,t){for(var e=0,r=t;e<r.length;e++){var i=r[e],o=n.length-i.length;if(o>=0&&-1!==n.indexOf(i,o))return!0}return!1}(n.toLowerCase(),t))}(n)}var u=e(4851),s=function(){function n(n,t){var e=this;this.handlers=[],this.gt=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return e.handlers.reduce((function(t,e){if(e)return e.apply(void 0,n)}),void 0)},t&&this.subscribe(t),this.bt=n,n(this.gt)}return n.prototype.subscribe=function(n){var t=this;return this.handlers.push(n),(0,u.Rm)((function(){var e=t.handlers.indexOf(n);e>-1&&t.handlers.splice(e,1)}))},n.prototype.subscribeAtFirst=function(n){var t=this;return this.handlers.unshift(n),(0,u.Rm)((function(){var e=t.handlers.indexOf(n);e>-1&&t.handlers.splice(e,1)}))},n.prototype.reset=function(){this.bt(this.gt)},n}(),a=(0,u.Rm)((function(){return new s((function(n){window.onbeforeunload=n}),window.onbeforeunload)})),c=function(){function n(){this.wt=!0}return n.getInstance=function(){return n._instance||(n._instance=new n)},n.prototype.blockUnload=function(){return this.wt?a().subscribe((function(){return""})):function(){}},n.prototype.forceUnblockUnload=function(n){void 0===n&&(n=!1),a().subscribe((function(){return null})),a().reset(),this.wt=!n},n}();function f(){return c.getInstance()}var l,h=e(94290),d=e(9947),m=e(916),v=e(37890),p=e(72317),g=e(31442),b=e(73252),w=e(20987),I=e(81620),y=e(47393),S=e(76669),F=e(46008),C=e(92528),_=e(7614),T=e(59469),P=0,N=null;function k(){window.formsRefreshAuthTokenCallbacks||(window.formsRefreshAuthTokenCallbacks=[]);return(0,T.W3)((function(){return(0,p.a)().AuthContext.hasUserLoggedIn()}),(function(){f().forceUnblockUnload(!0),(0,p.a)().AuthContext.signIn().then(y.iv)}))}function E(n,t){return new Promise((function(e,r){var i="detect-user-loggedIn-frame";if(window.formsDetectUserLoggedInCallback)r();else{var o="Msa"===n,u=o?"Auth.DetectUserLoggedInMSA":"Auth.DetectUserLoggedInAAD",s=new m.o(u);s.start();var a=(0,d.k0)(),c=a.signInLinkSilentMsa,f=a.signInLinkSilent,l=o?c:f;t&&(l=(0,I.y)(l,o?"username":"login_hint",encodeURIComponent(t))),window.formsDetectUserLoggedInCallback=function(n,t){window.formsDetectUserLoggedInCallback=void 0,s.end({resultType:t?"ExpectedFailure":"Success",extraData:{loggedIn:n}});var r=document.getElementById(i);null==r||r.remove(),e(n)},function(n,t){var e=document.createElement("iframe");return e.id=n,e.style.display="none",e.src=t,document.body.append(e),e}(i,l).contentWindow.addEventListener("load",(function(){window.setTimeout((function(){window.formsDetectUserLoggedInCallback&&window.formsDetectUserLoggedInCallback(!1,!0)}),5e3)}))}}))}function R(){if((0,w.dY)()||(0,w.LG)()||(0,w.Av)()){if(l||(l=new v.wU),!(0,w.LG)()&&!(0,w.Av)()&&N&&N.isAccessTokenFromHostValid()){var n=N.getAccessToken();return l.resolve(n),l.promise()}return l.states()!==v.Cb.Pending&&(l=new v.wU),function(){N=null,window.addEventListener("message",O,!1);var n="*";(0,b.cr)("FixEslintPostMessageError")&&(!(n=(0,F.LU)())||n&&!o(n))&&((0,g.$U)("Warning.HostOrigin.GetAccessTokenFromHost",{error:"Parent origin doesn't exist in whitelist",origin:n}),n="*");window.parent.postMessage("GetAccessTokenFromHost",n)}(),P=0,x(),l.promise()}return(0,F.xO)()?(0,C.y3)().then(null,(function(){return D()})):(0,h.mF)()?(0,S.l4)():D()}function O(n){if(n.data&&"string"==typeof n.data&&n.data.startsWith("FormsAccessTokenFromHost:"))try{var t="FormsAccessTokenFromHost:Bearer ",e=n.data.indexOf(t);if(-1!==e){var r=n.data.substring(e+t.length);N=new L(r)}}finally{window.removeEventListener("message",O,!1)}}function D(){return Promise.resolve(null)}function x(){if(null!=N){var n=N.getAccessToken();(0,_.r)(n).then((function(){return l.resolve(n)}))}else P<10?(P++,window.setTimeout(x,1e3)):(P=0,l.resolve(null))}var L=function(){function n(n){this.It=n;this.yt=(new Date).getTime()+33e5}return n.prototype.getAccessToken=function(){return this.It},n.prototype.isAccessTokenFromHostValid=function(){return!!this.It&&(new Date).getTime()<this.yt},n}()},59469:function(n,t,e){"use strict";e.d(t,{D1:function(){return h},W3:function(){return f},ad:function(){return d},hh:function(){return c},xO:function(){return l}});var r=e(59749),i=e(64459),o=e(9947),u=e(916),s=e(81620),a=e(47393);function c(n){if(401===(n&&n.response&&n.response.statusCode)){if(n&&n.response&&"Expired"===(0,s.jL)(n.response.headers,"X-FailureReason"))return!0;var t=n&&n.response&&(0,i.d)(n.response.body);if(711===(t&&t.error&&parseInt(t.error.code)))return!0}return!1}function f(n,t){var e=(0,o.k0)().signInLinkSilent,i=(0,o.k0)().signInLinkSilentMsa;return new Promise((function(s){if(window.formsRefreshAuthTokenCallbacks||(window.formsRefreshAuthTokenCallbacks=[]),window.formsRefreshAuthTokenCallbacks.push((function(n,e){!e&&n?s():t()})),!window.formsRefreshAuthTokenCallback){var a=new u.o("Auth.RefreshToken");a.start();var c=function(n,t){try{a.end({extraData:{loggedIn:n},resultType:t?"ExpectedFailure":"Success"});var e=document.querySelector("#refreshAuthTokenFrame");e&&e.parentNode.removeChild(e);var r=window.formsRefreshAuthTokenCallbacks;r&&(t?r&&r.length>0&&r[0](n,t):r.forEach((function(e){return e(n,t)})))}finally{window.formsRefreshAuthTokenCallback=void 0,window.formsRefreshAuthTokenCallbacks=void 0}};if(n()){var f=(0,o.k0)().userInfo.IsMsa?i:e,l=document.createElement("iframe");l.id="refreshAuthTokenFrame",l.setAttribute("style","display: none;"),(0,r.M5)(l,f);var h=function(){window.formsRefreshAuthTokenCallback&&window.formsRefreshAuthTokenCallback(!1,!0)};l.onload=function(){window.setTimeout(h,5e3)},window.setTimeout(h,5e3),window.formsRefreshAuthTokenCallback=c,document.body.appendChild(l)}else c(!1,!0)}}))}function l(n){if(401===(n&&n.response&&n.response.statusCode)){var t=n&&n.response&&(0,i.d)(n.response.body);if(718===(t&&t.error&&parseInt(t.error.code)))return!0}return!1}function h(n){if(401===(n&&n.response&&n.response.statusCode)){var t=n&&n.response&&(0,s.jL)(n.response.headers,"WWW-Authenticate");return t&&-1!==t.indexOf("invalid_token")}return!1}function d(){var n=window.location.href,t=n.replace(/^https:\/\/forms\.microsoft(-int)?\.com/,"https://forms.office$1.com");n!==t&&(0,a.mj)(t)}},49211:function(n,t,e){"use strict";e.d(t,{w:function(){return a}});var r=e(12611),i=e(29952),o=e(9947),u=e(72420),s=e(71860);function a(n,t){var e;if((0,u.HD)(n))e=n;else if(n){var a=n;if(a.isFieldReady(s.x.Schema.OwnerId)&&!a.IsGroupForm&&a.Model.OwnerId!==(0,o.k0)().userInfo.UserId)return!1;a.isFieldReady(s.x.Schema.Category)&&(e=a.Model.Category),a.isFieldReady(s.x.Schema.Type)&&!(0,i.Oy)()&&("approval"===a.Model.Type?e="Approval":"reports"===a.Model.Type&&(e="Reports"))}return!!e&&r.contains({"Loop Poll":["DisableEditForm"],Poll:["Settings.AllowResponderGetAllResponses","DisableEditForm","ResponsePage.PollView"],"Teams Poll":["DisableEditForm"],Approval:["DisableEditForm"],Reports:["DisableEditForm"]}[e],t)}},6787:function(n,t,e){"use strict";e.d(t,{lz:function(){return m},u3:function(){return w},Kc:function(){return v},HA:function(){return d},UM:function(){return p},Q3:function(){return b},CM:function(){return g},jq:function(){return I},y:function(){return f},cT:function(){return l},WT:function(){return a},Pq:function(){return c},sv:function(){return h}});var r=e(60211);function i(){return(0,r.Mr)()?"https://graph.eaglex.ic.gov/v1.0":(0,r.bQ)()?"https://graph.microsoft.scloud/v1.0":(0,r.j4)()?"https://graph.microsoft.us/v1.0":(0,r.a4)()||(0,r.u7)()?"https://graph.microsoft.com/v1.0":"https://graph.microsoft-ppe.com/v1.0"}var o=e(64290),u=e(73252),s=e(90710);function a(){return(0,u.cr)("EnableCustomerVoice")&&!(0,u.cr)("CustomerVoiceBlackList")}function c(){return window.location.host.toLocaleLowerCase().indexOf("customervoice.microsoft.us")>=0}function f(){var n=(0,r.kD)();return"CVInt"===n||"CVProd"===n||"CVTip"===n||"CVFastfood"===n||"CVDaily"===n||c()}function l(){return f()&&a()}function h(){return"/pages/mobiledesignpage.aspx"===window.location.pathname.toLowerCase()}function d(){return(0,o.pd)(i,(function(){return(0,r.yv)()?"https://graph.microsoft.com/beta":"https://graph.microsoft-ppe.com/beta"}))}function m(n){return"lists."+y(n)}function v(){return(0,s.NW)().lang||null}function p(){return(0,s.NW)().showmultilingual||null}function g(){return(0,s.NW)().showheader||null}function b(){return(0,s.NW)().showfooter||null}function w(){var n=(0,s.NW)().showoriginalheader;return n&&"true"===n}function I(){var n=(0,s.NW)().showcancel;return n&&"true"===n}function y(n,t){switch(void 0===t&&(t=!1),null==n&&(n=(0,r.kD)()),n){case"USNat":return t?"eaglex.ic.gov":"osi.eaglex.ic.gov";case"USSec":return t?"microsoft.scloud":"osi.microsoft.scloud";case"USDoDProd":return t?"apps.mil":"osi.apps.mil";case"USGovProd":return t?"office365.us":"osi.office365.us";case"USGovGccProd":return t?"office.com":"gcc.osi.office365.us";case"WWProd":case"MSProd":case"ProTip":case"CVProd":case"CVTip":case"CVFastfood":return"office.com";case"Trial":return"officeppe.com";default:return"office-int.com"}}},73252:function(n,t,e){"use strict";e.d(t,{VE:function(){return a},cr:function(){return f},g:function(){return l},M0:function(){return s},_y:function(){return d},Gs:function(){return c}});var r,i=e(9947);!function(n){n[n.ResponsePage=1]="ResponsePage",n[n.TeamsResponsePage=2]="TeamsResponsePage",n[n.AssignmentResponsePage=4]="AssignmentResponsePage"}(r||(r={}));var o,u=e(72317);function s(){return h(r.ResponsePage)&&!d()}function a(){return h(r.ResponsePage|r.TeamsResponsePage|r.AssignmentResponsePage)&&!d()}function c(){return s()}function f(n){try{return(0,u.a)().Flighting.isEnabled(n)}catch(n){return!1}}function l(){return f("FirstReleaseClientEnabled")}function h(n){return 0!=(o&n)}function d(){return!!(0,i.k0)().proEnabled&&f("FormsPro")}},94978:function(n,t,e){"use strict";e.d(t,{Gw:function(){return f},QJ:function(){return l},qA:function(){return h},vj:function(){return d}});var r,i=e(59312),o=e(4851),u=e(9947),s=e(9754),a={},c=(0,o.Rm)(s.kz);function f(n){var t,e;if(!window.OfficeFormServerInfo)return a[n]||"";if(void 0===r){try{r=JSON.parse(decodeURI((0,u.k0)().webSettings||"{}"))}catch(n){r={}}r=(0,i.pi)((0,i.pi)({},r),c())}return null!==(e=null!==(t=r[n])&&void 0!==t?t:a[n])&&void 0!==e?e:""}function l(n,t){void 0===t&&(t=null);var e=f(n);if(e)try{return JSON.parse(e)}catch(n){}return t}function h(n){var t=f(n);if(t)try{var e=JSON.parse(t);if(Array.isArray(e))return e}catch(n){return null}return null}function d(n,t){var e=f(n);if(e){var r=parseInt(e);if(!isNaN(r))return r}return t}function m(n,t){a[n]=t}m("CustomerVoiceTransitionCompletionDate","08/30/2020"),m("CustomerVoiceUrl","https://customervoice.microsoft-int.com")},57411:function(n,t,e){"use strict";e.d(t,{BP:function(){return h},M5:function(){return f},eT:function(){return l},gq:function(){return c},tE:function(){return a},x_:function(){return s}});var r=e(60211),i=e(37076),o=null,u=null;function s(){return o&&o()}function a(){return u&&u()}function c(){var n=(0,i.kc)(s()||"");return!!n.OrgId&&n.OrgId.toLowerCase()===(0,r.rq)()}function f(){var n=(0,i.kc)(s()||"");return!!n.OrgId&&n.OrgId.toLowerCase()===(0,r.Fc)()}function l(){var n=(0,i.kc)(s()||"");return!!n.OrgId&&-1!==(0,r.iI)().indexOf(n.OrgId.toLowerCase())}function h(){var n=s();return n&&(0,i.kc)(n)}},9754:function(n,t,e){"use strict";e.d(t,{EG:function(){return c},dR:function(){return a},kz:function(){return s}});var r,i=e(64459),o=e(9947);function u(n){var t=n||(0,o.k0)().ecsWebSettings||{};return"string"==typeof t&&(t=(0,i.d)(t)),"object"==typeof t&&!Array.isArray(t)&&t||(t={}),t}function s(n){var t=u(n),e={};return Object.keys(t).forEach((function(n){e[n]="string"!=typeof t[n]?JSON.stringify(t[n]):t[n]})),e}function a(n){return void 0===r&&(r=u()),r[n]}function c(n){r=u(n),!0}},7899:function(n,t,e){"use strict";e.d(t,{y:function(){return d},m:function(){return m}});var r=e(78587),i=e(9947),o=e(59749);var u,s,a,c,f,l={},h=(u=(0,i.k0)(),s=u.scriptSuffix,a=u.isCdnEnabled,c={"combined-design":a?"Vendors/combinedmin/design_v3.min.js":"Vendors/combined/design_v3_aabaaa2.js","combined-response":a?"Vendors/combinedmin/response_v2.min.js":"Vendors/combined/response_v2_5234a19.js",DataTables:"Vendors/DataTables."+s,Chart:"Vendors/Chart-2.6."+s,Clipboard:"Vendors/clipboard-1.7.1.min.js",ColorThief:"Vendors/color-thief/color-thief.min.js",D3:"Vendors/d3/d3."+s,ImmersiveReader:"Vendors/ImmersiveReader/immersive-reader-sdk.0.0.2.min.js",JQuery_RateIt:"Vendors/rating-1.1.0/jquery.rateit."+s,JQuery_QRCode:"Vendors/jquery.qrcode.min.js",MathJax:(f="".concat(window.location.origin,"/scripts/vendors/mathjax/MathJax.js?config=TeX-AMS_HTML"),f),MathQuill:"Vendors/mathquill/mathquill."+s,O365ShellBootstrap:v(),Mark:"Vendors/markjs-8.9.0/mark."+s,SignalR:"Vendors/SignalR/jquery.signalR-2.4.1.min.js",Sortable:"Vendors/sortablejs-1.8.4/Sortable.modified."+s},Object.keys(c).reduce((function(n,t){return n[t]=function(n,t){return p(n)?(0,r.oE)(t,!1):t||""}(t,c[t]),n}),{}));function d(n){return l[n]||(l[n]=function(n){return function(n,t,e){return new Promise((function(r,i){if(!n)throw Error("No script path for "+n);var u=document.getElementsByTagName("head")[0];if(!u)return i(Error("No head element found!"));var s=document.createElement("script");s.type="text/javascript",s.async=!0,(0,o.M5)(s,n),t&&e&&(s.crossOrigin="anonymous"),s.onload=function(){return r()},s.onerror=function(){u.removeChild(s),i(Error("Failed to load javascript file: "+n))},u.appendChild(s)}))}(h[n],(0,i.k0)().isCdnEnabled,p(n))}(n)),l[n]}function m(n){return Promise.all(n.map(d))}function v(){var n=(0,i.k0)(),t=n.o365ShellBootHost,e=n.o365ShellBootstrapperUrl;return t?e||t.concat("/api/shellbootstrapper/",(0,i.k0)().userInfo.IsMsa?"consumer":"business","/oneshell"):""}function p(n){return["MathJax","O365ShellBootstrap"].indexOf(n)<0}},77356:function(n,t,e){"use strict";e.d(t,{z:function(){return u}});var r=e(72377);var i=e(57411),o=e(94978);function u(n){(0,i.M5)()||r.Pv.Resolve("IThirdPartyLinkify").then((function(){return function(n){n.linkify();var t=/^[a-z0-9]\.|\.xxx/i,e=(0,o.Gw)("LinkifyEscapeRegex");e&&(t=new RegExp(e,"i"));n.find("a.linkified").each((function(n,e){$(e).text().match(t)&&$(e).contents().unwrap()}))}(n)}))}},51254:function(n,t,e){"use strict";e.d(t,{WW:function(){return u},d6:function(){return a}});var r,i=e(37890),o=e(61018),u="ClientMSGraph.";function s(){r=new i.bC((0,o.d8)().getOD4BToken())}function a(n){return(r&&r.states()!==i.Cb.Rejected||s(),r.promise()).then(n).catch((function(t){if(t&&t.response&&401===t.response.statusCode)return(r&&r.states()===i.Cb.Pending||s(),r.promise()).then(n);throw t}))}"undefined"!=typeof FormsPro&&(FormsPro.sendRequestWithToken=a)},21607:function(n,t,e){"use strict";e.d(t,{Ip:function(){return m},RC:function(){return g},UM:function(){return b},Yq:function(){return v},h6:function(){return d},sE:function(){return p},v9:function(){return w}});var r=e(9947),i=e(916),o=e(41480),u=e(84475),s=e(63795),a=e(77209),c=e(64290),f=e(31442),l=e(6787),h=e(9754);function d(n){var t;return n&&(t="lang="+n),function(n,t,e){return y(n,t,e,void 0)}("GetResourceStrings",t,void 0)}function m(){return d((0,l.Kc)())}function v(n){var t;return n&&"string"==typeof n&&(t=I(n)),y("GetRefreshedAntiForgeryToken",void 0,void 0,t).then((function(n){(0,r.cm)({antiForgeryToken:n})}))}function p(){return y("GetUserInfo",void 0,void 0,void 0).then((function(n){(0,r.cm)({userInfo:n})}))}function g(n){return y("GetThemes",void 0,JSON.stringify({name:n||""}),void 0)}function b(n){return(0,c.md)((function(){return!0}))?y("GetHeaderThemes",void 0,JSON.stringify({name:n||""}),void 0):Promise.resolve("")}function w(n){return n||(0,f.RF)("InvalidToken"),S("/Handlers/PageCommonHandler.ashx?method=GetCombined",void 0,I(n),"GetCombinedInfo").then((function(n){if(n){var t={ecsConfigSettings:n.ecsConfigSettings,flights:n.flight,userInfo:n.userInfo,environmentType:n.environmentType,ring:n.ring};n.antiForgeryToken&&(t.antiForgeryToken=n.antiForgeryToken),n.ecsWebSettings&&n.userInfo.UserId&&(t.ecsWebSettings=JSON.parse(n.ecsWebSettings)),(0,r.cm)(t),n.userInfo.UserId&&(0,h.EG)(t.ecsWebSettings)}}))}function I(n){return{Accept:"application/json",Authorization:(0,a.U)(n)}}function y(n,t,e,r){var i;return i="/"===window.location.pathname?"/Default.aspx/".concat(n):"".concat(window.location.pathname,"/").concat(n),t&&(i+="?"+t),S(i,e,r,(0,s.WU)("PageMethod.{0}",n)).then((function(n){return n.d}))}function S(n,t,e,r){return new Promise((function(s,a){var f=new i.o(r),l=new XMLHttpRequest;l.open("POST",n),(0,c.md)((function(){l.setRequestHeader("formspro","enabled")})),l.setRequestHeader("content-type","application/json; charset=utf-8"),l.setRequestHeader("X-CorrelationId",f.CorrelationId),l.setRequestHeader("X-UserSessionId",(0,o.k)()||""),l.setRequestHeader("x-ms-form-request-source",(0,u.A)()),e&&Object.keys(e).forEach((function(n){l.setRequestHeader(n,e[n])})),f.start(),t?l.send(t):l.send(),l.onreadystatechange=function(){if(l.readyState===XMLHttpRequest.DONE){var t=l.status;200===t||202===t||201===t?(f.end({resultType:"Success",extraData:{status:l.statusText}}),s(l.responseText&&JSON.parse(l.responseText))):(f.end({resultType:"Failure",extraData:{url:n,message:l.statusText}}),a(l.statusText))}}}))}},24821:function(n,t,e){"use strict";e.d(t,{f:function(){return r}});var r=function(){function n(n){var t=this;this.prefetchPromise=new Promise((function(n,e){t.prefetchResolve=n,t.prefetchReject=e})),this.cache=n}return n.prototype.init=function(){if(this.cache)switch(this.cache.state){case 3:this.onPrefetchSucceed();break;case 4:this.onPrefetchFaied();break;case 2:this.cache.successCallback=this.onPrefetchSucceed.bind(this),this.cache.errorCallback=this.onPrefetchFaied.bind(this);break;default:this.fallBackToNormalBoot()}else this.fallBackToNormalBoot()},n.prototype.getPromise=function(){return this.prefetchPromise},n}()},22617:function(n,t,e){"use strict";e.d(t,{D:function(){return i}});var r=e(7645);function i(n,t){var e=null!=t?t:(0,r.pm)();switch(n){case"1001":return e.Error_Message_1001;case"10203":return e.Error_Message_10203;case"10204":return e.Error_Message_10204;case"10205":return e.Error_Message_10205;case"10206":return e.Error_Message_10206;case"10207":return e.Error_Message_10207;case"10208":return e.Error_Message_10208;case"10300":return e.Error_Message_10300;case"10301":return e.Error_Message_10301;case"1204":return e.Error_Message_1204;case"15001":return e.Error_Message_15001;case"15003":return e.Error_Message_15003;case"15429":return e.Error_Message_15429;case"1624":return e.Error_Message_1624;case"20000":return e.Error_Message_20000;case"20001":return e.Error_Message_20001;case"5001":return e.Error_Message_5001;case"5002":return e.Error_Message_5002;case"5003":return e.Error_Message_5003;case"5004":return e.Error_Message_5004;case"5005":return e.Error_Message_5005;case"5006":return e.Error_Message_5006;case"5109":return e.Error_Message_5109;case"5114":return e.Error_Message_5114;case"5117":return e.Error_Message_5117;case"5203":return e.Error_Message_5203;case"5204":return e.Error_Message_5204;case"5205":return e.Error_Message_5205;case"5206":return e.Error_Message_5206;case"5207":return e.Error_Message_5207;case"5208":return e.Error_Message_5208;case"5209":return e.Error_Message_5209;case"5302":return e.Error_Message_5302;case"532":return e.Error_Message_532;case"533":return e.Error_Message_533;case"534":return e.Error_Message_534;case"535":return e.Error_Message_535;case"536":return e.Error_Message_536;case"537":return e.Error_Message_537;case"5400":return e.Error_Message_5400;case"5401":return e.Error_Message_5401;case"5402":return e.Error_Message_5402;case"5403":return e.Error_Message_5403;case"5501":return e.Error_Message_5501;case"5503":return e.Error_Message_5503;case"5504":return e.Error_Message_5504;case"5510":return e.Error_Message_5510;case"5550":return e.Error_Message_5550;case"5551":return e.Error_Message_5551;case"5552":return e.Error_Message_5552;case"5553":return e.Error_Message_5553;case"5554":return e.Error_Message_5554;case"5556":return e.Error_Message_5556;case"5557":return e.Error_Message_5557;case"5558":return e.Error_Message_5558;case"5559":return e.Error_Message_5559;case"5560":return e.Error_Message_5560;case"5561":return e.Error_Message_5561;case"600":return e.Error_Message_600;case"601":return e.Error_Message_601;case"602":return e.Error_Message_602;case"603":return e.Error_Message_603;case"604":return e.Error_Message_604;case"605":return e.Error_Message_605;case"606":return e.Error_Message_606;case"607":return e.Error_Message_607;case"608":return e.Error_Message_608;case"609":return e.Error_Message_609;case"610":return e.Error_Message_610;case"6100":return e.Error_Message_6100;case"6102":return e.Error_Message_6102;case"6103":return e.Error_Message_6103;case"6105":return e.Error_Message_6105;case"611":return e.Error_Message_611;case"613":return e.Error_Message_613;case"614":return e.Error_Message_614;case"615":return e.Error_Message_615;case"620":return e.Error_Message_620;case"622":return e.Error_Message_622;case"624":return e.Error_Message_624;case"625":return e.Error_Message_625;case"6252":return e.Error_Message_6252;case"6254":return e.Error_Message_6254;case"636":return e.Error_Message_636;case"642":return e.Error_Message_642;case"645":return e.Error_Message_645;case"649":return e.Error_Message_649;case"650":return e.Error_Message_650;case"651":return e.Error_Message_651;case"652":return e.Error_Message_652;case"653":return e.Error_Message_653;case"654":return e.Error_Message_654;case"655":return e.Error_Message_655;case"656":return e.Error_Message_656;case"657":return e.Error_Message_657;case"658":return e.Error_Message_658;case"659":return e.Error_Message_659;case"660":return e.Error_Message_660;case"6611":return e.Error_Message_6611;case"6612":return e.Error_Message_6612;case"6613":return e.Error_Message_6613;case"6614":return e.Error_Message_6614;case"6624":return e.Error_Message_6624;case"6634":return e.Error_Message_6634;case"6700":return e.Error_Message_6700;case"6701":return e.Error_Message_6701;case"6702":return e.Error_Message_6702;case"6705":return e.Error_Message_6705;case"674":return e.Error_Message_674;case"676":return e.Error_Message_676;case"700":return e.Error_Message_700;case"701":return e.Error_Message_701;case"702":return e.Error_Message_702;case"703":return e.Error_Message_703;case"704":return e.Error_Message_704;case"705":return e.Error_Message_705;case"707":return e.Error_Message_707;case"709":return e.Error_Message_709;case"710":return e.Error_Message_710;case"711":return e.Error_Message_711;case"712":return e.Error_Message_712;case"714":return e.Error_Message_714;case"715":return e.Error_Message_715;case"717":return e.Error_Message_717;case"720":return e.Error_Message_720;case"751":return e.Error_Message_751;case"752":return e.Error_Message_752;case"754":return e.Error_Message_754;case"755":return e.Error_Message_755;case"756":return e.Error_Message_756;case"812":return e.Error_Message_812;case"824":return e.Error_Message_824;default:return""}}},7645:function(n,t,e){"use strict";e.d(t,{D1:function(){return p},ay:function(){return v},pm:function(){return d}});var r,i,o,u=e(66676),s=e(43209),a=e(72377),c=e(35337),f=e(6787),l=e(21607),h={};function d(){return o}function m(n){o=(0,c.Y)(n)}function v(){return r||(r=new Promise((function(n,t){o?n(o):i?i.then((function(t){i=null,m(t),n(t)})):b().then((function(t){m(t),n(t)})).catch(t)}))),r}function p(n){var t=h[n];return t||(h[n]=new Promise((function(t,e){b(n).catch((function(){return(0,l.h6)(n)})).then((function(n){t((0,c.Y)(n))}))})),t=h[n]),t}function g(n){return(n?(0,l.h6)(n):(0,l.Ip)()).then(c.Y)}function b(n){return(0,s.aK)()||(0,f.y)()?g(n):Promise.resolve().then((function(){n=n||(0,u.K)().toLowerCase();var t=a.Pv.Resolve("ILazyLoadResourceStringsFunc");return t(n).catch((function(){var e=null==n?void 0:n.split("-")[0];return n!==e?t(e).catch((function(){return t(void 0)})):t(void 0)}))})).catch((function(){return g(n)}))}},8435:function(n,t,e){"use strict";e.d(t,{eg:function(){return c},qI:function(){return s}});var r=e(16586),i=e(4851),o=e(90710);function u(){return window.shellInfo}function s(){var n,t=window.navigator;return window.URL&&"serviceWorker"in t&&a()&&"function"==typeof(null===(n=t.serviceWorker)||void 0===n?void 0:n.register)}var a=(0,i.Rm)((function(){var n=!0;try{window.eval((0,r.Z9)("async () => {}"))()}catch(t){n=!1}return n}));function c(){var n=(0,o.NW)().fsw,t=u();return!("0"===n||!t)&&t.swEnabled}},83830:function(n,t,e){"use strict";e.d(t,{v:function(){return c}});var r=e(60211),i=e(64290),o=e(6787),u=e(70699),s="https://forms.microsoft.com/",a="https://forms.office.com/";function c(){var n;switch((0,r.kD)()){case"USNat":n="https://forms.osi.eaglex.ic.gov/";break;case"USSec":n="https://forms.osi.microsoft.scloud/";break;case"USDoDProd":n="https://forms.osi.apps.mil/";break;case"USGovProd":n="https://forms.osi.office365.us/";break;case"USGovGccProd":n=(0,r.H5)()?s:(0,o.Pq)()?"https://customervoice.microsoft.us/":a;break;case"WWProd":n=(0,i.pd)((function(){return a}),(function(){var n=(0,u.Bh)();return"/"!==n[n.length-1]&&(n+="/"),n}));break;case"MSProd":n=s;break;case"ProTip":n="https://tip.forms.office.com/";break;case"CVProd":n="https://customervoice.microsoft.com/";break;case"CVTip":n="https://tip.customervoice.microsoft.com/";break;case"CVFastfood":n="https://msit2.customervoice.microsoft.com/";break;default:n="https://"+window.location.host+"/"}return n}},43367:function(n,t,e){"use strict";e.r(t),e.d(t,{addIoCHeaderFontToSchemas:function(){return u},addIoCSurveyFontToSchemas:function(){return o},areIoCImageUploadButtonsEnabled:function(){return m},callIoCDeletePausedResponse:function(){return F},callIoCGetPausedResponse:function(){return y},callIoCSetLocaleItem:function(){return S},callIoCUpdatePR:function(){return I},callIoCUpdatePRForText:function(){return C},createChoiceQuestionRenderer:function(){return D},cvOnlyLanguageUtilityIoC:function(){return M},getIoCCreateCascadeQuestionRenderer:function(){return E},getIoCCreateFileUploadQuestionRenderer:function(){return N},getIoCCreateHeaderThemeRenderer:function(){return k},getIoCCustomLanguageFriendlyName:function(){return O},getIoCDefaultTheme:function(){return f},getIoCErrorPage:function(){return w},getIoCFlexPaneWidth:function(){return b},getIoCFooterElement:function(){return a},getIoCImagePickerLocalContainerClassName:function(){return g},getIoCLazyLoadThemes:function(){return c},getIoCMMediaPickerPaneText:function(){return d},getIoCMediaPickerPaneInfoContent:function(){return p},getIoCMediaPickerPaneTitle:function(){return v},getIoCModifiedTextField:function(){return s},getIoCPreviewSettingsPane:function(){return i},getIoCQuestionDelegatorClass:function(){return R},getIoCQuestionRendererFooter:function(){return x},getIoCThemeBackground:function(){return l},getIoCThemeStyle:function(){return h},getIocConditionalThankyouControl:function(){return _},getIocMessageContent:function(){return P},getIocThankYouMessageKey:function(){return T},handleSubmitButtonClickIoC:function(){return L}});var r=e(72377);function i(n){return q().createPreviewSettingPane(n)}function o(n){return q().addSurveyFontToSchemas(n)}function u(n){return q().addHeaderFontToSchemas(n)}function s(n,t){return q().getModifiedTextField(n,t)}function a(n){return q().getFooterElement(n)}function c(){return q().getLazyLoadThemes()}function f(){return q().getDefaultTheme()}function l(n){return q().getThemeBackground(n)}function h(n){return q().getThemeStyle(n)}function d(){return q().getMediaPickerPaneText()}function m(){return q().areImageUploadButtonsEnabled()}function v(){return q().getMediaPickerPaneTitle()}function p(){return q().getMediaPickerPaneInfoContent()}function g(){return q().getImagePickerLocalContainerClassName()}function b(){return q().getFlexPaneWidth()}function w(){return q().getErrorPage()}function I(n,t,e,r,i,o){return q().callUpdatePR(n,t,e,r,i,o)}function y(n,t){return q().callGetPausedResponse(n,t)}function S(n,t,e,r){return q().callSetLocaleItem(n,t,e,r)}function F(n,t){return q().callDeletePausedResponse(n,t)}function C(n,t,e,r,i){return q().callUpdatePRForTextQuestion(n,t,e,r,i)}function _(n){return q().getConditionalThankyouControl(n)}function T(n,t,e){return q().derivedThankYouMessageKey(n,t,e)}function P(n){return q().getMessageContent(n)}function N(n){return q().createFileUploadQuestionRenderer(n)}function k(n){return q().createHeaderThemeRenderer(n)}function E(n){return q().createCascadeQuestionRenderer(n)}function R(n){return q().getQuestionDelegatorClass(n)}function O(n){return q().getCustomLanguageFriendlyName(n)}function D(n){return q().createChoiceQuestionRenderer(n)}function x(n){return q().getQuestionRendererFooter(n)}function L(n,t){return q().handleSubmitButtonClick(n,t)}function M(){return q().cvOnlyLanguageUtility()}function q(){return r.Pv.Resolve("ICustomerVoiceUxFactory")}},19194:function(n,t,e){"use strict";e.d(t,{e:function(){return l}});var r=e(22617),i=e(60211),o=e(13877),u="officeforms.uselegacylogindomain";function s(n){return(0,o.$o)().getItem(n)}function a(){var n=!!s(u);return(0,i.yv)()?n?"https://login.windows.net/":"https://login.microsoftonline.com/":"https://login.windows-ppe.net/"}var c=e(63795);var f=e(7645);function l(n){return function(n,t){var e="";if(n)if(n instanceof Error&&!n.hasOwnProperty("correlationId"))switch(n.name){case"LoginIECrossZoneError":e=(0,c.WU)(t.Error_Message_Client_LoginIECrossZoneError,window.location.origin,a());break;case"ThirdPartyCookieBlockedError":e=(0,c.WU)(t.Error_Message_Client_ThirdPartyCookieError,a());break;case"AuthNoStorageError":e=t.Error_Message_Client_AuthNoStorageError;break;case"AADAcquireTokenMfaCheckError":e=t.Error_Message_705;break;case"TeamSiteNoGroupError":e=t.Error_Message_Client_TeamSiteNoGroupError}else{var i=n;i.innerCode&&(e=(0,r.D)(String(i.innerCode),t)||(0,c.WU)(t.Error_Message_Default,i.innerCode))}return e}(n,(0,f.pm)())}},20987:function(n,t,e){"use strict";e.d(t,{Es:function(){return s},Au:function(){return u},dY:function(){return a},LG:function(){return c},ft:function(){return f},_o:function(){return l},Av:function(){return h}});var r=e(60211),i=e(90710);function o(n,t){void 0===t&&(t=!1);var e=(0,i.NW)()[n];return""===e||(e?(Array.isArray(e)&&(e=e[0]),t?"false"!==e.toLowerCase():"true"===e.toLowerCase()):t)}function u(){return o("debug")}function s(){return o("d")}function a(){return o("oembedssotrial")&&(0,r.yv)()||o("oembedsso")||o("powerappembed")}function c(){return!!o("pptcontentsso")}function f(){return o("pptintegration")}function l(){return o("runtimeautorefresh")}function h(){return o("streamsso")}},37076:function(n,t,e){"use strict";e.d(t,{kc:function(){return o}});var r=16,i="$%@#";function o(n){var t=function(n){try{n=n.replace(/_/g,"/").replace(/-/g,"+");var t=atob(n.replace(/ /g,"")).split("").map((function(n){return n.charCodeAt(0)})),e=u(t.slice(0,r)),o=u(t.slice(r,32)),s=function(n,t){if(null==n||0===n.length)return n;var e=n.length;for(;--e>=0&&!(t.indexOf(n.charAt(e))<0););return n.substr(0,e+1)}(function(n){for(var t="",e=0;e<n.length;++e)t+=String.fromCharCode(n[e]);return t}(t.slice(32)),"."),a={},c=s.split(i);if(c.length>1){s=c[0];for(var f=1;f<c.length;f++){var l=c[f].split("=");l&&2===l.length&&(a[l[0]]=l[1])}}return{OrgId:e,OwnerId:o,TableId:s,MoreInfo:a}}catch(n){return{OrgId:null,OwnerId:null,TableId:null,MoreInfo:null}}}(n),e=!1,o="0";return t.MoreInfo&&("g"===t.MoreInfo.t&&(e=!0),t.MoreInfo.c&&(o=t.MoreInfo.c)),{OrgId:t.OrgId,OwnerId:t.OwnerId,TableId:t.TableId,IsGroupOwner:e,ContainerId:o}}function u(n){if(16!==n.length)return null;var t=function(n){for(var t="",e="",r=0;r<n.length;r++)t+=e=1===(e=n[r].toString(16)).length?"0"+e:e;return t}([].concat(n.slice(0,4).reverse(),n.slice(4,6).reverse(),n.slice(6,8).reverse(),n.slice(8)));return t=t.slice(0,8)+"-"+t.slice(8,12)+"-"+t.slice(12,16)+"-"+t.slice(16,20)+"-"+t.slice(20)}},11040:function(n,t,e){"use strict";e.d(t,{df:function(){return f},Tq:function(){return c},e1:function(){return l},pw:function(){return s}});var r=e(24497),i=e(7645);function o(n){var t=function(n){if(!n)return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(n),e=4;if(!t||t.length<e)return null;return{header:t[1],JWSPayload:t[2],JWSSig:t[3]}}(n);if(!t)return null;try{var e=function(n){return n=n.replace(/-/g,"+").replace(/_/g,"/"),decodeURIComponent(encodeURI(window.atob(n)))}(t.JWSPayload);return e?JSON.parse(e):null}catch(n){}return null}var u=e(48186);function s(n){return o(function(n){return n&&n.split(" ")[1]}(n)).exp<=Date.now()/1e3}function a(n,t){return n=(0,r.gA)(n),t?n?$("<div/>").html(n).text():"":n}function c(n){if((0,u.l)(n)||""===n.trim())return n;var t=n.replace(/&&/g,"__BR_AND_PAR__").replace(/\|\|/g,"__BR_OR_PAR__");return t=t.replace(/\(/g,"__BR_L_PAR__").replace(/\)/g,"__BR_R_PAR__")}function f(n){if((0,u.l)(n)||""===n.trim())return n;var t=n.replace(/__BR_L_PAR__/g,"(").replace(/__BR_R_PAR__/g,")");return t=t.replace(/__BR_AND_PAR__/g,"&&").replace(/__BR_OR_PAR__/g,"||")}function l(n){return n&&n.split("href")[0].indexOf('target="_blank"')>-1&&(n=n.replace('target="_blank"',' target="_blank" tabindex="0" aria-label="'.concat(function(n){if(n){var t=a(n,!0);return(t.indexOf("http")>-1?(0,i.pm)().Response_Page_Footer_Open_In_New_Tab_Text.format(t):(0,i.pm)().Response_Page_Footer_Open_In_New_Tab_Text_Terms_Privacy.format(t)).replace(/("|')/g,"")}return null}(n),'"'))),n}FormsPro.getTextFromHtml=a,FormsPro.encodeBranchingString=c,FormsPro.decodeBranchingString=f},24209:function(n,t,e){"use strict";e.d(t,{K:function(){return i}});var r=e(94290);function i(n,t,e,i){return function(n,t,e,r,i){if(i){var o=document.createElement("a");return o.href=n,o.target=t||"_blank",document.body.appendChild(o),o.click(),document.body.removeChild(o),null}return t||e||r?e||r?r?window.open(n,t,e,r):window.open(n,t,e):window.open(n,t):window.open(n)}(n,t,e,i,(0,r.Kw)())}},28087:function(n,t,e){"use strict";e.d(t,{Lp:function(){return o},WN:function(){return i}});var r=function(n){var t=document.createElement("a");return t.href=n,t};function i(n){return r(n).href}function o(n){return r(n).hostname}},54496:function(n,t,e){"use strict";e.d(t,{IB:function(){return c},Nw:function(){return f},bq:function(){return l},n1:function(){return s},p2:function(){return a}});var r=e(262),i=e(92575),o=e(88744),u=e(2775);function s(n,t,e,r,i){r=r||0,e=e||0;var o=t.height(),u=n.outerHeight();if(n.offset()&&t.offset()){var s=n.offset().top-t.offset().top;if(s<0)t.scrollTop(t.scrollTop()+s-(u+e>o?0:e));else{var a=Math.min(u,o),c=s+a-o;u+e+r<o?c=s+(a=u+r)-o:u+e<o&&(a=u+e,c=s-e),c>0&&(i?t.animate({scrollTop:t.scrollTop()+c},"fast"):t.scrollTop(t.scrollTop()+c))}}}function a(n,t){var e=(0,u.l7)({},n);for(var i in t)switch(i){case"className":case"aria-labelledby":case"aria-describedby":e[i]=(0,r.j)(e[i],t[i]);break;case"children":case"defaultValue":case"value":t.hasOwnProperty(i)&&(null!=e[i]?e[i]=[].concat(e[i],t[i]):e[i]=t[i]);break;case"style":null!=e[i]?(0,u.l7)(e[i],t[i]):e[i]=t[i];break;case"onCopy":case"onCut":case"onPaste":case"onCompositionEnd":case"onCompositionStart":case"onCompositionUpdate":case"onFocus":case"onBlur":case"onChange":case"onInput":case"onSubmit":case"onLoad":case"onError":case"onKeyDown":case"onKeyPress":case"onKeyUp":case"onAbort":case"onCanPlay":case"onCanPlayThrough":case"onDurationChange":case"onEmptied":case"onEncrypted":case"onEnded":case"onLoadedData":case"onLoadedMetadata":case"onLoadStart":case"onPause":case"onPlay":case"onPlaying":case"onProgress":case"onRateChange":case"onSeeked":case"onSeeking":case"onStalled":case"onSuspend":case"onTimeUpdate":case"onVolumeChange":case"onWaiting":case"onClick":case"onContextMenu":case"onDoubleClick":case"onDrag":case"onDragEnd":case"onDragEnter":case"onDragExit":case"onDragLeave":case"onDragOver":case"onDragStart":case"onDrop":case"onMouseDown":case"onMouseEnter":case"onMouseLeave":case"onMouseMove":case"onMouseOut":case"onMouseOver":case"onMouseUp":case"onSelect":case"onTouchCancel":case"onTouchEnd":case"onTouchMove":case"onTouchStart":case"onScroll":case"onWheel":e[i]=(0,o.F)(e[i],t[i]);break;default:void 0!==t[i]&&(e[i]=t[i])}return e}function c(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return function(e){(0===t.length||t.indexOf(e.keyCode)>=0)&&n(e)}}function f(n){var t=function(n){var t=["b"],e=t.map((function(n){return"<".concat(n,">")})),r=t.map((function(n){return"</".concat(n,">")})),i=t.map((function(n){return"&lt;".concat(n,"&gt;")})),o=t.map((function(n){return"&lt;/".concat(n,"&gt;")})),s=(0,u.YU)(n);return t.forEach((function(n,t){s=s.replaceAll(i[t],e[t]).replaceAll(o[t],r[t])})),s}(n);return l(t)}function l(n){var t=document.createElement("span");return(0,i.p)(t,n),t.innerHTML}},47393:function(n,t,e){"use strict";e.d(t,{iv:function(){return l},Gh:function(){return m},gB:function(){return c},sl:function(){return f},mj:function(){return d}});var r=e(83894),i=e(43209),o=e(9947),u=e(87260),s=e(81620);function a(n,t,e,r){return t?r:function(n,t){var e=encodeURIComponent(n);if(-1!==t.indexOf("/oidcLogin"))return(0,s.y)(t,"ru",e);return(0,s.y)(t,"state",e)}(n,e)}function c(n){return v().then((function(){window.location.assign(n)}))}function f(){return h(!1)}function l(){return h(!0)}function h(n){return v().then((function(){window.location.reload(n)}))}function d(n){return v().then((function(){window.location.replace(n)}))}function m(){var n=(0,o.k0)(),t=n.userInfo,e=(n.serverSessionId,n.signInLink),u=n.signInLinkMsa,s=window.location.href,c=t.IsMsa||(0,r.ro)(),f=["ResponseDetailPage","Response"].indexOf((0,i.C2)())>-1;return a(s,c&&!f,e,u)}function v(){return(0,u.I)()}},72467:function(n,t,e){"use strict";e.d(t,{AJ:function(){return h},AX:function(){return s},BF:function(){return c},Cu:function(){return o},Ed:function(){return i},f5:function(){return f},mp:function(){return a},uq:function(){return l},zE:function(){return u}});var r=e(72377);function i(){return r.Pv.Resolve("IMixin").getMixinFormMaster()}function o(){return r.Pv.Resolve("IMixin").getMixinImageInfoMaster()}function u(){return r.Pv.Resolve("IMixin").getMixinQuestionMaster()}function s(){return r.Pv.Resolve("IFormApiMixin").getMixinFormApi()}function a(){return r.Pv.Resolve("IMixin").getMixinFormElementManager()}function c(){return r.Pv.Resolve("IMixin").getMixinImageSettingsMaster()}function f(){return r.Pv.Resolve("IMixin").getMixinDesignPageUxStateMaster().getInstance()}function l(){return r.Pv.Resolve("IMixin").getMobileDesignPageUxStateMaster().getInstance()}function h(){return r.Pv.Resolve("IMixin").getFileUploadConfirmDialog()}},13886:function(n,t,e){"use strict";function r(n){var t=(n||"").trim().replace(/[,]/g,"");return $.isNumeric(t)}function i(n){var t=(n||"").trim().replace(/[,]/g,"");return $.isNumeric(t)?parseFloat(t).toString():""}function o(n){return Math.floor(n)===n}e.d(t,{Q5:function(){return i},U:function(){return o},ZR:function(){return r}})},77494:function(n,t,e){"use strict";e.d(t,{C_:function(){return s},b6:function(){return a},h_:function(){return d},o0:function(){return h}});var r=e(64290),i=e(9947),o=e(81620),u=e(90710);function s(){if((0,i.k0)().isOembedSPO||(0,u.NW)().oembedocv){var n,t=(0,r.pd)((function(){return(0,o.Uy)(".office-form.office-form-theme-shadow")}),(function(){return(0,o.Uy)(".office-form-theme-shadow")||(0,o.Uy)(".office-form-title-container")+((0,o.Uy)(".office-form-body")||(0,o.Uy)(".office-form.thank-you-page-content"))})),e=(0,o.Uy)(".office-form-footer-container");if((0,u.NW)().oembedocv)(n=(t||0)+(e||0)+12)>0&&c("ResponsePage",n);else if(t&&e)c("ResponsePage",n=t+e+80+(0,o.Uy)(".office-form-new-bottom-bar"))}}function a(n){(0,i.k0)().isOembedSPO&&c("ResponsePage",n)}function c(n,t){var e=(0,u.NW)().hostId;if(e)parent.postMessage("FormsPageHeight:".concat(e,":").concat(t.toString()),"*");else{var r=(0,u.NW)().id;parent.postMessage("".concat(n,"Height:").concat(r,":").concat(t.toString()),"*")}}function f(n){if((0,i.k0)().isOembedSPO){var t=n&&(n.innerCode||n.message||""),e=(0,u.NW)().hostId;parent.postMessage("FormsError:".concat(e,":").concat(encodeURIComponent(t)),"*")}}var l=window.onerror;function h(n,t){(0,i.k0)().isOembedSPO&&(n&&t&&function(n){if(n){var t=(0,o.Uy)(".form-content"),e=n+200;e>t&&(e=t),a(e)}}((0,o.Uy)(n)+(0,o.Uy)(t)))}function d(){c("ResponsePage",(0,o.Uy)(".thank-you-page-root-container")+12)}window.onerror=function(n,t,e,r,i){f(i),l&&l.apply(this,arguments)}},70699:function(n,t,e){"use strict";e.d(t,{Bh:function(){return o},FW:function(){return p},J8:function(){return v},KG:function(){return I},NA:function(){return S},QZ:function(){return a},R0:function(){return d},_G:function(){return w},aE:function(){return h},bL:function(){return b},cj:function(){return u},d9:function(){return l},ib:function(){return m},nL:function(){return g},qb:function(){return y},ru:function(){return f},sy:function(){return i},yX:function(){return s},zN:function(){return c}});var r=e(39455);function i(){return r.Z.getSetting(r.G.FormsProGeo)}function o(){return r.Z.getSetting(r.G.FormsHomeUrl)}function u(){return r.Z.getSetting(r.G.ApiFacadeEndPoint)}function s(){return r.Z.getSetting(r.G.ProjectUIServiceEndpoint)}function a(){return r.Z.getSetting(r.G.ProjectAlertServiceEndPoint)}function c(){return r.Z.getSetting(r.G.CustomerVoiceProjectShareServiceEndpoint)}function f(){return r.Z.getSetting(r.G.CustomerVoiceSurveyUIServiceEndpoint)}function l(){return r.Z.getSetting(r.G.FormsProSampleFormTenantId)}function h(){return r.Z.getSetting(r.G.FormsProCdnHomeUrl)}function d(){return r.Z.getSetting(r.G.FormsProLicensingServiceEndPoint)}function m(){return r.Z.getSetting(r.G.OrchestrationServiceEndpoint)}function v(){return r.Z.getSetting(r.G.SatisfactionMetricTrendAndAggregateDataUrl)}function p(){return r.Z.getSetting(r.G.ExportCsvServiceEndpoint)}function g(){return r.Z.getSetting(r.G.CVPauseResumeService)}function b(){return r.Z.getSetting(r.G.ShareV2StatusFetchDuration)}function w(){return r.Z.getSetting(r.G.CVSurveyCountApproachingLimitFirstStage)}function I(){return r.Z.getSetting(r.G.CVSurveyCountApproachingLimitSecondStage)}function y(){return r.Z.getSetting(r.G.CVSurveyCountExceedLimit)}function S(){return r.Z.getSetting(r.G.CVGetFormLimit)}},41350:function(n,t,e){"use strict";e.d(t,{Y:function(){return o},u:function(){return i}});var r=e(12611),i=function(){function n(n,t){void 0===t&&(t=0),this.St=n,this.Ft=t}return n.prototype.callOnceLater=function(){var n=this;0!==this.Ft&&null!=this.Ct&&this.clear(),null==this.Ct&&(this.Ct=window.setTimeout((function(){n.callImmediately()}),this.Ft))},n.prototype.flush=function(){null!=this.Ct&&(this.clear(),this.St())},n.prototype.callImmediately=function(){null!=this.Ct&&this.clear(),this.St()},n.prototype.clear=function(){clearTimeout(this.Ct),this.Ct=void 0},n}(),o=function(){function n(){this._t=[]}return n.prototype.register=function(n){this._t.push(n)},n.prototype.unregister=function(n){this._t=r.without(this._t,n)},Object.defineProperty(n.prototype,"trigger",{get:function(){return this.Tt},enumerable:!1,configurable:!0}),n.prototype.clear=function(){this._t=[]},n.prototype.Tt=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];this._t.forEach((function(t){return t.apply(void 0,n)}))},n}()},76669:function(n,t,e){"use strict";e.d(t,{Km:function(){return _},l4:function(){return y},v3:function(){return S}});var r,i=e(94290),o=e(29559),u=e(916),s=e(31442),a=e(7614),c=e(59312),f=function(){function n(t){if(this.secureUUID=t,n.initialize(),!this.secureUUID||0===this.secureUUID.trim().length)throw Error("The union secure uuid is null or empty.")}return n.prototype.initializeNativeEventCallback=function(n){window.officeMobileHandleNativeEvent=n},n.initialize=function(){window.officeMobileHandleNativeMessage||(window.officeMobileHandleNativeMessage=function(n){if(!n)return"responseObject is Empty";if(!n.callbackId)return"CallbackId and message are Empty";var t=window.mOfficeMobileNativeCallbackMap.get(n.callbackId);return t?(window.mOfficeMobileNativeCallbackMap.delete(n.callbackId),t(n.args)):"Unable to find callback"}),window.mOfficeMobileNativeCallbackMap||(window.mOfficeMobileNativeCallbackMap=new Map)},n.prototype.updateAndGetAuthTokenCallback=function(t,e){var r=this;n.initialize();var i="".concat(Date.now().toString(),"-").concat(n.callbackIndex++);return window.mOfficeMobileNativeCallbackMap.set(i,(function(n){var i=null;return n?n.UUID!==r.secureUUID&&(i="uuid is not same with the expected secure uuid"):i="Args is empty",null!==i?e(i):n.isSuccess?t(n.response):e(n.response),i})),i},n.callbackIndex=1e3,n}(),l=function(n){function t(t){return n.call(this,t)||this}return(0,c.ZT)(t,n),t.prototype.getServerAuthToken=function(){var t=this;return new Promise((function(e,r){if(void 0!==window.OMWebViewJSInterface&&void 0!==window.OMWebViewJSInterface.getServerAuthToken){var i=n.prototype.updateAndGetAuthTokenCallback.call(t,e,r);window.OMWebViewJSInterface.getServerAuthToken(t.secureUUID,i)}else r("App Interface not found")}))},t}(f),h=function(n){function t(t){return n.call(this,t)||this}return(0,c.ZT)(t,n),t.prototype.getServerAuthToken=function(){var t=this;return new Promise((function(e,r){var i,o;if(void 0!==window.webkit&&void 0!==window.webkit.messageHandlers.AuthToken){var u=n.prototype.updateAndGetAuthTokenCallback.call(t,e,r);null===(o=null===(i=window.webkit.messageHandlers)||void 0===i?void 0:i.AuthToken)||void 0===o||o.postMessage({UUID:t.secureUUID,callbackId:u})}else r("App Interface not found")}))},t}(f);function d(){return window.webkit&&window.webkit.messageHandlers.PageLoadCompleted?r.IOS:window.OMWebViewJSInterface&&window.OMWebViewJSInterface.onPageLoadCompleted?r.Android:r.Unknown}!function(n){n[n.Android=0]="Android",n[n.IOS=1]="IOS",n[n.Unknown=2]="Unknown"}(r||(r={}));var m,v=function(){function n(){}return n.prototype.resolvePlatformAndgetInterface=function(n,t){var e=d();return this.getInterface(n,t,e)},n.prototype.getInterface=function(n,t,e){if("v1_0_0"===t)switch(+e){case r.Android:return new l(n);case r.IOS:return new h(n);default:return null}return null},n}(),p=function(){return function(n){if(this.secureUUID=n,!this.secureUUID||0===this.secureUUID.trim().length)throw Error("The union secure uuid is null or empty.")}}(),g=function(n){function t(t){return n.call(this,t)||this}return(0,c.ZT)(t,n),t.prototype.sendLinkViaApp=function(n,t){void 0!==window.OMWebViewJSInterface&&void 0!==window.OMWebViewJSInterface.sendLinkViaApp&&window.OMWebViewJSInterface.sendLinkViaApp(this.secureUUID,n,t)},t.prototype.exitWebView=function(){void 0!==window.OMWebViewJSInterface&&void 0!==window.OMWebViewJSInterface.exitWebView&&window.OMWebViewJSInterface.exitWebView(this.secureUUID)},t.prototype.onPageLoadCompleted=function(){void 0!==window.OMWebViewJSInterface&&void 0!==window.OMWebViewJSInterface.onPageLoadCompleted&&window.OMWebViewJSInterface.onPageLoadCompleted(this.secureUUID)},t}(p),b=function(n){function t(t){return n.call(this,t)||this}return(0,c.ZT)(t,n),t.prototype.sendLinkViaApp=function(n,t){var e,r;void 0!==window.webkit&&(null===(r=null===(e=window.webkit.messageHandlers)||void 0===e?void 0:e.SendLinkViaApp)||void 0===r||r.postMessage({UUID:this.secureUUID,link:n,app:t}))},t.prototype.exitWebView=function(){var n,t;void 0!==window.webkit&&(null===(t=null===(n=window.webkit.messageHandlers)||void 0===n?void 0:n.ExitWebView)||void 0===t||t.postMessage({UUID:this.secureUUID}))},t.prototype.onPageLoadCompleted=function(){var n,t;void 0!==window.webkit&&(null===(t=null===(n=window.webkit.messageHandlers)||void 0===n?void 0:n.PageLoadCompleted)||void 0===t||t.postMessage({UUID:this.secureUUID}))},t}(p),w=function(){function n(){}return n.prototype.resolvePlatformAndgetInterface=function(n,t){var e=d();return this.getInterface(n,t,e)},n.prototype.getInterface=function(n,t,e){if("v1_0_0"===t)switch(+e){case r.Android:return new g(n);case r.IOS:return new b(n);default:return null}return null},n}(),I=e(90710);function y(n){return void 0===n&&(n=!1),new Promise((function(t,e){var i,o=function(){var n=F(),t=C(),e=null;e=n===r.Unknown?(new v).resolvePlatformAndgetInterface(window.UnionUuid,t):(new v).getInterface(window.UnionUuid,t,n);e||(0,s.zU)("createGetTokenInterface",{errorInfo:T()});return e}(),c=new u.o("Union.GetToken");if(c.start(),!o)return P(c,i="the nativeInterface is null"),void e(i);o.getServerAuthToken().then((function(r){if(r){if(c.end({resultType:"Success"}),n)return void t(r);(0,a.r)(r).then((function(){return t(r)}))}else P(c,i="the token is null or empty"),e(i)}),(function(n){c.end({resultType:"ExpectedFailure"}),e({innerCode:10302,innerMessage:n,type:"ExpectedFailure"})}))}))}function S(){return new Promise((function(n,t){try{n(_().onPageLoadCompleted())}catch(n){(0,s.zU)("Union.onPageLoadCompletedFailed",{errorInfo:n.message}),t(n)}}))}function F(){var n=(0,I.NW)()[i.hj],t=r.Unknown;if(n)switch(n){case"Android":t=r.Android;break;case"IOS":t=r.IOS}else t=d();return t===r.Unknown&&(t=(0,o.Dt)()?r.Android:(0,o.gn)()?r.IOS:r.Unknown),t}function C(){var n=(0,I.NW)()[i._y];return n||"v1_0_0"}function _(){var n=F(),t=C(),e=null;return(e=n===r.Unknown?(new w).resolvePlatformAndgetInterface(window.UnionUuid,t):(new w).getInterface(window.UnionUuid,t,n))||(0,s.zU)("createNativeInterface",{errorInfo:T()}),e}function T(){var n=F(),t=C(),e=(0,I.NW)(),r=window.location.hash?(0,I.NW)(window.location.hash):null;return"platform:".concat(n,";version:").concat(t,";platformInUrl:").concat(null==e?void 0:e[i.hj],";")+"versionInUrl:".concat(null==e?void 0:e[i._y],";id:").concat(null==e?void 0:e[i.Wy],";")+"action:".concat(null==r?void 0:r["#Action"],";formId:").concat(null==r?void 0:r["#FormId"])}function P(n,t){n.end({resultType:"Failure",extraData:{error:t}})}!function(n){n[n.Mail=0]="Mail",n[n.Teams=1]="Teams"}(m||(m={}))},1014:function(n,t,e){"use strict";e.d(t,{Qn:function(){return s}});var r=e(84358),i=e(94978),o=e(90710),u=e(46008);function s(n,t){return(0,u.Fp)()?(0,r.yk)(n)?a(n):(0,r.M4)(n)?function(n,t){if(-1===n.indexOf("sharepoint")){var e=n.indexOf("/video"),r=n.substring(n.indexOf("?")+1),u=(0,o.NW)(r),s=u.st?"st=".concat(u.st,"&amp;"):"",a=n.indexOf("?")>-1?n.slice(e,n.indexOf("?")):n.slice(e);return c="".concat(n.slice(0,e),"/embed").concat(a,"?").concat(s,"autoplay=false&amp;showinfo=true&amp;app=forms")}var c=null;if(-1===n.indexOf("layouts")&&n.indexOf("AllItems.aspx")>=0){var f=/teams\/[^\/]+\/(.+.aspx)/,l=(0,i.Gw)("VideoOfficeStreamUrl");l&&(f=new RegExp(l,"i"));var h=n.match(f);if(h&&2===h.length){var d=h[1];c="".concat(n.replace(d,"_layouts/15/embed.aspx"),"&correlationId=").concat(t,"&client_id=Forms")}}else{var m=function(n,t){return"/".concat(t,"/embed.aspx")};c="".concat(n.replace(/\/(_layouts\/15)\/([^\s]*).aspx/,m),"&correlationId=").concat(t,"&client_id=Forms")}return c}(n,t):void 0:a(n)}function a(n){var t=document.createElement("a");t.href=n;var e=t.pathname.split("/"),r=n.substring(n.indexOf("?")+1),i=(0,o.NW)(r),u=i.v||e[0]||e[1],s=i.t?"&start=".concat(i.t):"";return"https://www.youtube.com/embed/".concat(u,"?modestbranding=1&rel=0").concat(s)}},46008:function(n,t,e){"use strict";e.d(t,{$T:function(){return b},Fp:function(){return v},I8:function(){return g},LU:function(){return w},Nb:function(){return I},X9:function(){return f},f5:function(){return h},hu:function(){return c},m$:function(){return d},rA:function(){return p},wM:function(){return l},xO:function(){return m}});var r=e(60211),i=e(94290),o=e(43209),u=e(83894),s=e(2775),a=e(90710);function c(n,t){if(!n&&!(0,r.yv)()&&!(0,r.Gd)()){var e=(new Error).stack;console.assert(n,t,e)}}function f(){return(0,s.CE)((0,a.NW)(),"embed","oembedsso","themecolor","preview")}function l(){return!!(0,a.NW)().embed}function h(){var n=(0,a.NW)().compact;return n&&"true"===n.toLowerCase()}function d(){return!!(0,a.NW)().oembedsso&&!!(0,a.NW)().preview}function m(){return!(!(0,i.GF)()&&!function(){if((0,i.Kw)()&&(0,r.yv)()&&"Analyze"!==(0,o.C2)())return!0;return!1}()&&"Fluid"!==(0,o.C2)())}function v(){return!(0,u.ro)()&&!(0,r.x8)()}function p(n){return void 0===n&&(n=768),$(window).width()<=n}function g(n){var t=(0,s.d9)(n);return(0,s.S6)(t,(function(n,e){(0,s.Kn)(n)&&(t[e]=g(n))})),t}function b(n){return(0,s.XP)(n).filter($.isNumeric).map((function(t){return n[t]}))}function w(){var n=null,t=window.location!==window.parent.location?document.referrer:document.location.href;return t&&(n=new URL(t).origin),n}function I(n){var t=new RegExp("\\s+","gi");return n=n.replace(t,"")}},70877:function(n,t,e){"use strict";e.d(t,{B9:function(){return o}});e(12611);var r=e(84358),i=e(19976);function o(n,t){return!u(t)&&(0,r.yk)(n)}function u(n){return(0,i.a)().Model.FormsTenantSettings.bingImageSearch||n&&n.isFieldReady(n.Schema.TenantSwitches)&&1===n.Model.TenantSwitches}},77209:function(n,t,e){"use strict";function r(n){return n?(n.startsWith("t=")||n.startsWith("Bearer")?"":"Bearer ")+n:""}e.d(t,{U:function(){return r}})},54740:function(n,t,e){"use strict";e.d(t,{Ng:function(){return B},UF:function(){return q},tW:function(){return U},ge:function(){return V},s1:function(){return G},GO:function(){return A}});var r,i,o,u,s,a,c,f,l,h,d,m,v,p,g,b,w=(0,e(4851).Rm)((function(){return"complete"===document.readyState?Promise.resolve():new Promise((function(n){document.addEventListener("readystatechange",(function(){"complete"===document.readyState&&n()}))}))})),I=e(94290),y=e(9947),S=e(83894),F=e(2775);function C(){return h}function _(){return v}function T(){return p}function P(){return g}function N(){return b}function k(n,t){var e=(0,F.Ry)(n.map((function(n){var t=n.licenseName,e=n.skus;return[t.toUpperCase(),JSON.parse(e)]})));return function(n){for(var t in r)if(n.hasOwnProperty(r[t])){var e=n[r[t]];if(e&&e.length>0)return void(h=!0)}h=!1}(e),function(n){for(var t in i)if(n.hasOwnProperty(i[t])){var e=n[i[t]];if(e&&e.length>0)return d=!0,void parseInt(t)}d=!1}(e),function(n){for(var t in o)if(n.hasOwnProperty(o[t])&&(e=n[o[t]])&&e.length>0){!0,parseInt(t);break}for(var t in u)if(n.hasOwnProperty(u[t])&&(e=n[u[t]])&&e.length>0){parseInt(t);break}for(var t in s){var e;if(n.hasOwnProperty(s[t])&&(e=n[s[t]])&&e.length>0){parseInt(t);break}}}(e),function(n){m=!(!(0,S.ro)()||!n)}(t),function(n){for(var t in a)if(n.hasOwnProperty(a[t])){var e=n[a[t]];if(e&&e.length>0)return void(v=!0)}v=!1}(e),function(n){for(var t in c)n.hasOwnProperty(c[t])&&(e=n[c[t]])&&e.length>0&&(p=!0);for(var t in f)n.hasOwnProperty(f[t])&&(e=n[f[t]])&&e.length>0&&(b=!0);for(var t in l){var e;n.hasOwnProperty(l[t])&&(e=n[l[t]])&&e.length>0&&(g=!0)}}(e),e}function E(){var n=0;return C()&&(n=1),d&&(n|=2),(0,S.Wh)()&&(n|=8),(0,S.ro)()&&(n|=m?16:4),_()&&(n|=64,T()?n|=128:N()?n|=256:P()&&(n|=512)),n}!function(n){n[n.OFFICE_FORMS_PLAN_2=0]="OFFICE_FORMS_PLAN_2",n[n.OFFICE_FORMS_PLAN_3=1]="OFFICE_FORMS_PLAN_3"}(r||(r={})),function(n){n[n.FORMS_PLAN_E1=0]="FORMS_PLAN_E1",n[n.FORMS_PLAN_E3=1]="FORMS_PLAN_E3",n[n.FORMS_PLAN_E5=2]="FORMS_PLAN_E5",n[n.FORMS_PLAN_K=3]="FORMS_PLAN_K"}(i||(i={})),function(n){n[n.FORMS_GOV_E1=0]="FORMS_GOV_E1",n[n.FORMS_GOV_E3=1]="FORMS_GOV_E3",n[n.FORMS_GOV_E5=2]="FORMS_GOV_E5",n[n.FORMS_GOV_F1=3]="FORMS_GOV_F1"}(o||(o={})),function(n){n[n.FORMS_GCCHIGH_E1=0]="FORMS_GCCHIGH_E1",n[n.FORMS_GCCHIGH_E3=1]="FORMS_GCCHIGH_E3",n[n.FORMS_GCCHIGH_E5=2]="FORMS_GCCHIGH_E5",n[n.FORMS_GCCHIGH_F1=3]="FORMS_GCCHIGH_F1"}(u||(u={})),function(n){n[n.FORMS_DOD_E1=0]="FORMS_DOD_E1",n[n.FORMS_DOD_E3=1]="FORMS_DOD_E3",n[n.FORMS_DOD_E5=2]="FORMS_DOD_E5",n[n.FORMS_DOD_F1=3]="FORMS_DOD_F1"}(s||(s={})),function(n){n[n.FORMS_PRO=0]="FORMS_PRO",n[n.FORMS_PRO_USL=1]="FORMS_PRO_USL",n[n.FORMS_PRO_USL_GCC=2]="FORMS_PRO_USL_GCC",n[n.FORMS_PRO_CE=3]="FORMS_PRO_CE",n[n.FORMS_PRO_SERVICE=4]="FORMS_PRO_SERVICE",n[n.FORMS_PRO_FS=5]="FORMS_PRO_FS",n[n.FORMS_PRO_MARKETING=6]="FORMS_PRO_MARKETING",n[n.FORMS_PRO_PLAN=7]="FORMS_PRO_PLAN",n[n.FORMS_PRO_PS=8]="FORMS_PRO_PS",n[n.FORMS_PRO_SALESENT=9]="FORMS_PRO_SALESENT",n[n.FORMS_PRO_TALENT=10]="FORMS_PRO_TALENT",n[n.FORMS_PRO_OPERATIONS=11]="FORMS_PRO_OPERATIONS",n[n.FORMS_PRO_RELATIONSHIP_SALES=12]="FORMS_PRO_RELATIONSHIP_SALES",n[n.FORMS_PRO_CUSTOMER_INSIGHTS=13]="FORMS_PRO_CUSTOMER_INSIGHTS",n[n.FORMS_PRO_SERVICE_GCC=14]="FORMS_PRO_SERVICE_GCC",n[n.FORMS_PRO_FS_GCC=15]="FORMS_PRO_FS_GCC",n[n.FORMS_PRO_HUMAN_RESOURCES_GCC=16]="FORMS_PRO_HUMAN_RESOURCES_GCC",n[n.FORMS_PRO_PS_GCC=17]="FORMS_PRO_PS_GCC",n[n.FORMS_PRO_SALESENT_GCC=18]="FORMS_PRO_SALESENT_GCC",n[n.FORMS_PRO_CE_GCC=19]="FORMS_PRO_CE_GCC"}(a||(a={})),function(n){n[n.FORMS_PRO_USL=0]="FORMS_PRO_USL",n[n.FORMS_PRO_USL_GCC=1]="FORMS_PRO_USL_GCC"}(c||(c={})),function(n){n[n.FORMS_PRO_CE=0]="FORMS_PRO_CE",n[n.FORMS_PRO_SERVICE=1]="FORMS_PRO_SERVICE",n[n.FORMS_PRO_FS=2]="FORMS_PRO_FS",n[n.FORMS_PRO_MARKETING=3]="FORMS_PRO_MARKETING",n[n.FORMS_PRO_PLAN=4]="FORMS_PRO_PLAN",n[n.FORMS_PRO_PS=5]="FORMS_PRO_PS",n[n.FORMS_PRO_SALESENT=6]="FORMS_PRO_SALESENT",n[n.FORMS_PRO_TALENT=7]="FORMS_PRO_TALENT",n[n.FORMS_PRO_OPERATIONS=8]="FORMS_PRO_OPERATIONS",n[n.FORMS_PRO_RELATIONSHIP_SALES=9]="FORMS_PRO_RELATIONSHIP_SALES",n[n.FORMS_PRO_CUSTOMER_INSIGHTS=10]="FORMS_PRO_CUSTOMER_INSIGHTS",n[n.FORMS_PRO_SERVICE_GCC=11]="FORMS_PRO_SERVICE_GCC",n[n.FORMS_PRO_FS_GCC=12]="FORMS_PRO_FS_GCC",n[n.FORMS_PRO_HUMAN_RESOURCES_GCC=13]="FORMS_PRO_HUMAN_RESOURCES_GCC",n[n.FORMS_PRO_PS_GCC=14]="FORMS_PRO_PS_GCC",n[n.FORMS_PRO_SALESENT_GCC=15]="FORMS_PRO_SALESENT_GCC",n[n.FORMS_PRO_CE_GCC=16]="FORMS_PRO_CE_GCC"}(f||(f={})),function(n){n[n.FORMS_PRO=0]="FORMS_PRO"}(l||(l={}));var R,O=e(64290),D=e(31442),x=e(59312),L=e(61018),M=function(n){function t(){var e=this;return t.instance?t.instance:((e=n.call(this,window.FormPrefetchCache&&window.FormPrefetchCache.userLicenseInfoCache)||this).init(),t.instance=e,e)}return(0,x.ZT)(t,n),t.getInstance=function(){return new t},t.prototype.onPrefetchSucceed=function(){try{var n=JSON.parse(this.cache.data);this.prefetchResolve(n)}catch(n){this.fallBackToNormalBoot()}},t.prototype.onPrefetchFaied=function(){this.fallBackToNormalBoot()},t.prototype.fallBackToNormalBoot=function(){var n=this;L.VY.getInstance().createDataProvider().getUserInfo().then((function(t){return n.prefetchResolve(t)})).catch((function(t){return n.prefetchReject(t)}))},t}(e(24821).f);function q(){return z().then(C,(function(){return!1}))}function A(){return z().then(_,(function(){return!1}))}function U(){return z().then((function(){return!!T()}),(function(){return!1}))}function V(){return z().then((function(){return!T()&&!!N()}),(function(){return!1}))}function G(){return z().then((function(){return!T()&&!N()&&!!P()}),(function(){return!1}))}function B(){return z().then(E,(function(){return 0}))}function z(){return R||(R=new Promise((function(n,t){w().then((function(){if((0,y.k0)().userInfo.UserId||(0,I.CE)()||(0,I.Kw)())try{var e=(0,y.k0)().userLicenseInfo;if(null==e?void 0:e.id){var r=k(e.licenses,e.isPaidUser);n(r)}else M.getInstance().getPromise().then((function(t){var e=k(t.licenses,t.isPaidUser);n(e)})).catch(t)}catch(n){t(n)}else n({})}))}))).catch((function(n){(0,O.md)((function(){return!0}))&&window.location.pathname.toLowerCase().indexOf("responsepage.aspx")>-1&&758===n.innerCode?(0,D.JG)({type:"UserInfoGetFailure",eventInfo:{error:n}}):(0,D.zU)("UserInfoGetFailure",n)})),R}},54438:function(n,t,e){"use strict";e.d(t,{m:function(){return s}});var r=e(81380),i=e(51586),o=function(){function n(n,t){this.Pt=[],this.Nt=n,t=t||{},this.kt=t.deferredTimeInMs||100,this.Et=t.maxCount||10}return n.prototype.insert=function(n){var t=this,e=new Promise((function(e,r){t.Pt.push({Arguments:n,Resolve:e,Reject:r})}));return this.Pt.length>=this.Et?this.Rt():void 0===this.Ot&&(this.Ot=window.setTimeout((function(){return t.Rt()}),this.kt)),e},n.prototype.Rt=function(){var n=this.Pt;this.Pt=[],void 0!==this.Ot&&(window.clearTimeout(this.Ot),this.Ot=void 0),0!==n.length&&this.Nt(n.map((function(n){return n.Arguments}))).then((function(t){if(n.length!==t.length)throw Error("All the elements needs to be listed in result array.");t.forEach((function(t,e){t.Succeeded?n[e].Resolve(t.Value):n[e].Reject(t.Error)}))})).catch((function(t){n.forEach((function(n){n.Reject(t)}))}))},n}(),u={};function s(n,t){return u.hasOwnProperty(t)||(u[t]=new o((function(n){return function(n,t){var e=n.length,o=(0,i.OM)(t);if(o)return(0,r.lK)(o).copyLocaleResources(t,n).then((function(){for(var n=[],t=0;t<e;++t)n.push({Succeeded:!0,Value:void 0});return n}),(function(n){for(var t=[],r=0;r<e;++r)t.push({Error:n,Succeeded:!1});return t}));return Promise.resolve(null)}(n,t)}))),u[t].insert(n)}},30777:function(n,t,e){"use strict";e.d(t,{lW:function(){return k},MM:function(){return R}});var r=e(59312),i=e(12611),o=e.n(i);function u(n){return n?(n.startsWith("t=")?"":"Bearer ")+n:""}var s=e(60211),a=e(79552),c=e(9947),f=e(916),l=e(41480),h=e(83894),d=e(84475),m=e(59469),v=e(94978),p=e(57411),g=e(21607);function b(n){for(var t={},e=0,r=n.getAllResponseHeaders().split(/\r?\n/);e<r.length;e++){var i=r[e];if(i){var o=i.indexOf(": "),u=i.substring(0,o),s=i.substring(o+2);t[u]=s}}return t}var w,I=e(47393),y=e(72317),S=e(64290),F=e(44644),C=e(99437),_=e(5892);var T={},P={},N=null;function k(n,t,e){var i,b;void 0===t&&(t={});var k,R,x=n.qosEventName,L=-1!==((0,v.Gw)("ThrottledQosEventNames")||[]).indexOf(x),M=!t.disableLog,q=-1;M&&!L||(N||(N=setInterval((function(){Object.keys(T).forEach((function(n){T[n]=!0}))}),6e5)),void 0===T[x]||T[x]?(M=!0,q=null!==(i=P[x])&&void 0!==i?i:0,T[x]=!1,P[x]=0):(M=!1,void 0!==P[x]?++P[x]:P[x]=1));if(M){b=null!=e?e:new f.o(x);var A=o().clone(n.qosExtraData);q>=0&&(A=(0,r.pi)({SkippedCount:q},A)),b.ExtraData=A,b.start(),n.headers["X-CorrelationId"]=b.CorrelationId,n.headers["X-UserSessionId"]=(0,l.k)()}t.disableXMsHeader||(n.headers["x-ms-form-request-source"]=(0,d.A)(),(0,S.md)((function(){n.qosExtraData&&n.qosExtraData.FormType&&(k=n.qosExtraData.FormType),n.requestUri&&-1!==n.requestUri.indexOf("linkedBrData")&&(n.headers["x-ms-form-deleted"]=1)})),t.disableRequestRingHeader||(n.headers["x-ms-form-request-ring"]=(R=k,(0,S.md)((function(){w="Form"!==R&&"Quiz"!==R?"USGovGccProd"===(0,s.kD)()?"formsprogcc":"formspro":null})),w||((0,c.k0)().ring&&!(0,s.x8)()&&(w=(0,c.k0)().ring.toLowerCase()),w="USGovGccProd"===(0,s.kD)()?"gcc":(0,h.ro)()||(0,p.M5)()?"msa":(0,h.Wh)()||(0,p.gq)()?"msft":(0,h.Ak)()||(0,p.eT)()?"fastfood":"business"),w)));var U=-1,V=new Promise((function(e,r){var i=function(){U++,function(n,t,e,r){void 0===r&&(r=!1);n.blobResponseType?O(n,t,r?e:i):D(n,t,r?e:i);function i(r){(0,m.hh)(r)?(0,y.a)().AuthContext.refreshToken().then((function(r){(0,g.Yq)(r).then((function(){n.headers.__RequestVerificationToken=(0,c.k0)().antiForgeryToken,r&&"string"==typeof r&&(n.headers.Authorization=u(r)),o().then((function(){return D(n,t,e)}))})).catch(I.sl)}),e):(0,m.xO)(r)?(0,m.ad)():(0,m.D1)(r)?(0,y.a)().AuthContext.signIn().then(I.iv):e(r)}function o(){return(0,c.k0)().userInfo.UserId?Promise.resolve():(0,g.sE)().catch((function(){}))}}(n,(function(n){e(n)}),(function(e){var o,u=n.isSensitiveUri?void 0:n.requestUri.toString(),s=(0,C.Lo)(u,e,t.processQosInnerMessageOnFailureOrRetry),a=s.statusCode,c=s.innerCode,f=!1,l=0;if(502===a?(o="Forms_Http_"+a,f=U<2):503===a?(o="Forms_Http_"+a,f=U<5,l=E(U,!1)):504===a||0===a?(l=5e3,o="Forms_Http_"+a,f=U<6):6503===c||624===c||647===c?(o="CDB_Http_"+c,f=U<2):645===c||646===c?((0,y.a)().RetryingRecoverableError=!0,o="CDB_Http_"+c,f=U<10,l=E(U,t.hasPrefetch)):6300===c&&(o="CDB_Net_"+c,f=U<2),!f)return r(e);b&&b.log({resultCode:o,extraData:{RetryCount:U,RetryInterval:l,ServiceError:s}}),setTimeout(i,l)}),t.skipExpiredTokenCheck)};i()}));return b?V.then((function(t){var e,r,i={resultCode:(null===(r=null===(e=null==t?void 0:t.response)||void 0===e?void 0:e.response)||void 0===r?void 0:r.statusCode)||"",resultType:"Success"};if("Form.Create"===n.qosEventName){var u=(0,_.EI)(t);i.extraData={FormId:u.id,Origin:(0,F.P)()||void 0,RetryCount:U||void 0,XLWorkbookId:u.xlWorkbookId||void 0},o().extend(i.extraData,n.qosExtraData)}else if("Response.Submit"===n.qosEventName){u=(0,_.EI)(t);i.extraData={responseId:u&&u.id},o().extend(i.extraData,n.qosExtraData)}return b.end(i),t})).catch((function(e){var r=n.isSensitiveUri?void 0:n.requestUri.toString(),i=(0,C.Lo)(r,e,t.processQosInnerMessageOnFailureOrRetry);throw b.end({resultCode:e&&e.response?e.response.statusCode:"",resultType:(0,a.WP)(i)?"ExpectedFailure":"Failure",extraData:{ServiceError:i,RetryCount:U||void 0}}),e})):V}function E(n,t){var e=[2,16,32,64],r=n>=e.length?64:e[n];return t&&(r*=2),1e3*Math.min(r,64)*(.8+.4*Math.random())}function R(n,t){return void 0===t&&(t={}),new Promise((function(t,e){O(n,t,e,!0)}))}function O(n,t,e,r){void 0===r&&(r=!1);var i=new XMLHttpRequest,o=n.requestUri;if(i.onreadystatechange=function(){if(null!=i&&4===i.readyState){var u=i.status,s=i.statusText;1223===u&&(u=204,s="No Content");var a=i.response;if(u>=200&&u<=299){if(r){var c=b(i);a={requestUri:o,statusCode:u,statusText:s,headers:c,body:a}}i=null,t(a)}else{c=b(i);i=null,e({message:"HTTP request failed",request:n,response:{requestUri:o,statusCode:u,statusText:s,headers:c,body:a}})}}},i.open(n.method||"GET",o,!0),i.responseType="blob",n.headers)for(var u in n.headers)i.setRequestHeader(u,n.headers[u]);i.send(n.body)}function D(n,t,e){odatajs.oData.request(n,t,e)}},61018:function(n,t,e){"use strict";e.d(t,{VY:function(){return F},d8:function(){return C}});var r=e(60211),i=e(6787),o=e(83830),u=e(72467),s=e(9947),a=e(916),c=e(41480),f=e(97265),l=e(59469),h=e(21607),d=e(47393),m=e(72317),v=e(64290),p=function(){function n(n){for(this.xt=n.trim();"/"===this.xt.charAt(this.xt.length-1);)this.xt=this.xt.substr(0,this.xt.length-1)}return n.prototype.Lt=function(n){return this.xt+"/"+n},n.prototype.deleteQuestionImage=function(n,t,e){var r=this;return g().then((function(i){return I(i,r.Lt(w(n,t,e)))}))},n.prototype.uploadQuestionImage=function(n,t,e,r){var i=this;return g().then((function(o){return y(o,i.Lt(w(n,t,e)),e,r)}))},n.prototype.deleteFormImage=function(n,t){var e=this;return g().then((function(r){return I(r,e.Lt(b(n,t)))}))},n.prototype.uploadFormImage=function(n,t,e){var r=this;return g().then((function(i){return y(i,r.Lt(b(n,t)),t,e)}))},n}();function g(){return(0,m.a)().AuthContext.getFormApiToken()}function b(n,t){return"forms('{0}')/{1}".format(n,t)}function w(n,t,e){return"forms('{0}')/questions('{1}')/{2}".format(n,t,e)}function I(n,t){var e=new a.o("Image.Delete");e.start();return S({methodName:"DELETE",url:t,headers:{Authorization:n?"Bearer "+n:"","X-CorrelationId":e.CorrelationId,"X-UserSessionId":(0,c.k)()},successHandler:function(){return e.end({resultType:"Success"})},errorHandler:function(n){var r={correlationId:e.CorrelationId,innerCode:n.responseJSON&&n.responseJSON.error&&n.responseJSON.error.code,statusCode:n.status,innerMessage:n.responseJSON&&n.responseJSON.error&&n.responseJSON.error.message,statusText:n.statusText};return e.end({resultType:"Failure",extraData:{imageUrl:t,error:r}}),r}})}function y(n,t,e,r){var i=new a.o("Image.Upload");i.start();return S({methodName:"PUT",url:t,headers:{Authorization:n?"Bearer "+n:"","Content-Type":r.ImageType,"Content-Disposition":"attachment; name={0}; filename={1}".format((0,f.GW)(),r.ImageName),"X-CorrelationId":i.CorrelationId,"X-UserSessionId":(0,c.k)()},successHandler:function(n){if(!n||!n.resourceId){var r={correlationId:i.CorrelationId,innerCode:5200,statusCode:0,innerMessage:"Upload image return bad response",statusText:"CollabDb bad response"};throw i.end({resultType:"Failure",extraData:{imageUrl:t,error:r,imageType:e}}),r}return i.end({resultType:"Success",extraData:{imageType:e}}),{altText:n.altText,contentType:n.contentType,fileIdentifier:n.fileIdentifier,originalFileName:n.originalFileName,resourceId:n.resourceId,resourceUrl:n.resourceUrl,height:n.height,width:n.width}},errorHandler:function(n){var e={correlationId:i.CorrelationId,innerCode:n.responseJSON&&n.responseJSON.error&&n.responseJSON.error.code,statusCode:n.status,innerMessage:n.responseJSON&&n.responseJSON.error&&n.responseJSON.error.message,statusText:n.statusText};return i.end({resultType:"Failure",extraData:{imageUrl:t,error:e}}),e},blob:r.ImageBlob})}function S(n){var t=n.methodName,e=n.url,i=n.headers,o=n.successHandler,u=n.errorHandler,a=n.data,c=n.blob,f=new XMLHttpRequest;return f.open(t,e),f.setRequestHeader("__RequestVerificationToken",(0,s.k0)().antiForgeryToken),(0,v.md)((function(){"USGovGccProd"===(0,r.kD)()?f.setRequestHeader("x-ms-form-request-ring","formsprogcc"):f.setRequestHeader("x-ms-form-request-ring","formspro")})),Object.keys(i).forEach((function(n){f.setRequestHeader(n,i[n])})),a?(f.setRequestHeader("content-type","application/json; charset=utf-8"),f.send(a)):c?f.send(c):f.send(),new Promise((function(n,t){f.onreadystatechange=function(){if(f.readyState===XMLHttpRequest.DONE){var e=f.status;200===e||202===e||201===e||204===e?n(f.responseText&&JSON.parse(f.responseText)):t(f.statusText)}}})).then(o,(function(n){if(!(0,l.hh)(n))return u(n);(0,m.a)().AuthContext.refreshToken().then(h.Yq).then((function(){return S({methodName:t,url:e,headers:i,successHandler:o,errorHandler:u,data:a,blob:c})})).catch(d.sl)}))}var F=function(){function n(){if(n.instance)return n.instance;n.instance=this}return n.getInstance=function(){return new n},n.prototype.getOwnerServiceUrl=function(n,t,e){return 1===n?this.getFormApiServiceUrl():4===n?this.getFormApiServiceUrl()+"me/":t&&e?this.getFormApiServiceUrl()+t+(3===n?"/groups/":"/users/")+e+"/":null},n.prototype.createDataProvider=function(n,t,e){void 0===n&&(n=1),void 0===t&&(t=null),void 0===e&&(e=null);var r=(0,u.AX)();if(1===n)return this.defaultDataProvider||(this.defaultDataProvider=new r(this.getFormApiServiceUrl(),this.getFormApiServiceUrl())),this.defaultDataProvider;var i=this.getOwnerServiceUrl(n,t,e);return i&&new r(this.getFormApiServiceUrl(),i)},n.prototype.createImageProvider=function(n,t,e){if(void 0===n&&(n=1),void 0===t&&(t=null),void 0===e&&(e=null),1===n)return this.currentImageProvider||(this.currentImageProvider=new p(this.getFormApiServiceUrl())),this.currentImageProvider;var r=this.getOwnerServiceUrl(n,t,e);return r&&new p(r)},n.prototype.getFormApiServiceUrl=function(){return this.getServiceUrl("formapi/api/")},n.prototype.getCollabDBServiceUrl=function(){var n=(0,r.kD)();return(0,i.lz)(n)},n.prototype.getServiceUrl=function(n){return(0,o.v)()+n},n}();function C(){return F.getInstance().createDataProvider()}},99437:function(n,t,e){"use strict";e.d(t,{QX:function(){return u},Lo:function(){return c}});var r=e(81620),i=e(94978),o=[];function u(n){var t,e=null==n?void 0:n.response,i={error:{code:"".concat(15001),message:"[PIIRisk: Full Response logging.] "}},o=e&&e.statusCode;try{(null==e?void 0:e.body)&&(i=JSON.parse(e.body))}catch(n){if(401===o){var u=(0,r.jL)(null==e?void 0:e.headers,"WWW-Authenticate");u&&-1!==u.indexOf("invalid_token")&&(i.error.code="".concat(701))}}var a=(null===(t=i.error)||void 0===t?void 0:t.code)&&parseInt(i.error.code);if(isNaN(a))switch(o){case 0:a=15001,i.error&&(i.error.message="HTTP status code is 0");break;case 429:a=15429}var c={correlationId:(0,r.jL)(null==e?void 0:e.headers,"X-CorrelationId"),headers:null==e?void 0:e.headers,statusCode:e&&e.statusCode,statusText:e&&e.statusText,innerMessage:i.error&&i.error.message,type:s(o,i),customizedMessage:i.error&&i.error["@ms.form.error.customizedMessage"],isServerError:!0,innerCode:a};return 15001!==a||c.statusCode||(0,r.jL)(null==e?void 0:e.headers,"X-MSEdge-Ref")||(c.type="ExpectedFailure"),c}function s(n,t){var e=t.error&&t.error["@ms.form.error.type"];if(!e){e=n>=0&&n<500?"ExpectedFailure":"Failure"}return e}var a=function(n){if(!n)return!1;for(var t=0,e=(r=void 0,u=void 0,r=(0,i.QJ)("WhiteListRequestUrlRegList"),u=null==r?void 0:r.map((function(n){return new RegExp(n,"i")})),o.concat(u||[]));t<e.length;t++){if(e[t].test(n))return!0}var r,u;return!1};function c(n,t,e){var i,o,s,c=u(t),f=c&&c.innerMessage||"",l={statusCode:t&&t.response?parseInt(t.response.statusCode):0,correlationId:(0,r.jL)(null===(i=null==t?void 0:t.response)||void 0===i?void 0:i.headers,"X-CorrelationId"),statusText:t&&t.response?t.response.statusText:"",innerCode:c?c.innerCode:-1,innerMessage:e?e(f):f,failureReason:(0,r.jL)(null===(o=null==t?void 0:t.response)||void 0===o?void 0:o.headers,"X-FailureReason"),failureType:c?c.type:void 0,afdRef:(0,r.jL)(null===(s=null==t?void 0:t.response)||void 0===s?void 0:s.headers,"X-MSEdge-Ref")};return a(n)&&(l.sourceUrl=n),l}},5892:function(n,t,e){"use strict";e.d(t,{D3:function(){return p},W3:function(){return m},EI:function(){return v}});var r=e(64459),i=e(47393),o=e(72317),u=e(45862),s=e(99437),a=e(94290),c=e(29559),f=e(9947),l=e(90710),h=e(31442);function d(n,t,e){return 401===n.statusCode&&!(0,a.ft)()&&((401!==n.statusCode||!(0,a.Kw)()||!(0,a.s0)())&&((401!==n.statusCode||!(0,a.HI)())&&(function(n){if(n){var t=void 0;switch(n.innerCode){case 702:t="Auth.NotOnboardedTenant";break;case 703:t="Auth.DisabledByTenantAdmin";break;case 705:t="Auth.UserNeedMultiFactorAuth"}t&&(0,h.$U)(t,{tenantId:(0,f.k0)().userInfo.TenantId})}}(n),(0,l.NW)().embed?(n.innerCode=10001,!1):(700===n.innerCode||701===n.innerCode)&&(!(0,a.mF)()||701!==n.innerCode&&700!==n.innerCode?(0,c.K$)()&&(0,c.MG)()&&(0,c.Dt)()?(n.innerCode=15003,!1):(t(),!0):(e({innerCode:701===n.innerCode?10300:10301}),!1)))))}function m(n){var t=(0,s.QX)(n);if(function(n){return d(n,(function(){(0,o.a)().AuthContext.signIn().then(i.iv)}),u.P)}(t))return new Promise((function(){}));throw t}function v(n){return p(n).value}function p(n){var t={status:0};if(null==n)t.value=n;else{var e=n,i=e["@odata.count"]&&parseInt(e["@odata.count"]);isNaN(i)||(t.count=i),t.value=(0,r.d)(void 0===e.value?n:e.value)}return t}},29295:function(n,t,e){"use strict";e.d(t,{J:function(){return i}});var r=e(87363);function i(n,t){return n.__lazyComponentClass||(n.__lazyComponentClass=r.lazy(t)),n.__lazyComponentClass}},30521:function(n,t,e){"use strict";e.d(t,{a:function(){return a}});var r=e(59312),i=e(87363),o=e(32782),u=e(43367),s=e(29295);function a(n){var t=(0,s.J)(a,u.getIoCErrorPage);return i.createElement(o.Z,null,i.createElement(t,(0,r.pi)({},n)))}},29952:function(n,t,e){"use strict";e.d(t,{Oy:function(){return o}});var r=e(94290),i=e(90710);function o(){var n,t=(0,r.XF)();return"embed"===(null===(n=(0,i.NW)().mode)||void 0===n?void 0:n.toLowerCase())||"TeamsApproval"===t||"TeamsReports"===t}},22768:function(n,t,e){"use strict";e.d(t,{Rq:function(){return l},Sp:function(){return f},qS:function(){return h}});var r=e(59312),i=e(87363),o=e(32782),u=e(29295);function s(){return(0,r.mG)(this,void 0,void 0,(function(){return(0,r.Jh)(this,(function(n){switch(n.label){case 0:return[4,e.e(600).then(e.bind(e,54281))];case 1:return[2,{default:n.sent().MathjaxFormulaRenderer}]}}))}))}function a(){return(0,r.mG)(this,void 0,void 0,(function(){return(0,r.Jh)(this,(function(n){switch(n.label){case 0:return[4,e.e(600).then(e.bind(e,57596))];case 1:return[2,{default:n.sent().VirtualKeyboardControl}]}}))}))}function c(){return(0,r.mG)(this,void 0,void 0,(function(){return(0,r.Jh)(this,(function(n){switch(n.label){case 0:return[4,e.e(600).then(e.bind(e,92719))];case 1:return[2,{default:n.sent().FormulaDesigner}]}}))}))}function f(n){var t=(0,u.J)(f,a);return i.createElement(o.Z,null,i.createElement(t,(0,r.pi)({},n)))}function l(n){var t=(0,u.J)(l,s);return i.createElement(o.Z,null,i.createElement(t,(0,r.pi)({},n)))}function h(n){var t=(0,u.J)(h,c);return i.createElement(o.Z,null,i.createElement(t,(0,r.pi)({},n)))}},35337:function(n,t,e){"use strict";e.d(t,{f:function(){return f},Y:function(){return a}});var r=e(59749),i=e(36476);function o(n){return function(n,t){var e=u(),r=e.domain,i=e.isCdn,o=e.ring,s=i?"":"?ring=".concat(o);return"".concat(r).concat(t).concat(n.toLowerCase()).concat(s)}(n,"/scripts/dists/")}var u=(0,e(4851).Rm)((function(){var n,t,e=window.shellInfo,r=!1;if(e)r=!!(n=e.cdnEndpoint),t=e.ring;else{var o=window.OfficeFormServerInfo;r=o.isCdnEnabled,n=(0,i._k)(),t=o.ring}return{isCdn:r=r&&!!n,domain:r?n:location.protocol+"//"+location.host,ring:t}})),s=JSON.parse('["af","am-et","ar","as-in","az-latn-az","be","bg","bn-in","bs-latn-ba","ca-es-valencia","ca","cs","cy-gb","da","de","el","en-gb","en-us","es-mx","es","et","eu","fa","fi","fil-ph","fr-ca","fr","ga-ie","gd","gl","gu","he","hi","hr","hu","hy","id","is","it","ja","ka","kk","km-kh","kn","ko","kok","lb-lu","lo","lt","lv","mi-nz","mk","ml","mr","ms","mt-mt","nb-no","ne-np","nl","nn-no","or-in","pa","pl","pt-br","pt-pt","quz-pe","","ro","ru","sk","sl","sq","sr-cyrl-ba","sr-cyrl-rs","sr-latn-rs","sv","ta","te","th","tr","tt","ug","uk","ur","uz-latn-uz","vi","zh-cn","zh-tw"]');function a(n){return n}function c(n){if("string"!=typeof n||!n)return"default";var t=n.toLowerCase();if(s.indexOf(t)>=0)return t;var e=t.replace(/-[^-]+$/,"");return e&&t!==e?c(e):"default"}function f(n){window.FormsLsMap=window.FormsLsMap||{},window.formsLsPromiseMap=window.formsLsPromiseMap||{},n=c(n);var t=window.FormsLsMap[n];if(t)return Promise.resolve(t);var e=window.formsLsPromiseMap[n];return e||(e=l(o("".concat("ls-sr",".").concat(n,".").concat("e2bc1e470",".js"))).then((function(){return window.formsLsPromiseMap[n]=null,window.FormsLsMap[n]}),(function(){throw window.formsLsPromiseMap[n]=null,new Error("fail to download locstring")})).catch((function(n){return new Promise((function(){}))})),window.formsLsPromiseMap[n]=e,e)}function l(n,t){return void 0===t&&(t=0),new Promise((function(e,i){if(t>=2)i();else{var o=document.createElement("script");(0,r.M5)(o,n.toLowerCase()),o.type="text/javascript",o.async=!0,o.onload=function(){e()},o.onerror=function(){!function(){try{document.head.removeChild(o)}catch(n){}}(),e(l(n,t+1))};try{document.head.appendChild(o)}catch(n){i()}}}))}},24497:function(n,t,e){"use strict";e.d(t,{gA:function(){return s},wg:function(){return u}});var r=e(92575),i=e(70069),o=e(64290);function u(n,t,e){return void 0===e&&(e=!1),t&&function(n,t){return"false"!==t||"false"===n}(n,t)?t:n||""}function s(n){var t={$isSanitizeRichTextHTMLBase:!0,$text:n};return(0,o.pd)((function(){return(0,i.s)(t)}),(function(){return o.Xw.sanitizeRichTextHTML(n)}))}var a;a=document.createElement("div")},94605:function(n,t,e){"use strict";e.d(t,{G:function(){return h}});var r=e(59312),i=e(72377),o=e(26203),u=e(39923),s=e(73252),a=e(73293),c=e(25366),f=e(72374),l={TargetQuestionId:u.J4.string(),ToTheEnd:u.J4.boolean()},h=function(n){function t(e){var r=n.call(this,e)||this;return r.Mt=!1,r.qt=!1,r.At="",r.Ut=function(n){return r.Vt()},e.MasterTreeReady.then((function(){r.Deleted||(t.normalize(r,{},!1),r.addRule({Name:"normalize",onChange:function(n){t.normalize(r,n.OldValues,!0)}}),r.observe((function(n){r.Deleted||r.Gt()})))})),r}return(0,r.ZT)(t,n),t.prototype.getElementMaster=function(){var n=this.Parent;do{if(n instanceof f.MF||n instanceof a.Jv)return n}while(n=n.Parent);return null},t.prototype.getTargetElementMaster=function(){if(this.Deleted)return null;var n=this.getElementMaster().Form.FormElementManager;if(!this.Model.TargetQuestionId)return null;var t=n.getElementMasterById(this.Model.TargetQuestionId);return t&&t.Deleted?null:t?(c.H.isSection(t.Model.Type)||n.findContainerSection(this.getElementMaster())===n.findContainerSection(t))&&t:t},t.prototype.resetToDefault=function(){var n=this;this.Mt=!1,this.bulkEdit((function(){n.Model.ToTheEnd=null,n.Model.TargetQuestionId=null}))},t.prototype.isDefault=function(){return!this.Model.ToTheEnd&&!this.Model.TargetQuestionId},t.prototype.getBranchingResult=function(){var n=this.Model;return this.isValid()?n.ToTheEnd?{Type:"End"}:{Type:"Specified",TargetElement:this.getTargetElementMaster()}:{Type:"Next"}},t.prototype.hasSectionBranching=function(){var n=this.getElementMaster(),t=this.getTargetElementMaster();return c.H.isSection(n.Model.Type)||t&&c.H.isSection(t.Model.Type)},t.normalize=function(n,t,e){var r=n.Model;r.ToTheEnd?t.ToTheEnd&&r.TargetQuestionId||(r.TargetQuestionId=null):r.ToTheEnd=null,e&&n.Bt()},t.prototype.isValid=function(){return this.Mt&&this.At===this.Model.TargetQuestionId||(this.Bt(),this.Gt()),this.qt},t.prototype.Bt=function(){this.Mt=!0,this.At=this.Model.TargetQuestionId,this.qt=!(!this.Model.ToTheEnd&&!this.getTargetElementMaster());var n=this.Model.TargetQuestionId;!this.qt&&n&&(0,s.M0)()&&(this.qt=i.Pv.Resolve("IIncrementalLoadStrategy").has(n))},t.prototype.Gt=function(){var n=this.getTargetElementMaster(),t=this.zt;n!==t&&((t instanceof f.MF||t instanceof a.Jv)&&t.unobserve(this.Ut),this.zt=n,(n instanceof f.MF||n instanceof a.Jv)&&n.observe(this.Ut))},t.prototype.Vt=function(){if(this.zt.Deleted)this.Model.TargetQuestionId=null;else if(this.zt instanceof f.MF){var n=this.getElementMaster().Form.FormElementManager;n.findContainerSection(this.getElementMaster())!==n.findContainerSection(this.zt)&&(this.Model.TargetQuestionId=null)}},t}(o.d.createObjectMasterClass("BranchInfoMaster",l))},81380:function(n,t,e){"use strict";e.d(t,{Cs:function(){return h},Mv:function(){return d},Ol:function(){return I},lK:function(){return p},lb:function(){return b},o7:function(){return g},qU:function(){return l},rl:function(){return w}});var r=e(26203),i=e(37076),o=e(70699),u=e(61018),s=e(64290),a=e(31442),c=e(71860),f=e(96680);function l(n,t,e){var i=I(n);i.push("status");var o=r.d.getFieldSchemaInfo(c.x.Schema.Version).Attributes.SourceFieldName;i.indexOf(o)&&i.push(o);var s=4,f=null,l=null;t&&(f=t.OwnerTenantId,l=t.OwnerId,s=t.IsGroupForm?3:2);var h=u.VY.getInstance().createDataProvider(s,f,l);return h.getForms(i,e).then((function(n){var t=[],e=0,i=[];return n.forEach((function(n){if("Deleted"===n.status)++e,h.deleteForm(n.id);else if(n.version){var o=r.d.convertFromSourceData(n,c.x.Schema);i.push(o)}else t.push(n.id)})),(t.length||e)&&(0,a.$U)("PortalPage.FilteredOutForms",{deletedFormCount:e,oldVersionForms:t}),i}))}function h(){return u.VY.getInstance().createDataProvider().getFormsResponseCount()}function d(){return(0,s.pd)(m,v)}function m(){return u.VY.getInstance().createDataProvider(4).getFormsSharedWithCurrentUser().then((function(n){return n.map((function(n){return r.d.convertFromSourceData(n,c.x.Schema)}))}))}function v(){var n=u.VY.getInstance().createDataProvider(4),t=null;return new Promise((function(e,i){n.getFormsSharedWithCurrentUserPro(!1).then((function(i){t=i.Forms.map((function(n){return r.d.convertFromSourceData(n,c.x.Schema)}));var u=i.TotalFormCount/parseInt((0,o.NA)())-1,s=1;if(!(i.TotalFormCount>parseInt((0,o.NA)())))return e(t);for(;u>0;){var a=n.getFormsSharedWithCurrentUserPro(!0,s*parseInt((0,o.NA)()));s++,u--,a.then((function(n){if((t=t.concat(n.Forms.map((function(n){return r.d.convertFromSourceData(n,c.x.Schema)})))).length===i.TotalFormCount)return e(t)}))}}))}))}function p(n){if(!n.isFieldReady(c.x.Schema.OwnerTenantId)||!n.isFieldReady(c.x.Schema.OwnerId))return u.VY.getInstance().createDataProvider();var t=1;if(n.IsGroupForm)t=3;else{if(!n.Model.OwnerTenantId||!n.Model.OwnerId)return null;t=2}return u.VY.getInstance().createDataProvider(t,n.Model.OwnerTenantId,n.Model.OwnerId)}function g(n){var t=(0,i.kc)(n),e=1;return t.IsGroupOwner?e=3:t.OrgId&&t.OwnerId&&(e=2),u.VY.getInstance().createDataProvider(e,t.OrgId,t.OwnerId)}function b(n,t,e){return p(n).downloadExcelFile(n.Model.Id,t,e)}function w(n){return(0,a.$U)("DesignPage.ResponseCount.Get"),p(n).getFormResponseCount(n.Model.Id)}function I(n){return(0,f.sQ)(n||r.d.getSubFieldSchemas(c.x.Schema)).map((function(n){var t=r.d.getFieldSchemaInfo(n);if(!t.Attributes.IsLocalField)return t.Attributes.SourceFieldName||t.Name})).filter((function(n){return n}))}},82963:function(n,t,e){"use strict";e.d(t,{Lu:function(){return l},Od:function(){return d},_n:function(){return h},aj:function(){return f},bi:function(){return p},mt:function(){return m},q4:function(){return v},qs:function(){return c}});var r=e(12611),i=e(43209),o=e(26203),u=e(79849),s=e(81380),a="0001-01-01T00:00:00Z";function c(n,t){var e=r.map(t.Answers,(function(n){return{questionId:n.QuestionId,answer1:n.Answer}})),i={answers:JSON.stringify(e),startDate:t.StartDate instanceof Date?t.StartDate.toISOString():"",submitDate:t.SubmitDate instanceof Date?t.SubmitDate.toISOString():""};return i.emailReceiptConsent=t.EmailReceiptConsent,i.submitLanguage=t.SubmitLanguage,t.Responder&&(i.responder=t.Responder,i.responderName=t.ResponderName),(0,s.lK)(n).submitFormResponse(n.Model.Id,i)}function f(n,t,e,r){return(0,s.lK)(n).getFormResponses(n.Model.Id,r,t,e).then((function(n){return n.map(p)}))}function l(n){return(0,s.lK)(n).getRuntimeResponses(n.Model.Id).then((function(n){return n.map(p)}))}function h(n){return(0,s.lK)(n).deleteFormResponses(n.Model.Id)}function d(n,t){var e,r,o=null===(r=null===(e=window.FormPrefetchCache)||void 0===e?void 0:e.responseCache)||void 0===r?void 0:r.data;return("Response"===(0,i.C2)()&&o?Promise.resolve(o.value):(0,s.lK)(n).getRuntimeResponses(n.Model.Id,t)).then((function(n){return n.filter((function(n){return n.releaseDate!==a})).map(p)}))}function m(n,t){return(0,s.lK)(n).getRuntimeResponse(n.Model.Id,t).then(p)}function v(n,t){var e=(0,s.o7)(n);return Promise.all(t.map((function(t){return e.deleteFormResponse(n,t)})))}function p(n){var t=o.d.convertFromSourceData(n,u.KJ.Schema);void 0!==t.StartDateAsString&&(t.StartDate=new Date(t.StartDateAsString)),void 0!==t.SubmitDateAsString&&(t.SubmitDate=new Date(t.SubmitDateAsString)),void 0!==t.ReleaseDateAsString&&(null===t.ReleaseDateAsString?t.ReleaseDate=new Date(a):t.ReleaseDate=new Date(t.ReleaseDateAsString));var e=[];if(t.AnswersAsString&&(e=JSON.parse(t.AnswersAsString).map((function(n){return{Answer:n.answer1,QuestionId:n.questionId}})),t.Answers=e),t.Comments){var i={},s=[];r.forEach(t.Comments,(function(n){var t=n.QuestionId||"___";i[t]&&s.push(i[t]),i[t]=n})),t.Comments=r.difference(t.Comments,s)}if(t.Comments){var c={};e.forEach((function(n){return c[n.QuestionId]=n})),r.forEach(t.Comments,(function(n){var r=n.QuestionId;if(r){var i=c[r];i||(i={Answer:null,QuestionId:r},e.push(i),c[r]=i),i.Feedback=n.Feedback,i.Score=n.Score}else t.Feedback=n.Feedback,t.TotalScore=n.Score}))}return t}},94956:function(n,t,e){"use strict";e.d(t,{b:function(){return o}});var r=e(94290),i=e(37890),o=function(){function n(n,t,e){void 0===t&&(t=1e3),void 0===e&&(e=5e3);var i=this;this.jt=Number.MAX_VALUE,t=null!=t?t:1e3,e=null!=e?e:5e3,(0,r.mF)()?this.Qt=t:this.Qt=4*t,this.Ht=4*e,this.$t=function(){var n=i.Wt();n&&n.resolve()}}return n.prototype.scheduleUpdate=function(){return this.Jt&&console.warn("Calling scheduleUpdate() before the previous one is resolved."),this.Jt=new i.wU,this.Kt=window.setTimeout(this.$t,this.Qt),this.Xt=window.setTimeout(this.$t,this.Ht),this.Jt.promise()},n.prototype.postponeUpdate=function(){this.Jt||console.warn("Calling postponeUpdate() before update scheduled."),this.Kt&&window.clearTimeout(this.Kt),this.Kt=window.setTimeout(this.$t,this.Qt)},n.prototype.cancelUpdate=function(){var n;null===(n=this.Wt())||void 0===n||n.reject()},n.prototype.setMaxRetryTimesForUpdate=function(n){this.jt=n},n.prototype.Wt=function(){window.clearTimeout(this.Kt),this.Kt=void 0,window.clearTimeout(this.Xt),this.Xt=void 0;var n=this.Jt;return this.Jt=void 0,n},n.prototype.retryForCreation=function(n){return n<3?Promise.resolve():Promise.reject("Retry times exceeded.")},n.prototype.retryForUpdate=function(n){var t=this;if(n>=this.jt)return Promise.reject("times >= this.maxRetryTimesForUpdate");var e=s;n<a&&(e=u*Math.pow(2,n));var r=new i.wU;return this.Yt=window.setTimeout((function(){t.Yt=void 0,r.resolve()}),e),r.promise()},n.prototype.cancelRetryForUpdate=function(){window.clearTimeout(this.Yt),this.Yt=void 0},n}(),u=2500,s=6e5,a=Math.log(s/u)/Math.log(2)},73293:function(n,t,e){"use strict";e.d(t,{Jv:function(){return T},PQ:function(){return _}});var r=e(59312),i=e(12611),o=e(41480),u=e(84358),s=e(37890),a=e(26203),c=e(39923),f=e(72467),l=e(1014),h=e(46008),d=e(31442),m=e(94605),v=e(94956),p=e(90819),g=e(3920),b=e(81380),w=e(9743),I=function(){function n(n,t){this.Zt=n,this.ne=(0,b.lK)(this.Zt.Form)}return Object.defineProperty(n.prototype,"FormId",{get:function(){return this.Zt.Form.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ElementId",{get:function(){return this.Zt.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ElementType",{get:function(){return this.Zt.Model.Type},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ExtraQosData",{get:function(){var n=this.Zt.Form;return{WithSection:n.isFieldReady(n.Schema.DescriptiveElements)&&!!n.FormElementManager.SectionMasters.length}},enumerable:!1,configurable:!0}),n.prototype.add=function(n){var t=this;if(this.Zt.Form.SyncContext!==w.y.DesignTimeForm)throw Error("Trying to create an element without design type.");return this.Zt.createSyncJob((function(){return t.ne.createFormDescriptiveElement(t.FormId,n,t.ExtraQosData)}))},n.prototype.delete=function(n){var t=this;if(!n||!n.id)throw Error("Trying to delete an empty element.");if(this.Zt.Form.SyncContext!==w.y.DesignTimeForm)throw Error("Trying to delete an element without design type.");return this.Zt.createSyncJob((function(){return t.ne.deleteFormDescriptiveElement(t.FormId,n.id||"",t.ElementType,t.ExtraQosData)})).then(null,(function(n){if(n&&621===n.innerCode)return Promise.resolve();throw n}))},n.prototype.query=function(n){throw Error("No scenario to call this method currently.")},n.prototype.update=function(n,t){var e=this;return this.Zt.Form.SyncContext!==w.y.DesignTimeForm?Promise.resolve():this.Zt.createUploadSyncJob((function(){return e.ne.updateFormDescriptiveElement(e.FormId,e.ElementId,e.ElementType,n,e.ExtraQosData)}))},n}(),y=e(53907),S=e(62539),F=e(82205),C={BranchInfo:c.J4.fromMasterClass((function(){return m.G}),{IsLocalField:!0}),CoAuthors:c.J4.collectionOf(c.J4.reference(),{IsLocalField:!0}),FileUploadSPOInfo:c.J4.create({anonymousLinkInfo:c.J4.string(),driveId:c.J4.string(),errorCode:c.J4.string(),folderId:c.J4.string(),linkInfo:c.J4.string()},{SourceFieldName:"fileUploadSPOInfo"}),FormsProRTQuestionTitle:c.J4.string({SourceFieldName:"formsProRTQuestionTitle"}),FormsProRTSubtitle:c.J4.string({SourceFieldName:"formsProRTSubtitle"}),Id:c.J4.string({IsKeyField:!0,SourceFieldName:"id"}),ImageInfo:c.J4.fromMasterClass(f.Cu,{SourceFieldName:"image"}),ImageSettings:c.J4.fromMasterClass(f.BF,{IsLocalField:!0}),IntegratedSavingState:c.J4.reference({IsLocalField:!0}),Order:c.J4.number({SourceFieldName:"order"}),QuestionInfo:c.J4.string({SourceFieldName:"questionInfo"}),SavingState:c.J4.reference({IsLocalField:!0}),ShowSubtitle:c.J4.boolean({IsLocalField:!0}),Subtitle:c.J4.string({SourceFieldName:"subtitle"}),Title:c.J4.string({SourceFieldName:"title"}),Type:c.J4.reference({SourceFieldName:"type"}),Hidden:c.J4.boolean({IsLocalField:!0}),Visible:c.J4.boolean({IsLocalField:!0}),VideoInfo:c.J4.create({Author:c.J4.string(),OriginalHeight:c.J4.number(),OriginalWidth:c.J4.number(),ShowWarningBar:c.J4.boolean(),Thumbnail_url:c.J4.string(),Title:c.J4.string(),Url:c.J4.string()},{IsLocalField:!0})};function _(n){return a.d.getObjectMasterFromModel(n)}var T=function(n){function t(e){var r=this,o=new s.wU;if(!e.InitialData)throw Error("Element model should created with initial data.");return(e=i.clone(e)).InitialData=i.clone(e.InitialData),e.InitialData.FormsProRTQuestionTitle||(e.InitialData.FormsProRTQuestionTitle=null),e.InitialData.FormsProRTSubtitle||(e.InitialData.FormsProRTSubtitle=null),r=n.call(this,e,{MasterReady:o.promise(),Scheduler:new v.b(t.name)})||this,(0,F.vG)(r),r.ee(),r.re(e),(0,g.CU)(r,t.Schema.ImageInfo,t.Schema.ImageSettings),t.Rules.forEach((function(n){return r.addRule(n)})),r.ie={},o.resolve(),r}return(0,r.ZT)(t,n),t.supportMobileDesign=function(n){return!1},Object.defineProperty(t.prototype,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ImageInfoMaster",{get:function(){return(0,p.rQ)(this.Model.ImageInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ImageSettingsMaster",{get:function(){return(0,g.Hi)(this.Model.ImageSettings)},enumerable:!1,configurable:!0}),t.prototype.isFieldReady=function(e){return e=t.getSourceFields([e])[0],n.prototype.isFieldReady.call(this,e)},t.prototype.ensureFieldsReady=function(e){return n.prototype.ensureFieldsReady.call(this,t.getSourceFields(e))},t.prototype.fieldsReady=function(e){return n.prototype.fieldsReady.call(this,t.getSourceFields(e))},t.prototype.ensureCreationDone=function(){var n=this;return this.ImageInfoMaster.Synchronizer.flush().then((function(){return n.Synchronizer.flush()}))},t.prototype.setVideoUrl=function(n,e){var r=this.Model.VideoInfo;a.d.getObjectMasterFromModel(r).bulkEdit((function(){r.Url=(0,l.Qn)(n,(0,o.k)()),r.Title="",r.Author="",r.Thumbnail_url="",r.OriginalWidth=t.defaultWidth,r.OriginalHeight=t.defaultHeight,r.ShowWarningBar=e&&(0,u.M4)(n)}))},t.prototype.hasValidVideoUrl=function(){return(0,h.Fp)()?this.ue()&&(0,u.eC)(this.Model.VideoInfo.Url):this.ue()&&(0,u.yk)(this.Model.VideoInfo.Url)},t.prototype.clearVideoInfo=function(){this.Model.VideoInfo={Author:"",OriginalHeight:t.defaultHeight,OriginalWidth:t.defaultWidth,ShowWarningBar:!1,Thumbnail_url:"",Title:"",Url:""}},t.prototype.resetBranchInfo=function(){t.getBranchInfoMaster(this.Model.BranchInfo).resetToDefault()},t.prototype.createSyncJob=function(n){var t=this,e=new s.wU,r=e.promise().then((function(){return t.Form.getQuestionSyncBlocker(r)})).then(n);return e.resolve(),r},t.prototype.createUploadSyncJob=function(n){var t=this,e=new s.wU,r=Promise.all([e,this.ae]).then((function(){return t.createSyncJob(n)}));return e.resolve(),this.ae=(0,s.Bx)(r),r},t.prototype.updateCoAuthors=function(n){var t=this,e=i.filter(this.Model.CoAuthors,(function(t){return n.userId===t.userId}))[0],r=function(){e&&o.deleteItems([e]),n.userId in t.ie&&(clearTimeout(t.ie[n.userId]),delete t.ie[n.userId])},o=a.d.getCollectionMasterFromModel(this.Model.CoAuthors);o.bulkEdit((function(){r(),e=a.d.Collection.addItems(t.Model.CoAuthors,[n])[0]}));this.ie[n.userId]=window.setTimeout(r,1e4)},t.getBranchInfoMaster=function(n){return a.d.getObjectMasterFromModel(n)},t.prototype.re=function(n){this.ce=new y.S(this,t.Schema.QuestionInfo,t.QuestionInfoFieldSet),n.InitialData&&this.isFieldReady(t.Schema.QuestionInfo)&&(n.ExistingInDataSource||n.InitialData.QuestionInfo?this.ce.deserialize():this.ce.serialize())},t.prototype.ee=function(){this.isFieldReady(t.Schema.ImageInfo)?this.Model.IntegratedSavingState=(0,F.IM)([this.Model.ImageInfo.SavingState,this.Model.SavingState]):this.Model.IntegratedSavingState=this.Model.SavingState},t.prototype.ue=function(){return this.Model.VideoInfo&&this.Model.VideoInfo.Url},Object.defineProperty(t,"QuestionInfoFieldSet",{get:function(){return t.questionInfoFieldSet||(t.questionInfoFieldSet=new S.C([t.Schema.BranchInfo,t.Schema.ImageSettings,t.Schema.ShowSubtitle,t.Schema.VideoInfo,t.Schema.Hidden])),t.questionInfoFieldSet},enumerable:!1,configurable:!0}),Object.defineProperty(t,"Rules",{get:function(){if(!t.rules){var n=t.Schema;t.rules=[{InterestedFields:[n.Id],Name:"block id changes",onChange:function(n){var t,e=n.Master.Model,r=e.Id,i=n.OldValues.Id;e.Id=i;try{throw Error("Changing element id")}catch(n){t=n}(0,d.zU)("UpdatingElementId",{newId:r,oldId:i,stack:t.stack})}},{InterestedFields:[n.ImageInfo.SavingState,n.SavingState],Name:"IntegrateSavingState",onChange:function(n){return n.Master.ee()}}]}return t.rules},enumerable:!1,configurable:!0}),t.getSourceFields=function(n){return i.uniq(n.map((function(n){return t.QuestionInfoFieldSet.covers(n)?t.Schema.QuestionInfo:n})))},t.defaultWidth=459,t.defaultHeight=256,t}(a.d.createObjectMasterClass("DescriptiveElementMaster",C,(function(n,t){return new I(n,t)})))},85866:function(n,t,e){"use strict";var r;e.d(t,{d:function(){return r}}),function(n){n[n.Normal=0]="Normal",n[n.SoftDeleted=1]="SoftDeleted"}(r||(r={}))},9743:function(n,t,e){"use strict";var r;e.d(t,{y:function(){return r}}),function(n){n[n.DesignTimeForm=1]="DesignTimeForm",n[n.ResponseTimeForm=2]="ResponseTimeForm",n[n.SharedTimeForm=3]="SharedTimeForm",n[n.LocalForm=4]="LocalForm",n[n.AnalysisTimeForm=5]="AnalysisTimeForm",n[n.ResponseDetailTimeForm=6]="ResponseDetailTimeForm",n[n.AdminPhishingReviewForm=7]="AdminPhishingReviewForm"}(r||(r={}))},34212:function(n,t,e){"use strict";var r;e.d(t,{Z:function(){return r}}),function(n){n[n.None=0]="None",n[n.All=1]="All",n[n.Flip=2]="Flip",n[n.LimitedNumber=3]="LimitedNumber",n[n.Advanced=4]="Advanced"}(r||(r={}))},53907:function(n,t,e){"use strict";e.d(t,{S:function(){return o}});var r=e(26203),i=0,o=function(){function n(n,t,e){this.fe=n,this.me=t,this.ve=e.FieldSchemas,this.pe()}return n.prototype.serialize=function(){var n=this.fe.getSnapshot(this.ve),t=this.fe.Schema,e={};this.ve.forEach((function(t){var i=r.d.getFieldSchemaInfo(t).Name;e[i]=r.d.convertToSourceData(n[i],t)}));var o=r.d.getFieldSchemaInfo(this.me).Name,s=u(e,t,[]),a=s&&JSON.stringify(s),c=this.fe.Model[o]!==a;(c||Math.random()<i)&&(c=!0,a=(s=u(e,t,null))&&JSON.stringify(s)),c&&(this.fe.Model[o]=a)},n.prototype.deserialize=function(){var n=r.d.getFieldSchemaInfo(this.me).Name,t=this.fe.Model[n],e=t?JSON.parse(t):{},i={};this.ve.forEach((function(n){var t=r.d.getFieldSchemaInfo(n).Name;i[t]=r.d.convertFromSourceData(e[t],n)})),this.fe.setData(i,this.ve)},n.prototype.pe=function(){var n=this,t=r.d.getFieldSchemaInfo(this.me).Name;this.fe.addRule({Name:"Deserialize - "+t,InterestedFields:[this.me],onChange:function(t){t.BeingDeleted||n.deserialize()}}),this.fe.addRule({Name:"Serialize - "+t,InterestedFields:this.ve,onChange:function(t){t.BeingDeleted||n.serialize()}})},n}();function u(n,t,e){if(null==n)return null;if(Array.isArray(n)){if(n.length){var i=t[0];return n.map((function(n){return u(n,i,e)}))}return e}var o={},s=0;return r.d.getSubFieldSchemas(t).forEach((function(t){var i=r.d.getFieldSchemaInfo(t),a=i.Attributes.SourceFieldName||i.Name,c=n[a];i.IsLeaf||(c=u(c,t,e)),null!=c&&(++s,o[a]=c)})),s>0?o:null}},62539:function(n,t,e){"use strict";e.d(t,{C:function(){return u}});var r=e(12611),i=e(72420),o=e(26203),u=function(){function n(n){this.we=n.concat(),this.Ie=n.map((function(n){return o.d.getFieldSchemaInfo(n).Name}))}return Object.defineProperty(n.prototype,"FieldSchemas",{get:function(){return this.we.concat()},enumerable:!1,configurable:!0}),n.prototype.covers=function(n){return(0,i.HD)(n)?r.contains(this.Ie,n):r.contains(this.we,n)},n}()},71860:function(n,t,e){"use strict";e.d(t,{x:function(){return Q}});var r=e(59312),i=e(12611),o=e(9947),u=e(64459),s=e(37890),a=e(72377);var c=e(26203),f=e(39923),l=e(73252),h=e(20987),d=e(72467),m=e(64290),v=(e(94978),e(41293)),p=e(6787),g=e(7645),b=e(85866),w=e(9743),I=e(81380),y=function(){function n(n,t){if(this.ye=n,this.ne=(0,I.lK)(n),this.ne){var e=this.ne.getDesignForm;switch(this.ye.SyncContext){case w.y.SharedTimeForm:e=this.ne.getSharedForm;break;case w.y.ResponseTimeForm:e=this.ne.getRuntimeForm;break;case w.y.AnalysisTimeForm:e=this.ne.getAnalysisTimeForm;break;case w.y.ResponseDetailTimeForm:e=this.ne.getResponseDetailRuntimeForm;break;case w.y.AdminPhishingReviewForm:e=this.ne.getAdminPhishingReviewForm}this.Se=e.bind(this.ne)}}return n.prototype.add=function(n){return this.ye.SyncContext===w.y.LocalForm?new Promise((function(){})):this.ye.SyncContext===w.y.DesignTimeForm?this.ne.createForm(n):void(0,v._y)("Trying to create a form without design type.")},n.prototype.delete=function(n){var t=this;if(this.ye.SyncContext===w.y.DesignTimeForm)return this.Fe(),(0,m.md)((function(){return!0}))?this.ye.ensureFieldsReady([Q.Schema.BusinessCdsId,Q.Schema.BusinessCdsRegion]).then((function(){return t.ne.deleteForm(t.ye.Model.Id,t.ye.Model.BusinessCdsId,t.ye.Model.BusinessCdsRegion)})):this.ne.deleteForm(this.ye.Model.Id);(0,v._y)("Trying to delete a form without design type.")},n.prototype.query=function(n){var t=this;if((0,m.md)((function(){return!0}))&&this.ye.IsSampleForm)return Promise.resolve(null);if(!this.Se){return Promise.reject({innerCode:1001,type:"ExpectedFailure"})}var e=this.ye.isFieldReady(this.ye.Schema.Flags)&&S(this.ye.Model.Flags),o=this.Ce(e),u=this._e(n,o);return Promise.all(u).then((function(n){return i.extend.apply(i,(0,r.ev)([{}],n,!1))})).then((function(e){var r=c.d.getFieldSchemaInfo(t.ye.Schema.Flags).Attributes.SourceFieldName;return n.indexOf(r)>=0&&!S(e.flags)&&(e.archivedRowCount=0),e}))},n.prototype.update=function(n){if(!(0,m.md)((function(){return!0}))||!this.ye.IsSampleForm){if(this.ye.SyncContext===w.y.LocalForm)return new Promise((function(){}));if(this.ye.SyncContext!==w.y.DesignTimeForm)return Promise.resolve();var t=c.d.getFieldSchemaInfo(Q.Schema.SoftDeleted).Attributes.SourceFieldName;if(t in n)n[t]===b.d.SoftDeleted&&this.Fe();else if(this.ye.isFieldReady(Q.Schema.SoftDeleted)&&this.ye.Model.SoftDeleted===b.d.SoftDeleted)return Promise.resolve();return""!==n.title||(0,p.y)()||(n.title=(0,g.pm)().Designer_DefaultFormTitle),this.ne.updateForm(this.ye.Model.Id,n)}},n.prototype._e=function(n,t){var e=[],r=new Set;n.forEach((function(n){t.hasOwnProperty(n)?r.add(t[n]):e.push(n)}));var i=[];return e.length&&i.push(this.Se(this.ye.Model.Id,e)),r.forEach((function(n){return i.push(n())})),i},n.prototype.Ce=function(n){var t=this,e={localizedResources:function(){if(!(0,p.sv)())return t.ye.getAllLocaleResources()}};if(n){e.archivedRowCount=function(){return t.ne.getArchiveAndActiveResponseCount({$formId:t.ye.Model.Id}).then((function(n){return{rowCount:n.active,archivedRowCount:n.archive}}))}}return e},n.prototype.Fe=function(){var n=this;return this.ne.removeRecentForm(this.ye.Model.Id).then((function(){var t=Forms.Mru.MruDocumentCollectionMaster.getInstance();t&&t.removeDocument(n.ye.Model.Id)}))},n}();function S(n){return(128&n)>0}var F=e(82963),C=e(94956),_=e(73293),T=e(53907),P=e(90819),N=e(3920),k=e(502),E=function(){function n(n){this.fe=n,this.ne=(0,I.lK)(this.fe.Form)}return n.prototype.add=function(n){if(!n.localeId||!n.localeName||this.fe.Form.SyncContext!==w.y.DesignTimeForm)return Promise.resolve();var t={elementKey:"localename",elementValue:n.localeName,locale:n.localeId,questionId:""};return this.ne.createLocaleItem(this.fe.FormId,t)},n.prototype.delete=function(n){return n.localeId&&this.fe.Form.SyncContext===w.y.DesignTimeForm?this.ne.deleteLocale(this.fe.FormId,n.localeId):Promise.resolve()},n.prototype.query=function(n){throw Error("No scenario to call this method currently.")},n.prototype.update=function(n,t){if(!t.ValuesBefore||!n.localeName||this.fe.Form.SyncContext!==w.y.DesignTimeForm)return Promise.resolve();var e=null!==t.ValuesBefore.localeName,r={elementKey:"localename",elementValue:n.localeName,locale:this.fe.Model.localeId,questionId:null};return e?this.ne.updateLocaleItem(this.fe.FormId,r):this.ne.createLocaleItem(this.fe.FormId,r)},n}(),R={localeId:f.J4.string({IsKeyField:!0}),localeName:f.J4.string()},O=function(n){function t(e){return n.call(this,e,{Scheduler:new C.b(t.name)})||this}return(0,r.ZT)(t,n),Object.defineProperty(t.prototype,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),t}(c.d.createObjectMasterClass("LocaleInfoMaster",R,(function(n){return new E(n)}))),D=e(91091),x=e(64966),L=function(){function n(n,t){this.Te=n,this.ne=(0,I.lK)(this.Te.getForm())}return n.prototype.Pe=function(){return this.Te.getFormId()},n.prototype.add=function(n){return this.ne.createPermissionToken(this.Pe(),n)},n.prototype.delete=function(n){return this.ne.deletePermissionToken(this.Pe(),n.principalId)},n.prototype.query=function(n){return(0,v._y)("No scenario to call this method currently.")},n.prototype.update=function(n,t){return(0,v._y)("No scenario to call this method currently.")},n}(),M={PrincipalId:f.J4.string({IsSourceGenerated:!0,SourceFieldName:"principalId"}),Type:f.J4.reference({SourceFieldName:"type"}),Name:f.J4.string({SourceFieldName:"name"})};var q,A=function(n){function t(t){return n.call(this,t)||this}return(0,r.ZT)(t,n),t.prototype.getForm=function(){return this.Parent.Parent},t.prototype.getFormId=function(){return this.getForm().Model.Id},t}(c.d.createObjectMasterClass("PermissionToken",M,(function(n,t){return new L(n,t)}))),U=e(20469),V=e(79849);!function(n){n[n.Default=0]="Default",n[n.Shown=1]="Shown",n[n.Closed=2]="Closed"}(q||(q={}));var G=e(96680),B=e(66097),z=e(7174),j={Id:f.J4.string({IsSourceGenerated:!0,IsKeyField:!0,SourceFieldName:"id"}),Description:f.J4.string({SourceFieldName:"description"}),Background:f.J4.fromMasterClass(d.Cu,{SourceFieldName:"background"}),Category:f.J4.string({SourceFieldName:"category"}),Logo:f.J4.fromMasterClass(d.Cu,{SourceFieldName:"logo"}),MeetingId:f.J4.string({SourceFieldName:"meetingId"}),ModifiedDate:f.J4.string({SourceFieldName:"modifiedDate"}),CreatedDate:f.J4.string({SourceFieldName:"createdDate"}),OtherInfo:f.J4.string({SourceFieldName:"otherInfo"}),OwnerId:f.J4.string({SourceFieldName:"ownerId"}),OwnerTenantId:f.J4.string({SourceFieldName:"ownerTenantId"}),OwnerUserType:f.J4.string({SourceFieldName:"ownerUserType"}),CollectionId:f.J4.string({SourceFieldName:"collectionId"}),RowCount:f.J4.number({SourceFieldName:"rowCount"}),ArchivedRowCount:f.J4.number({SourceFieldName:"archivedRowCount"}),SharedBy:f.J4.string({SourceFieldName:"sharedBy"}),SharedFormOwnerName:f.J4.string({SourceFieldName:"ownerDisplayName"}),SharedDate:f.J4.string({SourceFieldName:"dateTimeShared"}),TableId:f.J4.string({IsSourceGenerated:!0,SourceFieldName:"tableId"}),TenantSwitches:f.J4.number({SourceFieldName:"tenantSwitches"}),PrivacyUrl:f.J4.string({SourceFieldName:"privacyUrl"}),Title:f.J4.string({SourceFieldName:"title"}),Version:f.J4.string({SourceFieldName:"version"}),XlWorkbookId:f.J4.string({SourceFieldName:"xlWorkbookId"}),FillOutTimeLimit:f.J4.string({SourceFieldName:"fillOutTimeLimit"}),XlExportingTag:f.J4.string({SourceFieldName:"xlExportingTag"}),XlFileUnsynced:f.J4.boolean({SourceFieldName:"xlFileUnSynced"}),XlUnsyncedReason:f.J4.string({SourceFieldName:"xlUnsyncedReason"}),Permissions:f.J4.collectionOf((function(){return x.LN}),{SourceFieldName:"permissions"}),ResponderPermissions:f.J4.collectionOf((function(){return U.Qq}),{SourceFieldName:"responderPermissions"}),PermissionTokens:f.J4.collectionOf((function(){return A}),{SourceFieldName:"permissionTokens"}),Questions:f.J4.collectionOf(d.zE,{SourceFieldName:"questions"}),DescriptiveElements:f.J4.collectionOf((function(){return _.Jv}),{SourceFieldName:"descriptiveQuestions"}),MovingToRecycleBin:f.J4.boolean({IsLocalField:!0}),FormsInsightsInfo:f.J4.string({SourceFieldName:"formsInsightsInfo"}),SoftDeleted:f.J4.enumeration((function(){return b.d}),{SourceFieldName:"softDeleted",IsNumberTypeInDataSource:!0}),BusinessCdsId:f.J4.string({SourceFieldName:"BusinessCdsId"}),BusinessCdsRegion:f.J4.string({SourceFieldName:"BusinessCdsRegion"}),IsDefaultCds:f.J4.string({SourceFieldName:"IsDefaultCds"}),LastEmbedConfig:f.J4.string({SourceFieldName:"LastEmbedConfig"}),FormsProBranchRules:f.J4.string({SourceFieldName:"FormsProBranchRules"}),MfpBranchingData:f.J4.string({SourceFieldName:"mfpBranchingData"}),CVSimplifiedBranchingSupported:f.J4.string({SourceFieldName:"cvSimplifiedBranchingSupported"}),PipesDetails:f.J4.string({SourceFieldName:"formsProConfiguredPipes"}),FormsProRTTitle:f.J4.string({SourceFieldName:"formsProRTTitle"}),FormsProRTDescription:f.J4.string({SourceFieldName:"formsProRTDescription"}),ResponseThresholdCount:f.J4.string({SourceFieldName:"responseThresholdCount"}),InviteExpiryDays:f.J4.string({SourceFieldName:"inviteExpiryDays"}),FormsProEmbedCode:f.J4.string({SourceFieldName:"formsProEmbedCode"}),FormsProAnswerTagMap:f.J4.collectionOf({name:f.J4.string(),value:f.J4.string(),questionId:f.J4.string()},{IsLocalField:!0}),FormsProAnswerTagMapRT:f.J4.collectionOf({name:f.J4.string(),value:f.J4.string()},{IsLocalField:!0}),FooterText:f.J4.string({SourceFieldName:"footerText"}),ConditionalThankyouMessage:f.J4.string({SourceFieldName:"conditionalThankyouMessage"}),CVDefaultLanguage:f.J4.string({SourceFieldName:"cvDefaultLanguage"}),CustomCssFileName:f.J4.string({SourceFieldName:"customCssFileName"}),CustomDomainSenderEmail:f.J4.string({SourceFieldName:"customDomainSenderEmail"}),ProjectId:f.J4.string({SourceFieldName:"projectId"}),InitialFormId:f.J4.string({SourceFieldName:"initialFormId"}),InitialFormOwnerId:f.J4.string({SourceFieldName:"initialFormOwnerId"}),SurveyFont:f.J4.string({SourceFieldName:"surveyFont"}),HeaderFont:f.J4.string({SourceFieldName:"headerFont"}),Alias:f.J4.string({SourceFieldName:"alias"}),ShortUrl:f.J4.string({SourceFieldName:"shortUrl"}),ProjectName:f.J4.string({SourceFieldName:"projectName"}),ProjectGroupId:f.J4.string({SourceFieldName:"projectGroupId"}),FileUploadStorage:f.J4.string({SourceFieldName:"fileUploadStorage"}),SurveyPermanentId:f.J4.string({SourceFieldName:"surveyPermanentId"}),EmailTemplatesMapping:f.J4.string({SourceFieldName:"emailTemplatesMapping"}),SurveyLastModifiedAt:f.J4.string({SourceFieldName:"surveyLastModifiedAt"}),HeaderEnabled:f.J4.string({SourceFieldName:"headerEnabled"}),HeaderBGImage:f.J4.fromMasterClass(d.Cu,{SourceFieldName:"header"}),HeaderTheme:f.J4.fromMasterClass((function(){return a.Pv.Resolve("ICVMixin").getMixinHeaderThemeMaster()}),{IsLocalField:!0}),BackGroundPositionX:f.J4.string({IsLocalField:!0}),BackGroundPositionY:f.J4.string({IsLocalField:!0}),BackGroundPositionZ:f.J4.string({IsLocalField:!0}),ThemeHeaderBackgroundImageURL:f.J4.string({IsLocalField:!0}),LogoPositionX:f.J4.string({IsLocalField:!0}),LogoPositionY:f.J4.string({IsLocalField:!0}),TitlePositionX:f.J4.string({IsLocalField:!0}),TitlePositionY:f.J4.string({IsLocalField:!0}),LogoSize:f.J4.string({IsLocalField:!0}),HeaderImageFocalPointEnabled:f.J4.string({IsLocalField:!0}),HeaderOtherInfo:f.J4.string({SourceFieldName:"headerOtherInfo"}),HeaderAltText:f.J4.string({SourceFieldName:"headerAltText"}),CustomCSSInLineHeaderToggle:f.J4.string({SourceFieldName:"customCSSInLineHeaderToggle"}),FlowTemplateId:f.J4.string({SourceFieldName:"flowTemplateId"}),InvitesCoolingPeriod:f.J4.number({SourceFieldName:"invitesCoolingPeriod"}),OverSurveySettingEnabled:f.J4.boolean({SourceFieldName:"overSurveySettingEnabled"}),TrackingId:f.J4.string({SourceFieldName:"trackingId"}),ThankYouMessage:f.J4.string({SourceFieldName:"thankYouMessage"}),EmailReceiptEnabled:f.J4.boolean({SourceFieldName:"emailReceiptEnabled"}),Flags:f.J4.number({SourceFieldName:"flags"}),Type:f.J4.reference({SourceFieldName:"type"}),ReputationTier:f.J4.number({SourceFieldName:"reputationTier"}),BufferResponses:f.J4.collectionOf(f.J4.reference({},(function(n){return n.Id.toString()})),{IsLocalField:!0}),CoAuthors:f.J4.collectionOf(f.J4.reference(),{IsLocalField:!0}),DeleteCollaborationPermission:f.J4.boolean({IsLocalField:!0}),LastSyncTime:f.J4.number({IsLocalField:!0}),RtcStatus:f.J4.number({IsLocalField:!0}),HasValidBranching:f.J4.boolean({IsLocalField:!0}),HasQuestionMedia:f.J4.boolean({IsLocalField:!0}),Created:f.J4.string({IsLocalField:!0}),Modified:f.J4.string({IsLocalField:!0}),PredefinedResponses:f.J4.collectionOf({Id:f.J4.number({IsKeyField:!0}),Answers:f.J4.collectionOf({QuestionId:f.J4.string(),Answer:f.J4.reference()})},{IsLocalField:!0}),PrimaryCustomizedThemeColor:f.J4.string({IsLocalField:!0}),QuizQuestionsCount:f.J4.number({IsLocalField:!0}),SecondaryCustomizedThemeColor:f.J4.string({IsLocalField:!0}),Responses:f.J4.collectionOf(f.J4.reference({},(function(n){return n.Id.toString()})),{IsLocalField:!0}),ResponsesCount:f.J4.number({IsLocalField:!0}),XlExportingLocalTag:f.J4.string({IsLocalField:!0}),SerializedSettings:f.J4.string({SourceFieldName:"settings"}),Settings:f.J4.fromMasterClass((function(){return B.w}),{IsLocalField:!0}),SerializedPredefinedResponses:f.J4.string({SourceFieldName:"predefinedResponses"}),TertiaryCustomizedThemeColor:f.J4.string({IsLocalField:!0}),Theme:f.J4.fromMasterClass((function(){return z.I}),{IsLocalField:!0}),ResponseModels:f.J4.collectionOf((function(){return V.KJ}),{IsLocalField:!0}),IntegratedSavingState:f.J4.reference({IsLocalField:!0}),SavingState:f.J4.reference({IsLocalField:!0}),LogoInfo:f.J4.fromMasterClass(d.BF,{IsLocalField:!0}),CreatedFromOneDrive:f.J4.boolean({IsLocalField:!0}),TemplateId:f.J4.string({IsLocalField:!0}),TransferInProgress:f.J4.boolean({IsLocalField:!0}),DataClassificationLabel:f.J4.string(),DefaultLanguage:f.J4.string({SourceFieldName:"defaultLanguage"}),LocaleList:f.J4.collectionOf((function(){return O}),{SourceFieldName:"localeList"}),LocalizedResources:f.J4.collectionOf((function(){return k.k}),{SourceFieldName:"localizedResources"}),CreatedBy:f.J4.string({SourceFieldName:"createdBy"}),FileUploadFormInfo:f.J4.create({errorCode:f.J4.string()},{SourceFieldName:"fileUploadFormInfo"}),ProgressBarEnabled:f.J4.string({SourceFieldName:"progressBarEnabled"}),YouTubeMessageBarState:f.J4.enumeration((function(){return q}),{IsLocalField:!0}),QuizPreviousResponsesCount:f.J4.number({IsLocalField:!0}),NotifiedAdminForApproval:f.J4.boolean({IsLocalField:!0}),SupportedQuestionType:f.J4.reference({IsLocalField:!0})},Q=function(n){function t(e,r,i,o,u,a){void 0===o&&(o=!1);var c=this,f=new s.wU;r=(0,G.xO)(r),(c=n.call(this,r,{Scheduler:new C.b(t.name),MasterReady:f.promise()})||this).initializing=f,c.syncBlocker=u?new s.bC(u):c.initializing,c.isGroupForm=i,c.Ne=o,c.ke=e,c.Re=a;var l=(0,d.mp)();return c.formElementManager=new l(c),c.Oe(r),(0,m.md)((function(){c.initializeHeaderOtherInfoBinder(r)})),c.De(r),c.xe(r),t.Rules.forEach((function(n){return c.addRule(n)})),c.Le(),c}return(0,r.ZT)(t,n),t.prototype.getSyncBlocker=function(){return this.syncBlocker},Object.defineProperty(t.prototype,"IsGroupForm",{get:function(){return this.isGroupForm},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"IsSampleForm",{get:function(){return this.Ne},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"IsAssignmentForm",{get:function(){return!!this.isFieldReady(this.Schema.Category)&&"assignments"===this.Model.Category},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"SyncContext",{get:function(){return this.ke},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"FormElementManager",{get:function(){return this.formElementManager},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"SettingMaster",{get:function(){return c.d.getObjectMasterFromModel(this.Model.Settings)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ThemeMaster",{get:function(){return c.d.getObjectMasterFromModel(this.Model.Theme)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"HeaderThemeMaster",{get:function(){return c.d.getObjectMasterFromModel(this.Model.HeaderTheme)},enumerable:!1,configurable:!0}),t.prototype.getRelatedSourceFields=function(n){return(0,G.sQ)(n)},t.prototype.getImageMaster=function(n){return(0,P.rQ)(this.getModelByFieldSchema(n))},t.prototype.getImageSettingsMaster=function(n){return(0,N.Hi)(this.getModelByFieldSchema(n))},t.prototype.getQuestionById=function(n){return this.formElementManager.getQuestionById(n)},t.prototype.getElementById=function(n){return this.formElementManager.getElementMasterById(n)},t.prototype.getReleasedResponsesByResponder=function(n){var t=this;return n&&!this.SettingMaster.Model.IsAnonymous?(0,F.Od)(this,n).then((function(n){return(0,l.M0)()?t.Re.normalizeResponses(n):t.normalizeResponses(n)})):Promise.resolve(null)},t.prototype.getRuntimeResponse=function(n){var t=this;return n?(0,F.mt)(this,n).then((function(n){return t.Me(n)})):Promise.resolve(null)},t.prototype.ensureReadyToResponse=function(){return this.ensureFieldsReady((0,G.Co)())},t.prototype.ensureReadyToShare=function(){return this.ensureFieldsReady((0,G.ez)())},t.prototype.getDefaultResponse=function(){var n={};return(0,h.Es)()&&i.forEach(this.Model.Questions,(function(t){return n[t.Id]=t.DefaultValue})),n},t.prototype.hasSection=function(){return this.FormElementManager.SectionMasters.length>0},t.prototype.syncRuntimeResponses=function(){var n=this;return this.Synchronizer.existingInDataSource().then((function(){return(0,F.Lu)(n)})).then((function(t){n.updatingResponsesFromServer=!0,n.bulkEdit((function(){return n.Model.Responses=n.normalizeResponses(t)})),n.updatingResponsesFromServer=!1}))},t.prototype.submitResponse=function(n){var t=this;if(this.syncBlocker.states()===s.Cb.Pending)return Promise.resolve(void 0);var e=!1;return(n=i.clone(n)).Answers=i.map(n.Answers,(function(n){var r=t.getQuestionById(n.QuestionId);return r&&r.Model&&((n=i.clone(n)).Answer=r.serializeAnswer(n.Answer),"Question.TextField"===r.Model.Type&&!e&&r.Model.IsMathQuiz&&(e=!0)),n})),e&&this.qe(n),new Promise((function(e){t.Synchronizer.existingInDataSource().then((function(){return e((0,F.qs)(t,n))}))}))},t.prototype.getSnapshotToCopy=function(){var n=this.getSnapshot((0,G.DV)()),t=null;return n.XlWorkbookId&&((t=i.clone(n)).XlWorkbookId="WaitingForExport"),this.Model.OwnerTenantId!==(0,o.k0)().userInfo.TenantId&&n.DataClassificationLabel&&(t||(t=i.clone(n)),t.DataClassificationLabel=null),(0,m.md)((function(){n.CustomCssFileName&&(t||(t=i.clone(n)),t.CustomCssFileName=null)})),null===t?n:t},t.prototype.getLocaleResouceById=function(n){var t=this;return(0,I.o7)(this.Model.Id).getLocaleResource(this.Model.Id,n).then((function(n){var e=(0,D.n$)(n);return t.ensureFieldsReady([t.Schema.Questions]).then((function(){return t.Ae(e)}))}))},t.prototype.Ae=function(n){var t=this;return i.forEach(n.localizedResources,(function(n){i.forEach(n.questionResources,(function(n){n.choices=i.filter(i.map(n.choices,(function(e){var r=t.getQuestionById(n.questionId),i=r&&(r.getChoiceByKey(e.key)||r.getChoiceById(Number(e.choiceId)));return i&&{key:i.Model.Key,choiceId:String(i.Model.Id),description:e.description}})),(function(n){return!!(n&&n.choiceId&&n.key&&n.description)}))}))})),n},t.prototype.totalSectionCount=function(){return this.formElementManager.SectionMasters.length+(this.formElementManager.HeaderTopQuestionMasters.length>0?1:0)},t.prototype.isProgressBarVisible=function(){return!!this.isFieldReady(t.Schema.ProgressBarEnabled)&&("true"===this.Model.ProgressBarEnabled&&this.totalSectionCount()>=2)},t.prototype.ensureFieldsReady=function(t){return n.prototype.ensureFieldsReady.call(this,t)},t.prototype.De=function(n){n.ExistingInDataSource?this.isFieldReady(t.Schema.ModifiedDate)&&(this.Model.Modified=this.Model.ModifiedDate):this.Model.Modified=(new Date).toISOString()},t.prototype.xe=function(n){n.ExistingInDataSource?this.isFieldReady(t.Schema.CreatedDate)&&(this.Model.Created=this.Model.CreatedDate):this.Model.Created=(new Date).toISOString()},t.prototype.Oe=function(n){this.Ue=new T.S(this,t.Schema.OtherInfo,(0,G.gD)()),n.InitialData&&this.isFieldReady(t.Schema.OtherInfo)&&(n.ExistingInDataSource||n.InitialData.OtherInfo?this.Ue.deserialize():this.Ue.serialize())},t.prototype.initializeHeaderOtherInfoBinder=function(n){var e=this;(0,m.md)((function(){e.Ve=new T.S(e,t.Schema.HeaderOtherInfo,(0,G.Av)()),n.InitialData&&e.isFieldReady(t.Schema.HeaderOtherInfo)&&(n.ExistingInDataSource||n.InitialData.HeaderOtherInfo?e.Ve.deserialize():e.Ve.serialize())}))},t.prototype.normalizeResponses=function(n){var t=this;return this.bulkEdit((function(){n=n.map((function(n){return t.Me(n)}))})),n},t.prototype.Me=function(n){var t=this.Model.Settings.IsQuizMode&&this.SyncContext!==w.y.ResponseTimeForm,e={};this.FormElementManager.QuestionMasters.forEach((function(n){return e[n.Model.Id]=n})),(n=i.clone(n)).Answers=i.map(n.Answers,(function(n){var r=e[n.QuestionId];return r?((n=i.clone(n)).Answer=r.deserializeAnswer(n.Answer),n.IsMathAnswer=!r.Model.IsAnswerPlainText,null==n.Score&&t&&r.autoGradeAnswer(n),n):null})).filter((function(n){return!!n}));var r=this.getResponseModelById(n.Id);return r&&((0,V._p)(r).updateWithNormalizedResponse(n),n=r),n},t.prototype.getResponseModelById=function(n){return c.d.Collection.getItemWithKeyFields(this.Model.ResponseModels,{Id:n})},t.prototype.qe=function(n){var t=this,e={QuestionCount:0,GradableQuestionCount:0,MathResponses:0,MathGradableResponses:0,TextResponses:0,TextGradableResponses:0,EmptyResponses:0,TotalLength:0};i.forEach(n.Answers,(function(n){var r=t.getQuestionById(n.QuestionId);if(r&&r.Model&&"Question.TextField"===r.Model.Type&&r.Model.IsMathQuiz){r.hasCorrectAnswers()?e.GradableQuestionCount++:e.QuestionCount++;var i=(0,u.d)(n.Answer);null!=i&&i.Answer?(e.TotalLength+=i.Answer.length,r.hasCorrectAnswers()?i.IsMath?e.MathGradableResponses++:e.TextGradableResponses++:i.IsMath?e.MathResponses++:e.TextResponses++):e.EmptyResponses++}}))},t.prototype.Le=function(){var n=this;this.formElementManager.adjustElementOrders();var e=[t.Schema.Questions,t.Schema.DescriptiveElements],r=this.Re;this.addRule({Name:"ElementOrder",InterestedFields:e,onChange:function(){r&&!r.isFormLoadingComplete()||n.formElementManager.adjustElementOrders()}})},Object.defineProperty(t,"Rules",{get:function(){if(!t.rules){var n=t.Schema;t.rules=[{Name:"DeserializeSettings",InterestedFields:[n.SerializedSettings],onChange:function(n){if(!n.BeingDeleted){var t=n.Master.Model.SerializedSettings||"{}",e=JSON.parse(t);n.Master.setData({Settings:e})}}},{Name:"DeserializePredefinedResponses",InterestedFields:[n.SerializedPredefinedResponses],onChange:function(n){if(!n.BeingDeleted){var t=n.Master.Model.SerializedPredefinedResponses||"[]",e=JSON.parse(t);n.Master.setData({PredefinedResponses:e})}}},{Name:"QuestionMediaProperties",InterestedFields:[n.Questions,n.DescriptiveElements],onChange:function(n){var t=n.Master.Model,e=c.d.convertToArray(n.Master.getSnapshot().Questions),r=c.d.convertToArray(n.Master.getSnapshot().DescriptiveElements);t.HasQuestionMedia=e.some((function(n){return!(!n.ImageInfo.ResourceUrl&&!n.VideoInfo.Url)}))||r.some((function(n){return!(!n.ImageInfo.ResourceUrl&&!n.VideoInfo.Url)}))}},{Name:"QuestionBranchValidity",InterestedFields:[n.Questions,n.DescriptiveElements],onChange:function(n){var e=n.Master.Model,r=!1;n.Master.isFieldReady(t.Schema.Questions)&&(r=c.d.convertToArray(n.Master.Model.Questions).some((function(n){return c.d.getObjectMasterFromModel(n).hasValidBranching()})));var i=!1;n.Master.isFieldReady(t.Schema.DescriptiveElements)&&(i=c.d.convertToArray(n.Master.Model.DescriptiveElements).some((function(n){return n.BranchInfo&&c.d.getObjectMasterFromModel(n.BranchInfo).isValid()})));e.HasValidBranching=r||i;var o=c.d.convertToArray(n.Master.getSnapshot().Questions);e.QuizQuestionsCount=o.filter((function(n){return n.IsQuiz})).length}}]}return t.rules},enumerable:!1,configurable:!0}),t}(c.d.createObjectMasterClass("FormMaster",j,(function(n,t){return n.getSyncBlocker().promise().then((function(){return new y(n,t)}))})))},25366:function(n,t,e){"use strict";e.d(t,{H:function(){return a}});var r=e(12611),i=e(26203),o=e(73293),u=e(71860),s=e(72374),a=function(){function n(n){this.formMaster=n}return Object.defineProperty(n,"QuestionOrderFloor",{get:function(){return 500},enumerable:!1,configurable:!0}),Object.defineProperty(n,"QuestionOrderDefaultStep",{get:function(){return 100},enumerable:!1,configurable:!0}),n.isDescriptiveElement=function(n){return"Question.ColumnGroup"===n},n.isSection=function(n){return"Question.ColumnGroup"===n},Object.defineProperty(n.prototype,"TopQuestionMasters",{get:function(){return r.filter(this.formMaster.Model.Questions,(function(n){return!n.GroupId})).map(i.d.getObjectMasterFromModel)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"HeaderTopQuestionMasters",{get:function(){var n=this.SectionMasters,t=n.length&&n[0].Model.Order;return t>0?this.Ge(null,t):this.TopQuestionMasters},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"HeaderQuestionMasters",{get:function(){var n=this.SectionMasters,t=n.length&&n[0].Model.Order;return t>0?this.Ge(null,t,!0):this.QuestionMasters},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"QuestionMasters",{get:function(){return i.d.convertToArray(this.formMaster.Model.Questions).map(i.d.getObjectMasterFromModel)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"DescriptiveElementMasters",{get:function(){return i.d.convertToArray(this.formMaster.Model.DescriptiveElements).map(i.d.getObjectMasterFromModel)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"SectionMasters",{get:function(){return r.filter(this.DescriptiveElementMasters,(function(t){return n.isDescriptiveElement(t.Model.Type)}))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"AllElementMasters",{get:function(){return this.getAllElements().map(i.d.getObjectMasterFromModel)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"TopElementMasters",{get:function(){return this.Be(!0).map(i.d.getObjectMasterFromModel)},enumerable:!1,configurable:!0}),n.prototype.getQuestionById=function(n){var t=i.d.Collection.getItemWithKeyFields(this.formMaster.Model.Questions,{Id:n});return t&&(0,s.vV)(t)},n.prototype.getElementMasterById=function(n){return this.getQuestionById(n)||this.getDescriptiveElementMasterById(n)},n.prototype.getDescriptiveElementMasterById=function(n){var t=i.d.Collection.getItemWithKeyFields(this.formMaster.Model.DescriptiveElements,{Id:n});return t&&(0,o.PQ)(t)},n.prototype.findQuestionsInSection=function(n,t){if(n){var e=this.SectionMasters,i=r.indexOf(e,n);return i>=0?this.Ge(e[i].Model.Order,i+1<e.length?e[i+1].Model.Order:null,t):[]}return t?this.HeaderQuestionMasters:this.HeaderTopQuestionMasters},n.prototype.findContainerSection=function(n){var t=this.SectionMasters;return t[r.findLastIndex(t,(function(t){return t.Model.Order<=n.Model.Order}))]},n.prototype.adjustElementOrders=function(){var t=this;if(this.formMaster.isFieldReady(u.x.Schema.Questions)){var e=this.formMaster.isFieldReady(u.x.Schema.DescriptiveElements),r=this.getAllElements();r.length&&this.formMaster.bulkEdit((function(){r.sort(n.questionComparer),r[0].Order||(r[0].Order=n.QuestionOrderFloor+n.QuestionOrderDefaultStep);for(var i=0,o=r[0].Order,u=1;u<=r.length;++u){var s=r[u]&&r[u].Order;if(!s)break;if(o!==s){var a=(s-o)/(u-i);for(o+=a;++i<u;)r[i].Order=o,o+=a}}for(;++i<r.length;)o+=n.QuestionOrderDefaultStep,r[i].Order=o;t.formMaster.Model.Questions=r.filter((function(t){return!n.isDescriptiveElement(t.Type)})).map((function(n){return n})),e&&(t.formMaster.Model.DescriptiveElements=r.filter((function(t){return n.isDescriptiveElement(t.Type)})))}))}},n.prototype.getSectionNodes=function(){var n=this,t=[],e=this.HeaderTopQuestionMasters;return e.length&&t.push({TopQuestionMasters:e}),this.SectionMasters.forEach((function(e){t.push({Section:e,TopQuestionMasters:n.findQuestionsInSection(e)})})),t},n.prototype.getAllElements=function(){return this.Be(!1)},n.prototype.Be=function(t){var e=i.d.convertToArray(this.formMaster.Model.Questions);t&&(e=r.filter(e,(function(n){return!n.GroupId})));var o=e;return this.formMaster.isFieldReady(u.x.Schema.DescriptiveElements)&&(o=o.concat(i.d.convertToArray(this.formMaster.Model.DescriptiveElements)).sort(n.questionComparer)),o},n.questionComparer=function(n,t){var e=n.Order-t.Order;return n.Order&&t.Order||(e=-e),e||n.Id.localeCompare(t.Id)},n.prototype.Ge=function(n,t,e){var r;return r=e?this.QuestionMasters:this.TopQuestionMasters,null!==t&&(r=r.filter((function(n){return t>n.Model.Order}))),null!==n&&(r=r.filter((function(t){return t.Model.Order>=n}))),r},n}()},51586:function(n,t,e){"use strict";e.d(t,{OM:function(){return S},Si:function(){return b},ZP:function(){return y},iZ:function(){return I},jg:function(){return w}});e(7174);var r=e(12611),i=e(94290),o=e(9947),u=e(26203),s=e(73252),a=e(37076),c=e(72467),f=e(41350),l=e(64290),h=e(9743),d=e(71860),m=e(96680),v={},p={},g=new f.Y;function b(n){return w(n,!0)}function w(n,t,e){if(void 0===e&&(e=!1),n.Id)return y(n,e);if(t?(n.OwnerId=n.OwnerId||(0,i.av)(),!n.OwnerId&&(0,c.f5)().Model.GroupMaster&&(n.OwnerId=(0,c.f5)().Model.GroupMaster.Model.id),(0,l.md)((function(){(0,s.cr)("CustomerVoiceSharingV2AllProject")&&(n.OwnerId=(0,c.f5)().Model.CurrentProject.ADGroupId)})),n.OwnerTenantId=n.OwnerTenantId||(0,i.jM)()||(0,o.k0)().userInfo.TenantId):(n.OwnerId=n.OwnerId||(0,o.k0)().userInfo.UserId,n.OwnerTenantId=n.OwnerTenantId||(0,o.k0)().userInfo.TenantId),!n.OwnerId||!n.OwnerTenantId)throw new Error("Form OwnerId or OwnerTenantId cannot be null!");return function(n,t,e){var i=(0,m.pf)().map(u.d.getFieldSchemaInfo).map((function(n){return n.Name})),o=new((0,c.Ed)())(h.y.DesignTimeForm,{ExistingInDataSource:!1,InitialData:r.pick(n,i)},"Group"===t,e);return p[o.getInstanceId()]=o,o.existingOnServerSide().then((function(){v[o.Model.Id]=o})),g.trigger(o),o}(n,t?"Group":"User",e)}function I(n,t){var e=new((0,c.Ed)())(h.y.DesignTimeForm,{ExistingInDataSource:!0,InitialData:n},t);return e.forceFieldsReady((0,m.E3)()),p[e.getInstanceId()]=e,g.trigger(e),e.Synchronizer.Model.CreationInProcess=!0,e}function y(n,t,e){void 0===e&&(e=!1);var i=v[n.Id];if(i&&!e){var o=u.d.convertToSourceData(n,d.x.Schema);return i.Synchronizer.onSourceDataReceived(o),i}var s=(0,a.kc)(n.Id);return(n=r.clone(n)).OwnerId=s.OwnerId,n.OwnerTenantId=s.OrgId,n.TableId=s.TableId,i=new((0,c.Ed)())(h.y.DesignTimeForm,{ExistingInDataSource:!0,InitialData:n},s.IsGroupOwner,t),p[i.getInstanceId()]=i,v[n.Id]=i,g.trigger(i),i}function S(n){return v[n]}},96680:function(n,t,e){"use strict";e.d(t,{Av:function(){return m},Co:function(){return p},DV:function(){return l},E3:function(){return v},eT:function(){return w},ez:function(){return g},gD:function(){return d},pf:function(){return h},sQ:function(){return f},xO:function(){return b}});var r,i,o=e(12611),u=e(64290),s=e(62539),a=e(71860),c=e(66097);function f(n){var t=a.x.Schema,e=[];return n.forEach((function(n){switch(n){case"Settings":case t.Settings:e.push(t.SerializedSettings);break;case"Modified":case t.Modified:e.push(t.ModifiedDate);break;case"Created":case t.Created:e.push(t.CreatedDate);break;case"ResponsesCount":case t.ResponsesCount:e.push(t.RowCount);break;case"PredefinedResponses":case t.PredefinedResponses:e.push(t.SerializedPredefinedResponses);break;case"Theme":case t.Theme:e.push(t.Background,t.OtherInfo);break;case"HeaderTheme":case t.HeaderTheme:e.push(t.HeaderBGImage,t.HeaderOtherInfo);break;default:d().covers(n)?e.push(t.OtherInfo):m().covers(n)?e.push(t.HeaderOtherInfo):e.push(n)}})),o.uniq(e)}function l(){var n=a.x.Schema,t=[n.Background,n.Description,n.Logo,n.LogoInfo,n.Questions,n.DescriptiveElements,n.Settings,n.SerializedSettings,n.SoftDeleted,n.Title,n.PrimaryCustomizedThemeColor,n.SecondaryCustomizedThemeColor,n.TertiaryCustomizedThemeColor,n.Theme,n.TrackingId,n.XlWorkbookId,n.ThankYouMessage,n.EmailReceiptEnabled,n.DataClassificationLabel,n.Type,n.DefaultLanguage,n.LocaleList,n.LocalizedResources,n.ReputationTier,n.MeetingId,n.FormsInsightsInfo,n.ProgressBarEnabled,n.FormsProRTTitle,n.FormsProRTDescription,n.FillOutTimeLimit,n.OtherInfo];return(0,u.md)((function(){t.push(n.BusinessCdsId,n.BusinessCdsRegion,n.LastEmbedConfig,n.FormsProBranchRules,n.MfpBranchingData,n.CVSimplifiedBranchingSupported,n.IsDefaultCds,n.PipesDetails,n.FooterText,n.ConditionalThankyouMessage,n.CustomDomainSenderEmail,n.CVDefaultLanguage,n.OverSurveySettingEnabled,n.InvitesCoolingPeriod,n.ResponseThresholdCount,n.InviteExpiryDays,n.OwnerUserType,n.ProjectId,n.SurveyFont,n.HeaderFont,n.Alias,n.ProjectGroupId,n.HeaderEnabled,n.CustomCSSInLineHeaderToggle,n.HeaderAltText,n.HeaderImageFocalPointEnabled,n.HeaderBGImage,n.HeaderTheme,n.BackGroundPositionX,n.BackGroundPositionY,n.BackGroundPositionZ,n.ThemeHeaderBackgroundImageURL,n.LogoPositionX,n.LogoPositionY,n.TitlePositionX,n.TitlePositionY,n.LogoSize,n.FileUploadStorage,n.SurveyLastModifiedAt)})),t}function h(){return l().concat([a.x.Schema.OwnerId,a.x.Schema.OwnerTenantId,a.x.Schema.CollectionId])}function d(){return r||(r=new s.C([a.x.Schema.PrimaryCustomizedThemeColor,a.x.Schema.SecondaryCustomizedThemeColor,a.x.Schema.TertiaryCustomizedThemeColor,a.x.Schema.Theme,a.x.Schema.LogoInfo,a.x.Schema.CreatedFromOneDrive,a.x.Schema.TemplateId])),r}function m(){return i||(i=new s.C([a.x.Schema.HeaderTheme,a.x.Schema.BackGroundPositionX,a.x.Schema.BackGroundPositionY,a.x.Schema.BackGroundPositionZ,a.x.Schema.ThemeHeaderBackgroundImageURL,a.x.Schema.LogoPositionX,a.x.Schema.LogoPositionY,a.x.Schema.TitlePositionX,a.x.Schema.TitlePositionY,a.x.Schema.LogoSize])),i}function v(){var n=a.x.Schema,t=[n.Title,n.ModifiedDate,n.CreatedDate,n.MeetingId,n.FormsInsightsInfo,n.OwnerId,n.OwnerTenantId,n.Description,n.Questions,n.DescriptiveElements,n.Permissions,n.ResponderPermissions,n.PermissionTokens,n.ResponsesCount,n.Settings,n.Theme,n.Logo,n.LogoInfo,n.Background,n.XlWorkbookId,n.XlExportingTag,n.XlFileUnsynced,n.XlUnsyncedReason,n.Category,n.TrackingId,n.PredefinedResponses,n.ThankYouMessage,n.EmailReceiptEnabled,n.Flags,n.ReputationTier,n.DataClassificationLabel,n.Type,n.DefaultLanguage,n.LocaleList,n.LocalizedResources,n.ProgressBarEnabled,n.FormsProRTTitle,n.FormsProRTDescription];return(0,u.md)((function(){t.push(n.BusinessCdsId,n.BusinessCdsRegion,n.PipesDetails,n.FormsProBranchRules,n.MfpBranchingData,n.CVSimplifiedBranchingSupported,n.FooterText,n.ConditionalThankyouMessage,n.CustomCssFileName,n.CustomDomainSenderEmail,n.CVDefaultLanguage,n.OverSurveySettingEnabled,n.InvitesCoolingPeriod,n.Id,n.ResponseThresholdCount,n.InviteExpiryDays,n.OwnerUserType,n.ProjectId,n.SurveyFont,n.HeaderFont,n.Alias,n.ShortUrl,n.ProjectName,n.ProjectGroupId,n.FileUploadStorage,n.SurveyPermanentId,n.FlowTemplateId,n.InitialFormId,n.InitialFormOwnerId,n.HeaderEnabled,n.CustomCSSInLineHeaderToggle,n.HeaderAltText,n.HeaderImageFocalPointEnabled,n.HeaderBGImage,n.BackGroundPositionX,n.BackGroundPositionY,n.BackGroundPositionZ,n.ThemeHeaderBackgroundImageURL,n.LogoPositionX,n.LogoPositionY,n.TitlePositionX,n.TitlePositionY,n.LogoSize,n.HeaderTheme,n.EmailTemplatesMapping,n.SurveyLastModifiedAt)})),t}function p(){var n=a.x.Schema,t=[n.Title,n.ModifiedDate,n.Description,n.Settings,n.Theme,n.Questions,n.DescriptiveElements,n.Logo,n.LogoInfo,n.Background,n.Category,n.PredefinedResponses,n.ThankYouMessage,n.EmailReceiptEnabled,n.DataClassificationLabel,n.Type,n.DefaultLanguage,n.LocaleList,n.ReputationTier,n.ProgressBarEnabled,n.TenantSwitches,n.PrivacyUrl,n.FormsProRTTitle,n.FormsProRTDescription];return(0,u.md)((function(){t.push(n.CustomCssFileName,n.FooterText,n.ConditionalThankyouMessage,n.CVDefaultLanguage,n.FormsProBranchRules,n.MfpBranchingData,n.CVSimplifiedBranchingSupported,n.PipesDetails,n.ResponseThresholdCount,n.InviteExpiryDays,n.OwnerUserType,n.SurveyFont,n.HeaderFont,n.HeaderEnabled,n.CustomCSSInLineHeaderToggle,n.HeaderAltText,n.HeaderBGImage,n.BackGroundPositionX,n.BackGroundPositionY,n.BackGroundPositionZ,n.ThemeHeaderBackgroundImageURL,n.LogoPositionX,n.LogoPositionY,n.TitlePositionX,n.TitlePositionY,n.LogoSize,n.HeaderTheme,n.ProjectGroupId,n.FileUploadStorage,n.SurveyLastModifiedAt)})),t}function g(){var n=a.x.Schema,t=[n.Title,n.ModifiedDate,n.OwnerId,n.OwnerTenantId,n.Description,n.Questions,n.DescriptiveElements,n.Settings,n.Theme,n.Logo,n.LogoInfo,n.Background,n.XlWorkbookId,n.Category,n.Type,n.ProgressBarEnabled,n.FormsProRTTitle,n.FormsProRTDescription];return(0,u.md)((function(){t.push(n.ResponseThresholdCount,n.InviteExpiryDays,n.OwnerUserType,n.HeaderEnabled,n.CustomCSSInLineHeaderToggle,n.HeaderAltText,n.HeaderImageFocalPointEnabled,n.HeaderBGImage,n.BackGroundPositionX,n.BackGroundPositionY,n.BackGroundPositionZ,n.ThemeHeaderBackgroundImageURL,n.LogoPositionX,n.LogoPositionY,n.TitlePositionX,n.TitlePositionY,n.LogoSize,n.HeaderTheme,n.SurveyFont,n.HeaderFont,n.SurveyLastModifiedAt,n.CVSimplifiedBranchingSupported)})),t}function b(n){var t;return n.InitialData&&((n.InitialData.SerializedSettings||n.InitialData.Settings)&&(t=t||{},n.InitialData.SerializedSettings?t.Settings=JSON.parse(n.InitialData.SerializedSettings):t.SerializedSettings=c.w.serialize(n.InitialData.Settings)),(n.InitialData.SerializedPredefinedResponses||n.InitialData.PredefinedResponses)&&(t=t||{},n.InitialData.SerializedPredefinedResponses?t.PredefinedResponses=JSON.parse(n.InitialData.SerializedPredefinedResponses):t.SerializedPredefinedResponses=w(n.InitialData.PredefinedResponses))),t&&((n=o.clone(n)).InitialData=o.extend({},n.InitialData,t)),n}function w(n){return n&&n.length>0?JSON.stringify(n):null}},66097:function(n,t,e){"use strict";e.d(t,{w:function(){return f}});var r,i=e(59312),o=e(26203),u=e(39923),s=e(7645),a=e(81380);!function(n){n[n.NotStarted=1]="NotStarted",n[n.Opened=2]="Opened",n[n.Expired=3]="Expired",n[n.Closed=4]="Closed"}(r||(r={}));var c={LockGivenQuestionsEndDisplayOrder:u.J4.number(),LockGivenQuestionsStartDisplayOrder:u.J4.number(),FormClosed:u.J4.boolean(),FormClosedMessage:u.J4.string(),FormClosedMessageChanged:u.J4.boolean(),TimerEnabled:u.J4.boolean(),TimerEnabledStart:u.J4.boolean(),TimerEnabledEnd:u.J4.boolean(),StartTime:u.J4.string(),EndTime:u.J4.string(),RequiresUniqueResponse:u.J4.boolean(),IsAnonymous:u.J4.boolean(),NotRecordIdentity:u.J4.boolean(),ShuffleAllQuestions:u.J4.boolean(),ShuffleQuestionOrder:u.J4.boolean(),ShowGradedResults:u.J4.boolean(),RespondInAppOnly:u.J4.boolean(),AllowCopy:u.J4.boolean(),ShareToken:u.J4.string(),ManualGradingEnabled:u.J4.boolean(),IsQuizMode:u.J4.boolean(),EmailNotification:u.J4.boolean(),AllowResponderGetAllResponses:u.J4.boolean(),ShowQuestionNumbers:u.J4.boolean(),IsEmailableEntityCreationEnabled:u.J4.boolean(),CDSSyncQuestionResponses:u.J4.boolean(),OverSurveySettingEnabled:u.J4.boolean(),InvitesCoolingPeriod:u.J4.number(),EmailableEntity:u.J4.string(),HideLanguageDropdown:u.J4.boolean(),PauseAndResumeSurvey:u.J4.boolean(),RecordPartialResponse:u.J4.number(),DisableSubmitAnother:u.J4.boolean(),PermissionForResponder:u.J4.boolean()},f=function(n){function t(e){var r=n.call(this,e)||this;return r.addRule({Name:"updateClosedMessage",InterestedFields:[r.Schema.FormClosed],onChange:t.updateClosedMessage}),r.addRule({Name:"updateAllowCopy",InterestedFields:[r.Schema.ShareToken],onChange:t.updateAllowCopy}),r}return(0,i.ZT)(t,n),t.serialize=function(n){var t=o.d.convertToSourceData(n,this.Schema),e=0;return Object.keys(t).forEach((function(n){null==t[n]?delete t[n]:++e})),e>0?JSON.stringify(t):null},t.prototype.getFormStatus=function(){var n=this.Model;if(n.FormClosed)return r.Closed;if(n.TimerEnabled){var t=Date.now();if(null!=n.StartTime&&Date.parse(n.StartTime)>t)return r.NotStarted;if(null!=n.EndTime&&Date.parse(n.EndTime)<t)return r.Expired}return r.Opened},t.prototype.getFormClosedMessage=function(){var n=this.Model;switch(this.getFormStatus()){case r.Closed:return n.FormClosedMessage;case r.NotStarted:return(0,s.pm)().FormSetting_NotStartForm_DefaultMessage.format(new Date(n.StartTime).toLocaleString());case r.Expired:return(0,s.pm)().FormSetting_ExpiredForm_DefaultMessage;default:return}},t.prototype.setSharingStatus=function(n,t){var e=this,r=this.Parent,i=(0,a.lK)(r);return r.existingOnServerSide().then((function(){return i.changeSharingStatus(r.Model.Id,t)})).then((function(n){e.Model.ShareToken=n}))},t.updateClosedMessage=function(n){if(-1===n.FieldSchemas.indexOf(t.Schema.FormClosedMessage)){var e=n.Master.Model;e.FormClosed?null!=e.FormClosedMessage&&(0,s.ay)().then((function(n){return e.FormClosedMessage=n.FormSetting_ClosedForm_DefaultMessage})):e.FormClosedMessage=null}},t.updateAllowCopy=function(n){var t=n.Master.Model;t.AllowCopy=!!t.ShareToken},t}(o.d.createObjectMasterClass("FormSettingsMaster",c))},7174:function(n,t,e){"use strict";e.d(t,{I:function(){return b}});var r,i,o=e(59312),u=e(46407),s=e(9947),a=e(26203),c=e(39923),f=e(78587),l=e(21607),h=e(43367);function d(n){return r||(r=(0,l.RC)(n||(0,h.getIoCDefaultTheme)().Name).then(JSON.parse)),r}function m(n){if(!n)return n;var t=(0,o.pi)({},n),e=n.BackgroundImage,r=n.Thumbnail;return null!=e&&(/^\/Images\//i.test(e)||/^\/formsresources\//i.test(e))&&(t.BackgroundImage=(0,f.Jn)(e)),null!=r&&(/^\/Images\//i.test(r)||/^\/formsresources\//i.test(r))&&(t.Thumbnail=(0,f.Jn)(r)),t}var v=e(9743),p=e(71860),g={BackgroundColor:c.J4.string({IsLocalField:!0}),BackgroundImage:c.J4.string({IsLocalField:!0}),Name:c.J4.string(),PrimaryColor:c.J4.string({IsLocalField:!0}),SecondaryColor:c.J4.string({IsLocalField:!0}),Thumbnail:c.J4.string({IsLocalField:!0})},b=function(n){function t(t){var e=n.call(this,t)||this;if(t.MasterTreeReady){var r=p.x.Schema;t.MasterTreeReady.then((function(){return e.Form.fieldsReady([r.Theme])})).then((function(){return e.Form.ensureFieldsReady([r.PrimaryCustomizedThemeColor,r.SecondaryCustomizedThemeColor,r.TertiaryCustomizedThemeColor,r.Background])})).then((function(){return e.ze()}))}return e}return(0,o.ZT)(t,n),Object.defineProperty(t.prototype,"Form",{get:function(){return this.Parent},enumerable:!1,configurable:!0}),t.prototype.isCustomized=function(){return this.Model.Name===u.FP},t.prototype.getCustomizedTheme=function(){var n=this.Form.Model,t=(0,h.getIoCDefaultTheme)();return{BackgroundColor:n.TertiaryCustomizedThemeColor||t.BackgroundColor,BackgroundImage:n.Background.ResourceUrl,Name:u.FP,PrimaryColor:n.PrimaryCustomizedThemeColor||t.PrimaryColor,SecondaryColor:n.SecondaryCustomizedThemeColor||t.SecondaryColor,Thumbnail:null}},t.prototype.ze=function(){var n=this;this.addRule({Name:"calculate theme basing on name",onChange:function(t){t.BeingDeleted||n.je()}});var t=p.x.Schema;this.Form.observe((function(){return n.je()}),[t.PrimaryCustomizedThemeColor,t.SecondaryCustomizedThemeColor,t.TertiaryCustomizedThemeColor,t.Background.ResourceUrl]),this.je()},t.prototype.je=function(){var n=this,t=this.Model.Name;switch(t){case u.FP:this.setData(this.getCustomizedTheme());break;case u.kC:this.setData((0,h.getIoCDefaultTheme)());break;default:var e=(0,s.k0)().themeConfig;if(e&&"object"==typeof e&&e[t]&&"object"==typeof e[t])return void this.setData(e[t]);this.Qe(t).then((function(t){return n.setData(t)}))}},t.prototype.Qe=function(n){return this.Form.SyncContext!==v.y.ResponseTimeForm?function(n){return(0,o.mG)(this,void 0,Promise,(function(){return(0,o.Jh)(this,(function(t){switch(t.label){case 0:return[4,(i||(i=(0,h.getIoCLazyLoadThemes)()),i)];case 1:return[2,m(t.sent()[n])||(0,h.getIoCDefaultTheme)()]}}))}))}(n):function(n){return(0,o.mG)(this,void 0,Promise,(function(){return(0,o.Jh)(this,(function(t){switch(t.label){case 0:return[4,d(n)];case 1:return[2,m(t.sent()[n])||(0,h.getIoCDefaultTheme)()]}}))}))}(n)},t}(a.d.createObjectMasterClass("FormTheme",g))},93271:function(n,t,e){"use strict";e.d(t,{r:function(){return I},k:function(){return w}});var r=e(59312),i=e(97265),o=e(37890),u=e(26203),s=e(39923),a=e(94605),c=e(94956),f=e(53907),l=e(62539),h=e(82205),d=e(41293),m=e(31442),v=e(81380),p=e(9743),g=function(){function n(n,t){this.He=n,this.ne=(0,v.lK)(this.He.Form)}return Object.defineProperty(n.prototype,"FormId",{get:function(){return this.He.FormId},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"QuestionId",{get:function(){return this.He.QuestionId},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ChoiceId",{get:function(){return this.He.Model.Id},enumerable:!1,configurable:!0}),n.prototype.add=function(n){if(this.He.Form.SyncContext===p.y.DesignTimeForm)return this.ne.createQuestionChoice(this.FormId,this.QuestionId,n);(0,d._y)("Trying to create a choice out of design time.")},n.prototype.delete=function(n){if(this.He.Form.SyncContext===p.y.DesignTimeForm)return this.ne.deleteQuestionChoice(this.FormId,this.QuestionId,this.ChoiceId);(0,d._y)("Trying to delete a choice out of design time.")},n.prototype.query=function(n){return this.ne.getQuestionChoice(this.FormId,this.QuestionId,this.ChoiceId)},n.prototype.update=function(n,t){if(this.He.Form.SyncContext===p.y.DesignTimeForm){if(n)return this.ne.updateQuestionChoice(this.FormId,this.QuestionId,this.ChoiceId,n);try{throw Error("patch choice body null error")}catch(n){(0,m.zU)("DataSourceUpdatingChoiceNull",{stack:n.stack})}return Promise.resolve()}(0,d._y)("Trying to update a choice out of design time.")},n}(),b={Id:s.J4.number({IsSourceGenerated:!0,IsKeyField:!0,SourceFieldName:"id"}),AnswerHint:s.J4.string({SourceFieldName:"description"}),CustomProperties:s.J4.string({SourceFieldName:"customProperties"}),Description:s.J4.string({SourceFieldName:"displayText"}),FormsProDisplayRTText:s.J4.string({IsLocalField:!0}),Order:s.J4.number({SourceFieldName:"order"}),Key:s.J4.string({SourceFieldName:"key"}),IsGenerated:s.J4.boolean({IsLocalField:!0}),IsMathOption:s.J4.boolean({IsLocalField:!0}),BranchInfo:s.J4.fromMasterClass((function(){return a.G}),{IsLocalField:!0}),SavingState:s.J4.reference({IsLocalField:!0}),Level:s.J4.number({SourceFieldName:"level"}),ParentOrder:s.J4.number({SourceFieldName:"parentOrder"}),parentChoiceId:s.J4.number({SourceFieldName:"parentId"})};function w(n){return u.d.getObjectMasterFromModel(n)}var I=function(n){function t(e){var r=this,u=new o.wU;return r=n.call(this,e,{Scheduler:new c.b(t.name),MasterReady:u.promise()})||this,(0,h.vG)(r),r.fieldsReady([r.Schema.Id,r.Schema.Key]).then((function(){r.Model.Key||(r.Model.Key=(0,i.GW)())})),r.$e(e),u.resolve(),r}return(0,r.ZT)(t,n),Object.defineProperty(t.prototype,"Question",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"QuestionId",{get:function(){return this.Question.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Form",{get:function(){return this.Question.Form},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),t.prototype.$e=function(n){this.We=new f.S(this,t.Schema.CustomProperties,t.CustomPropertiesFieldSet),n.InitialData&&this.isFieldReady(t.Schema.CustomProperties)&&(n.ExistingInDataSource||n.InitialData.CustomProperties?this.We.deserialize():this.We.serialize())},Object.defineProperty(t,"CustomPropertiesFieldSet",{get:function(){return t.customPropertiesFieldSet||(t.customPropertiesFieldSet=new l.C([t.Schema.BranchInfo,t.Schema.IsGenerated,t.Schema.IsMathOption,t.Schema.FormsProDisplayRTText])),t.customPropertiesFieldSet},enumerable:!1,configurable:!0}),t}(u.d.createObjectMasterClass("ChoiceV2Master",b,(function(n,t){return new g(n,t)})))},76795:function(n,t,e){"use strict";e.d(t,{L:function(){return d},P:function(){return m}});var r=e(59312),i=e(12611),o=e(63795),u=e(26203),s=e(73252),a=e(7645),c=e(64290),f=e(34212),l=e(58680),h=e(72374),d=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return(0,r.ZT)(t,n),t.getElementTypeName=function(){return"Question.Choice"},t.createDefaultDefinition=function(){var n=[{Description:(0,a.pm)().Designer_Choices_DefaultDescription.format(1),IsGenerated:!0},{Description:(0,a.pm)().Designer_Choices_DefaultDescription.format(2),IsGenerated:!0}],e={Type:t.getElementTypeName(),Title:(0,a.pm)().Question_DefaultTitle,Choices:n,ChoiceType:h.T6.SingleChoice,OptionDisplayStyle:h.h3.ListAll,QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1};return(0,c.md)((function(){(0,s.cr)("CVLeapFrogChoiceQuestionNewUX")&&(e.FormsProOptionsLayout=h.ek.Vertical,e.FormsProOtherChoice={Description:(0,a.pm)().CV_ChoiceQuestion_Add_Other_Choice_Placeholder,IsDefault:!0,FormsProDisplayRTText:""},e.FormsProChoiceLimits=!1),(0,s.cr)("CVLeapFrogChoiceQuestionRandomization")&&(e.FormsProRandomizationType=f.Z.None)})),e},t.supportMobileDesign=function(n){return!t.hasInvalidSettingOnMobile(n)&&n.OptionDisplayStyle!==h.h3.Dropdown},t.prototype.verify=function(n){return!this.Model.Required||n&&"[]"!==n?n&&n.length>t.MaxAnswerLength?h.ej.MultiChoiceQuestionLengthLimitError:h.ej.Success:h.ej.RequiredError},t.prototype.isEmpty=function(n){return this.Model.ChoiceType===h.T6.SingleChoice?!n:!n||"[]"===n},t.prototype.getTypeDisplayName=function(){switch(this.Model.ChoiceType){case h.T6.SingleChoice:return(0,a.pm)().QuestionType_SingleChoice;case h.T6.MultiChoice:return(0,a.pm)().QuestionType_MultiChoice;default:throw Error("Choice Question Type Not Supported")}},t.prototype.supportsQuestionLevelBranching=function(){return this.Model.ChoiceType!==h.T6.SingleChoice},t.prototype.supportsChoiceLevelBranching=function(){return this.Model.ChoiceType===h.T6.SingleChoice},t.prototype.getSnapshotWithoutBranchInfo=function(){var t=n.prototype.getSnapshotWithoutBranchInfo.call(this);return t.Choices=u.d.convertToArray(t.Choices).map((function(n){return delete(n=i.clone(n)).BranchInfo,n})),t},t.prototype.resetBranchInfo=function(){var t=this;n.prototype.resetBranchInfo.call(this),u.d.convertToArray(this.Model.Choices).filter((function(n){return t.getBranchInfoMaster(n.BranchInfo).resetToDefault()})),this.getBranchInfoMaster(this.Model.BranchInfoForOtherChoice).resetToDefault()},t.prototype.insertChoice=function(n,t){var e=this.Model.Choices,r=i.find(e,(function(n){return n.IsGenerated}));if(!r||t&&""!==r.Description){var o=u.d.Collection.addItems(e,[{Description:n,IsMathOption:t}]);r=o[0]}else{var s=u.d.getObjectMasterFromModel(r);(0,c.pd)((function(){s.bulkEdit((function(){r.Description=n,r.IsGenerated=null,r.IsMathOption=t}))}),(function(){var i=[];i.push(r);var o=u.d.Collection.addItems(e,[{IsGenerated:null,Description:n,IsMathOption:t}]);e=u.d.Collection.deleteItems(e,i),r=o[0]}))}return r},t.prototype.hasCorrectAnswers=function(n){return n?i.some(n.IsAnswerKeys):i.some(this.Model.Choices,(function(n){return n.IsAnswerKey}))},t.prototype.isCorrectAnswer=function(n){var t=m(n,this.Model).SelectedOptions.map((function(n){return(0,o.bC)(n)})).sort(),e=u.d.convertToArray(this.Model.Choices).filter((function(n){return n.IsAnswerKey})).map((function(n){return n.Description})).map((function(n){return(0,o.bC)(n)})).sort();return i.isEqual(e,t)},t.prototype.justifyQuestionInfo=function(){var n=this.Master.Model;if(null==n.OptionDisplayStyle){var e=n.ChoiceType===h.T6.SingleChoice&&!n.IsMathQuiz&&!n.AllowOtherAnswer&&n.Choices.length>=t.MinimumOptionsForDropDown;n.OptionDisplayStyle=e?h.h3.Dropdown:h.h3.ListAll}},t.prototype.showAsDropdown=function(){return this.Master.Model.OptionDisplayStyle===h.h3.Dropdown},t.prototype.setAnswerKey=function(n,t){var e=this;this.Master.bulkEdit((function(){n.IsAnswerKey=t,e.Model.ChoiceType===h.T6.SingleChoice&&n.IsAnswerKey&&u.d.convertToArray(e.Model.Choices).forEach((function(t){t.IsAnswerKey&&t!==n&&(t.IsAnswerKey=!1)}))}))},t.prototype.createQuizResult=function(n){if(this.Model.IsQuiz){var t=u.d.convertToArray(this.Model.Choices);return t.some((function(n){return n.IsAnswerKey}))?{IsAnswerCorrect:this.isCorrectAnswer(n),AnswerHints:t.map((function(n){return n.AnswerHint})),IsAnswerKeys:t.map((function(n){return n.IsAnswerKey})),Choices:t.map((function(n){return n.Description})),GradingBasis:this.Model.GradingBasis}:void 0}},t.prototype.autoGradeAnswer=function(t){if(i.some(this.Model.Choices,(function(n){return n.IsAnswerKey}))){var e=this.Model.Point?this.Model.Point:0;t.Score=this.isCorrectAnswer(t.Answer)?e:0,t.IsAutoGraded=!0}else n.prototype.autoGradeAnswer.call(this,t)},t.prototype.autoGradeWithQuizResult=function(n,t){return t?t.IsAnswerCorrect?this.Model.Point:0:null},t.prototype.getBranchingResult=function(t){var e=this;if(this.Model.ChoiceType!==h.T6.SingleChoice)return n.prototype.getBranchingResult.call(this,t);var r=u.d.convertToArray(this.Model.Choices),o=r.filter((function(n){return n.BranchInfo&&u.d.getObjectMasterFromModel(n.BranchInfo).isValid()})),s=u.d.getObjectMasterFromModel(this.Model.BranchInfoForOtherChoice);if(0===o.length&&!s.isValid())return n.prototype.getBranchingResult.call(this,t);var a,c=r.filter((function(n){return e.Je(t,n)})),f=i.intersection(c,o);f.length>0||c.length>0?a=(f[0]||c[0]).BranchInfo:this.isEmpty(t)||(a=this.Model.BranchInfoForOtherChoice);return a?this.getBranchInfoMaster(a).getBranchingResult():{Type:"Pending"}},t.prototype.Je=function(n,t){return t.Description===n},t.MinimumOptionsForDropDown=7,t.MaxAnswerLength=4e3,t}(l.P);function m(n,t){var e=t.ChoiceType===h.T6.SingleChoice;if(null!=n){var r=u.d.convertToArray(t.Choices).map((function(n){return n.Description}));if(!e||!t.AllowOtherAnswer&&!i.contains(r,n))try{var o=JSON.parse(n);if(Array.isArray(o)){if(!o.some((function(n){return!i.isString(n)})))return{IsSingleChoiceAnswer:!1,IsLegacyChoiceAnswer:!1,SelectedOptions:o}}else if(i.isObject(o)){var s=i.values(o);if(!s.some((function(n){return!i.isString(n)})))return{IsSingleChoiceAnswer:e&&s.length<=1,IsLegacyChoiceAnswer:!0,SelectedOptions:s}}}catch(n){}}return{IsSingleChoiceAnswer:e,IsLegacyChoiceAnswer:!1,SelectedOptions:null==n?[]:[n]}}},58680:function(n,t,e){"use strict";e.d(t,{P:function(){return o}});var r=e(12611),i=e(26203),o=function(){function n(n){this.Xe=n}return n.supportMobileDesign=function(n){return!1},n.hasInvalidSettingOnMobile=function(n){return n.ShowSubtitle||!!n.ImageInfo.ResourceUrl||!!n.VideoInfo.Url},Object.defineProperty(n.prototype,"Master",{get:function(){return this.Xe},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"Model",{get:function(){return this.Xe.Model},enumerable:!1,configurable:!0}),n.prototype.isEmpty=function(n){return!n},n.prototype.justifyNumberBoundaries=function(){throw Error("to be overridden")},n.prototype.supportsQuestionLevelBranching=function(){return!0},n.prototype.supportsChoiceLevelBranching=function(){return!1},n.prototype.getBranchedResult=function(n,t){var e=this.getBranchingResult(n);if("Next"===e.Type)e.TargetElement=t;return e},n.prototype.isNumberType=function(){return!1},n.prototype.getNumberValidationErrorMessage=function(n){throw Error("to be overridden")},n.prototype.getValidationErrorMessage=function(){throw Error("to be overridden")},n.prototype.getSnapshotWithoutBranchInfo=function(){var n=r.clone(this.Master.getSnapshot());return delete n.BranchInfo,delete n.BranchInfoForOtherChoice,n},n.prototype.resetBranchInfo=function(){this.getBranchInfoMaster(this.Model.BranchInfo).resetToDefault()},n.prototype.insertChoice=function(n,t){},n.prototype.getNormalizedAnswer=function(n){return n},n.prototype.hasAnswer=function(){return!0},n.prototype.hasCorrectAnswers=function(n){return!1},n.prototype.isCorrectAnswer=function(n){return!1},n.prototype.setAnswerKey=function(n,t){},n.prototype.createQuizResult=function(n){return null},n.prototype.autoGradeAnswer=function(n){var t=!this.Model.Point,e=null==n.Answer||""===n.Answer;(t||e)&&(n.Score=0,n.IsAutoGraded=!0)},n.prototype.autoGradeWithQuizResult=function(n,t){var e=this.Master.Parent;return(e&&e.Model||this.Model).Point||(null==n||""===n)?0:null},n.prototype.serializeAnswer=function(n){return n},n.prototype.deserializeAnswer=function(n){return n},n.prototype.justifyQuestionInfo=function(){},n.prototype.showAsDropdown=function(){},n.prototype.redressGradingBasis=function(){},n.prototype.getBranchInfoMaster=function(n){return i.d.getObjectMasterFromModel(n)},n.prototype.getBranchingResult=function(n){return this.getBranchInfoMaster(this.Model.BranchInfo).getBranchingResult()},n}()},72374:function(n,t,e){"use strict";e.d(t,{T6:function(){return o},pW:function(){return i},h3:function(){return a},ek:function(){return c},MF:function(){return z},ej:function(){return s},le:function(){return u},PA:function(){return r},vV:function(){return B}});var r,i,o,u,s,a,c,f,l=e(59312),h=e(12611),d=e(84358),m=e(37890),v=e(26203),p=e(41293),g=e(39923),b=e(73252),w=e(43367),I=e(72467),y=e(46008),S=e(64290),F=e(31442),C=e(94605),_=e(94956),T=e(90819),P=e(3920),N=e(34212),k=e(53907),E=e(62539),R=e(71860),O=e(82205),D=e(93271),x=e(81380),L=e(9743),M=[],q=function(n){for(;M.shift()!==n;);},A=function(n){return n.then((function(t){return q(n),t})).catch((function(t){throw q(n),t}))},U=function(){function n(n,t){this.Ye=n,this.ne=(0,x.lK)(this.Ye.Form)}return Object.defineProperty(n.prototype,"FormId",{get:function(){return this.Ye.Form.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"QuestionId",{get:function(){return this.Ye.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"QuestionType",{get:function(){return this.Ye.Model.Type},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ExtraQosData",{get:function(){var n=this.Ye.Form;return{WithSection:n.isFieldReady(n.Schema.DescriptiveElements)&&n.hasSection(),FormType:n.isFieldReady(n.Schema.Type)&&null!==n.Model.Type?n.Model.Type:""}},enumerable:!1,configurable:!0}),n.prototype.add=function(n){var t=this;if(this.Ye.Form.SyncContext===L.y.DesignTimeForm){var e=this.Ye.ParentQuestionMaster;return e?e.Synchronizer.existingInDataSource().then((function(){return t.Ze(n)})):this.Ze(n)}(0,p._y)("Trying to create a question without design type.")},n.prototype.delete=function(n){var t=this;this.Ye.Form.SyncContext!==L.y.DesignTimeForm&&(0,p._y)("Trying to delete a question without design type.");var e=this.Ye.ParentQuestionMaster;if(e&&e.Deleted)return Promise.resolve();var r=this.Ye.SubQuestionMasters.map((function(n){return n.Synchronizer.flush()}));return Promise.all(r).then((function(){return t.Ye.createSyncJob((function(){return t.ne.deleteFormQuestion(t.FormId,n.id,t.QuestionType,t.ExtraQosData)}))})).then(null,(function(n){if(n&&621===n.innerCode)return Promise.resolve();throw n}))},n.prototype.query=function(n){(0,p._y)("No scenario to call this method currently.")},n.prototype.update=function(n,t){var e=this;if((0,S.md)((function(){return!0}))&&this.Ye.Form.IsSampleForm)return Promise.resolve();if(this.Ye.Form.SyncContext!==L.y.DesignTimeForm)return Promise.resolve();if("id"in n){var r=n.id,i=t.ValuesBefore.id;(0,F.zU)("DataSourceUpdatingQuestionId",{newId:r,oldId:i})}if(null===n.allowMultipleValues)try{throw Error("allowMultipleValues null error")}catch(n){(0,F.zU)("DataSourceUpdatingQuestionNullAllowMultipleValues",{stack:n.stack})}return this.Ye.createUploadSyncJob((function(){return e.ne.updateFormQuestion(e.FormId,e.QuestionId,e.QuestionType,n,e.ExtraQosData)}))},n.prototype.Ze=function(n){var t=this,e=this.Ye.createSyncJob((function(){return t.nr(n)})).then((function(n){var t=n;return t.FileUploadSPOInfo&&(n.fileUploadSPOInfo={driveId:t.FileUploadSPOInfo.DriveId,errorCode:t.FileUploadSPOInfo.ErrorCode,folderId:t.FileUploadSPOInfo.FolderId,linkInfo:t.FileUploadSPOInfo.linkInfo,anonymousLinkInfo:t.FileUploadSPOInfo.anonymousLinkInfo}),n}));return e.then((function(n){"id"in n&&n.id!==t.QuestionId&&(0,F.zU)("ChangedIdFromServerSide",{formId:t.FormId,newId:n.id,oldId:t.QuestionId})})),e},n.prototype.nr=function(n){var t=this;if("Question.FileUpload"===n.type){if(M.length>0){var e=M[M.length-1].then((function(){return t.ne.createFormQuestion(t.FormId,n,t.ExtraQosData)}),(function(){return t.ne.createFormQuestion(t.FormId,n,t.ExtraQosData)}));return M.push(e),A(e)}var r=this.ne.createFormQuestion(this.FormId,n,this.ExtraQosData);return M.push(r),A(r)}return this.ne.createFormQuestion(this.FormId,n,this.ExtraQosData)},n}(),V=e(46211),G={Id:g.J4.string({IsKeyField:!0,SourceFieldName:"id"}),DefaultValue:g.J4.string({SourceFieldName:"defaultValue"}),ImageInfo:g.J4.fromMasterClass(I.Cu,{SourceFieldName:"image"}),ImageSettings:g.J4.fromMasterClass(I.BF,{IsLocalField:!0}),Order:g.J4.number({SourceFieldName:"order"}),QuestionInfo:g.J4.string({SourceFieldName:"questionInfo"}),Required:g.J4.boolean({SourceFieldName:"required"}),Subtitle:g.J4.string({SourceFieldName:"subtitle"}),CombinedTitle:g.J4.string({SourceFieldName:"title"}),Type:g.J4.reference({SourceFieldName:"type"}),GroupId:g.J4.string({SourceFieldName:"groupId"}),ShowSubtitle:g.J4.boolean({IsLocalField:!0}),Hidden:g.J4.boolean({IsLocalField:!0}),Visible:g.J4.boolean({IsLocalField:!0}),FormsProRTQuestionTitle:g.J4.string({SourceFieldName:"formsProRTQuestionTitle"}),FormsProCalculateSentiment:g.J4.boolean({IsLocalField:!0}),FormsProRTSubtitle:g.J4.string({SourceFieldName:"formsProRTSubtitle"}),FormsProEnableAnswerTag:g.J4.boolean({IsLocalField:!0}),FormsProAnswerTag:g.J4.string({IsLocalField:!0}),FormsProAnswerTagHasError:g.J4.boolean({IsLocalField:!0}),Title:g.J4.string({IsLocalField:!0}),BranchInfo:g.J4.fromMasterClass((function(){return C.G}),{IsLocalField:!0}),IntegratedSavingState:g.J4.reference({IsLocalField:!0}),SavingState:g.J4.reference({IsLocalField:!0}),IsQuiz:g.J4.boolean({SourceFieldName:"isQuiz"}),GradingBasis:g.J4.string({IsLocalField:!0}),Point:g.J4.number({IsLocalField:!0}),AllowMultipleValues:g.J4.boolean({SourceFieldName:"allowMultipleValues"}),AllowOtherAnswer:g.J4.boolean({IsLocalField:!0}),BranchInfoForOtherChoice:g.J4.fromMasterClass((function(){return C.G}),{IsLocalField:!0}),FormsProIsFileUploaded:g.J4.boolean({IsLocalField:!0}),FormsProChoiceLimits:g.J4.boolean({IsLocalField:!0}),FormsProNumberOfSelections:g.J4.number({IsLocalField:!0}),FormsProOptionsLayout:g.J4.enumeration((function(){return c}),{IsLocalField:!0}),FormsProOtherChoice:g.J4.create({Description:g.J4.string(),IsDefault:g.J4.boolean(),FormsProDisplayRTText:g.J4.string()},{IsLocalField:!0}),FormsProRandomizationType:g.J4.enumeration((function(){return N.Z}),{IsLocalField:!0}),FormsProNumberOfRandomizationOptions:g.J4.number({IsLocalField:!0}),OptionDisplayStyle:g.J4.enumeration((function(){return a}),{IsLocalField:!0}),ChoiceGroup:g.J4.collectionOf((function(){return D.r}),{SourceFieldName:"choices"}),Choices:g.J4.collectionOf({Description:g.J4.string(),BranchInfo:g.J4.fromMasterClass((function(){return C.G})),IsAnswerKey:g.J4.boolean(),AnswerHint:g.J4.string(),IsGenerated:g.J4.boolean(),IsMathOption:g.J4.boolean(),FormsProDisplayRTText:g.J4.string()},{IsLocalField:!0}),ChoiceType:g.J4.reference({IsLocalField:!0}),Hint:g.J4.string({IsLocalField:!0}),ShuffleOptions:g.J4.boolean({IsLocalField:!0}),Length:g.J4.number({IsLocalField:!0}),RatingShape:g.J4.enumeration((function(){return u}),{IsLocalField:!0}),LeftDescription:g.J4.string({IsLocalField:!0}),RightDescription:g.J4.string({IsLocalField:!0}),FormsProRTLeftDescription:g.J4.string({IsLocalField:!0}),FormsProRTRightDescription:g.J4.string({IsLocalField:!0}),ShowRatingLabel:g.J4.boolean({IsLocalField:!0}),MinRating:g.J4.number({IsLocalField:!0}),FormsProSmileyList:g.J4.string({IsLocalField:!0}),Multiline:g.J4.boolean({IsLocalField:!0}),IsNumber:g.J4.boolean({IsLocalField:!0}),HasTFRestrictionForPro:g.J4.boolean({IsLocalField:!0}),Placeholder:g.J4.string({IsLocalField:!0}),NumberValidationRule:g.J4.enumeration((function(){return i}),{IsLocalField:!0}),FormsProValidationType:g.J4.enumeration((function(){return r}),{IsLocalField:!0}),NumberMinBoundary:g.J4.string({IsLocalField:!0}),NumberMaxBoundary:g.J4.string({IsLocalField:!0}),FormsProCustomRegEx:g.J4.string({IsLocalField:!0}),FormsProCustomPlaceholder:g.J4.string({IsLocalField:!0}),Date:g.J4.boolean({IsLocalField:!0}),Time:g.J4.boolean({IsLocalField:!0}),FileUploadSPOInfo:g.J4.create({anonymousLinkInfo:g.J4.string(),driveId:g.J4.string(),folderId:g.J4.string(),errorCode:g.J4.string(),linkInfo:g.J4.string()},{SourceFieldName:"fileUploadSPOInfo"}),FileTypes:g.J4.create({Word:g.J4.boolean(),Excel:g.J4.boolean(),PowerPoint:g.J4.boolean(),PDF:g.J4.boolean(),Image:g.J4.boolean(),Video:g.J4.boolean(),Audio:g.J4.boolean()},{IsLocalField:!0}),MaxFileCount:g.J4.number({IsLocalField:!0}),MaxFileSize:g.J4.number({IsLocalField:!0}),HasSpecificFileType:g.J4.boolean({IsLocalField:!0}),CoAuthors:g.J4.collectionOf(g.J4.reference(),{IsLocalField:!0}),IsMathQuiz:g.J4.boolean({IsLocalField:!0}),IsPlainTextInMathField:g.J4.boolean({IsLocalField:!0}),IsAnswerPlainText:g.J4.boolean({IsLocalField:!0}),IsMathInputDefault:g.J4.boolean({IsLocalField:!0}),InputSwitcherDisabled:g.J4.boolean({IsLocalField:!0}),MathTemplateID:g.J4.number({IsLocalField:!0}),MathAriaLabels:g.J4.collectionOf(g.J4.string(),{IsLocalField:!0}),LastMathMLFormula:g.J4.string({IsLocalField:!0}),VideoInfo:g.J4.create({Url:g.J4.string(),Title:g.J4.string(),Author:g.J4.string(),Thumbnail_url:g.J4.string(),OriginalWidth:g.J4.number(),OriginalHeight:g.J4.number(),ShowWarningBar:g.J4.boolean()},{IsLocalField:!0}),TrackingId:g.J4.string({SourceFieldName:"trackingId"}),QuestionTagForIntelligence:g.J4.string({SourceFieldName:"questionTagForIntelligence"}),InsightsInfo:g.J4.string({SourceFieldName:"insightsInfo"}),IsFromSuggestion:g.J4.boolean({SourceFieldName:"isFromSuggestion"}),SuspiciousEvidence:g.J4.number({IsLocalField:!0}),CascadeLevel:g.J4.number({SourceFieldName:"cascadeLevel"}),CascadeFileName:g.J4.string({SourceFieldName:"cascadeFileName"}),CascadeChoiceGroup:g.J4.collectionOf(g.J4.reference(),{IsLocalField:!0})};!function(n){n[n.Number=0]="Number",n[n.Email=1]="Email",n[n.Custom=2]="Custom"}(r||(r={})),function(n){n[n.None=0]="None",n[n.Greater=1]="Greater",n[n.GreaterOrEqual=2]="GreaterOrEqual",n[n.Less=3]="Less",n[n.LessOrEqual=4]="LessOrEqual",n[n.Equal=5]="Equal",n[n.NotEqual=6]="NotEqual",n[n.Between=7]="Between",n[n.NotBetween=8]="NotBetween",n[n.Max=9]="Max"}(i||(i={})),function(n){n[n.SingleChoice=1]="SingleChoice",n[n.MultiChoice=2]="MultiChoice"}(o||(o={})),function(n){n[n.Number=0]="Number",n[n.Star=1]="Star",n[n.Smiley=2]="Smiley",n[n.CheckMark=3]="CheckMark",n[n.Flag=4]="Flag",n[n.Heart=5]="Heart",n[n.Lightbulb=6]="Lightbulb",n[n.Ribbon=7]="Ribbon",n[n.SmileFace=8]="SmileFace",n[n.ThumbLike=9]="ThumbLike",n[n.Trophy=10]="Trophy"}(u||(u={})),function(n){n[n.Success=0]="Success",n[n.RequiredError=1]="RequiredError",n[n.NumberValidationError=2]="NumberValidationError",n[n.QuizWrongChoiceError=3]="QuizWrongChoiceError",n[n.MathLengthError=4]="MathLengthError",n[n.MultiChoiceQuestionLengthLimitError=5]="MultiChoiceQuestionLengthLimitError",n[n.RegExValidationError=6]="RegExValidationError"}(s||(s={})),function(n){n[n.Dropdown=0]="Dropdown",n[n.ListAll=1]="ListAll"}(a||(a={})),function(n){n[n.Vertical=0]="Vertical",n[n.Horizontal=1]="Horizontal"}(c||(c={})),function(n){n[n.Editing=0]="Editing",n[n.Preview=1]="Preview"}(f||(f={}));G.Choices[0],G.ChoiceGroup[0];function B(n){return v.d.getObjectMasterFromModel(n)}var z=function(n){function t(e){var r=this,i=new m.wU;return e.InitialData?(t.resolveQuestionNullTypeIssue(e.InitialData),(e=h.clone(e)).InitialData=h.clone(e.InitialData),void 0!==e.InitialData.CombinedTitle?(0,V.S)(e.InitialData):(0,V.k)(e.InitialData)):(0,p._y)("Question model should created with initial data."),(r=n.call(this,e,{MasterReady:i.promise(),Scheduler:new _.b(t.name)})||this).fieldsReady([t.Schema.ChoiceGroup]).then((function(){v.d.Collection.setComparer(r.Model.ChoiceGroup,(function(n,t){return n.Order-t.Order}));var n=v.d.getCollectionMasterFromModel(r.Model.ChoiceGroup);(0,O.v)(n,n.Schema[0].SavingState,(function(n){var t=[r.Model.SavingState,n];r.Model.IntegratedSavingState=(0,O.IM)(t)}))})),r.re(e),(0,P.CU)(r,t.Schema.ImageInfo,t.Schema.ImageSettings),r.rr(e),r.redressGradingBasis(),r.coAuthorTimers={},r.initializing=i,r}return(0,l.ZT)(t,n),Object.defineProperty(t.prototype,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ImageInfoMaster",{get:function(){return(0,T.rQ)(this.Model.ImageInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ImageSettingsMaster",{get:function(){return(0,P.Hi)(this.Model.ImageSettings)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ParentQuestionMaster",{get:function(){if(!this.isFieldReady(this.Schema.GroupId))return null;var n=this.Model.GroupId;return n&&this.Form.getQuestionById(n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"SubQuestionMasters",{get:function(){var n=this;return this.Form.FormElementManager.QuestionMasters.filter((function(t){return t.Model.GroupId===n.Model.Id}))},enumerable:!1,configurable:!0}),t.prototype.isFieldReady=function(e){return e=t.getSourceFields([e])[0],n.prototype.isFieldReady.call(this,e)},t.prototype.ensureFieldsReady=function(e){return n.prototype.ensureFieldsReady.call(this,t.getSourceFields(e))},t.prototype.fieldsReady=function(e){return n.prototype.fieldsReady.call(this,t.getSourceFields(e))},t.prototype.hasValidVideoUrl=function(){return(0,y.Fp)()?this.ue()&&(0,d.eC)(this.Model.VideoInfo.Url):this.ue()&&(0,d.yk)(this.Model.VideoInfo.Url)},t.prototype.createSyncJob=function(n){var t=this,e=new m.wU,r=e.promise().then((function(){return t.Form.getQuestionSyncBlocker(r)})).then(n);return e.resolve(),r},t.prototype.createUploadSyncJob=function(n){var t=this,e=new m.wU,r=Promise.all([e,this.ae]).then((function(){return t.createSyncJob(n)}));return e.resolve(),this.ae=(0,m.Bx)(r),r},t.prototype.getMethodDelegator=function(){var n=this.Model.Type;this.ir=this.ir||(this.ir={});var t=this.ir[n];t||(t=new((0,w.getIoCQuestionDelegatorClass)(n))(this),this.ir[n]=t);return t},t.prototype.getChoiceById=function(n){var t=h.find(this.Model.ChoiceGroup,(function(t){return t.Id===n}));return t&&(0,D.k)(t)},t.prototype.getChoiceByKey=function(n){var t=h.find(this.Model.ChoiceGroup,(function(t){return t.Key===n}));return t&&(0,D.k)(t)},t.prototype.hasValidBranching=function(){var n=this.Model;return h.map(n.Choices,(function(n){return n.BranchInfo})).concat([n.BranchInfo,n.BranchInfoForOtherChoice]).map(v.d.getObjectMasterFromModel).some((function(n){return n.isValid()}))},t.prototype.re=function(n){this.ce=new k.S(this,t.Schema.QuestionInfo,t.QuestionInfoFieldSet),n.InitialData&&this.isFieldReady(t.Schema.QuestionInfo)&&(n.ExistingInDataSource||n.InitialData.QuestionInfo?this.ce.deserialize():this.ce.serialize()),this.justifyQuestionInfo()},t.prototype.rr=function(n){!n.ExistingInDataSource&&n.InitialData.FileUploadSPOInfo&&(this.Model.FileUploadSPOInfo=null)},t.prototype.hasRuntimeError=function(){var n=this,t=this.Model.FileUploadSPOInfo;return(0,S.md)((function(){(0,b.cr)("CustomerVoiceCDSFileUpload")&&n.Form.isFieldReady(R.x.Schema.FileUploadStorage)&&"cds"===n.Form.Model.FileUploadStorage&&(t=null)})),!!t&&!(!this.Form.SettingMaster.Model.IsAnonymous||!t.anonymousLinkInfo)},t.prototype.ue=function(){return this.Model.VideoInfo&&this.Model.VideoInfo.Url},Object.defineProperty(t,"QuestionInfoFieldSet",{get:function(){return t.questionInfoFieldSet||(t.questionInfoFieldSet=new E.C([t.Schema.VideoInfo,t.Schema.ShowSubtitle,t.Schema.Hidden,t.Schema.BranchInfo,t.Schema.ShowRatingLabel,t.Schema.Point,t.Schema.FormsProCalculateSentiment,t.Schema.ImageSettings,t.Schema.GradingBasis,t.Schema.ChoiceType,t.Schema.Choices,t.Schema.Hint,t.Schema.AllowOtherAnswer,t.Schema.OptionDisplayStyle,t.Schema.ShuffleOptions,t.Schema.BranchInfoForOtherChoice,t.Schema.Length,t.Schema.RatingShape,t.Schema.LeftDescription,t.Schema.RightDescription,t.Schema.Multiline,t.Schema.IsNumber,t.Schema.NumberValidationRule,t.Schema.NumberMinBoundary,t.Schema.NumberMaxBoundary,t.Schema.Date,t.Schema.Time,t.Schema.IsMathQuiz,t.Schema.IsPlainTextInMathField,t.Schema.IsAnswerPlainText,t.Schema.InputSwitcherDisabled,t.Schema.IsMathInputDefault,t.Schema.MathTemplateID,t.Schema.MathAriaLabels,t.Schema.HasSpecificFileType,t.Schema.FileTypes,t.Schema.MaxFileCount,t.Schema.MaxFileSize,t.Schema.MinRating,t.Schema.FormsProChoiceLimits,t.Schema.FormsProIsFileUploaded,t.Schema.FormsProNumberOfRandomizationOptions,t.Schema.FormsProNumberOfSelections,t.Schema.FormsProOptionsLayout,t.Schema.FormsProOtherChoice,t.Schema.FormsProRandomizationType,t.Schema.FormsProRTLeftDescription,t.Schema.FormsProRTRightDescription,t.Schema.FormsProEnableAnswerTag,t.Schema.FormsProAnswerTag,t.Schema.FormsProAnswerTagHasError,t.Schema.HasTFRestrictionForPro,t.Schema.FormsProValidationType,t.Schema.FormsProCustomRegEx,t.Schema.FormsProCustomPlaceholder,t.Schema.FormsProSmileyList])),t.questionInfoFieldSet},enumerable:!1,configurable:!0}),t.resolveQuestionNullTypeIssue=function(n){if(!n.Type){var t={choiceType:n.ChoiceType,date:n.Date,time:n.Time,ratingShape:n.RatingShape,multiline:n.Multiline};n.Type=null!=t.choiceType?"Question.Choice":null!=t.date||null!=t.time?"Question.DateTime":t.ratingShape?"Question.Rating":"Question.TextField",(0,F.zU)("QuestionNullTypeError",{message:"question type resolved",conditions:t,resolvedType:n.Type})}},t.getSourceFields=function(n){return h.uniq(n.map((function(n){return t.QuestionInfoFieldSet.covers(n)?t.Schema.QuestionInfo:n})))},t}(v.d.createObjectMasterClass("QuestionMaster",G,(function(n,t){return new U(n,t)})));Object.keys({verify:null,isEmpty:null,getTypeDisplayName:null,getBranchedResult:null,isNumberType:null,resetBranchInfo:null,getNormalizedAnswer:null,hasAnswer:null,justifyNumberBoundaries:null,getNumberValidationErrorMessage:null,getValidationErrorMessage:null,supportsQuestionLevelBranching:null,supportsChoiceLevelBranching:null,getSnapshotWithoutBranchInfo:null,insertChoice:null,setAnswerKey:null,createQuizResult:null,autoGradeAnswer:null,autoGradeWithQuizResult:null,serializeAnswer:null,deserializeAnswer:null,justifyQuestionInfo:null,showAsDropdown:null,hasCorrectAnswers:null,isCorrectAnswer:null,redressGradingBasis:null}).forEach((function(n){z.prototype[n]=function(){var t=this.getMethodDelegator();return t[n].apply(t,arguments)}}))},46211:function(n,t,e){"use strict";e.d(t,{k:function(){return r},S:function(){return i}});function r(n){if(n.IsMathQuiz&&n.Subtitle){var t=n.Title||"";n.CombinedTitle=t+"⁣"+n.Subtitle}else n.CombinedTitle=n.Title}function i(n){var t=n.CombinedTitle;t&&(t=t.split("⁣")[0]),n.Title=t}},91367:function(n,t,e){"use strict";e.d(t,{E:function(){return s}});var r=e(12611),i=e(97265),o=e(31442),u=function(){return function(n,t,e){this.answer=n,this.id=t||(0,i.GW)(),this.isMath=e}}(),s=function(){function n(t){if(this.lr=[],null!=t.GradingBasis)try{this.lr=JSON.parse(t.GradingBasis)}catch(e){this.lr=[],(0,o.zU)("ShortTextGradingBasisJsonParseFailure",{gradingBasisLength:t.GradingBasis.length,nonAsciiDetected:n.doesContainNonAsciiCharacters(t.GradingBasis)})}else this.lr=[]}return n.prototype.serialize=function(){return JSON.stringify(this.lr)},n.prototype.getAnswers=function(){return r.clone(this.lr)},n.prototype.areAnyAnswersDefined=function(){return 0!==this.lr.length},n.prototype.addAnswer=function(n,t){return!this.dr(n)&&(!this.vr(n)&&(this.lr.push(new u(n,void 0,t)),!0))},n.prototype.updateAnswer=function(n,t,e){if(this.dr(t))return!1;if(this.vr(t,n))return!1;var r=this.pr(n);if(r<0)return!1;var i=this.lr[r];return this.lr[r]=new u(t,i.id,e),!0},n.prototype.deleteAnswer=function(n){var t=this.pr(n);t>=0&&this.lr.splice(t,1)},n.prototype.isCorrect=function(n){return!this.dr(n)&&(n=(n+="").trim().toUpperCase(),null!=r.find(this.lr,(function(t){return t.answer.trim().toUpperCase()===n})))},n.prototype.vr=function(n,t){var e=(n+="").toUpperCase();return null!=r.find(this.lr,(function(n){return n.answer.toUpperCase()===e&&n.id!==t}))},n.prototype.dr=function(n){return null==n||""===n},n.prototype.pr=function(n){return r.findIndex(this.lr,(function(t){return t.id===n}))},n.doesContainNonAsciiCharacters=function(n){for(var t=0;t<n.length;t++)if(n.charCodeAt(t)>127)return!0;return!1},n}()},82205:function(n,t,e){"use strict";e.d(t,{IM:function(){return s},v:function(){return u},vG:function(){return o}});var r=e(12611),i=e(26203);function o(n){var t=n.Synchronizer;t.observe((function(){return a(n)}),[t.Schema.CreationFailed,t.Schema.CreationInProcess,t.Schema.CreationScheduled,t.Schema.UpdateFailed,t.Schema.UpdateInProcess,t.Schema.UpdateScheduled]),a(n)}function u(n,t,e){var o=i.d.convertToArray(n.Model).map(i.d.getObjectMasterFromModel);function u(){var n=o.map((function(n){return n.getModelByFieldSchema(t)}));e(s(n))}u(),n.observe((function(n){n.AddedModels.length&&(o=o.concat(n.AddedModels.map(i.d.getObjectMasterFromModel))),n.RemovedModels.length&&n.RemovedModels.map(i.d.getObjectMasterFromModel).forEach((function(n){n.Synchronizer.deletedFromDataSource().then((function(){o=r.without(o,n),u()}))})),u()}),[t])}function s(n){return r.contains(n,"Saving")?"Saving":r.contains(n,"Scheduled")?"Scheduled":r.contains(n,"Failed")?"Failed":"Idle"}function a(n){var t=n.Synchronizer.Model;t.CreationInProcess||t.UpdateInProcess?n.Model.SavingState="Saving":t.CreationScheduled||t.UpdateScheduled?n.Model.SavingState="Scheduled":t.CreationFailed||t.UpdateFailed?n.Model.SavingState="Failed":n.Model.SavingState="Idle"}},90819:function(n,t,e){"use strict";e.d(t,{dL:function(){return i},Xf:function(){return P},nv:function(){return r},w9:function(){return T},rQ:function(){return C},bN:function(){return _},UO:function(){return F}});var r,i,o=e(59312),u=e(12611),s=e(37890),a=e(26203),c=e(39923),f=e(97265),l=e(41293),h=e(72467),d=e(61018),m=e(31442),v=e(73293),p=e(71860),g=e(72374),b=e(81380),w=function(){function n(n,t){this.gr=n;var e,r=this.gr.Parent;if(r instanceof p.x)e=r;else{if(!(r instanceof g.MF||r instanceof v.Jv))throw"Wrong parent type of ImageInfoMaster.";e=r.Form}var i=e.IsGroupForm?3:2;this.ne=(0,b.lK)(e),this.wr=d.VY.getInstance().createImageProvider(i,e.Model.OwnerTenantId,e.Model.OwnerId);var o=a.d.getFieldSchemaInfo(n.Membership.FieldSchema);this.Ir=o.Attributes.SourceFieldName||o.Name}return n.prototype.add=function(n){return new Promise((function(n){window.setTimeout((function(){n(void 0)}))}))},n.prototype.delete=function(n){return(0,l._y)("not supported")},n.prototype.query=function(n){return(0,l._y)("not supported")},n.prototype.update=function(n){var t,e=n.uploadParameters;return e?(e.Delete?t=this.yr():e.ImageFile?t=this.Sr(e.ImageFile):e.Url&&(t=this.Fr(e.Url,e.Size)),t?t.then((function(n){var t=u.clone(n);return t.uploadParameters=null,t})):void 0):this.Cr()},n.prototype.Cr=function(){var n=this,t=a.d.convertToSourceData(this.gr.getSnapshot(),(0,h.Cu)().Schema);delete t.uploadParameters;var e,r={};r[this.Ir]=t;var i=this.gr.Parent;if(i instanceof p.x)e=this.ne.updateForm(i.Model.Id,r);else{if(!(i instanceof g.MF||i instanceof v.Jv))return(0,l._y)("not supported");var o=i;e=o.createUploadSyncJob((function(){return n.ne.updateFormQuestion(o.Form.Model.Id,o.Model.Id,o.Model.Type,r)}))}return e.then((function(t){return t&&t[n.Ir]}))},n.prototype.Fr=function(n,t){var e=this,r={SourceUrl:n,Title:(0,f.GW)(),Size:t},i=this.gr.Parent;if(i instanceof p.x)return this.ne.createFormImageFromUrl(i.Model.Id,this.Ir,r);if(i instanceof g.MF||i instanceof v.Jv){var o=i;return o.createUploadSyncJob((function(){return e.ne.createQuestionImageFromUrl(o.Form.Model.Id,o.Model.Id,r)}))}return(0,l._y)("not supported")},n.prototype.Sr=function(n){var t=this,e={ImageBlob:n,ImageName:(0,f.GW)(),ImageType:n.type},r=this.gr.Parent;if(r instanceof p.x)return this.wr.uploadFormImage(r.Model.Id,this.Ir,e);if(r instanceof g.MF||r instanceof v.Jv){var i=r;return i.createUploadSyncJob((function(){return t.wr.uploadQuestionImage(i.Form.Model.Id,i.Model.Id,t.Ir,e)}))}return(0,l._y)("not supported")},n.prototype.yr=function(){var n,t=this,e=this.gr.Parent;if(e instanceof p.x)(0,m.$U)("DesignPage.FormImage.Delete"),n=this.wr.deleteFormImage(e.Model.Id,this.Ir);else{if(!(e instanceof g.MF||e instanceof v.Jv))return(0,l._y)("not supported");var r=e;(0,m.$U)("DesignPage.QuestionImage.Delete"),n=r.createUploadSyncJob((function(){return t.wr.deleteQuestionImage(r.Form.Model.Id,r.Model.Id,t.Ir)}))}return n.then(null,(function(n){if(n&&805===n.innerCode)return(0,m.zU)("DeleteImageNotFoundError",{imageUrl:t.gr.Model.ResourceUrl}),Promise.resolve();throw n})).then((function(){return{altText:null,contentType:null,fileIdentifier:null,height:null,imageFile:null,originalFileName:null,resourceId:null,resourceUrl:null,size:null,width:null}}))},n}(),I=e(94956),y=e(82205),S={AltText:c.J4.string({SourceFieldName:"altText"}),ContentType:c.J4.string({SourceFieldName:"contentType"}),FileIdentifier:c.J4.string({SourceFieldName:"fileIdentifier"}),OriginalFileName:c.J4.string({SourceFieldName:"originalFileName"}),ResourceId:c.J4.string({SourceFieldName:"resourceId"}),ResourceUrl:c.J4.string({SourceFieldName:"resourceUrl"}),Width:c.J4.number({SourceFieldName:"width"}),Height:c.J4.number({SourceFieldName:"height"}),UploadParameters:c.J4.reference({SourceFieldName:"uploadParameters"}),ErrorType:c.J4.enumeration((function(){return i}),{IsLocalField:!0}),ResponseError:c.J4.reference({IsLocalField:!0}),ImageProcessingStatus:c.J4.enumeration((function(){return r}),{IsLocalField:!0}),IsPredefined:c.J4.boolean({IsLocalField:!0}),SavingState:c.J4.reference({IsLocalField:!0})};function F(n){if(!n)return!1;if(n.ResourceUrl)return!0;var t=n.UploadParameters;return!!t&&!!t.ImageFile}function C(n){return a.d.getObjectMasterFromModel(n)}function _(n,t,e,r){if(n>e||t>r){var i=Math.min(r/t,e/n);n*=i,t*=i}return{width:n,height:t}}function T(){return{UploadParameters:null,ErrorType:i.NoError,ResponseError:null,ImageProcessingStatus:r.Idle,Width:null,Height:null}}!function(n){n[n.Idle=0]="Idle",n[n.Picking=1]="Picking",n[n.Uploading=2]="Uploading",n[n.Deleting=3]="Deleting"}(r||(r={})),function(n){n[n.NoError=0]="NoError",n[n.SizeTooLarge=1]="SizeTooLarge",n[n.InvalidType=2]="InvalidType",n[n.BrokenImage=3]="BrokenImage",n[n.ServerError=4]="ServerError",n[n.DeleteFailError=5]="DeleteFailError"}(i||(i={}));var P=function(n){function t(e){var o=this,a=new s.wU,c=!e.ExistingInDataSource&&e.InitialData&&!!e.InitialData.ResourceUrl,f=u.clone(e.InitialData);(e=u.clone(e)).InitialData=c?u.extend({},f,{ImageProcessingStatus:r.Uploading}):u.extend({},f,T());var l=new I.b(t.name);l.setMaxRetryTimesForUpdate(0);var h=(o=n.call(this,e,{Scheduler:l,MasterReady:a.promise()})||this).Synchronizer;return h.observe((function(n){var t;u.contains(n.FieldSchemas,h.Schema.CreationError)?t=h.Model.CreationError:u.contains(n.FieldSchemas,h.Schema.UpdateError)&&(t=h.Model.UpdateError),t&&o.bulkEdit((function(){o.Model.ResponseError=t;var n=o.Model.UploadParameters;n&&n.Delete?o.Model.ErrorType=i.DeleteFailError:o.Model.ErrorType=i.ServerError}))}),[h.Schema.CreationError,h.Schema.UpdateError]),o.addRule({InterestedFields:[o.Schema.ResourceId],Name:"ResetErrorStatus",onChange:function(n){!n.BeingDeleted&&o.Model.ResourceId&&o.resetStatus(r.Idle)}}),o.initializing=a,o.duplicatingImage=c,o.originalInitialData=f,(0,y.vG)(o),o}return(0,o.ZT)(t,n),t.prototype.getSettingsMaster=function(){return this._r},t.prototype.setSettingsMaster=function(n){this._r=n},t.prototype.resetStatus=function(n){var t=this.Model;this.bulkEdit((function(){t.ErrorType=i.NoError,t.ResponseError=void 0,t.ImageProcessingStatus=n}))},t}(a.d.createObjectMasterClass("ImageInfoMaster",S,(function(n,t){return new w(n,t)})))},3920:function(n,t,e){"use strict";e.d(t,{CU:function(){return v},Hi:function(){return m},RZ:function(){return r},Vj:function(){return p},h2:function(){return i}});var r,i,o=e(59312),u=e(12611),s=e(9947),a=e(26203),c=e(39923),f=e(687),l=e(71860),h=e(90819),d={Layout:c.J4.enumeration((function(){return r})),Size:c.J4.enumeration((function(){return i})),NaturalWidth:c.J4.number(),NaturalHeight:c.J4.number(),ContainerWidth:c.J4.number(),ContainerHeight:c.J4.number(),ActualWidth:c.J4.number(),ActualHeight:c.J4.number(),Left:c.J4.number(),Top:c.J4.number()};function m(n){return a.d.getObjectMasterFromModel(n)}function v(n,t,e){n.fieldsReady([t]).then((function(){var r=n.getModelByFieldSchema(t),i=(0,h.rQ)(r);n.ensureFieldsReady([e]).then((function(){var t=m(n.getModelByFieldSchema(e));i.setSettingsMaster(t)}))}))}!function(n){n[n.Horizontal=1]="Horizontal",n[n.Vertical=2]="Vertical",n[n.Square=3]="Square"}(r||(r={})),function(n){n[n.Small=1]="Small",n[n.Large=2]="Large"}(i||(i={}));var p=function(n){function t(t){var e=n.call(this,t)||this;return t.MasterTreeReady&&t.MasterTreeReady.then((function(){var n=e.Parent;n instanceof l.x&&n.fieldsReady([l.x.Schema.LogoInfo]).then((function(){n.Model.LogoInfo===e.Model&&(e.Tr=!0)}))})),e}return(0,o.ZT)(t,n),Object.defineProperty(t.prototype,"IsFormLogo",{get:function(){return this.Tr},enumerable:!1,configurable:!0}),t.prototype.validateImageSettings=function(n){var t=u.clone(this.getSnapshot());if(744===t.ContainerWidth&&(t.ContainerHeight=t.ContainerHeight*(0,f.Fy)()/t.ContainerWidth,t.ContainerWidth=(0,f.Fy)(),!n)){var e=this.Model;e.ContainerWidth=t.ContainerWidth,e.ContainerHeight=t.ContainerHeight}if(null==t.ContainerHeight||null==t.ContainerWidth||null==t.ActualHeight||null==t.ActualWidth||null==t.Top){var r=this.getDefaultImageSettings();for(var i in r)t[i]=Math.round(r[i]),n||(this.Model[i]=t[i])}return t},t.prototype.calcLogoLayout=function(n){var t,e,i,o=(this.Model.NaturalWidth||(0,f.vM)())/(this.Model.NaturalHeight||(0,f.HJ)()),u=(n=n||{}).isSmallSize,s=n.isMobile,a=n.isSlimSize;if(s)(e=(t=a?30:u?70:80)*o)>t?(e=(t=a?40:t)*o,i=r.Vertical):i=r.Horizontal;else{var c=void 0;u?(t=70,c=125):a?(t=40,c=95):(t=120,c=215),(e=t*o)>c?(e=(t=a?30:u?40:70)*o,i=r.Vertical):i=r.Horizontal}return{ActualWidth:e=Math.min(e,750),ActualHeight:t,Layout:i}},t.prototype.getDefaultImageSettings=function(){var n,t=this.Model;t.NaturalHeight&&t.NaturalWidth?n={NaturalHeight:t.NaturalHeight,NaturalWidth:t.NaturalWidth}:n={NaturalHeight:t.NaturalHeight||(0,f.HJ)(),NaturalWidth:t.NaturalWidth||(0,f.vM)()};if(!(0,s.k0)().userInfo.IsMsa&&this.IsFormLogo)return n;var e=this.Pr();if(null==e.Height?(n.ContainerWidth=e.Width,n.ContainerHeight=e.Width*n.NaturalHeight/n.NaturalWidth):null==e.Width?(n.ContainerWidth=e.Height*n.NaturalWidth/n.NaturalHeight,n.ContainerHeight=e.Height):(n.ContainerWidth=e.Width,n.ContainerHeight=e.Height),null==e.Height||null==e.Width)n.Left=0,n.Top=0,n.ActualWidth=n.ContainerWidth,n.ActualHeight=n.ContainerHeight;else{var r=Math.max(n.ContainerWidth/n.NaturalWidth,n.ContainerHeight/n.NaturalHeight);n.ActualWidth=r*n.NaturalWidth,n.ActualHeight=r*n.NaturalHeight,n.Left=(n.ContainerWidth-n.ActualWidth)/2,n.Top=(n.ContainerHeight-n.ActualHeight)/2}return n},t.prototype.Pr=function(){var n=this.Model;if(null==n.Size||n.Size===i.Small)switch(n.Layout){case r.Square:return{Width:314,Height:314};case r.Vertical:return{Height:314};case r.Horizontal:default:return{Width:314}}else switch(n.Layout){case r.Square:return{Width:414,Height:414};case r.Vertical:return{Height:414};case r.Horizontal:default:return{Width:(0,f.Fy)()}}},t}(a.d.createObjectMasterClass("ImageSettingsMaster",d))},502:function(n,t,e){"use strict";e.d(t,{k:function(){return v}});var r=e(59312),i=e(12611),o=e(26203),u=e(39923),s=e(94956),a=e(54438),c=e(81380),f=e(9743),l=e(91091),h=function(){function n(n){this.fe=n,this.ne=(0,c.lK)(this.fe.Form)}return n.prototype.add=function(n){var t=this;if(this.fe.Form.SyncContext!==f.y.DesignTimeForm)return Promise.resolve();var e=this.fe.Form;return e?e.Synchronizer.existingInDataSource().then((function(){var n=t.fe.Model.localeId,r=o.d.Collection.getItemWithKeyFields(e.Model.LocaleList,{localeId:n});return o.d.getObjectMasterFromModel(r).Synchronizer.existingInDataSource()})).then((function(){var e,r=[];for(e in n)if(n.hasOwnProperty(e)){var o=(0,l.Lk)(i.pick(n,[e]));null!==o.elementKey&&"localename"!==o.elementKey&&(o.locale=t.fe.Model.localeId,o.questionId="",r.push((0,a.m)(o,t.fe.FormId)))}return Promise.all(r).then((function(n){}))})):Promise.reject()},n.prototype.delete=function(n){throw Error("No scenario to call this method currently.")},n.prototype.query=function(n){throw Error("No scenario to call this method currently.")},n.prototype.update=function(n,t){if(!t.ValuesBefore||this.fe.Form.SyncContext!==f.y.DesignTimeForm)return Promise.resolve();var e,r=[];for(e in n)if(n.hasOwnProperty(e)){var o=null!==t.ValuesBefore[e],u=(0,l.Lk)(i.pick(n,[e]));u.locale=this.fe.Model.localeId,u.questionId="",r.push(o?this.ne.updateLocaleItem(this.fe.FormId,u):this.ne.createLocaleItem(this.fe.FormId,u))}return Promise.all(r).then((function(){}))},n}(),d=e(155),m={conditionalThankyouMessage:u.J4.string(),footerText:u.J4.string(),formCloseMessage:u.J4.string(),formsprortlocalesubtitle:u.J4.string(),formsprortlocaletitle:u.J4.string(),localeId:u.J4.string({IsKeyField:!0}),localeName:u.J4.string(),questionResources:u.J4.collectionOf((function(){return d.A})),subtitle:u.J4.string(),thankYouMessage:u.J4.string(),title:u.J4.string()},v=function(n){function t(e){return n.call(this,e,{Scheduler:new s.b(t.name)})||this}return(0,r.ZT)(t,n),Object.defineProperty(t.prototype,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"LocaleId",{get:function(){return this.Model.localeId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"LocaleName",{get:function(){return this.Model.localeName},enumerable:!1,configurable:!0}),t.getFormResourceMaster=function(n,t){var e=i.find(t.Model.LocalizedResources,(function(t){return t.localeId===n}));if(e)return o.d.getObjectMasterFromModel(e);throw Error("This locale does not exist in form.")},t.getQuestionResourceMaster=function(n,t,e){var r=e.Model.LocalizedResources,i=o.d.Collection.getItemWithKeyFields(r,{localeId:n});if(i){if(i.questionResources||(i.questionResources=[]),i.questionResources.length>0){var u=o.d.Collection.getItemWithKeyFields(i.questionResources,{localeId:n,questionId:t});if(u)return o.d.getObjectMasterFromModel(u)}return(0,l._T)({localeId:n,localeName:i.localeName},t,i,e)}throw Error("This locale does not exist in form.")},t}(o.d.createObjectMasterClass("FormLocalizedItemMaster",m,(function(n){return new h(n)})))},91091:function(n,t,e){"use strict";e.d(t,{Lk:function(){return a},Mn:function(){return m},_T:function(){return h},an:function(){return f},e0:function(){return c},fK:function(){return g},fp:function(){return d},n$:function(){return u},tc:function(){return l}});var r=e(12611),i=e(26203),o=e(31442);function u(n){return{localizedResources:s(n)}}function s(n){var t=function(n){var t=n.filter((function(n){return""===n.questionId})),e=r.groupBy(t,(function(n){return n.locale}));return r.map(e,(function(n){var t={conditionalThankyouMessage:null,footerText:null,formCloseMessage:null,formsprortlocalesubtitle:null,formsprortlocaletitle:null,localeId:null,localeName:null,questionResources:[],subtitle:null,thankYouMessage:null,title:null};return n.forEach((function(n){!function(n,t){switch(n.elementKey){case"thankyoumessage":t.thankYouMessage=n.elementValue;break;case"formclosemessage":t.formCloseMessage=n.elementValue;break;case"footertext":t.footerText=n.elementValue;break;case"conditionalthankyoumessage":t.conditionalThankyouMessage=n.elementValue;break;default:v(n,t)}}(n,t)})),t}))}(n),e=function(n){var t=n.filter((function(n){return n.questionId})),e=r.groupBy(t,(function(n){return n.locale})),i={},o=r.map(e,(function(n,t){var e=r.groupBy(n,(function(n){return n.questionId})),i=r.map(e,(function(n,e){var i={choices:[],choicesV1:[],formsprortlocaleldescription:null,formsprortlocalerdescription:null,formsprocustomplaceholder:null,formsprortlocalesubtitle:null,formsprortlocaletitle:null,leftDescription:null,localeId:t,localeName:null,option:null,questionId:e,rightDescription:null,subtitle:null,title:null,cascadeChoices:null},o=n.filter((function(n){return n.elementKey&&(n.elementKey.startsWith("choiceid_")||n.elementKey.startsWith("choicekey_"))}));if(o&&o.length>0){var u=r.map(o,(function(n){var t={choiceId:null,description:null,key:null};return function(n,t){var e=n.elementKey;e&&e.startsWith("choiceid_")&&(t.choiceId=e.split("_")[1]);e&&e.startsWith("choicekey_")&&(t.key=e.split("_")[1]);t.description=n.elementValue}(n,t),t}));i.choices=u}var s=n.filter((function(n){return n.elementKey&&!(n.elementKey.startsWith("choiceid_")||n.elementKey.startsWith("choicekey_"))}));return s&&s.forEach((function(n){!function(n,t){switch(t.questionId=n.questionId,n.elementKey){case"leftdescription":t.leftDescription=n.elementValue;break;case"rightdescription":t.rightDescription=n.elementValue;break;case"option":t.option=n.elementValue;break;case"formsprortlocaleldescription":t.formsprortlocaleldescription=n.elementValue;break;case"formsprortlocalerdescription":t.formsprortlocalerdescription=n.elementValue;break;case"formsprocustomplaceholder":t.formsprocustomplaceholder=n.elementValue;break;default:v(n,t)}}(n,i)})),i}));return i}));return o.forEach((function(n){var t=n.length>0&&n[0].localeId;t&&(i[t]=n)})),i}(n);return t.forEach((function(n){if(n.localeId){var t=e[n.localeId];t&&(n.questionResources=t)}})),t}function a(n){var t=p(n);return null!=n.formCloseMessage?(t.elementKey="formclosemessage",t.elementValue=n.formCloseMessage):null!=n.thankYouMessage?(t.elementKey="thankyoumessage",t.elementValue=n.thankYouMessage):null!=n.footerText?(t.elementKey="footertext",t.elementValue=n.footerText):null!=n.conditionalThankyouMessage&&(t.elementKey="conditionalthankyoumessage",t.elementValue=n.conditionalThankyouMessage),t}function c(n){var t=p(n);return null!=n.leftDescription?(t.elementKey="leftdescription",t.elementValue=n.leftDescription):null!=n.rightDescription?(t.elementKey="rightdescription",t.elementValue=n.rightDescription):null!=n.option&&'{"choicesV1":[]}'!==n.option?(t.elementKey="option",t.elementValue=n.option):null!=n.formsprortlocaleldescription?(t.elementKey="formsprortlocaleldescription",t.elementValue=n.formsprortlocaleldescription):null!=n.formsprortlocalerdescription?(t.elementKey="formsprortlocalerdescription",t.elementValue=n.formsprortlocalerdescription):null!=n.formsprocustomplaceholder&&(t.elementKey="formsprocustomplaceholder",t.elementValue=n.formsprocustomplaceholder),t}function f(n,t){var e=t.Model;if(!i.d.Collection.getItemWithKeyFields(e.LocalizedResources,{localeId:n.localeId})){var r={footerText:null,formCloseMessage:null,formsprortlocalesubtitle:null,formsprortlocaletitle:null,localeId:n.localeId,localeName:n.localeName,questionResources:[],subtitle:null,thankYouMessage:null,title:null,conditionalThankyouMessage:null};i.d.Collection.itemsAddedInSource(e.LocalizedResources,[r])}}function l(n,t){var e=t.Model,r=i.d.Collection.getItemWithKeyFields(e.LocalizedResources,{localeId:n});r&&i.d.Collection.itemsDeletedInSource(e.LocalizedResources,[r])}function h(n,t,e,o){var u={choices:[],choicesV1:[],formsprortlocaleldescription:null,formsprortlocalerdescription:null,formsprocustomplaceholder:null,formsprortlocalesubtitle:null,formsprortlocaletitle:null,leftDescription:null,localeId:n.localeId,localeName:n.localeName,option:null,questionId:t,rightDescription:null,subtitle:null,title:null,cascadeChoices:null},s=i.d.Collection.getItemWithKeyFields(o.Model.Questions,{Id:t});if(s&&s.ChoiceGroup&&s.ChoiceGroup.length>0){var a=r.map(s.ChoiceGroup,(function(n){return{choiceId:n.Id.toString(),description:null,key:n.Key}}));u.choices=a}var c=i.d.Collection.itemsAddedInSource(e.questionResources,[u]);return i.d.getObjectMasterFromModel(c[0])}function d(n,t,e){var r={choiceId:n,description:null,key:t},o=i.d.Collection.itemsAddedInSource(e.choices,[r]);return i.d.getObjectMasterFromModel(o[0])}function m(n){var t=i.d.Collection.itemsAddedInSource(n.choicesV1,[{choiceId:null,description:"",formsProDisplayRTText:""}]);return i.d.getObjectMasterFromModel(t[0])}function v(n,t){switch(t.localeId=n.locale,n.elementKey){case"title":t.title=n.elementValue;break;case"subtitle":t.subtitle=n.elementValue;break;case"localename":t.localeName=n.elementValue;break;case"formsprortlocaletitle":t.formsprortlocaletitle=n.elementValue;break;case"formsprortlocalesubtitle":t.formsprortlocalesubtitle=n.elementValue;break;default:var e=n.elementValue&&n.elementValue.length,r="Unexpected locale element key:[".concat(n.elementKey,"], value length:").concat(e),i=new Error(r).stack;return console.log(i),void(0,o.zU)("UnexpectedLocaleElementKey","".concat(r,", call stack:").concat(i))}}function p(n){var t={elementKey:null,elementValue:null,locale:null,questionId:null};return null!=n.title?(t.elementKey="title",t.elementValue=n.title):null!=n.subtitle?(t.elementKey="subtitle",t.elementValue=n.subtitle):null!=n.localeName?(t.elementKey="localename",t.elementValue=n.localeName):null!=n.formsprortlocaletitle?(t.elementKey="formsprortlocaletitle",t.elementValue=n.formsprortlocaletitle):null!=n.formsprortlocalesubtitle&&(t.elementKey="formsprortlocalesubtitle",t.elementValue=n.formsprortlocalesubtitle),t}function g(n,t){n&&n.length>0&&r.forEach(n,(function(n){var e=[];r.forEach(t,(function(t){var o=r.filter(n.questionResources,(function(n){return n.questionId===t.oldId}));r.forEach(o,(function(n){(n=r.clone(i.d.getObjectMasterFromModel(n).getSnapshot())).questionId=t.newId,e.push(n)}))})),i.d.Collection.addItems(n.questionResources,e)}))}},155:function(n,t,e){"use strict";e.d(t,{A:function(){return I}});var r=e(59312),i=e(12611),o=e(37890),u=e(26203),s=e(39923),a=e(94956),c=e(53907),f=e(62539),l=e(54438),h=e(81380),d=e(9743),m=function(){function n(n){this.fe=n,this.ne=(0,h.lK)(this.fe.Form)}return n.prototype.add=function(n){var t=this;if(this.fe.Form.SyncContext!==d.y.DesignTimeForm)return Promise.resolve();var e=this.fe.QuestionId;if(e){var r=this.fe.Form.getQuestionById(e).getChoiceByKey(this.fe.Model.key||"");if(r)return r.Synchronizer.existingInDataSource().then((function(){var e=r.Model.Id.toString();t.fe.Model.choiceId=e;var i={elementKey:"choiceid_"+e,elementValue:n.description,locale:t.fe.LocaleId,questionId:t.fe.QuestionId};return(0,l.m)(i,t.fe.FormId).then((function(){return{choiceId:e,description:n.description}}))}))}return Promise.reject()},n.prototype.delete=function(n){throw Error("No scenario to call this method currently.")},n.prototype.query=function(n){throw Error("No scenario to call this method currently.")},n.prototype.update=function(n,t){if(!t.ValuesBefore||this.fe.Form.SyncContext!==d.y.DesignTimeForm)return Promise.resolve();if(n.choiceId||void 0===n.description)throw Error("No valid payload to update.");var e={elementKey:"choiceid_"+this.fe.ChoiceId,elementValue:n.description,locale:this.fe.LocaleId,questionId:this.fe.QuestionId};return null!==t.ValuesBefore.description?this.ne.updateLocaleItem(this.fe.FormId,e):this.ne.createLocaleItem(this.fe.FormId,e)},n}(),v={choiceId:s.J4.string({IsKeyField:!0,IgnoreKeyWithEmptyValue:!0}),description:s.J4.string(),key:s.J4.string()},p=function(n){function t(e){var r=n.call(this,e,{Scheduler:new a.b(t.name)})||this;if(!r.Model.key){if(!r.Model.choiceId)throw Error("Current choice localized master doesn't has key and choiceId.");e.MasterTreeReady&&e.MasterTreeReady.then((function(){return r.Form.fieldsReady([r.Form.Schema.Questions])})).then((function(){var n=r.Form.getQuestionById(r.QuestionId).getChoiceById(Number(r.Model.choiceId));n&&(r.Model.key=n.Model.Key)}))}return r}return(0,r.ZT)(t,n),Object.defineProperty(t.prototype,"QuestionLocalizedMaster",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Form",{get:function(){return this.QuestionLocalizedMaster.Form},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"QuestionId",{get:function(){return this.QuestionLocalizedMaster.Model.questionId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"LocaleId",{get:function(){return this.QuestionLocalizedMaster.Model.localeId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ChoiceId",{get:function(){return this.Model.choiceId},enumerable:!1,configurable:!0}),t}(u.d.createObjectMasterClass("ChoiceLocalizedItemMaster",v,(function(n){return new m(n)}))),g=e(91091),b=function(){function n(n){this.fe=n,this.ne=(0,h.lK)(this.fe.Form)}return n.prototype.add=function(n){var t=this;if(this.fe.Form.SyncContext!==d.y.DesignTimeForm)return Promise.resolve();var e=this.fe.QuestionId;if(e){var r=this.fe.Form.getElementById(e);if(r)return r.Synchronizer.existingInDataSource().then((function(){var e,r=[];for(e in n)if(n.hasOwnProperty(e)){var o=(0,g.e0)(i.pick(n,[e]));o.elementKey&&(o.locale=t.fe.Model.localeId,o.questionId=t.fe.QuestionId,r.push((0,l.m)(o,t.fe.FormId)))}return Promise.all(r).then((function(n){}))}))}return Promise.reject()},n.prototype.delete=function(n){throw Error("No scenario to call this method currently.")},n.prototype.query=function(n){throw Error("No scenario to call this method currently.")},n.prototype.update=function(n,t){if(!t.ValuesBefore||this.fe.Form.SyncContext!==d.y.DesignTimeForm)return Promise.resolve();var e,r=[];for(e in n)if(n.hasOwnProperty(e)){var o=null!==t.ValuesBefore[e],u=(0,g.e0)(i.pick(n,[e]));u.locale=this.fe.Model.localeId,u.questionId=this.fe.QuestionId,r.push(o?this.ne.updateLocaleItem(this.fe.FormId,u):this.ne.createLocaleItem(this.fe.FormId,u))}return Promise.all(r).then((function(){}))},n}(),w={choices:s.J4.collectionOf((function(){return p})),choicesV1:s.J4.collectionOf({choiceId:s.J4.string({IsLocalField:!0}),description:s.J4.string({SourceFieldName:"Description"}),formsProDisplayRTText:s.J4.string({SourceFieldName:"FormsProDisplayRTText"})},{IsLocalField:!0}),formsprortlocaleldescription:s.J4.string(),formsprortlocalerdescription:s.J4.string(),formsprocustomplaceholder:s.J4.string(),formsprortlocalesubtitle:s.J4.string(),formsprortlocaletitle:s.J4.string(),leftDescription:s.J4.string(),localeId:s.J4.string({IsKeyField:!0}),localeName:s.J4.string(),option:s.J4.string(),questionId:s.J4.string({IsKeyField:!0}),rightDescription:s.J4.string(),subtitle:s.J4.string(),title:s.J4.string(),cascadeChoices:s.J4.collectionOf({choiceId:s.J4.string({IsLocalField:!0}),elementValue:s.J4.string({IsLocalField:!0}),locale:s.J4.string({IsLocalField:!0}),questionId:s.J4.string({IsLocalField:!0})},{IsLocalField:!0})},I=function(n){function t(e){var r=this,i=new o.wU;return(r=n.call(this,e,{MasterReady:i.promise(),Scheduler:new a.b(t.name)})||this).Nr(e),i.resolve(),r}return(0,r.ZT)(t,n),t.handleChoicesV1Deleted=function(n,t,e){n<0||i.forEach(e.Model.LocalizedResources,(function(e){i.filter(e.questionResources,(function(n){return n.questionId===t})).forEach((function(t){t.choicesV1.length>n&&u.d.Collection.itemsDeletedInSource(t.choicesV1,[t.choicesV1[n]])}))}))},t.handleChoicesV1Exchange=function(n,t,e,r){i.forEach(r.Model.LocalizedResources,(function(r){u.d.getCollectionMasterFromModel(r.questionResources).bulkEdit((function(r){i.filter(r,(function(n){return n.questionId===e})).forEach((function(e){var r,o,u=e.choicesV1;for(n>t?(r=t,o=n):(r=n,o=t);u.length<=o+1;)(0,g.Mn)(e);var s=i.map(u,(function(n){return n.description})),a=s.splice(n,1);s.splice(t,0,a[0]);for(var c=r;c<=o;++c)u[c].description=s[c]}))}))}))},Object.defineProperty(t.prototype,"Form",{get:function(){return this.FormLocalizedMaster.Form},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"FormLocalizedMaster",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"QuestionId",{get:function(){return this.Model.questionId},enumerable:!1,configurable:!0}),t.prototype.getChoiceLocalizedMaster=function(n){var t=this,e=i.find(this.Form.Model.Questions,(function(n){return n.Id===t.QuestionId}));if(e){var r=i.find(e.ChoiceGroup,(function(t){return t.Id.toString()===n}));if(r){var o=u.d.Collection.getItemWithKeyFields(this.Model.choices,{choiceId:n});return o?u.d.getObjectMasterFromModel(o):(0,g.fp)(n,r.Key,this.Model)}}throw Error("Question or Chocie don't exist for localization.")},t.prototype.getChoiceV1LocalizedMaster=function(n){var t=this,e=i.find(this.Form.Model.Questions,(function(n){return n.Id===t.QuestionId}));if(e&&e.Choices.length>n){for(;this.Model.choicesV1.length<e.Choices.length;)(0,g.Mn)(this.Model);return u.d.getObjectMasterFromModel(this.Model.choicesV1[n])}return null},t.prototype.Nr=function(n){t.Schema.option&&(this.Er=new c.S(this,t.Schema.option,t.ChoicesV1FieldSet),n.InitialData&&this.isFieldReady(t.Schema.option)&&(n.ExistingInDataSource||n.InitialData.option?this.Er.deserialize():this.Er.serialize()))},Object.defineProperty(t,"ChoicesV1FieldSet",{get:function(){return t.choicesV1FieldSet||(t.choicesV1FieldSet=new f.C([t.Schema.choicesV1])),t.choicesV1FieldSet},enumerable:!1,configurable:!0}),t}(u.d.createObjectMasterClass("QuestionLocalizedItemMaster",w,(function(n){return new b(n)})))},64966:function(n,t,e){"use strict";e.d(t,{LN:function(){return m},yN:function(){return h},pg:function(){return d}});var r=e(59312),i=e(26203),o=e(39923),u=e(41293),s=e(9743),a=e(81380),c=function(){function n(n,t){this.Dr=n,this.ne=(0,a.lK)(this.Dr.Form)}return Object.defineProperty(n.prototype,"FormId",{get:function(){return this.Dr.FormId},enumerable:!1,configurable:!0}),n.prototype.add=function(n){return this.Dr.Form.SyncContext===s.y.AdminPhishingReviewForm?this.ne.createAdminPhishingReviewPermissionLink(this.FormId,n):this.ne.createPermissionLink(this.FormId,n)},n.prototype.delete=function(n){return this.ne.deletePermissionLink(this.FormId,n.principalId)},n.prototype.query=function(n){return(0,u._y)("No scenario to call this method currently.")},n.prototype.update=function(n,t){if("OrgLink"===t.Snapshot.type||"Link"===t.Snapshot.type||"ShareToPeople"===t.Snapshot.type){var e={permissionSet:t.Snapshot.permissionSet,type:t.Snapshot.type};return this.Dr.Form.SyncContext===s.y.AdminPhishingReviewForm?this.ne.createAdminPhishingReviewPermissionLink(this.FormId,e):this.ne.createPermissionLink(this.FormId,e)}return(0,u._y)("No scenario to call this method currently.")},n}(),f=e(82205),l={PrincipalId:o.J4.string({SourceFieldName:"principalId"}),PermissionSet:o.J4.string({SourceFieldName:"permissionSet"}),Type:o.J4.reference({SourceFieldName:"type"}),FormId:o.J4.string({IsSourceGenerated:!0,SourceFieldName:"formId"}),IsOwner:o.J4.boolean({IsSourceGenerated:!0,SourceFieldName:"isOwner"}),PrincipalEmailAddress:o.J4.string({IsSourceGenerated:!0,SourceFieldName:"principalEmailAddress"}),PrincipalName:o.J4.string({IsSourceGenerated:!0,SourceFieldName:"principalName"}),SavingState:o.J4.reference({IsLocalField:!0})};function h(n){return{PermissionSet:"Read, Write, Share",Type:n}}function d(n){return i.d.getObjectMasterFromModel(n)}var m=function(n){function t(t){var e=n.call(this,t)||this;return(0,f.vG)(e),e}return(0,r.ZT)(t,n),Object.defineProperty(t.prototype,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),t}(i.d.createObjectMasterClass("Permission",l,(function(n,t){return new c(n,t)})))},39271:function(n,t,e){"use strict";e.d(t,{Z:function(){return v},I:function(){return r}});var r,i=e(59312),o=e(12611),u=e(26203),s=e(39923),a=e(71860),c=e(51586),f=e(61018),l=function(){function n(n){this.Lr=n}return n.prototype.add=function(n){throw Error("No scenario to call this method currently.")},n.prototype.delete=function(n){throw Error("No scenario to call this method currently.")},n.prototype.query=function(n){var t,e=(0,f.d8)();switch(this.Lr.Model.Extension){case r.Form:t="User";break;case r.GroupForm:t="Group";break;default:t=null}return e.getRecentForms(t).then((function(n){return{documents:n}}))},n.prototype.update=function(n,t){return new Promise((function(){}))},n}(),h={App:s.J4.string({SourceFieldName:"app"}),Category:s.J4.string({SourceFieldName:"category"}),Extension:s.J4.string({SourceFieldName:"extension"}),FormCategory:s.J4.string({SourceFieldName:"formCategory"}),FormType:s.J4.string({SourceFieldName:"formType"}),IsPinned:s.J4.boolean({SourceFieldName:"isPinned"}),MruId:s.J4.string({SourceFieldName:"mruId"}),NotExist:s.J4.boolean({IsLocalField:!0}),OwnerId:s.J4.string({SourceFieldName:"ownerId"}),OwnerName:s.J4.string({SourceFieldName:"ownerName"}),OwnerTenantId:s.J4.string({SourceFieldName:"ownerTenantId"}),OwnerType:s.J4.reference({SourceFieldName:"ownerType"}),ServerDocId:s.J4.string({SourceFieldName:"serverDocId"}),Timestamp:s.J4.string({SourceFieldName:"timestamp"}),Title:s.J4.string({SourceFieldName:"title"}),Type:s.J4.string({SourceFieldName:"type"}),Url:s.J4.string({SourceFieldName:"url"})},d=function(n){function t(t){var e=n.call(this,t)||this;return e.Model.NotExist=!1,e}return(0,i.ZT)(t,n),Object.defineProperty(t.prototype,"FormMaster",{get:function(){return this.qr||(this.qr=(0,c.Si)({Id:this.Model.ServerDocId})),this.qr},enumerable:!1,configurable:!0}),t.prototype.matchSearchStrings=function(n){var t="".concat(this.Model.Title," ").concat(this.Model.OwnerName||"").toLowerCase();return o.all(n,(function(n){return t.indexOf(n)>=0}))},t}(u.d.createObjectMasterClass("MruDocument",h)),m={Extension:s.J4.enumeration((function(){return r}),{IsLocalField:!0}),Knowledge:s.J4.string({IsSourceGenerated:!0,SourceFieldName:"knowledge"}),MruDocuments:s.J4.collectionOf((function(){return d}),{SourceFieldName:"documents"}),ResponseCode:s.J4.string({IsSourceGenerated:!0,SourceFieldName:"responseCode"})};!function(n){n[n.Form=0]="Form",n[n.GroupForm=1]="GroupForm",n[n.Unspecified=2]="Unspecified"}(r||(r={}));var v=function(n){function t(){var t=n.call(this,{ExistingInDataSource:!0,InitialData:{Extension:r.GroupForm,Knowledge:""}})||this;return t.Ar=[],t}return(0,i.ZT)(t,n),t.getInstance=function(){return this.instance||(this.instance=new t),this.instance},Object.defineProperty(t.prototype,"Documents",{get:function(){return this.isFieldReady(this.Schema.MruDocuments)?u.d.convertToArray(this.Model.MruDocuments).sort((function(n,t){return Date.parse(t.Timestamp)-Date.parse(n.Timestamp)})).map((function(n){return u.d.getObjectMasterFromModel(n)})):[]},enumerable:!1,configurable:!0}),t.prototype.removeDocument=function(n){this.isFieldReady(this.Schema.MruDocuments)&&u.d.Collection.deleteItems(this.Model.MruDocuments,o.filter(this.Model.MruDocuments,(function(t){return t.ServerDocId===n})))},t.prototype.initializeFormList=function(){var n=this,e=t.Schema;return this.ensureFieldsReady([e.Knowledge,e.MruDocuments]).then((function(){o.forEach(n.Model.MruDocuments,(function(n){var t=(0,c.ZP)({Id:n.ServerDocId},!1);t.fieldsReady([a.x.Schema.Title]).then((function(){t.observe((function(e){e.BeingDeleted||(n.Title=t.Model.Title)}),[a.x.Schema.Title]),n.Title=t.Model.Title}))}))}),(function(){}))},t.prototype.observeListChange=function(n){if(this.Vr(n)<0){var t=function(t){(t.AddedModels.length||t.RemovedModels.length)&&n()};this.Ar.push({originCallback:n,registeredCallback:t}),this.Gr().then((function(n){return n.observe(t)}))}},t.prototype.unobserveListChange=function(n){var t=this.Vr(n);if(t>=0){var e=this.Ar[t];this.Ar.splice(t,1),this.Gr().then((function(n){return n.unobserve(e.registeredCallback)}))}},t.prototype.Gr=function(){var n=this;return this.fieldsReady([this.Schema.MruDocuments]).then((function(){return u.d.getCollectionMasterFromModel(n.Model.MruDocuments)}))},t.prototype.Vr=function(n){return o.findIndex(this.Ar,(function(t){return t.originCallback===n}))},t}(u.d.createObjectMasterClass("MruDocumentCollection",m,(function(n){return new l(n)})));Forms.Mru.MruDocumentCollectionMaster=v},20469:function(n,t,e){"use strict";e.d(t,{Qq:function(){return d},kF:function(){return l},cp:function(){return h}});var r=e(59312),i=e(26203),o=e(39923),u=e(41293),s=e(81380),a=function(){function n(n,t){this.Dr=n,this.ne=(0,s.lK)(this.Dr.Form)}return Object.defineProperty(n.prototype,"FormId",{get:function(){return this.Dr.FormId},enumerable:!1,configurable:!0}),n.prototype.add=function(n){return this.ne.createResponderPermissionLink(this.FormId,n)},n.prototype.delete=function(n){return this.ne.deleteResponderPermissionLink(this.FormId,n.principalId)},n.prototype.query=function(n){return(0,u._y)("No scenario to call this method currently.")},n.prototype.update=function(n,t){return(0,u._y)("No scenario to call this method currently.")},n}(),c=e(82205),f={PrincipalId:o.J4.string({SourceFieldName:"principalId"}),PermissionSet:o.J4.string({SourceFieldName:"permissionSet"}),Type:o.J4.reference({SourceFieldName:"type"}),FormId:o.J4.string({IsSourceGenerated:!0,SourceFieldName:"formId"}),IsOwner:o.J4.boolean({IsSourceGenerated:!0,SourceFieldName:"isOwner"}),PrincipalEmailAddress:o.J4.string({IsSourceGenerated:!0,SourceFieldName:"principalEmailAddress"}),PrincipalName:o.J4.string({IsSourceGenerated:!0,SourceFieldName:"principalName"}),SavingState:o.J4.reference({IsLocalField:!0})};function l(n){return{PermissionSet:"DataCreator",Type:n}}function h(n){return i.d.getObjectMasterFromModel(n)}var d=function(n){function t(t){var e=n.call(this,t)||this;return(0,c.vG)(e),e}return(0,r.ZT)(t,n),Object.defineProperty(t.prototype,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),t}(i.d.createObjectMasterClass("ResponderPermission",f,(function(n,t){return new a(n,t)})))},79849:function(n,t,e){"use strict";e.d(t,{KJ:function(){return S},q4:function(){return y},_p:function(){return I}});var r=e(59312),i=e(37890),o=e(82205),u=e(26203),s=e(39923),a=e(41293),c=e(9743),f=e(81380),l=function(){function n(n,t){this.Br=n,this.zr=t,this.ne=(0,f.lK)(this.Br.Form)}return n.prototype.Pe=function(){return this.Br.FormId},n.prototype.jr=function(){return this.Br.ResponseId},n.prototype.add=function(n){return(0,a._y)("No scenario to call this method currently.")},n.prototype.delete=function(n){return this.ne.deleteFormResponse(this.Pe(),n.id)},n.prototype.query=function(n){return(0,a._y)("No scenario to call this method currently.")},n.prototype.update=function(n,t){var e=n.releaseDate,r=this.Br.Form.SyncContext;return r!==c.y.DesignTimeForm&&r!==c.y.AnalysisTimeForm?new Promise((function(){})):void 0!==e?this.ne.setResponseReleaseDate(this.Pe(),this.jr(),e):Promise.resolve()},n}(),h=e(82963),d=e(94956),m=e(31442);e(12611);var v=function(){function n(n,t){this.Qr=n,this.ne=(0,f.lK)(this.Qr.Response.Form)}return Object.defineProperty(n.prototype,"FormId",{get:function(){return this.Qr.FormId},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ResponseId",{get:function(){return this.Qr.ResponseId},enumerable:!1,configurable:!0}),n.prototype.Hr=function(){var t=this;return new Promise((function(e,r){n.responsePromiseObjCacheMap.set(t.ResponseId,{resolve:e,reject:r});void 0===n.timerID&&0!==n.comments.length&&(n.timerID=window.setTimeout((function(){if(n.timerID=void 0,1===n.comments.length){var i=n.comments[0];n.comments=[],t.ne.addFormResponseComment(t.FormId,t.ResponseId,i).then((function(n){e(n)}),r)}else{var o=n.comments.map((function(n){return n}));n.comments=[],t.ne.addFormResponseComments(t.FormId,o).then((function(t){for(var e=0,r=t;e<r.length;e++){var i=r[e],o=n.responsePromiseObjCacheMap.get(i.responseId);n.responsePromiseObjCacheMap.delete(i.responseId),o.resolve(i)}}),(function(t){n.responsePromiseObjCacheMap.forEach((function(n,e,r){n.reject(t)}))}))}}),500))}))},n.prototype.add=function(t,e,r){return(i=document.getElementById("grading-by-people-tab"))&&"true"===i.getAttribute("aria-selected")?this.ne.addFormResponseComment(this.FormId,this.ResponseId,e.Snapshot):(e.Snapshot.responseId=this.ResponseId,n.comments.push(e.Snapshot),this.Hr());var i},n.prototype.delete=function(n){return new Promise((function(){}))},n.prototype.query=function(n){return(0,a._y)("No scenario to call this method currently.")},n.prototype.update=function(n,t){var e=this.Qr.Response.Form.SyncContext;return e!==c.y.DesignTimeForm&&e!==c.y.AnalysisTimeForm?new Promise((function(){})):this.add(n,t,!0)},n.comments=new Array,n.responsePromiseObjCacheMap=new Map,n}(),p={QuestionId:s.J4.string({IsKeyField:!0,SourceFieldName:"questionId"}),Id:s.J4.number({SourceFieldName:"id"}),Feedback:s.J4.string({SourceFieldName:"feedback"}),Score:s.J4.number({SourceFieldName:"score"}),SavingState:s.J4.reference({IsLocalField:!0})};var g=function(n){function t(e){var r=n.call(this,e,{Scheduler:new d.b(t.name)})||this;return(0,o.vG)(r),r.observe(b),r.Synchronizer.observe(t.checkCommentUpdateError,[r.Synchronizer.Schema.UpdateError]),r}return(0,r.ZT)(t,n),t.setUpdateErrorCallback=function(n){t.updateErrorCallback=n},t.resetUpdateErrorCallback=function(){t.updateErrorCallback=null},Object.defineProperty(t.prototype,"Response",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"FormId",{get:function(){return this.Response.FormId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ResponseId",{get:function(){return this.Response.ResponseId},enumerable:!1,configurable:!0}),t.checkCommentUpdateError=function(n){t.updateErrorCallback&&n.Master&&n.Master.Schema.UpdateError&&t.updateErrorCallback(n.Master.Model.UpdateError,n.Master.getInstanceId())},t}(u.d.createObjectMasterClass("Comment",p,(function(n,t){return new v(n,t)})));function b(n){if(n.BeingDeleted&&n.Master.Synchronizer.Model.UpdateScheduled)try{throw Error("DeletingComment")}catch(n){(0,m.zU)("ModelError",n.stack)}}var w={Id:s.J4.number({IsKeyField:!0,SourceFieldName:"id"}),Comments:s.J4.collectionOf((function(){return g}),{SourceFieldName:"comments"}),AnswersAsString:s.J4.string({SourceFieldName:"answers"}),StartDateAsString:s.J4.string({SourceFieldName:"startDate"}),SubmitDateAsString:s.J4.string({SourceFieldName:"submitDate"}),Responder:s.J4.string({SourceFieldName:"responder"}),ResponderName:s.J4.string({SourceFieldName:"responderName"}),QuizResult:s.J4.string({SourceFieldName:"quizResult"}),ReleaseDateAsString:s.J4.string({SourceFieldName:"releaseDate"}),Answers:s.J4.collectionOf({QuestionId:s.J4.string({IsKeyField:!0,SourceFieldName:"questionId"}),Answer:s.J4.reference({SourceFieldName:"answer1"}),Feedback:s.J4.string({IsLocalField:!0}),Score:s.J4.number({IsLocalField:!0}),IsAutoGraded:s.J4.boolean({IsLocalField:!0}),IsMathAnswer:s.J4.boolean({IsLocalField:!0})},{IsLocalField:!0}),StartDate:s.J4.reference({IsLocalField:!0}),SubmitDate:s.J4.reference({IsLocalField:!0}),ReleaseDate:s.J4.reference({IsLocalField:!0}),Feedback:s.J4.string({IsLocalField:!0}),TotalScore:s.J4.number({IsLocalField:!0}),IntegratedSavingState:s.J4.reference({IsLocalField:!0}),SavingState:s.J4.reference({IsLocalField:!0}),EmailReceiptConsent:s.J4.boolean({SourceFieldName:"emailReceiptConsent"}),SubmitLanguage:s.J4.string({SourceFieldName:"submitLanguage"}),MSRewardsData:s.J4.reference({SourceFieldName:"msRewardsData"}),FormsProData:s.J4.reference({SourceFieldName:"formsProData"})};w.Answers[0];function I(n){return u.d.getObjectMasterFromModel(n)}function y(n,t){return(0,h.q4)(n.Model.Id,t)}var S=function(n){function t(e){var r=this,o=new i.wU;return(r=n.call(this,e,{Scheduler:new d.b(t.name),MasterReady:o.promise()})||this).$r(),t.Rules.forEach((function(n){return r.addRule(n)})),o.resolve(),r}return(0,r.ZT)(t,n),Object.defineProperty(t.prototype,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ResponseId",{get:function(){return this.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Comment",{get:function(){return this.getCommentByQuestionId(null)},enumerable:!1,configurable:!0}),t.prototype.updateWithNormalizedResponse=function(n){var e=this;this.bulkEdit((function(){e.Synchronizer.onSourceDataReceived(u.d.convertToSourceData(n,t.Schema)),e.setData(n)}))},t.prototype.getAnswerByQuestionId=function(n){var t=u.d.Collection.getItemWithKeyFields(this.Model.Answers,{QuestionId:n});return t&&u.d.getObjectMasterFromModel(t)},t.prototype.getCommentByQuestionId=function(n){var t=u.d.Collection.getItemWithKeyFields(this.Model.Comments,{QuestionId:n});return t&&function(n){return u.d.getObjectMasterFromModel(n)}(t)},t.prototype.setAnswerGrading=function(n,t,e){var r=this.Form.getQuestionById(n);if(r){var i=r.SubQuestionMasters;i.length>0&&(n=i[i.length-1].Model.Id);var o=this.getCommentByQuestionId(n);if(o)o.bulkEdit((function(){void 0!==t&&(o.Model.Score=t),void 0!==e&&(o.Model.Feedback=e)}));else{var s=this.getAnswerByQuestionId(n);t=null!=t?t:s.Model.Score;var a={QuestionId:n,Feedback:e,Score:t};try{u.d.Collection.addItems(this.Model.Comments,[a])}catch(r){this.getCommentByQuestionId(n)&&this.setAnswerGrading(n,t,e)}}}},t.prototype.$r=function(){var n=this;this.Wr="Idle";var t=u.d.getCollectionMasterFromModel(this.Model.Comments);(0,o.v)(t,t.Schema[0].SavingState,(function(t){n.Wr=t,n.ee()})),(0,o.vG)(this),this.ee()},t.prototype.Jr=function(n){var t=this.getAnswerByQuestionId(n);if(t)return t;var e=u.d.Collection.addItems(this.Model.Answers,[{QuestionId:n}])[0];return u.d.getObjectMasterFromModel(e)},t.prototype.ee=function(){this.Model.IntegratedSavingState=(0,o.IM)([this.Model.SavingState,this.Wr])},Object.defineProperty(t,"Rules",{get:function(){if(!t.rules){var n=t.Schema;t.rules=[{Name:"ResponseComment",InterestedFields:[n.Feedback,n.TotalScore],onChange:function(n){var t=n.Master,e=t.getCommentByQuestionId(null);e?e.bulkEdit((function(){e.Model.Feedback=t.Model.Feedback,e.Model.Score=t.Model.TotalScore})):u.d.Collection.addItems(t.Model.Comments,[{QuestionId:null,Feedback:t.Model.Feedback,Score:t.Model.TotalScore}])}},{Name:"AnswerComment",InterestedFields:[n.Answers[0].Feedback,n.Answers[0].Score,n.Answers[0].IsAutoGraded],onChange:function(n){var t=n.Master,e=t.Model.Answers,r=function(n){n.IsAutoGraded||t.setAnswerGrading(n.QuestionId,n.Score,n.Feedback)};n.SubChanges.filter((function(n){return n.Master.Model===e})).forEach((function(n){n.AddedModels.forEach(r),n.SubChanges.forEach((function(n){return r(n.Master.Model)}))}))}},{Name:"ApplyCommentChange",InterestedFields:[n.Comments],onChange:function(n){var t=n.Master,e=t.Model.Comments,r=function(n){var e=n.QuestionId;if(e){var r=t.Jr(e);r.bulkEdit((function(){r.Model.Feedback=n.Feedback,r.Model.Score=n.Score,r.Model.IsAutoGraded=!1}))}else t.bulkEdit((function(){t.Model.Feedback=n.Feedback,t.Model.TotalScore=n.Score}))};n.SubChanges.filter((function(n){return n.Master.Model===e})).forEach((function(n){n.AddedModels.forEach(r),n.SubChanges.forEach((function(n){return r(n.Master.Model)}))}))}}],t.rules=t.rules.concat(t.getRulesForSyncBetweenDateFields(n.StartDate,n.StartDateAsString),t.getRulesForSyncBetweenDateFields(n.SubmitDate,n.SubmitDateAsString),t.getRulesForSyncBetweenDateFields(n.ReleaseDate,n.ReleaseDateAsString))}return t.rules},enumerable:!1,configurable:!0}),t.getRulesForSyncBetweenDateFields=function(n,t){var e=u.d.getFieldSchemaInfo(n).Name,r=u.d.getFieldSchemaInfo(t).Name;return[{Name:"update ".concat(e),InterestedFields:[t],onChange:function(n){var t=n.Master.Model;t[e]=new Date(t[r])}},{Name:"update ".concat(r),InterestedFields:[n],onChange:function(n){var t=n.Master.Model;t[r]=t[e].toISOString()}}]},t}(u.d.createObjectMasterClass("Response",w,(function(n,t){return new l(n,t)})))},35564:function(n,t,e){"use strict";e.d(t,{l:function(){return F}});var r=e(59312),i=e(12611),o=e(81620),u=e(26203),s=e(39923),a=e(73252),c=e(90710),f=e(72467),l=e(13886),h=e(41350),d=e(64290),m=e(71860),v=e(38174),p=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return(0,r.ZT)(t,n),t.prototype.calculateQuestionRuntimeList=function(n){var t,e=this,r=[];i.forEach(n,(function(n){t=e.formRuntimeMaster.getOrCreateQuestionRuntime(n),r.push(t),n.SubQuestionMasters.forEach((function(n){var t=e.formRuntimeMaster.getOrCreateQuestionRuntime(n);r.push(t)}))})),this.formRuntimeMaster.Model.QuestionRuntimeMasters=r,this.formRuntimeMaster.ensureProRuleManager()},t.prototype.getPreviousSection=function(){var n,t=this.formRuntimeMaster,e=t.Model.RuntimeSectionId,r=t.Form.FormElementManager,o=r.getDescriptiveElementMasterById(e),u=r.SectionMasters,s=i.findLastIndex(u,(function(n){return n.Model.Order<o.Model.Order}));if(null==e||s<0)return null;for(;s>=0;){n=u[s];var a=this.getRuntimeQuestionsWithSectionId(n.Model.Id);if(!(a.length>0)||(a=a.filter((function(n){return t.formsProQuestionVisiblityCheck(n)&&t.isContainingSectionVisible(n.Question.Model.Id)}))).length)break;s--}return s<0?null:n},t.prototype.getNextSection=function(){for(var n,t=this.formRuntimeMaster,e=t.Model.RuntimeSectionId,r=t.Form,o=function(){if(null==e)n=r.hasSection()?i.min(r.FormElementManager.SectionMasters,(function(n){return n.Model.Order})):null;else{var o=r.FormElementManager.getDescriptiveElementMasterById(e);n=i.find(r.FormElementManager.SectionMasters,(function(n){return n.Model.Order>o.Model.Order}))}if(null==n)return"break";var s=u.getRuntimeQuestionsWithSectionId(n.Model.Id);return s.length>0&&!(s=s.filter((function(n){return t.formsProQuestionVisiblityCheck(n)&&t.isContainingSectionVisible(n.Question.Model.Id)}))).length?(e=n.Model.Id,"continue"):"break"},u=this;;){if("break"===o())break}return n},t.prototype.hasPrevSection=function(){return!!this.getPreviousSection()},t}(function(){function n(){}return n.prototype.hasPrevSection=function(){return!!this.formRuntimeMaster.Model.RuntimeSectionId},n.prototype.gotoPrevSection=function(){var n=this.getPreviousSection();null==n?this.formRuntimeMaster.Model.RuntimeSectionId=null:(this.formRuntimeMaster.Model.RuntimeSectionId=n.Model.Id,(0,d.md)((function(){(0,v.Wz)(document.getElementsByClassName("__title__")[0])})))},n.prototype.hasNextSection=function(){return!!this.getNextSection()},n.prototype.gotoNextSection=function(){var n=this.getNextSection();n&&(this.formRuntimeMaster.Model.RuntimeSectionId=n.Model.Id,(0,d.md)((function(){(0,v.Wz)(document.getElementsByClassName("__title__")[0])})))},n.prototype.getAllSections=function(){var n=this,t=[];t.push({TopQuestionMasters:this.getRuntimeQuestionsWithSectionId()});var e=this.formRuntimeMaster.Form.FormElementManager.SectionMasters.map((function(t){return{Section:t,TopQuestionMasters:n.getRuntimeQuestionsWithSectionId(t.Model.Id)}}));return t=t.concat(e)},n.prototype.getCurrentSection=function(){var n=this.formRuntimeMaster,t=n.Model.RuntimeSectionId,e=t?n.Form.FormElementManager.getDescriptiveElementMasterById(t):void 0,r=this.getRuntimeQuestionsWithSectionId(t);if(this.formRuntimeMaster.Form.hasSection()&&!t&&!r.length){if(e=this.getNextSection())this.formRuntimeMaster.Model.RuntimeSectionId=e.Model.Id;else{var o=n.Form.FormElementManager.SectionMasters,u=i.max(o,(function(n){return n.Model.Order}));this.formRuntimeMaster.Model.RuntimeSectionId=u?u.Model.Id:null}r=this.getRuntimeQuestionsWithSectionId(this.formRuntimeMaster.Model.RuntimeSectionId)}return{Section:e,TopQuestionMasters:r}},n.prototype.isFirstPage=function(){var n=this,t=this.formRuntimeMaster.Model.RuntimeSectionId,e=this.formRuntimeMaster.Form.FormElementManager.SectionMasters,r=t&&e.length?e.map((function(n){return n.Model.Id})).indexOf(t):-1;return!t||0===r&&!this.getRuntimeQuestionsWithSectionId().length||(0,d.md)((function(){return r>0&&!n.getRuntimeQuestionsWithSectionId().length&&null==n.getPreviousSection()}))},n.prototype.getRuntimeQuestionsWithSectionId=function(n){var t,e=u.d.convertToArray(this.formRuntimeMaster.Model.QuestionRuntimeMasters).filter((function(n){return!n.Question.Model.GroupId})),r=this.formRuntimeMaster.Form;if(n){var o=r.FormElementManager.getDescriptiveElementMasterById(n);t=e.filter((function(n){return n.Question.Model.Order>o.Model.Order}));var s=i.find(r.FormElementManager.SectionMasters,(function(n){return n.Model.Order>o.Model.Order}));s&&(t=i.filter(t,(function(n){return s.Model.Order>n.Question.Model.Order})))}else{var a=r.FormElementManager.SectionMasters,c=a.length&&a[0].Model.Order;t=e,c>0&&(t=i.filter(t,(function(n){return n.Question.Model.Order<c})))}return t},n}()),g=e(25366),b=e(72374),w=function(){function n(n){this.Kr=[],this.Xr=this.Xr.bind(this),this.Yr=n}return n.getBranchedSections=function(t,e){for(var r=[],o=[],u=0,s=function(){var s=t[u];if(i.findIndex(r,(function(n){return n.Section===s.Section}))>=0)return"break";for(var a=[],c=void 0,f=s.TopQuestionMasters[0],l=function(){if(i.include(o,f))return"break";o.push(f),a.push(f);var n=e(f,s.TopQuestionMasters),r=n.TargetElement;r instanceof b.MF?f=r:(r&&g.H.isSection(r.Model.Type)?c=i.findIndex(t,(function(n){return n.Section===r})):"End"===n.Type&&(c=-1),f=null)};f;){if("break"===l())break}r.push({Section:s.Section,TopQuestionMasters:a}),u=void 0!==c?c:n.getNextSectionFromSection(s,t)};u<=t.length-1&&u>=0;){if("break"===s())break}return r},n.prototype.calculateQuestionRuntimeList=function(t){var e=[],r=this.Zr(t);this.formRuntimeMaster.IsDisableBranching||(r=n.getBranchedSections(r,this.Xr));var i=this.Kr,o=this.ni(r,e);if(this.Yr||n.isBranchingResultChanged(i,o)){this.Kr=o;var u=this.formRuntimeMaster.Model;this.formRuntimeMaster.bulkEdit((function(){u.QuestionRuntimeMasters=e,u.BranchChangeVersion=(u.BranchChangeVersion||0)+1}))}},n.prototype.hasPrevSection=function(){return this.ti()>0},n.prototype.gotoPrevSection=function(){var n=this.ti();if(n>0){var t=this.Kr[n-1];this.formRuntimeMaster.Model.RuntimeSectionId=t.Section&&t.Section.Model.Id}},n.prototype.hasNextSection=function(){return this.ti()<this.Kr.length-1},n.prototype.gotoNextSection=function(){var n=this.ei();n&&(this.formRuntimeMaster.Model.RuntimeSectionId=n)},n.prototype.getAllSections=function(){return this.Kr},n.prototype.getCurrentSection=function(){return this.ri(this.formRuntimeMaster.Model.RuntimeSectionId)},n.prototype.isFirstPage=function(){var n=this.getCurrentSection();return 0===this.Kr.indexOf(n)},n.isBranchingResultChanged=function(n,t){if(n.length!==t.length)return!0;for(var e=0;e<n.length;e++){if(n[e].Section!==t[e].Section||n[e].TopQuestionMasters.length!==t[e].TopQuestionMasters.length)return!0;for(var r=0;r<n[e].TopQuestionMasters.length;r++)if(n[e].TopQuestionMasters[r]!==t[e].TopQuestionMasters[r])return!0}return!1},n.prototype.Xr=function(n,t){var e=this.formRuntimeMaster.getOrCreateQuestionRuntime(n),r=e.Model.BranchingType,i=e.Model.BranchedElement;return i instanceof b.MF&&-1===t.indexOf(i)&&(i=t[t.indexOf(n)+1]),{TargetElement:i,Type:r}},n.prototype.ni=function(n,t){var e=this;return n.map((function(n){return{Section:n.Section,TopQuestionMasters:n.TopQuestionMasters.map((function(n){var r=e.formRuntimeMaster.getOrCreateQuestionRuntime(n);return t.push(r),n.SubQuestionMasters.forEach((function(n){var r=e.formRuntimeMaster.getOrCreateQuestionRuntime(n);t.push(r)})),r}))}}))},n.getNextSectionFromSection=function(n,t){var e=n.Section,r=e&&e.Model.BranchInfo;if(r){if(r.ToTheEnd)return-1;var o=i.findIndex(t,(function(n){return n.Section&&n.Section.Model.Id===r.TargetQuestionId}));if(o>=0)return o}return i.findIndex(t,n)+1},n.prototype.ri=function(n){var t=this,e=i.find(this.Kr,(function(t,e){return n?t.Section&&n===t.Section.Model.Id:0===e}));return n&&!e&&(e=this.Kr[0],setTimeout((function(){t.formRuntimeMaster.Model.RuntimeSectionId=null}))),e},n.prototype.ti=function(){return i.indexOf(this.Kr,this.getCurrentSection())},n.prototype.Zr=function(n){var t=this.formRuntimeMaster.Form;return t.hasSection()?t.FormElementManager.getSectionNodes():[{TopQuestionMasters:n.filter((function(n){return!n.Model.GroupId}))}]},n.prototype.ei=function(){var n=this.ti();if(n<this.Kr.length-1&&n>=0){var t=this.Kr[n+1];return t.Section&&t.Section.Model.Id}},n}();function I(n){var t=(0,d.md)((function(){return!0}))?new p:new w((0,a.M0)());return t.formRuntimeMaster=n,t}var y=e(22530),S={QuestionRuntimeMasters:s.J4.collectionOf(s.J4.reference()),RuntimeSectionId:s.J4.string(),UploadingFileCount:s.J4.number(),BranchChangeVersion:s.J4.number()},F=function(n){function t(t,e){var r=n.call(this)||this;return r.ii={},r.oi=new h.Y,r.ui=function(){return r.oi.trigger()},r.si=function(n){return r.replaceAnswerTagsWithValue(n.Master)},r.ai=function(n){return r.ci(n)},r.li=function(){return r.ci()},r.di=function(){return r.mi.callOnceLater()},r.mi=new h.u((function(){return r.gi()}),0),r.qr=t,(0,d.md)((function(){var n=(0,f.f5)();t&&!n.Model.FormMaster&&(n.Model.FormMaster=t),e&&(null==e?void 0:e.Answers)&&(r.Answers=e.Answers)})),r.wi=I(r),e=e||{},r.Ii=e.disableShuffle,r.Fi=e.disableBranching,r.ci(),r.mi.callImmediately(),r.Model.UploadingFileCount=0,u.d.getCollectionMasterFromModel(t.Model.Questions).observe(r.ai),t.observe(r.li,[m.x.Schema.HasValidBranching,m.x.Schema.Settings.ShuffleQuestionOrder]),r}return(0,r.ZT)(t,n),Object.defineProperty(t.prototype,"Form",{get:function(){return this.qr},enumerable:!1,configurable:!0}),t.prototype.ElementManager=function(){return this.wi},Object.defineProperty(t.prototype,"IsDisableBranching",{get:function(){return this.Fi},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Answers",{get:function(){return u.d.convertToArray(this.Model.QuestionRuntimeMasters).filter((function(n){return n.Question.hasAnswer()})).map((function(n){return n.getAnswerEntity()}))},set:function(n){var t=this,e={};i.forEach(n,(function(n){return e[n.QuestionId]=n.Answer})),this.bulkEdit((function(){t.qr.FormElementManager.QuestionMasters.map((function(n){return t.getOrCreateQuestionRuntime(n)})).forEach((function(n){n.Model.Answer=e[n.Question.Model.Id]}))})),this.mi.flush()},enumerable:!1,configurable:!0}),t.prototype.TopQuestionRuntimeMasters=function(){return u.d.convertToArray(this.Model.QuestionRuntimeMasters).filter((function(n){return!n.Question.Model.GroupId}))},t.prototype.CurrentRuleManager=function(){return this.Ci},t.prototype.isDefaultAnswer=function(){var n=this.qr.getDefaultResponse();return u.d.convertToArray(this.Model.QuestionRuntimeMasters).every((function(t){var e=t.Question.Model.Id;return n[e]===t.Model.Answer}))},t.prototype.updateWithResponse=function(n){var t=this,e={};n&&n.Answers&&i.forEach(n.Answers,(function(n){return e[n.QuestionId]=n})),this.bulkEdit((function(){t.qr.FormElementManager.QuestionMasters.map((function(n){return t.getOrCreateQuestionRuntime(n)})).forEach((function(n){var t=n.Question.Model.Id,r=e[t];n.bulkEdit((function(){n.Model.Answer=r&&r.Answer,n.Model.AnswerEntity=r}))}))})),this.ci()},t.prototype.setQuizResults=function(n){var t=this;n.forEach((function(n){var e=t.ii[n.id];e&&(e.Model.QuizResult={IsAnswerCorrect:n.isAnswerCorrect,AnswerHints:n.answerHints,IsAnswerKeys:n.answerKeys,Choices:i.map(e.Question.Model.Choices,(function(n){return n.Description})),GradingBasis:n.gradingBasis})}))},t.prototype.clearQuizResult=function(){for(var n in this.ii)this.ii[n].Model.QuizResult=void 0},t.prototype.resetQuestions=function(){if((0,a.cr)("FormsProAnswerTag"))for(var n in this.Form.Model.FormsProAnswerTagMapRT=[],this.ii)this.ii[n].Model.FormsProRuntimeTitle=void 0,this.ii[n].Model.FormsProRuntimeSubtitle=void 0,this.ii[n].Model.InitialFormsProLocalizedRuntimeTitle=void 0,this.ii[n].Model.InitialFormsProLocalizedRuntimeSubtitle=void 0},t.prototype.getQuestionResponseFromQueryString=function(){var n=(0,c.NW)().questionId,t=(0,c.NW)().answer;return(0,c.NW)().vt&&n&&t?[{Answer:t,QuestionId:n}]:null},t.prototype.calculateQuizResultFromModel=function(){u.d.convertToArray(this.Model.QuestionRuntimeMasters).forEach((function(n){return n.calculateQuizResultFromModel()}))},t.prototype.formsProQuestionVisiblityCheck=function(n){return!(!0!==n.Model.Visible&&(!(0,a.cr)("FormsProQuestionVisibility")||null!=n.Model.Visible||n.Question.Model.Hidden))},t.prototype.setVisibility=function(n){null!==n.Model.Visible&&n.Model.Visible?(0,a.cr)("FormsProQuestionVisibility")&&n.Question.Model.Hidden&&(n.Question.Model.Hidden=!1):n.Model.Visible=!0},t.prototype.isContainingSectionVisible=function(n){var t=!0;if(this.Form.hasSection()){var e=this.Form.FormElementManager,r=e.getElementMasterById(n),i=e.findContainerSection(r);t=this.formsProSectionVisiblityCheck(i)}return t},t.prototype.formsProSectionVisiblityCheck=function(n){return!0===n.Model.Visible||null==n.Model.Visible&&!n.Model.Hidden},t.prototype.getQuestionsWithWrongAnswer=function(n){var t=this;if((0,d.md)((function(){n=n.filter((function(n){return t.formsProQuestionVisiblityCheck(n)&&t.isContainingSectionVisible(n.Question.Model.Id)}))})),n.length<=0)return[];var e=this.TopQuestionRuntimeMasters();(0,d.md)((function(){e=e.filter((function(n){return t.formsProQuestionVisiblityCheck(n)&&t.isContainingSectionVisible(n.Question.Model.Id)}))}));var r=i.findIndex(e,(function(t){return t.Question.Model.Id===n[0].Question.Model.Id}))+1;return n.map((function(n,t){return n.verifyAnswer()?-1:t+r})).filter((function(n){return n>0}))},t.prototype.getOrCreateQuestionRuntimeById=function(n){var t=this.qr.getQuestionById(n);return t&&this.getOrCreateQuestionRuntime(t)},t.prototype.observeAnswerChange=function(n){this.oi.register(n)},t.prototype.unobserveAnswerChange=function(n){this.oi.unregister(n)},t.prototype.release=function(){var n=this,t=function(t){var r=e.ii[t];r.unobserve(e.di),r.unobserve(e.ui),(0,d.md)((function(){r.unobserve(n.si)})),r.release()},e=this;for(var r in this.ii)t(r);u.d.getCollectionMasterFromModel(this.qr.Model.Questions).unobserve(this.ai),this.qr.unobserve(this.li)},t.prototype.getOrCreateQuestionRuntime=function(n){var t=n.Model.Id;return this.ii[t]||(this.ii[t]=this._i(n)),this.ii[t]},t.prototype._i=function(n){var t=this,e=new y.r(n,this);return e.observe(this.di,[y.r.Schema.BranchedElement,y.r.Schema.BranchingType]),e.observe(this.ui,[y.r.Schema.Answer]),(0,d.md)((function(){e.observe(t.si,[y.r.Schema.Answer])})),e},t.prototype.ci=function(n){var t,e=this,o=this.qr.Model.Settings,u=this.qr.FormElementManager;this.Ti=u.TopQuestionMasters;var s=this.Form.hasSection();if(!s&&!this.Ii&&!this.qr.Model.HasValidBranching&&o.ShuffleQuestionOrder)if(o.ShuffleAllQuestions||null==o.ShuffleAllQuestions)this.Ti=i.shuffle(this.Ti);else if((0,l.U)(o.LockGivenQuestionsStartDisplayOrder)&&(0,l.U)(o.LockGivenQuestionsEndDisplayOrder)){var a=o.LockGivenQuestionsStartDisplayOrder-1,c=o.LockGivenQuestionsEndDisplayOrder-1,f=this.Ti.splice(a,c-a+1);this.Ti=i.shuffle(this.Ti),(t=this.Ti).splice.apply(t,(0,r.ev)([a,0],f,!1))}s?u.getSectionNodes().forEach((function(n){return e.Pi(n.TopQuestionMasters)})):this.Pi(this.Ti),n&&(n.AddedModels.length||n.RemovedModels.length)&&this.mi.callOnceLater()},t.prototype.Pi=function(n){var t=this;n.forEach((function(e,r){var i=t.getOrCreateQuestionRuntime(e);i.bulkEdit((function(t){t.NextQuestionInOrder=n[r+1],t.NextQuestionInitialized=!0})),"Specified"===i.Model.BranchingType&&!i.Model.BranchedElement&&(0,a.M0)()&&i.updateBranchedQuestion(),e.SubQuestionMasters.forEach((function(n){return t.getOrCreateQuestionRuntime(n)}))}))},t.prototype.ensureProRuleManager=function(n){this.Ci=FormsPro.getRuleManager(this.qr,this.Model.QuestionRuntimeMasters,this,n,this.Answers)},t.prototype.Ni=function(n,t,e){if(null!=n){var r=u.d.convertToArray(this.Form.Model.FormsProAnswerTagMapRT),i=n.match(/\[\[(.*?)\]\]/g);null!=i&&i.length>0&&i.forEach((function(i){if(""!=i){var o=r.filter((function(n){return n.name==i}))[0];null!=o&&(""!=o.value&&null!=o.value||(o.value=o.name),null!=n&&(t[e]=n.replaceAll(i,o.value),n=t[e]))}}))}else t[e]=n},t.prototype.gi=function(){this.wi.calculateQuestionRuntimeList(this.Ti)},t.prototype.calcProgressBarInfo=function(){return{showProgressBar:this.Form.isProgressBarVisible(),currentPageNumber:this.ki()+1,totalPageNumber:this.Form.totalSectionCount()}},t.prototype.ki=function(){var n=this.Model.RuntimeSectionId;if(!n)return 0;var t=this.Form.FormElementManager,e=t.getDescriptiveElementMasterById(n);return e?t.SectionMasters.indexOf(e)+(t.HeaderTopQuestionMasters.length>0?1:0):0},t.prototype.replaceAnswerTagsWithValue=function(n){var t=this;if((0,a.cr)("FormsProAnswerTag")&&n&&n.Question&&n.Question.Model.FormsProEnableAnswerTag&&""!=n.Question.Model.FormsProAnswerTag&&null!=n.Question.Model.FormsProAnswerTag){var e=u.d.convertToArray(this.Form.Model.FormsProAnswerTagMapRT),r=n.Question.Model.FormsProAnswerTag;r="[[".concat(r,"]]");var i=null!=n.Model.Answer&&(0,o.F1)(n.Model.Answer.toString());null!=n.Model.SelectedChoice&&""!=n.Model.SelectedChoice&&(i=n.Model.SelectedChoice);var s=e.filter((function(n){return n.name==r}))[0];s?s.value=i:e.push({name:r,value:i}),this.Form.Model.FormsProAnswerTagMapRT=e,u.d.convertToArray(this.Model.QuestionRuntimeMasters).forEach((function(n){var e=null!=n.Question.Model.FormsProRTQuestionTitle?JSON.parse(JSON.stringify(n.Question.Model.FormsProRTQuestionTitle)):JSON.parse(JSON.stringify(n.Question.Model.Title)),r=null!=n.Question.Model.FormsProRTSubtitle?JSON.parse(JSON.stringify(n.Question.Model.FormsProRTSubtitle)):JSON.parse(JSON.stringify(n.Question.Model.Subtitle));null!=n.Model.InitialFormsProLocalizedRuntimeTitle&&(e=JSON.parse(JSON.stringify(n.Model.InitialFormsProLocalizedRuntimeTitle))),null!=n.Model.InitialFormsProLocalizedRuntimeSubtitle&&(r=JSON.parse(JSON.stringify(n.Model.InitialFormsProLocalizedRuntimeSubtitle))),t.Ni(e,n.Model,"FormsProRuntimeTitle"),null!=n.Model.InitialFormsProLocalizedRuntimeSubtitle&&(r=JSON.parse(JSON.stringify(n.Model.InitialFormsProLocalizedRuntimeSubtitle))),t.Ni(r,n.Model,"FormsProRuntimeSubtitle")}))}},t.prototype.clearFileUploadAnswers=function(){this.Model.UploadingFileCount=0;var n=this.Model.QuestionRuntimeMasters;u.d.convertToArray(n).filter((function(n){return"Question.FileUpload"===n.Question.Model.Type})).forEach((function(n){return n.Model.Answer=void 0}))},t}(u.d.createObjectMasterClass("FormRuntime",S))},22530:function(n,t,e){"use strict";e.d(t,{r:function(){return v}});var r=e(59312),i=e(64459),o=e(26203),u=e(39923),s=e(73252),a=e(687),c=e(43367),f=e(90710),l=e(64290),h=e(31442),d=e(72374),m={Answer:u.J4.reference(),AnswerEntity:u.J4.reference(),BranchedElement:u.J4.reference(),BranchingType:u.J4.string(),NextQuestionInOrder:u.J4.reference(),NextQuestionInitialized:u.J4.boolean(),QuizResult:u.J4.reference(),Visible:u.J4.reference(),FormsProOrdinal:u.J4.reference(),FormsProRuntimeTitle:u.J4.reference(),FormsProRuntimeSubtitle:u.J4.reference(),InitialFormsProLocalizedRuntimeTitle:u.J4.reference(),InitialFormsProLocalizedRuntimeSubtitle:u.J4.reference(),SelectedChoice:u.J4.reference(),CDSFileResponseId:u.J4.reference(),CDSFileId:u.J4.reference(),HasSensitiveInfo:u.J4.boolean()},v=function(n){function t(t,e){var r=n.call(this)||this;return r.Ei=function(){return r.updateBranchedQuestion()},r.Ye=t,r.Ye.observe(r.Ei),r.Ri=e,(0,l.hl)((function(){r.addRule({Name:"UpdateBranchedQuestion",onChange:function(n){return r.updateBranchedQuestion()}})})),(0,l.md)((function(){var n;if(r.addRule({Name:"executeFormsProBranching",onChange:function(n){return r.Oi()},InterestedFields:[r.Schema.Answer]}),null===(n=null==e?void 0:e.Form)||void 0===n?void 0:n.SettingMaster.Model.PauseAndResumeSurvey){var t=(0,f.NW)().vt;if(t){var i=t.split("_")[1];r.addRule({Name:"updatePausedResponse",onChange:function(n){return r.Di(i,t)},InterestedFields:[r.Schema.Answer]})}}})),r}return(0,r.ZT)(t,n),Object.defineProperty(t.prototype,"Question",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"SubQuestions",{get:function(){return this.Question.SubQuestionMasters},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"SubQuestionRuntimeMasters",{get:function(){var n=this;return this.SubQuestions.map((function(t){return n.getSubQuestionRuntimeById(t.Model.Id)}))},enumerable:!1,configurable:!0}),t.prototype.getSubQuestionRuntimeById=function(n){return this.Ri?this.Ri.getOrCreateQuestionRuntimeById(n):null},t.prototype.verifyAnswer=function(){if(0===this.SubQuestionRuntimeMasters.length){if(this.Question.Model.IsMathQuiz){var n=(0,i.d)(this.Model.Answer||"{}"),t=null==n.Answer?this.Model.Answer:n.Answer;return this.Question.verify(t)===d.ej.Success}return this.Question.verify(this.Model.Answer)===d.ej.Success}return this.SubQuestionRuntimeMasters.every((function(n){return n.Question.verify(n.Model.Answer)===d.ej.Success}))},t.prototype.release=function(){this.Ye.unobserve(this.Ei)},t.prototype.getAnswerEntity=function(){return{Answer:this.Question.getNormalizedAnswer(this.Model.Answer),QuestionId:this.Question.Model.Id}},t.prototype.calculateQuizResultFromModel=function(){0===this.SubQuestionRuntimeMasters.length?this.Model.QuizResult=this.Question.createQuizResult(this.Model.Answer):this.Model.QuizResult={IsAnswerCorrect:!1}},t.prototype.getScore=function(){var n=this.Model.AnswerEntity,t=n&&n.Score;return null!=t?t:this.Question.autoGradeWithQuizResult(this.Model.Answer,this.Model.QuizResult)},t.prototype.updateBranchedQuestion=function(){if(!this.Question.Deleted){var n=this.Model,t=this.Question.getBranchedResult(n.Answer,n.NextQuestionInOrder);this.bulkEdit((function(n){n.BranchedElement=t.TargetElement,n.BranchingType=t.Type}))}},t.prototype.Oi=function(){this.Ri&&(this.Ri.CurrentRuleManager()?this.Ri.CurrentRuleManager().execute(this.Question.Model.Id,this.Ri.Answers):(this.Ri.ensureProRuleManager(),this.Ri.Form.Model.MfpBranchingData&&this.Ri.CurrentRuleManager().execute(this.Question.Model.Id,this.Ri.Answers)))},t.prototype.Di=function(n,t){var e=this;(0,l.md)((function(){if("Question.TextField"!==e.Question.Model.Type){var r=(0,a.vT)();(0,s.cr)("CVPartialResponse")&&e.Ri.Form.SettingMaster.Model.RecordPartialResponse&&(r=e.Ri.Form.SettingMaster.Model.RecordPartialResponse,(0,h.JG)({type:"CustomerVoice_PartialResponseSettingTaken",eventInfo:{Component:"PartialResponse",Value:r}})),(0,c.callIoCUpdatePR)(n,e.Ri.Answers,e.Ri.Form.Model.Id,e.Ri.Model.RuntimeSectionId,t,r)}}))},t}(o.d.createObjectMasterClass("QuestionRuntime",m))},19976:function(n,t,e){"use strict";e.d(t,{a:function(){return o}});var r=e(6787),i=e(72467);function o(){return(0,r.sv)()?(0,i.uq)():(0,i.f5)()}},48333:function(n,t,e){"use strict";e.d(t,{Q:function(){return u},o:function(){return i}});var r=e(12611);function i(n,t,e){for(var i=n,u=o(n);r.contains(e,i);)i=t.format(u.BaseName,++u.Count);return i}function o(n){var t=n+" ",e=1,r="",i=n.lastIndexOf("(");return n&&")"===n.slice(-1)&&i>=0&&parseInt(n.slice(i+1,n.length-1))&&(r=n.slice(i+1,n.length-1),e=parseInt(r),t=n.slice(0,i)),{BaseName:t,Count:e,CountStr:r}}function u(n,t){var e=n.copyTitle,r=n.copyRichTitle,i=n.newTitle,u=i;if(!r)return{newTitle:i,newRichTitle:r};if(e!==r){var s=o(e),a=o(r);s.CountStr===a.CountStr?u=t.format(a.BaseName,o(i).Count):(i=t.format("".concat(e," "),"2"),u=t.format("".concat(r," "),"2"))}return{newTitle:i,newRichTitle:u}}},24513:function(n,t,e){"use strict";e.d(t,{a:function(){return o},k:function(){return u}});var r=e(59312),i=e(87363),o="single-progress-bar",u=function(n){if(n.$CurrentStep<0||n.$TotalSteps<=0||n.$TotalSteps<n.$CurrentStep)return null;var t=Math.round(100*n.$CurrentStep/n.$TotalSteps),e={id:o,className:"progress-bar-text office-form-theme-secondary-color"},u={className:"progress-bar-div",role:"progressbar","aria-label":n.$DescriptionText,"aria-valuenow":t};return i.createElement("div",(0,r.pi)({},u),i.createElement("div",{className:"progress-bar-background office-form-theme-progress-bar-background"},i.createElement("div",(0,r.pi)({},e),n.$DescriptionText),i.createElement("div",{className:"progress-bar"},i.createElement("div",{className:"progress-bar-control office-form-theme-primary-background",style:{width:"".concat(t,"%")}}))))}},72317:function(n,t,e){"use strict";e.d(t,{a:function(){return i}});var r=e(72377);function i(){return r.Pv.Resolve("IPageContext")}},45862:function(n,t,e){"use strict";e.d(t,{P:function(){return h}});var r,i=e(61533),o=e(94290),u=e(7645),s=e(31442),a=e(76669);function c(){try{(0,a.Km)().exitWebView()}catch(n){(0,s.zU)("Union.exitWebViewFailed",{errorInfo:n.message})}}!function(n){n[n.Mail=0]="Mail",n[n.Teams=1]="Teams"}(r||(r={}));var f=e(30521),l=e(64290);function h(n){(0,l.c2)(),(0,u.ay)().then((function(){i.render((0,f.a)({Error:n,ShowBackButton:(0,o.mF)(),OnBackButtonClicked:(0,o.mF)()?c:null}),document.getElementById("content-root"))}))}},64290:function(n,t,e){"use strict";e.d(t,{Sp:function(){return d},Xw:function(){return m},c2:function(){return h},hl:function(){return l},md:function(){return f},pd:function(){return c}});var r,i,o=e(9947),u=e(262),s=e(6787),a=e(73252);function c(n,t){return d()?t():n()}function f(n){return d()?n():null}function l(n){return d()?null:n()}function h(){f((function(){r||(document.body.className=(0,u.j)(document.body.className,(0,u.j)("forms-pro",(0,s.cT)()?"customer-voice":null)),r=!0)}))}function d(){return void 0===i&&(i=!!(0,o.k0)().proEnabled&&(0,a.cr)("FormsPro")),i}FormsPro.initializeStyleBasis=h;var m={}},58537:function(n,t,e){"use strict";var r;e.d(t,{w:function(){return r}}),function(n){n[n.Desktop=0]="Desktop",n[n.Mobile=1]="Mobile",n[n.Auto=2]="Auto",n[n.Embed=3]="Embed"}(r||(r={}))},5699:function(n,t,e){"use strict";e.d(t,{$A:function(){return y},$w:function(){return h},Bv:function(){return l},Cm:function(){return k},E1:function(){return U},Gy:function(){return T},Hs:function(){return r},J9:function(){return o},KF:function(){return v},L:function(){return D},N5:function(){return z},OP:function(){return V},QA:function(){return f},QM:function(){return O},Q_:function(){return x},Qx:function(){return A},Tb:function(){return c},VZ:function(){return F},W1:function(){return g},bf:function(){return d},er:function(){return I},f0:function(){return s},gK:function(){return _},gU:function(){return E},hj:function(){return b},i:function(){return B},i7:function(){return q},iA:function(){return C},iQ:function(){return L},l3:function(){return w},lV:function(){return R},lv:function(){return u},m0:function(){return S},nq:function(){return P},rd:function(){return M},te:function(){return p},uS:function(){return a},ul:function(){return N},wc:function(){return i},xM:function(){return G},zo:function(){return m}});var r="291cebec6b9a4cbf9489bc8cf3a0cc50-06f4c682-bd49-4f88-a8c2-ac582180b7f9-7725",i="d4551187b06a470980076d381efaa944-55338c41-3ed1-4be7-86ae-f6f2d022aa9a-7049",o="34574250afbe400d814cda5bafaabbbf-e8b2d8de-469a-4779-8134-0c3b0fa0d78e-7592",u="577e32a3275e48c5a639a92c9a8af033-4028cb75-b5f4-4ad0-835e-0e26d79ff209-6823",s="aa96061debfd4ec7b9704f62060b4ca6-a498d428-fdba-43da-bc8b-4fe51865cb7f-7984",a="79beea9c4fdb49a5adab4843729e1fa0-19b42cd4-5bd4-4bf8-8e49-05dc0f7f97f8-7484",c="5f4ebf0f9a11474199e89f94bc7e2f50-61b8420a-22b1-4220-b531-4a4b96e4edb9-7406",f="2ddc7e5f54754fc68f3ae1c5b7f3eb20-1883aa8c-4c7b-42d1-b3d6-c9cdb5956783-7092",l="e132e188c609439ab47cd7b06511fc0a-433f81b3-fab9-415a-882a-ba9e2f91abea-6917",h="d34df8693d35452c98f0e1cdfde6d6a8-44cd1abe-6b6d-4edc-a342-46ba159633a4-7645",d="847cac884ec7438c803f8fc375832d7f-8af022cb-395a-4731-b40b-aade0142f724-7321",m="fb4a5e0bc6e5481a8790cf380d1b1058-eaf2bb92-036c-4ff5-984e-ad0782620010-7469",v="event_correlation_id",p="duration",g="event_name",b="properties",w="timestamp",I="form_id",y="user_type",S="client_build_version",F="integration_appid",C="integration_host",_="MUID",T="page_type",P="routing_build",N="routing_dc",k="routing_instance",E="server_build_version",R="server_dc",O="server_instance",D="server_ring",x="session_id",L="source_application",M="UserInfo.Id",q="UserInfo.IdType",A="UserInfo.OMSTenantId",U="user_id",V="user_role",G="user_tenant_id",B="4e990506778b4d9cbf05300e98315eed-682648e1-a406-45c4-9d5b-709b9899d662-7161",z="Office.Forms.Web"},31442:function(n,t,e){"use strict";e.d(t,{f:function(){return m},RF:function(){return l},$U:function(){return f},zU:function(){return v},JG:function(){return c},b6:function(){return h},w6:function(){return d}});var r=e(60211),i=e(43209),o=e(72377),u=e(73546);function s(n,t,e,r,i){i&&console.error(i),v("UnhandleException",{columnNo:r,error:i&&i.toString(),fileName:t,lineNo:e,message:n,stack:i&&i.stack})}var a=[];function c(n){(0,u.j)().logFormsProEvent(n)}function f(n,t,s){(0,u.j)().logData({correlationId:s,eventName:n,eventType:"engagement_event",extraData:t}),(0,r.x8)()||"Design"!==(0,i.C2)()||(0===a.length&&e.e(410).then(e.t.bind(e,40634,19)).then((function(n){return n.default})).then((function(n){a=n})),n&&a.indexOf(n)>=0&&o.Pv.Resolve("IFormUserContextActionSignal").addUserActionSignal(n,6,null,!1))}function l(n,t){(0,u.j)().logData({eventName:n,eventType:"diagnostic_event",extraData:t})}function h(n,t){(0,u.j)().logData({eventName:n,eventType:"generic_event",extraData:t,$optoutUTel:!0})}function d(n,t){(0,u.j)().logData({eventName:n,eventType:"impression_event",extraData:t,$optoutUTel:!0})}function m(n,t){(0,u.j)().logData({eventName:n,eventType:"anonymous_event",extraData:t})}function v(n,t,e){(0,u.j)().logData({correlationId:e,eventName:n,eventType:"error_event",extraData:t})}var p=window.onerror;window.onerror=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];s.apply(void 0,n),p&&p.apply(this,n)}},89904:function(n,t,e){"use strict";e.d(t,{$o:function(){return u},AX:function(){return o}});var r=e(64459),i=e(63795),o=function(n){return(0,i.r3)(n,"<head")||(0,i.r3)(n,"<title")||(0,i.r3)(n,"<span")||(0,i.r3)(n,"<div")||(0,i.r3)(n,"<html")||(0,i.r3)(n,"<!DOCTYPE")||(0,i.r3)(n,"<img")},u=function(n){var t;return n.properties=function(n){return o(n)?'{"log":"[Sanitized log due to property contains HTML]"}':n}((t=n.properties,(0,i.r3)(t,"OnlineSafetyLevel")&&(0,i.r3)(t,"Questions")&&(0,i.r3)(t,"IsQuiz")?'{"log":"[Sanitized log due to property contains Form Definition]"}':t)),n.properties=function(n){return(0,i.r3)(n,"submitDate")&&(0,i.r3)(n,"responderName")&&(0,i.r3)(n,"answers")?'{"log":"[Sanitized log due to property contains Form Result]"}':n}(n.properties),n.properties=function(n){return(0,i.r3)(n,"userName")||(0,i.r3)(n,"user name")?'{"log":"[Sanitized log due to property contains UserName]"}':n}(n.properties),n=function(n){if(n){if((0,i.r3)(n.eventName,"ClientMSGraph.GetPeople")&&(0,i.r3)(n.properties,"Syntax error")){var t=(0,r.d)(n.properties);t&&t.ServiceError&&(t.ServiceError.sourceUrl='{"log":"[Sanitized log due to sourceUrl contains people list]"}',t.ServiceError.innerMessage='{"log":"[Sanitized log due to sourceUrl contains people list]"}',n.properties=JSON.stringify(t))}return n}}(function(n){if(n){if((0,i.r3)(n.eventName,"FileUpload.UploadFile")){var t=(0,r.d)(n.properties);t&&t.ServiceError&&t.ServiceError.sourceUrl&&(t.ServiceError.sourceUrl='{"log":"[Sanitized log due to sourceUrl contains user content]"}',n.properties=JSON.stringify(t))}return n}}(n))}},44644:function(n,t,e){"use strict";e.d(t,{P:function(){return u}});var r=e(94290),i=e(20987),o=e(90710);function u(){var n;if(n=(0,r.Eh)())return n;var t="origin",e=(0,o.NW)()[t];return e||(t="oembedsso",(0,o.NW)()[t]?"Forms WebPart":(0,i.ft)()?"PowerPoint":null)}},14327:function(n,t,e){"use strict";function r(n){return"string"!=typeof n?n:n.replace(/((http|https|chrome-extension):\/\/[^\?\#]+[\?\#])([^ \s'"]+)[ \s'"]?/g,"$1[PII:UrlParameters] ")}function i(n){return"string"!=typeof n?n:n.replace(/(?![\w]+@thread\.v2)[a-zA-Z0-9.!#$%&’*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)/g,"[PII:Email]")}function o(n){var t=new Set(["","/","/default.aspx"]);if(!n||"string"!=typeof n)return!0;var e=n.trim().toLocaleLowerCase();return""===e||(!!t.has(e)||(!!e.startsWith("/pages/")||!!/^\/(r|g|e)\/[^.]+$/.test(e)))}e.d(t,{Or:function(){return o},WW:function(){return r},ug:function(){return i}})},13309:function(n,t,e){"use strict";e.d(t,{u:function(){return r}});var r=(0,e(4851).Rm)((function(){return!!window.navigator.webdriver||navigator.userAgent.includes("HeadlessChrome")}))},93387:function(n,t,e){"use strict";e.d(t,{ax:function(){return f},zx:function(){return l}});var r=e(59312),i=e(87363),o=e(29559),u=e(262),s=e(65274),a=e(88744),c=e(23112);function f(n){return i.createElement(l,(0,r.pi)({},n))}var l=function(n){function t(t){var e=n.call(this,t)||this;return e.xi=(0,s.EL)("b"),e.Li=i.createRef(),e.Mi=0,e.state={ShowTooltip:!1},e.qi=e.qi.bind(e),e}return(0,r.ZT)(t,n),t.prototype.componentWillUnmount=function(){window.clearTimeout(this.Mi)},t.prototype.componentDidUpdate=function(){var n=this.Li.current;if(this.state.ShowTooltip&&n){var t=n.getBoundingClientRect(),e=this.getHtmlElement();if(t.right>window.innerWidth){var r=e.getBoundingClientRect();n.style.left="auto",n.style.right=(0,o.tq)()?"".concat(window.innerWidth-r.right,"px"):"".concat(r.right-window.innerWidth,"px")}t.bottom>window.innerHeight&&(n.style.bottom="".concat(e.clientHeight,"px"))}},t.prototype.render=function(){var n=this,t=(0,s.l7)({},this.props.HTMLAttributes);switch(t.className=(0,u.j)(t.className,"button-control"),t["aria-pressed"]=this.props.ToggleActive,this.props.ToggleActive&&(t.className=(0,u.j)(t.className,"active")),this.props.ButtonStyle){case 1:t.className=(0,u.j)(t.className,"light-background-button");break;case 2:t.className=(0,u.j)(t.className,"dark-background-button")}var e=null,o=this.props.Tooltip,c=t.title;if(o||c){var f=void 0;c&&c!==o&&(f=i.createElement("span",{key:"s"},c));var l=void 0;if(o){var d=void 0;t["aria-label"]===o||t["aria-describedby"]||(d=this.xi+"-tooltip",t["aria-describedby"]=d),l=i.createElement("span",{id:d,key:"t"},o)}var m=void 0;m=this.state.ShowTooltip?this.props.TooltipClassName||"button-tooltip":"screenReaderReference",e=i.createElement("div",{className:m,key:"t",onClick:h,ref:this.Li},f,l),t.title=void 0,t.onKeyUp=(0,a.F)(t.onKeyUp,this.qi),t.onFocus=(0,a.F)(t.onFocus,(function(){return n.Ai(!0)})),t.onMouseOver=(0,a.F)(t.onMouseOver,(function(){return n.Ai(!0)})),t.onBlur=(0,a.F)(t.onBlur,(function(){return n.Ai(!1)})),t.onMouseOut=(0,a.F)(t.onMouseOut,(function(){return n.Ai(!1)}))}return i.createElement("button",(0,r.pi)({},t),i.createElement("div",{className:"button-content"},this.props.children),e)},t.prototype.focus=function(){this.getHtmlElement().focus()},t.prototype.qi=function(n){this.state.ShowTooltip&&27===n.keyCode&&(n.stopPropagation(),this.setState({ShowTooltip:!1}))},t.prototype.Ai=function(n){var t=this;window.clearTimeout(this.Mi),this.state.ShowTooltip!==n&&(this.Mi=window.setTimeout((function(){t.setState({ShowTooltip:n}),t.Mi=0}),n?500:300))},t}(c.r);function h(n){n.stopPropagation()}},74302:function(n,t,e){"use strict";e.d(t,{i:function(){return s}});var r=e(59312),i=e(87363),o=e(12611),u=e(262),s=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return(0,r.ZT)(t,n),t.prototype.render=function(){var n=o.extend({},this.props.HTMLAttributes);return this.props.ValidationStyle&&(n.className=(0,u.j)(n.className,this.props.ValidationStyle)),this.props.Hidden&&(n.style=n.style||{},n.style.display="none"),i.createElement("div",n,this.createReactNodes())},t.prototype.createReactNodes=function(){throw Error("to be overridden.")},t}(i.Component)},35929:function(n,t,e){"use strict";e.d(t,{R:function(){return o}});var r=e(59312),i=e(87363),o=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return(0,r.ZT)(t,n),t.prototype.render=function(){return i.createElement("span",{className:"required-star"})},t}(e(23112).r)},3424:function(n,t,e){"use strict";e.d(t,{F:function(){return a},M:function(){return s}});var r=e(59312),i=e(87363),o=e(262),u=e(65274);function s(n){return i.createElement(a,(0,r.pi)({},n))}var a=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return(0,r.ZT)(t,n),t.prototype.render=function(){var n=(0,u.d9)(this.props.HTMLAttributes)||{};if(this.props.FluentIcon){var t=this.props.FluentIcon.replaceAll(" ","");n.className=(0,o.j)("ff-icon ff-icon-".concat(t),this.props.className,n.className)}else n.className=(0,o.j)("ms-Icon",this.props.IconName?"ms-Icon--".concat(this.props.IconName):"",this.props.className,n.className);return this.props.Accessible||(n.role="presentation",n["aria-hidden"]="true"),i.createElement("i",(0,r.pi)({},n))},t}(e(23112).r)},42605:function(n,t,e){"use strict";e.d(t,{F:function(){return c}});var r=e(59312),i=e(87363),o=e(12611),u=e(262),s=e(93387),a=e(3424);function c(n){var t,e,c=o.clone(n)||{},f=o.clone(c.HTMLAttributes)||{};switch(c.HTMLAttributes=f,n.GlyphButtonStyle){case 1:case"Vertical":f.className=(0,u.j)(f.className,"glyph-button-control-vertical");break;default:f.className=(0,u.j)(f.className,"glyph-button-control-horizontal")}if(f["aria-label"]=f["aria-label"]||n.Text,n.Icon||n.FluentIcon){var l={FluentIcon:n.FluentIcon,HTMLAttributes:{className:n.IconClassName},IconName:n.Icon,key:"icon"};t=i.createElement(a.F,(0,r.pi)({},l))}switch("GlyphOnly"!==n.GlyphButtonStyle&&2!==n.GlyphButtonStyle?e=i.createElement("span",{className:n.TextClassName,key:"text"},n.Text):n.Text&&(c.Tooltip=c.Tooltip||n.Text,c.Tooltip!==n.Text&&(f.title=n.Text)),n.GlyphLocation){case 1:case"Right":c.children=[e,n.children,t];break;default:c.children=[t,e,n.children]}return(0,s.ax)(c)}},17764:function(n,t,e){"use strict";e.d(t,{_:function(){return c}});var r=e(59312),i=e(87363),o=e(49050),u=e(74302),s=e(35929),a=e(3424);function c(n){return i.createElement(f,n)}var f=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.Ui=!1,t.Vi=!1,t}return(0,r.ZT)(t,n),t.prototype.componentDidMount=function(){var n=this;this.Vi=!0,this.Ui||window.setTimeout((function(){n.Ui=!0,n.Vi&&n.forceUpdate()}))},t.prototype.componentWillUnmount=function(){this.Vi=!1},t.prototype.createReactNodes=function(){var n,t=this.props,e=t.ShowRequiredStar?i.createElement(s.R):void 0,r=t.ShowOrdinal?i.createElement("span",{className:"ordinal-number",key:"ordinalNumber"},"".concat(this.props.Ordinal,".")):void 0;t.Alert&&!this.Ui||(n=(0,o.q)({ContainsHtml:!!t.HtmlContent,Text:t.Label,RenderMode:"RichText"}));var u=t.ShowWarningIcon&&(0,a.M)({FluentIcon:"Error Circle",HTMLAttributes:{className:"forms-icon-size20x20 warning-icon-style",title:t.WarningIconTooltip},Accessible:!0}),c=t.ShowInfoIcon&&(0,a.M)({FluentIcon:"Info",HTMLAttributes:{className:"forms-icon-size12x12 info-icon-style",title:t.InfoIconTooltip},Accessible:!0});return t.Bold?i.createElement(i.Fragment,{},i.createElement("b",void 0,r,n,e),t.children):i.createElement(i.Fragment,{},r,n,e,u,c,t.children)},t}(u.i)},41040:function(n,t,e){"use strict";e.d(t,{P:function(){return u}});var r=e(59312),i=e(87363),o=e(262),u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return(0,r.ZT)(t,n),t.prototype.render=function(){var n=this.props.Ignorable?(0,o.j)(this.props.ClassName,"optional-cell"):this.props.ClassName;return i.createElement("div",{className:n},i.createElement("div",{className:"common-spinner-circle"}),this.Gi())},t.prototype.Gi=function(){if(this.props.LoadingDescription)return i.createElement("div",{className:"loading-control-description",role:"status"},this.props.LoadingDescription)},t}(e(23112).r)},61111:function(n,t,e){"use strict";e.d(t,{E:function(){return m}});var r=e(59312),i=e(87363),o=e(61533),u=e(12611),s=e(29559),a=e(262),c=e(38174),f=e(54496),l=e(23112),h=e(3424),d=e(49050);function m(n){return i.createElement(v,(0,r.pi)({},n))}var v=function(n){function t(e){var r=n.call(this,e)||this;r.Bi=!0,r.zi=u.uniqueId(t.name),r.ji=r.zi+"_placeholder",r.Qi=i.createRef(),r.$i=r.$i.bind(r),r.Wi=r.Wi.bind(r),r.Ji=r.Ji.bind(r),r.Ki=r.Ki.bind(r);var o=r.Xi(),s=u.findIndex(o,(function(n){return n.Value===r.props.Value}));return r.Yi=s<0?void 0:o[s].Key,r.state={Expanded:!1},r}return(0,r.ZT)(t,n),t.prototype.componentWillUpdate=function(n,e){var r=t.GetSelectOptions(n),i=u.findIndex(r,(function(t){return t.Value===n.Value}));this.Yi=i<0?void 0:r[i].Key},t.prototype.componentDidMount=function(){this.Bi=!1},t.prototype.componentDidUpdate=function(){if(this.Zi(),this.state.Expanded){if(this.eo(),this.props.NeedScroll){var n=this.Qi.current;if(n){var t=$(".office-form-content"),e=n.getBoundingClientRect().bottom,r=t.height()-e;if(r<70){var i=o.findDOMNode(this.refs.menu);t.scrollTop(t.scrollTop()+i.offsetHeight-r)}}}var u=this.refs[this.Yi];if(u){var s=o.findDOMNode(u);s&&s.focus()}}},t.prototype.eo=function(){var n=document.getElementById(this.zi),t=window.getComputedStyle(n),e=n.offsetWidth,r=o.findDOMNode(this.refs.menu);(this.props.AllowWrap||r.offsetWidth<e)&&(r.style.width=e+"px"),r.style.top=n.offsetHeight-parseInt(t.borderTopWidth)+"px",r.style.left="-"+t.borderLeftWidth},t.prototype.render=function(){var n=this,t=u.extend({},this.props.HTMLAttributes),e=(0,f.p2)(t,{className:"select-control",id:this.zi,onBlur:this.$i,onClick:t.disabled?void 0:function(){return n.io()},onKeyUp:this.Wi,onKeyDown:this.Ji,ref:this.Qi,tabIndex:t.disabled?-1:0});return this.props.IsMobile||(e=(0,f.p2)(e,{"aria-describedby":this.ji,"aria-expanded":this.state.Expanded,"aria-haspopup":"listbox","aria-label":this.props.Label,"aria-required":!!this.props.required,role:"listbox"})),i.createElement("div",(0,r.pi)({},e),this.oo(),this.uo())},t.GetSelectOptions=function(n){var t=n.SelectOptions;if(t)return t;var e=n.SelectOptionGroups;return u.flatten(e.map((function(n){return n.SelectOptions})))},t.prototype.Xi=function(){return t.GetSelectOptions(this.props)},t.prototype.so=function(){return!!this.ao()},t.prototype.ao=function(){return this.props.SelectOptionGroups},t.prototype.oo=function(){var n,t=this,e=this.Xi(),o=u.findIndex(e,(function(n){return void 0===t.Yi?n.Value===t.props.Value:n.Key===t.Yi})),a=this.Yi?"select-placeholder-text":"select-placeholder-text default",c=this.props.IsMobile;o>=0&&(n=e[o].DisplayContent||e[o].DisplayName),n||(n=this.props.Placeholder||"");var l=(this.props.PlaceholderIcon||this.props.PlaceholderFluentIcon)&&i.createElement("div",{className:"select-placeholder-icon","aria-hidden":"true"},i.createElement(h.F,{FluentIcon:this.props.PlaceholderFluentIcon,IconName:this.props.PlaceholderIcon,HTMLAttributes:{className:"forms-icon-size14x14"}})),m={className:"select-placeholder","aria-hidden":(0,s.Dt)(),"aria-label":c?this.props.Label:this.lo(e[o]),"aria-live":this.state.Expanded||this.Bi?"off":"polite","aria-selected":!0,"aria-posinset":o>0?o+1:void 0,"aria-setsize":o>0?e.length:void 0,id:this.ji,role:this.props.IsMobile?"button":"option"};return c&&(m=(0,f.p2)(m,{"aria-expanded":this.state.Expanded,"aria-haspopup":"listbox"})),i.createElement("div",(0,r.pi)({},m),l,i.createElement("span",{className:a},"string"==typeof n?i.createElement(d.D,{Text:n,RenderMode:"RichText",ContainsHtml:!0}):i.createElement("span",null,n)),this.ho())},t.prototype.lo=function(n){return n&&n.DisplayName?n.DisplayName:this.props.Placeholder||""},t.prototype.ho=function(){var n={FluentIcon:this.state.Expanded?"Chevron Up":"Chevron Down",HTMLAttributes:{className:"select-placeholder-arrow forms-icon-size14x14"},IconName:this.state.Expanded?"ChevronUp":"ChevronDown"};return i.createElement(h.F,(0,r.pi)({},n))},t.prototype.uo=function(){var n=this;if(this.state.Expanded){var t={"aria-label":this.props.Label,className:"select-option-menu-container",ref:"menu",role:"listbox",onWheel:function(t){t.preventDefault();var e=t.deltaY,r=o.findDOMNode(n.refs.menu),i=r.scrollTop+e;if(e>=0){var u=r.scrollHeight-r.clientHeight;r.scrollTop=Math.min(i,u)}else r.scrollTop=Math.max(i,0)}};return i.createElement("div",(0,r.pi)({},t),this.do())}},t.prototype.do=function(){var n=this;return this.so()?this.ao().map((function(t,e){return n.mo(t,e)})):this.vo(this.Xi())},t.prototype.mo=function(n,t){var e=!(!n.SelectOptions.length||!n.DisplayName)&&i.createElement("h5",{className:"select-group-header office-form-theme-primary-color",key:"group_header"+t},n.DisplayName);return i.createElement(i.Fragment,{key:"group_"+t},e,this.vo(n.SelectOptions))},t.prototype.vo=function(n){var t=this;return n.map((function(n,e,r){return t.po(n,e,r.length)}))},t.prototype.po=function(n,t,e){var u=this,s=n.Key===this.Yi,c={"aria-label":n.AriaLabel||n.DisplayName,"aria-selected":s,"aria-disabled":n.Disabled,"aria-posinset":t+1,"aria-setsize":e,className:this.props.AllowWrap?"select-option-nocheck":"select-option",tabIndex:s?0:-1,key:n.Key,ref:n.Key&&n.Key.toString(),role:"option"};n.Disabled?(c.className=(0,a.j)(c.className,"disabled"),c["aria-labelledby"]=n.ArialLabelId||void 0,c.onFocus=function(t){t.stopPropagation(),n.showToolTip&&n.showToolTip(),n.DisableFocused=!0},c.onBlur=function(t){t.stopPropagation(),n.hideToolTip&&n.hideToolTip(),n.DisableFocused=!1}):c.onClick=function(t){t.stopPropagation(),u.Yi&&u.Yi===n.Key||u.props.onValueChange(n.Value),u.setState({Expanded:!1},(function(){o.findDOMNode(u).focus()}))};var f,l="select-option-state forms-icon-size14x14";(this.props.PlaceholderIcon||this.props.PlaceholderFluentIcon)&&(l=(0,a.j)(l,"hasPlaceholderIcon")),this.props.AllowWrap||(f=i.createElement(h.F,{FluentIcon:"Checkmark",HTMLAttributes:{className:l}})),s&&(c.className=(0,a.j)(c.className,"selected"));var m=n.DisplayContent;return m||(m=i.createElement("span",{"aria-hidden":"true"},i.createElement(d.D,{Text:n.DisplayName,RenderMode:"RichText",ContainsHtml:!0}))),i.createElement("div",(0,r.pi)({},c),i.createElement("div",{className:"select-option-content"},f,m))},t.prototype.$i=function(n){var t=this,e=this.Qi.current;n.persist(),window.setTimeout((function(){var r=(0,c.y3)(n);e&&!e.contains(r)&&t.state.Expanded&&"HTML"!==r.nodeName&&t.setState({Expanded:!1})}),0)},t.prototype.Ji=function(n){if(this.state.Expanded&&27===n.keyCode&&(n.stopPropagation(),this.Ki()),(0,s.Dt)())switch(n.keyCode){case 32:case 13:n.preventDefault(),n.stopPropagation()}},t.prototype.Wi=function(n){var t=this;switch(n.keyCode){case 32:this.setState({Expanded:!0}),n.stopPropagation();break;case 13:this.io(!0),n.stopPropagation();break;case 9:this.state.Expanded&&(n.stopPropagation(),this.Ki());break;case 38:case 40:n.altKey?this.setState({Expanded:!this.state.Expanded},(function(){var n=t.Qi.current;!t.state.Expanded&&n&&n.focus()})):38===n.keyCode?this.bo():this.Io(),n.stopPropagation(),n.preventDefault()}},t.prototype.bo=function(){var n=this,t=this.Xi(),e=u.findIndex(t,(function(t){return t.Key===n.Yi}));if(e>0){var r=t[e-1];if(this.Yi=r.Key,r.Disabled||this.props.disableSelectOnArrowKeys){var i=o.findDOMNode(this.refs[r.Key]);i&&i.focus()}else this.props.onValueChange(r.Value)}},t.prototype.Io=function(){var n=this,t=this.Xi(),e=u.findIndex(t,(function(t){return t.Key===n.Yi}));if(e<t.length-1){var r=t[e+1];this.Yi=r.Key;var i=o.findDOMNode(this.refs[r.Key]);i&&i.focus(),r.Disabled||this.props.disableSelectOnArrowKeys||this.props.onValueChange(r.Value)}},t.prototype.io=function(n){var t=this,e=this.Xi();if(this.state.Expanded){if(o.findDOMNode(this).focus(),this.props.disableSelectOnArrowKeys){var r=u.findIndex(e,(function(n){return n.Key===t.Yi}));e[r]&&this.props.onValueChange(e[r].Value)}}else n&&void 0===this.Yi&&e[0]&&this.props.onValueChange(e[0].Value);this.setState({Expanded:!this.state.Expanded})},t.prototype.Zi=function(){if(this.state.Expanded){var n=$(o.findDOMNode(this.refs.menu)),t=n.find(".select-option.selected");(0,f.n1)(t,n)}},t.prototype.Ki=function(){var n=this,t=this.Xi();u.some(t,(function(n){return n.DisableFocused}))?t.forEach((function(n){n.Disabled&&n.hideToolTip&&(n.hideToolTip(),n.DisableFocused=!1)})):this.setState({Expanded:!1},(function(){n.Qi.current&&n.Qi.current.focus()}))},t.prototype.focus=function(){o.findDOMNode(this).focus()},t}(l.r)},40554:function(n,t,e){"use strict";e.d(t,{s:function(){return v}});var r=e(59312),i=e(87363),o=e(61533),u=e(12611),s=e(29559),a=e(262),c=e(38174),f=e(54496),l=e(3424),h=e(23112),d=e(63481),m=e(42605);function v(n){return i.createElement(p,(0,r.pi)({},n))}var p=function(n){function t(e){var r=n.call(this,e)||this;return r.yo=u.uniqueId(t.name),r.So=r.So.bind(r),r}return(0,r.ZT)(t,n),t.prototype.componentDidMount=function(){(void 0===this.props.TrapFocus||this.props.TrapFocus)&&(0,d.mZ)(o.findDOMNode(this))},t.prototype.shouldComponentUpdate=function(n){return!u.isEqual(this.props,n)},t.prototype.render=function(){var n=this;if(this.props.ShowDialog){var t=(0,f.p2)(this.props.HTMLAttributes,{className:this.props.ClassName||"simple-dialog-container",key:"dialogContainer",ref:"dialogContainer",tabIndex:-1,onBlur:function(t){var e=(0,c.y3)(t);o.findDOMNode(n.refs.dialogContainer).contains(e)||n.props.onBlur&&n.props.onBlur()},onKeyDown:function(t){return n.Ji(t)},onMouseLeave:this.props.onMouseLeave,onMouseOver:this.props.onMouseOver}),e=!(0,s.tq)();return i.createElement("div",(0,r.pi)({},t),this.props.children,this.Fo(),e&&this.props.CloseButtonProps&&this.To(),this.Po(),this.No(),this.Eo())}return null},t.prototype.Fo=function(){var n=this.props;if(n.IconName||n.FluentIcon){var t={FluentIcon:n.FluentIcon,HTMLAttributes:{className:n.IconClassName},IconName:n.IconName,key:"icon"};return i.createElement(l.F,(0,r.pi)({},t))}},t.prototype.To=function(){return this.So(this.props.CloseButtonProps,this.props.ButtonsProps.length+1)},t.prototype.Po=function(){if(this.props.Description){var n=(0,a.j)("description-container",this.props.TextClassName);return i.createElement("div",{className:n,id:this.yo,key:"descriptionContainer"},this.props.Description)}return null},t.prototype.Eo=function(){return this.props.WarningMessage?i.createElement("div",{className:"warning-container",id:this.yo+"_warning",key:"warningContainer"},this.props.WarningMessage):null},t.prototype.So=function(n,t){return(0,m.F)({ButtonStyle:n.ButtonStyle,GlyphButtonStyle:n.GlyphButtonStyle,FluentIcon:n.FluentIcon,HTMLAttributes:{"aria-describedby":n.ConveyDescription?this.yo:"",autoFocus:0===t,className:n.ClassName,title:n.Title,onClick:function(t){t.preventDefault(),t.stopPropagation(),n.onClick&&n.onClick(t)}},Icon:n.IconClass,IconClassName:(0,a.j)(n.IconClassName,"forms-icon-size24x24"),IsDisabled:n.IsDisabled,key:n.Key,ref:n.ref,Text:n.Text,TextClassName:n.TextClassName})},t.prototype.No=function(){var n=this.props.ButtonsProps||[];return n.length>0?i.createElement("div",{className:"buttons-container",key:"buttonsContainer"},n.filter((function(n){return!!n})).map(this.So)):null},t.prototype.Ji=function(n){27===n.keyCode&&(n.stopPropagation(),n.preventDefault(),this.props.onDismiss&&this.props.onDismiss())},t}(h.r)},20572:function(n,t,e){"use strict";e.d(t,{ZA:function(){return F},ZN:function(){return C}});var r=e(59312),i=e(87363),o=e(61533),u=e(12611),s=e(29559),a=e(262),c=e(63795),f=e(73252),l=e(687),h=e(7645),d=e(54496),m=e(32782),v=e(29295);function p(){return(0,r.mG)(this,void 0,void 0,(function(){return(0,r.Jh)(this,(function(n){switch(n.label){case 0:return[4,e.e(757).then(e.bind(e,17213))];case 1:return[2,{default:n.sent().EditorRibbonCombination}]}}))}))}function g(n){var t=(0,v.J)(g,p);return i.createElement(m.Z,null,i.createElement(t,(0,r.pi)({},n)))}var b=e(64290),w=e(31442),I=e(23112);var y=e(74302),S=e(35929);function F(n){return i.createElement(_,n)}function C(n,t,e,r,i,o,u,s,a){return(0,b.pd)((function(){return F(n)}),(function(){return b.Xw.createTextFieldWithCKEditor(n,t,e,r,i,o,u,s,a)}))}var _=function(n){function t(t){var e=n.call(this,t)||this;return e.Ro=i.createRef(),e.Oo=e.Oo.bind(e),e}return(0,r.ZT)(t,n),t.prototype.componentDidMount=function(){this.props.AutoFocus&&this.focus()},t.prototype.focus=function(){if(this.Ro.current)this.Ro.current.focus();else{var n=o.findDOMNode(this),t=$(n).find(".roosterjs-editor-box");t&&t.focus()}},t.prototype.createReactNodes=function(){return i.createElement(i.Fragment,{},this.Do(),this.xo())},t.prototype.Do=function(){var n=this.props,t=n.Options;if(n.Label||n.ShowRequiredStar)return i.createElement("div",null,i.createElement("span",{className:t&&t.classNameForInnerLabel},n.Label),n.ShowRequiredStar?i.createElement(S.R):void 0)},t.prototype.Mo=function(){var n=this,e=this.props,r=e.Options,i="DesignPage.ShortCut.Clipboard",u="".concat("office-form-textfield-input"," form-control border-no-radius");return(0,b.md)((function(){n.props.AddTextToClassName&&(u="".concat(u," cv-").concat(n.props.HTMLAttributes.className))})),(0,d.p2)(r&&r.HTMLPropsForInnerElement,{value:e.Value||"","aria-label":e.AriaLabel,className:u,rows:this.props.Rows,placeholder:e.Placeholder,ref:this.Ro,"aria-required":e.Required,style:{height:e.MinimalHeight?"".concat(e.MinimalHeight,"px"):void 0,overflowY:1===e.TextFieldType?"auto":void 0},spellCheck:!0,disabled:e.Disabled,onChange:this.qo.bind(this),maxLength:e.MaxLength?e.MaxLength:(0,l.LY)(),onFocus:e.AutoSelection?function(){if(n.Ro.current){var t=o.findDOMNode(n.Ro.current);t&&t.select()}}:void 0,onClick:function(){var t;return(0,s.gn)()&&(null===(t=n.Ro.current)||void 0===t?void 0:t.focus())},onKeyDown:(0,d.IB)((function(r){if(r.ctrlKey||r.metaKey){var o=new Date,u=String.fromCharCode(r.keyCode),s="".concat(r.ctrlKey?"Ctrl":"Meta","+").concat(u);switch(u){case"B":case"I":case"U":(0,w.$U)("TextFormatShortcutEvent",{TextFormatFlight:!0,Shortcut:s,Location:e.TextFieldLocation});break;case"C":case"X":n.Ao(t.prevTimeKeyDown,o.getTime())>t.minDuration&&n.Uo(r,i,s),t.prevTimeKeyDown=o.getTime();break;case"V":n.Uo(r,i,s);break;case"Y":case"Z":n.Uo(r,"DesignPage.ShortCut.UndoRedo",s)}}})),onCopy:function(e){var r=new Date;n.Ao(t.prevTimeOnCopy,r.getTime())>t.minDuration&&n.Uo(e,i,"onCopy"),t.prevTimeOnCopy=r.getTime()},onPaste:function(t){n.Uo(t,i,"onPaste")},onCut:function(e){var r=new Date;n.Ao(t.prevTimeOnCut,r.getTime())>t.minDuration&&n.Uo(e,i,"onCut"),t.prevTimeOnCut=r.getTime()}})},t.prototype.xo=function(){var n,t,e,r,o,u,s=this.props,c=this.Mo(),l=(0,a.j)("office-form-textfield",null===(n=s.Options)||void 0===n?void 0:n.classNameForInnerDiv);if(s.Disabled||!s.AllowRichText||(0,f._y)())switch(s.TextFieldType){case 2:var d=c,m=null==s.MinimalHeight?80:s.MinimalHeight>0?s.MinimalHeight:0;d.MinHeight=m.toString()+"px",e=function(n){return i.createElement(T,n)}(d);break;case 1:r=i.createElement("textarea",c);break;default:o=i.createElement("input",c)}else{l=(0,a.j)(l,"textfield-with-text-format");var v=(0,a.j)("roosterjs-editor-box",c.className);(2===s.TextFieldType||s.AllowHeightAdjustment)&&(v=(0,a.j)(v,"auto-height-div"),delete c.style.height,c.style.minHeight=s.MinimalHeight?"".concat(s.MinimalHeight,"px"):void 0),t=g({$ariaLabel:c["aria-label"],$autoFocus:s.AutoFocus,$className:v,$disableRibbon:s.DisableRibbon,$leaveFirstLineOnlyWhenPaste:s.LeaveFirstLineOnlyWhenPaste,$maxLength:c.maxLength,$placeHolder:c.placeholder,$preventMultiline:!s.TextFieldType,$style:c.style,$textFieldLocation:s.TextFieldLocation,$value:String(c.value),$context:{$flights:{$svgIcon:!1},$ls:(0,h.pm)(),$funcAdapters:{$logEngagement:w.$U}},$onKeyDown:c.onKeyDown,$onPaste:s.onRichEditorPaste,$updateContentToBindBox:this.Oo})}if(s.ShowCharCounter){var p=!s.Value||c.maxLength>s.Value.length?"office-form-textfield-counter":"office-form-textfield-counter textfield-counter-warning";u=i.createElement("label",{className:p},this.Vo(s.Value,c.maxLength))}return i.createElement("div",{className:l},t,e,r,o,u)},t.prototype.Oo=function(n){this.props.onValueChange(n)},t.prototype.qo=function(n){if(!this.props.Disabled){var t=n.target,e=(0,c.bC)(t.value);if(e&&e.length>t.maxLength&&(e=e.slice(0,t.maxLength)),this.props.onValueChange(e),this.props.ShowCharCounter){var r=o.findDOMNode(t).nextSibling;r&&(r.innerText=this.Vo(e,t.maxLength))}}},t.prototype.Vo=function(n,t){return(n||"").length.toString()+" / "+t.toString()},t.prototype.Uo=function(n,t,e){var r;this.props.HTMLAttributes&&(r=this.props.HTMLAttributes.className),(0,w.$U)(t,{targetClassName:r,operation:e})},t.prototype.Ao=function(n,t){return t-n},t.prevTimeKeyDown=0,t.prevTimeOnCopy=0,t.prevTimeOnCut=0,t.minDuration=500,t}(y.i);var T=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.Ro=i.createRef(),t}return(0,r.ZT)(t,n),t.prototype.componentDidMount=function(){this.Go(),this.Bo=this.Go.bind(this),window.addEventListener("resize",this.Bo)},t.prototype.componentDidUpdate=function(){this.Go()},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.Bo)},t.prototype.focus=function(){this.Ro.current&&this.Ro.current.focus()},t.prototype.render=function(){var n=u.clone(this.props);return n.ref=this.Ro,delete n.MinHeight,i.createElement("textarea",n)},t.prototype.Go=function(){if(!this.Ro.current.hasAttribute("rows")){var n=o.findDOMNode(this),t=this.props,e=n.parentElement,r=e.style.height;e.style.height=window.getComputedStyle(e).height,n.style.height=t.MinHeight;var i=n.offsetHeight-n.clientHeight;n.style.height=n.scrollHeight+i+"px",e.style.height=r,n.style.minHeight=t.MinHeight}},t}(I.r)},49050:function(n,t,e){"use strict";e.d(t,{D:function(){return b},q:function(){return g}});var r=e(59312),i=e(87363),o=e(23112),u=e(37944),s=e(59749),a=e(2775),c=["strong","em","u","sup","sub","a","i","b"],f=c.map((function(n){return"<".concat(n,">")})),l=c.map((function(n){return"</".concat(n,">")})),h=c.map((function(n){return"&lt;".concat(n,"&gt;")})),d=c.map((function(n){return"&lt;/".concat(n,"&gt;")}));function m(n){var t=function(n){var t=(0,a.YU)(n);return c.forEach((function(n,e){t=t.replaceAll(h[e],f[e]).replaceAll(d[e],l[e])})),t}(n);return function(n){var t=document.createElement("span");return(0,s.kM)(t,n),n=t.innerHTML}(t)}var v=e(24497),p=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return(0,r.ZT)(t,n),t.prototype.render=function(){var n=this.props,t=n.Html;n.RenderHtml||(t=m(n.Html));var e=(0,v.gA)(t);return i.createElement(u.H,{id:n.Id,className:"text-format-content",$html:e})},t}(o.r);function g(n){return i.createElement(b,(0,r.pi)({},n))}var b=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return(0,r.ZT)(t,n),t.prototype.render=function(){var n;return"RichText"===(this.props.RenderMode||"PlainText")?(n={id:this.props.Id,Html:this.props.Text,RenderHtml:this.props.ContainsHtml},i.createElement(p,(0,r.pi)({},n))):(n={id:this.props.Id},i.createElement("span",(0,r.pi)({},n),this.props.Text))},t}(o.r)},77309:function(n,t,e){"use strict";e.d(t,{L:function(){return u}});var r=e(59312),i=e(87363),o=e(12611),u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return(0,r.ZT)(t,n),t.prototype.componentDidMount=function(){var n=this;this.props.LazyRendering&&window.setTimeout((function(){return n.setState({Mounted:!0})}))},t.prototype.render=function(){var n=o.clone(this.props.HTMLAttributes||{});switch(this.props.Role){case"Alert":n.role="alert";break;case"Log":n.role="log",n["aria-live"]=n["aria-live"]||"polite",n["aria-relevant"]=n["aria-relevant"]||"additions text";break;case"Marquee":n.role="marquee";break;case"Status":n.role="status"}return this.props.LazyRendering&&!this.state.Mounted?(n["aria-label"]=void 0,n.children=null,i.createElement("div",(0,r.pi)({},n))):i.createElement("div",(0,r.pi)({},n),this.props.children)},t}(e(23112).r)},50434:function(n,t,e){"use strict";e.d(t,{DQ:function(){return T},EE:function(){return S},Iy:function(){return R},KR:function(){return F},LP:function(){return P},UL:function(){return N},a1:function(){return D},nX:function(){return C},q2:function(){return E},uV:function(){return _}});var r=e(87363),i=e(12611),o=e(13877),u=e(73252),s=e(7645),a=e(71860),c=e(64290),f=e(3424),l=["mp3","aif","iff","m3u","m4a","mid","mpa","ra","wav","wma"],h=["xls","xlt","xlm","xlsx","xlsm","xltx","xltm"],d=["jpg","jpeg","png","gif","bmp","tiff","psd","thm","yuv","ai","drw","eps","ps","svg","3dm","max"],m=["ppt","pot","pps","pptx","pptm","potx","potm","ppam","ppsx","ppsm","sldx","sldm"],v=["pdf"],p=["avi","mp4","mov","wmv","asf","3g2","3gp","asx","flv","mpg","rm","swf","vob"],g=["doc","dot","wbk","docx","docm","dotx","dotm","docb"],b={};l.forEach((function(n){return b[n]="Audio"})),h.forEach((function(n){return b[n]="Excel"})),d.forEach((function(n){return b[n]="Image"})),m.forEach((function(n){return b[n]="PowerPoint"})),v.forEach((function(n){return b[n]="PDF"})),p.forEach((function(n){return b[n]="Video"})),g.forEach((function(n){return b[n]="Word"}));var w={Audio:l,Excel:h,Image:d,PDF:v,PowerPoint:m,Video:p,Word:g},I={Audio:{Color:"#666",Name:"Microphone"},Excel:{Color:"#217346",Name:"ExcelDocument"},Image:{Color:"#666",Name:"Photo2"},PDF:{Color:"#666",Name:"PDF"},PowerPoint:{Color:"#B7472A",Name:"PowerPointDocument"},Text:{Color:"#666",Name:"TextField"},Video:{Color:"#666",Name:"Video"},Word:{Color:"#2B579A",Name:"WordDocument"}},y="officeforms.fileuploaddialogmap",S={"10MB":10,"100MB":100,"1GB":1e3};function F(n){if((0,c.md)((function(){(0,u.cr)("CustomerVoiceCDSFileUpload")&&n.isFieldReady(a.x.Schema.FileUploadStorage)&&"cds"===n.Model.FileUploadStorage&&n.isFieldReady(n.Schema.FileUploadFormInfo)&&(n.Schema.FileUploadFormInfo=null)})),n.isFieldReady(n.Schema.FileUploadFormInfo)&&n.Model.FileUploadFormInfo&&n.Model.FileUploadFormInfo.errorCode&&"3"!==n.Model.FileUploadFormInfo.errorCode)return(0,s.pm)().UploadFile_ErrorMessage_PortalPage_FormCard_Bar}function C(n){var t=(0,s.pm)(),e="";switch(n){case"3":e=t.UploadFile_ErrorMessage_ErrorCode_3;break;case"6611":e=t.Error_Message_6611;break;case"6612":e=t.Error_Message_6612;break;case"6613":e=t.Error_Message_6613;break;case"6614":e=t.Error_Message_6614;break;default:e=t.UploadFile_Creation_Error_Message}return e}function _(n,t){var e="";switch(n){case 1:e=(0,s.pm)().UploadFile_ErrorMessage_DesignPage_1;break;case 14:e=(0,s.pm)().UploadFile_ErrorMessage_DesignPage_14;break;case 16:e=(0,s.pm)().UploadFile_ErrorMessage_DesignPage_16;break;default:e=(0,s.pm)().UploadFile_Creation_Error_Message}return t?e="".concat((0,s.pm)().UploadFile_ErrorMessage_DesignPage_AnonymousDisabled," ").concat(e):e||(e=(0,s.pm)().UploadFile_Creation_Error_Message),e}function T(n){var t=[];return Object.keys(n).forEach((function(e){n[e]&&(t=t.concat(w[e]))})),t}function P(n){var t=k(n),e={className:"forms-icon-size20x20 office-form-theme-quiz-point analyze-view-file-icon",style:{color:t.Color}};return r.createElement(f.F,{HTMLAttributes:e,IconName:t.Name})}function N(n,t){switch(t){case"Audio":return n.UploadFile_Type_Audio;case"Excel":return n.UploadFile_Type_Excel;case"Image":return n.UploadFile_Type_Image;case"PowerPoint":return n.UploadFile_Type_PowerPoint;case"PDF":return n.UploadFile_Type_PDF;case"Video":return n.UploadFile_Type_Video;case"Word":return n.UploadFile_Type_Word;default:return""}}function k(n){var t=n.split("."),e=t[t.length-1].toLowerCase();return I[b[e]]||{Color:"#666",Name:"TextDocument"}}function E(n,t){var e=n.Model.Id,r=!!i.find(n.Model.Questions,(function(n){return"Question.FileUpload"===n.Type}));if(R(e)||!r){var u=O(),s=i.find(u,(function(n){return n.FormId===e}));s?s.ShowConfirmDialog=s.ShowConfirmDialog&&t:u.push({FormId:e,ShowConfirmDialog:!0}),(0,o.$o)().setItem(y,JSON.stringify(u))}}function R(n){var t=i.find(O(),(function(t){return t.FormId===n}));return!!t&&t.ShowConfirmDialog}function O(){var n=[],t=(0,o.$o)().getItem(y);return t&&(n=JSON.parse(t)),n}function D(n){var t=n.Model.FileTypes;Object.keys(t).forEach((function(n){t[n]=!0}))}},16717:function(n,t,e){"use strict";e.d(t,{U:function(){return u}});var r=e(87363),i=e(7645),o={};Object.defineProperty(o,"LocalizedStrings",{get:i.pm});var u=r.createContext(o)},24635:function(n,t,e){"use strict";e.d(t,{k:function(){return c}});var r=e(59312),i=e(87363),o=e(80820),u=e(69065);var s=e(93387),a=e(3424),c=function(n){function t(t){return n.call(this,t)||this}return(0,r.ZT)(t,n),t.prototype.render=function(){var n=this.jo(),t=this.props.displayText?this.props.displayText.toLocaleUpperCase():(0,a.M)({FluentIcon:"Person",HTMLAttributes:{className:"author-notification-icon"}}),e={backgroundColor:n.backgroundColor,color:n.textColor},r={onClick:function(n){$(n.target).trigger("focus")},"aria-label":this.props.ariaLabel||this.props.tooltip,className:"author-notification-content",style:e,title:this.props.tooltip};return(0,s.ax)({HTMLAttributes:r,ButtonStyle:1,Tooltip:this.props.tooltip,children:i.createElement("span",{"aria-hidden":!0},t)})},t.createColor=function(n){for(var e=0,r=n.length-1;r>=0;r--){var i=n.charCodeAt(r),o=r%8;e^=(i<<o)+(i>>8-o)}var u=e%t.COLOR_SWATCHES_LOOKUP.length;return t.COLOR_SWATCHES_LOOKUP[u]},t.prototype.jo=function(){var n=this.props,e="",r="";n.backgroundColor&&(e=(0,u.hq)(n.backgroundColor)),n.textColor&&(r=(0,u.hq)(n.textColor));var i=n.email||n.name;return""!==r&&""!==e||!i||(e=e||t.createColor(i),r=r||(0,u.hq)((0,u.en)((0,u.$W)(e)))),{backgroundColor:e=e||t.defaultBackgroundColor,textColor:r=r||t.defaultTextColor}},t.COLOR_SWATCHES_LOOKUP=["#3765E4","#D83B01","#B91C49","#910A19","#E40089","#971497","#8150FD","#562685","#2C5797","#007B8A","#11723F","#6F292A","#A16412"],t.defaultBackgroundColor=t.COLOR_SWATCHES_LOOKUP[0],t.defaultTextColor=o.Ej,t}(e(23112).r)},54164:function(n,t,e){"use strict";e.d(t,{c:function(){return v}});var r=e(66676),i=new RegExp("\\(([^)]*)\\)","gi"),o=new RegExp("(?:[\0-/:-@[-^`{-퟿-￿]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udbff](?![\udc00-\udfff])|(?:[^\ud800-\udbff]|^)[\udc00-\udfff]) ","gi"),u=new RegExp("\\s+","gi"),s=new RegExp("[ء-ي٠-٩]"),a=new RegExp("[ᄀ-ᇿ|㄰-㆏|ꥠ-꥿|가-힯|ힰ-퟿]"),c=new RegExp("[一-鿌㐀-䶵﨎﨏﨑﨓﨔﨟﨡﨣﨤﨧-﨩]|[\ud840-\ud868][\udc00-\udfff]|\ud869[\udc00-\uded6\udf00-\udfff]|[\ud86a-\ud86c][\udc00-\udfff]|\ud86d[\udc00-\udf34\udf40-\udfff]|\ud86e[\udc00-\udc1d]");function f(n,t){var e=n.replace(/\s/,"");return t?e[e.length-1]:e[0]}function l(n,t){var e=n.replace(/\s/,"");return e.length<=2?t?e[0]:e[e.length-1]:t?e.substr(0,2):e.substr(e.length-2,e.length)}function h(n,t){var e="",r=n.split(" ");return 2===r.length?(e+=r[0].charAt(0).toUpperCase(),e+=r[1].charAt(0).toUpperCase()):3===r.length?(e+=r[0].charAt(0).toUpperCase(),e+=r[2].charAt(0).toUpperCase()):0!==r.length&&(e+=r[0].charAt(0).toUpperCase()),t&&e.length>1?e.charAt(1)+e.charAt(0):e}function d(n){return n=(n=(n=(n=n.replace(i,"")).replace(o,"")).replace(u," ")).trim()}function m(n,t){return null==n?"":(arguments.length<2&&(t=(0,r.t)()),n=d(n),s.test(n)?f(n,!!t):a.test(n)||c.test(n)?l(n,!!t):h(n,!!t))}function v(n,t,e){return m(n?n.trim():"".concat(t||""," ").concat(e||"").trim())}},23112:function(n,t,e){"use strict";e.d(t,{r:function(){return u}});var r=e(59312),i=e(87363),o=e(61533),u=function(n){function t(t){var e,r,i=n.call(this,t)||this;return i.state={},r=e=i,s.forEach((function(n){var t=r[n];t&&(r[n]=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];try{return t.apply(e,r)}catch(t){return a(e,n,t),null}})})),i}return(0,r.ZT)(t,n),t.prototype.getHtmlElement=function(){return o.findDOMNode(this)},t}(i.Component),s=["componentWillMount","componentDidMount","componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","componentDidUpdate","componentWillUnmount","render"];function a(n,t,e){try{if(window.onerror){var r="React error in ".concat(n.constructor.name,".").concat(t);e&&e.message&&(r+=": ".concat(e.message)),window.onerror(r,"",0,0,e)}}catch(n){}}},41360:function(n,t,e){"use strict";e.d(t,{z:function(){return u}});var r=e(59312),i=e(87363),o=e(78587),u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return(0,r.ZT)(t,n),t.prototype.render=function(){var n=this.props,t=n.src,e=(0,r._T)(n,["src"]);return i.createElement("img",(0,r.pi)({role:"presentation",src:(0,o.Jn)(t)},e))},t}(e(23112).r)},93018:function(n,t,e){"use strict";e.d(t,{d:function(){return u}});var r=e(59312),i=e(87363),o=e(94290),u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return(0,r.ZT)(t,n),t.prototype.render=function(){return(0,o.Ig)()?i.createElement("div",{className:"image-alternative-text"},this.props.children):null},t}(e(23112).r)},46956:function(n,t,e){"use strict";e.d(t,{z:function(){return m}});var r=e(59312),i=e(87363),o=e(94283),u=e(687),s=e(72467),a=e(90819),c=e(64290),f=e(31442),l=e(41040),h=e(23112),d=e(93018),m=function(n){function t(t){var e=n.call(this,t)||this;return e.Qo=function(n){(0,c.md)((function(){e.props.onHover&&e.props.onHover(n)}))},e.Wi=function(n){(0,c.md)((function(){if("Tab"===n.key&&e.props.cvContainerClassName){n.stopPropagation();var t=document.getElementsByClassName(e.props.cvContainerClassName);t&&t.length>0&&t[1].firstChild.firstChild.focus()}}))},e.state={ImageLoadStatus:0,RetryCount:0},e.Ho=e.Ho.bind(e),e.Wo=e.Wo.bind(e),e.Jo=e.Jo.bind(e),e}return(0,r.ZT)(t,n),t.prototype.componentDidMount=function(){var n=(0,s.Cu)().Schema;this.props.ImageInfoMaster.observe(this.Jo,[n.AltText,n.ResourceId,n.ResourceUrl])},t.prototype.componentWillUnmount=function(){this.Ko&&window.clearTimeout(this.Ko),this.props.ImageInfoMaster.unobserve(this.Jo)},t.prototype.render=function(){var n,e;this.props.FullFilled?(n="100%",e="auto"):(n=this.props.ImageWidth||(0,u.Rr)(),e=this.props.ImageHeight||(0,u.w_)());var r,o,s=this.state.RetryCount,a=this.props.ImageInfoMaster.Model,c=a.ResourceUrl;2===this.state.ImageLoadStatus&&s>0&&(c+="?"+s),this.Xo()?o=t.createSpinner():1===this.state.ImageLoadStatus&&(r="visiable");var f=a.AltText||"";return i.createElement("div",{className:"office-form-title-image-box",onMouseOver:this.Qo,onFocus:this.props.cvContainerClassName&&this.Qo,tabIndex:this.props.cvContainerClassName&&0,onKeyUp:this.Wi},i.createElement("img",{title:f,className:r,height:e,onError:this.Wo,onLoad:this.Ho,src:c,width:n}),o,i.createElement(d.d,null,this.props.ImageInfoMaster.Model.AltText))},t.prototype.Xo=function(){var n=this.props.ImageInfoMaster.Model;return 1!==this.state.ImageLoadStatus||n.ImageProcessingStatus!==a.nv.Idle},t.createSpinner=function(){var n=i.createElement(l.P,(0,r.pi)({},{ClassName:"designPage-question-titleLoadImage-spinner",Ignorable:!1}));return i.createElement("div",{className:"image-spinner"},n)},t.prototype.Ho=function(){(0,f.w6)("Image.ImageOnLoad.Success",{imageType:this.props.ImageType,location:"1"}),(0,o.OE)(2,{$imageType:this.props.ImageType,$location:"RenderCard"}),this.setState({ImageLoadStatus:1})},t.prototype.Wo=function(){var n=this,t=this.state.RetryCount;t<3?this.Ko=window.setTimeout((function(){return n.setState({RetryCount:++t})}),1e3):((0,f.w6)("Image.ImageOnLoad.Failure",{imageType:this.props.ImageType,location:"1"}),(0,o.OE)(1,{$imageType:this.props.ImageType,$location:"RenderCard"}),this.setState({ImageLoadStatus:2}))},t.prototype.Jo=function(){this.forceUpdate()},t}(h.r)},932:function(n,t,e){"use strict";e.d(t,{$:function(){return f}});var r=e(59312),i=e(87363),o=e(262),u=e(6787),s=e(7645),a=e(23112),c=e(41360),f=function(n){function t(t){var e=n.call(this,t)||this;return e.Yo=i.createRef(),e.state={ShowIR:!1},e.Zo=e.Zo.bind(e),e}return(0,r.ZT)(t,n),t.prototype.render=function(){var n=this,t=this.state.ShowIR?"immersive-reader-focused":"";return i.createElement("div",{tabIndex:this.state.ShowIR?-1:0,onFocus:this.Zo,className:"immersive-reader-button-wrapper"},i.createElement("button",{className:(0,o.j)("immersive-reader-button-form",this.props.className,t),"data-locale":(0,u.Kc)()||navigator.language,"aria-label":(0,s.pm)().ImmersiveReaderButton_Hint,onClick:this.props.onClick,onBlur:function(){return n.setState({ShowIR:!1})},ref:this.Yo},i.createElement(c.z,{src:this.props.whiteIcon?"/Images/IR_white_title.svg":"/Images/immersive-reader-icon_black.svg",alt:(0,s.pm)().ImmersiveReaderButton_Hint,title:(0,s.pm)().ImmersiveReaderButton_Hint,style:{verticalAlign:"middle"}})))},t.prototype.Zo=function(){var n=this;this.setState({ShowIR:!0},(function(){var t;null===(t=n.Yo.current)||void 0===t||t.focus()}))},t}(a.r)},24742:function(n,t,e){"use strict";e.d(t,{E:function(){return a}});var r=e(59312),i=e(87363),o=e(77356),u=e(3424),s=e(49050),a=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.nu=i.createRef(),t}return(0,r.ZT)(t,n),t.prototype.componentDidMount=function(){(0,o.z)($(this.nu.current))},t.prototype.render=function(){var n,t=this.props.Message,e=t;return"string"==typeof t&&(n={RenderMode:"RichText",Text:t,ContainsHtml:!0},e=(0,s.q)(n)),i.createElement("div",null,i.createElement("div",{className:"thank-you-page-confirm"},i.createElement(u.F,{FluentIcon:"Checkmark Circle",HTMLAttributes:{className:"office-form-theme-primary-color thank-you-page-font-icon"}}),i.createElement("span",{className:"thank-you-page-comfirm-text"},this.props.ConfirmText)),i.createElement("div",{className:"thank-you-page-container thank-you-page-message",ref:this.nu},e))},t}(e(23112).r)},70642:function(n,t,e){"use strict";e.d(t,{n:function(){return A}});var r=e(87363),i=e(43367),o=e(59312),u=e(32782),s=e(29295);function a(){return(0,o.mG)(this,void 0,void 0,(function(){return(0,o.Jh)(this,(function(n){switch(n.label){case 0:return[4,e.e(969).then(e.bind(e,76836))];case 1:return[2,{default:n.sent().DateTimeRenderer}]}}))}))}function c(n){var t=(0,s.J)(c,a);return r.createElement(u.Z,null,r.createElement(t,(0,o.pi)({},n)))}function f(){return(0,o.mG)(this,void 0,void 0,(function(){return(0,o.Jh)(this,(function(n){switch(n.label){case 0:return[4,e.e(647).then(e.bind(e,4057))];case 1:return[2,{default:n.sent().LikertRenderer}]}}))}))}function l(n){var t=(0,s.J)(l,f);return r.createElement(u.Z,null,r.createElement(t,(0,o.pi)({},n)))}function h(){return(0,o.mG)(this,void 0,void 0,(function(){return(0,o.Jh)(this,(function(n){switch(n.label){case 0:return[4,e.e(42).then(e.bind(e,18747))];case 1:return[2,{default:n.sent().NPSRenderer}]}}))}))}function d(n){var t=(0,s.J)(d,h);return r.createElement(u.Z,null,r.createElement(t,(0,o.pi)({},n)))}function m(){return(0,o.mG)(this,void 0,void 0,(function(){return(0,o.Jh)(this,(function(n){switch(n.label){case 0:return[4,e.e(967).then(e.bind(e,74461))];case 1:return[2,{default:n.sent().RankingRenderer}]}}))}))}function v(n){var t=(0,s.J)(v,m);return r.createElement(u.Z,null,r.createElement(t,(0,o.pi)({},n)))}function p(){return(0,o.mG)(this,void 0,void 0,(function(){return(0,o.Jh)(this,(function(n){switch(n.label){case 0:return[4,e.e(66).then(e.bind(e,98489))];case 1:return[2,{default:n.sent().RatingRenderer}]}}))}))}function g(n){var t=(0,s.J)(g,p);return r.createElement(u.Z,null,r.createElement(t,(0,o.pi)({},n)))}var b=e(12611),w=e(262),I=e(97265),y=e(64459),S=e(63795),F=e(29952),C=e(73252),_=e(687),T=e(90710),P=e(13886);var N=e(22768),k=e(72374),E=e(91367),R=e(64290),O=e(31442),D=e(3424),x=e(42605),L=e(17764),M=e(20572),q=function(n){function t(t){var e=n.call(this,t)||this;return e.iu="presentation",e.ou=1,e.uu=new Map,e.state={ShowWarningMessage:!1},e.onMathValueChange=e.onMathValueChange.bind(e),e.onInputValueChange=e.onInputValueChange.bind(e),e.au=e.au.bind(e),e.validateOnBlur=e.validateOnBlur.bind(e),e.setInputFieldDefault(),e}return(0,o.ZT)(t,n),t.prototype.componentWillUpdate=function(n){this.props.LocaleId!==n.LocaleId&&(this.defaultPlaceholder=(0,F.Oy)()?n.LocalizedStrings.Question_TextFiled_Placeholder:n.LocalizedStrings.TextField_DefaultPlaceholder)},t.prototype.createReactNodes=function(){var n=this,t=this.props.Master.Model,e=this.props.Master.Question,i=e.Model,o=e.Form.SettingMaster.Model.IsAnonymous;this.defaultPlaceholder=(0,F.Oy)()?this.props.LocalizedStrings.Question_TextFiled_Placeholder:this.props.LocalizedStrings.TextField_DefaultPlaceholder;var u,s,a,c=this.getErrorMessageLabel();if(this.props.PrintView){var f=(0,R.pd)((function(){return"textbox-printview"}),(function(){return"textbox-printview cv-textbox-printview"}));u=r.createElement("div",{className:f,key:"printView"},t.Answer)}else{var l=void 0,h=void 0,d=void 0;if(i.IsMathQuiz&&!i.Multiline){var m=this.getCorrectnessIcon(!0),v=i.InputSwitcherDisabled||!i.IsMathInputDefault,p=this.props.Disabled||v?void 0:this.createMathTextSwitcher(),g=void 0,b=void 0;if(t.AnswerEntity)g=t.AnswerEntity.IsMathAnswer,b=t.AnswerEntity.Answer;else g=!i.IsAnswerPlainText,b=(0,y.d)(t.Answer||"{}").Answer||"";if(g){this.props.IsPrintViewDesignTime?(d=" ",a=i.InputSwitcherDisabled&&r.createElement("div",{className:"print-restriction-tip"},this.props.LocalizedStrings.TextField_EnterMathAnswer)):d=i.InputSwitcherDisabled?this.props.LocalizedStrings.TextField_EnterMathAnswer:this.defaultPlaceholder;var w={onBlur:this.validateOnBlur},I=r.createElement(N.qS,{Disabled:this.props.Disabled,HTMLAttributes:w,key:"textmathquestion-mathfield",Location:"TextField.Response",onValueChange:this.onMathValueChange,Placeholder:d,QuestionId:i.Id,Value:b},p);h=r.createElement("div",{className:"office-form-response-question-math-container"},I,m)}else{var S=(0,M.ZA)({AutoSelection:!0,Disabled:this.props.Disabled,HTMLAttributes:{className:"design-question-math-plaintext-text",onBlur:this.validateOnBlur},key:"textmathquestion-textfield",Label:void 0,MaxLength:(0,_.NJ)(),MinimalHeight:this.props.IsPrintViewDesignTime&&i.Multiline?void 0:40,onValueChange:this.onMathValueChange,Options:{HTMLPropsForInnerElement:this.getElementProps({className:"design-question-math-plaintext-text"})},Placeholder:d||this.defaultPlaceholder,Rows:i.Multiline&&this.props.IsPrintViewDesignTime&&10,Theme:this.props.Theme,ValidationStyle:this.getValidationStyle(),Value:b});h=r.createElement("div",{className:"office-form-response-question-math-textfield"},S,p,m)}s=r.createElement("div",{className:"student-feedback-view-short-text-field-with-correctness",key:"normalView"},h)}else{this.props.IsPrintViewDesignTime?(d=" ",a=i.IsNumber&&r.createElement("div",{className:"print-restriction-tip"},e.getNumberValidationErrorMessage(this.props.LocalizedStrings))):d=(0,R.pd)((function(){return i.IsNumber?e.getNumberValidationErrorMessage(n.props.LocalizedStrings):i.Placeholder||n.defaultPlaceholder}),(function(){var t,r=n.questionLocalizedItemMaster,o=r&&r.Model;return t=e.getValidationErrorMessage(n.props.LocalizedStrings,o&&o.formsprocustomplaceholder),i.IsNumber||i.HasTFRestrictionForPro?t:i.Placeholder||n.defaultPlaceholder})),l=(0,M.ZA)({Disabled:this.props.Disabled,HTMLAttributes:{onBlur:this.validateOnBlur},key:"textquestion-textfield",Label:void 0,MaxLength:(0,_.NJ)(),onValueChange:this.onInputValueChange,Required:this.props.Master.Question.Model.Required,Options:{HTMLPropsForInnerElement:this.getElementProps({className:"office-form-question-textbox"})},Placeholder:d,Rows:i.Multiline&&this.props.IsPrintViewDesignTime&&10,TextFieldType:i.Multiline?2:0,Theme:this.props.Theme,ValidationStyle:this.getValidationStyle(),Value:t.Answer});m=this.getCorrectnessIcon();s=r.createElement("div",{className:"student-feedback-view-short-text-field-with-correctness",key:"normalView"},l,m,this.cu(o))}}return[u,s,a,this.createCorrectAnswerList(),c]},t.prototype.cu=function(n){return this.state.ShowWarningMessage&&(0,C.cr)("SensitiveInfoCheckInResponsePage")&&((0,C.cr)("SensitiveInfoCheckForAllForms")||n)?r.createElement("div",{className:"warning-message-container",key:"warningMessage"},this.props.LocalizedStrings.Response_Page_SensitiveInfo_QuestionWarning):null},t.prototype.createMathTextSwitcher=function(){var n=this.props.Master.Question.Model,t="design-question-choice-to-math-button";this.props.IsMobile&&(t=(0,w.j)(t,"isMobile"));var e,r,i={className:t,onClick:this.au()};return n.IsAnswerPlainText?(e=this.props.LocalizedStrings.Designer_Question_Equation_Button,r=this.props.LocalizedStrings.Designer_Question_Equation_Button_Tooltip):(e=this.props.LocalizedStrings.Designer_Question_EquationToText_Button,r=this.props.LocalizedStrings.Designer_Question_EquationToText_Button_Tooltip),(0,x.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:i,FluentIcon:n.IsAnswerPlainText?"Math Formula":"Text Field",IconClassName:"forms-icon-size24x24",Text:e,Tooltip:r})},t.prototype.au=function(){var n=this;return function(t){var e=n.props.Master.Question.Model,r=n.props.Master.Model,i=(0,y.d)(r.Answer||"{}");e.IsAnswerPlainText=!e.IsAnswerPlainText;var o={Answer:i.Answer,IsMath:!e.IsAnswerPlainText};r.Answer=JSON.stringify(o),(0,O.$U)(e.IsAnswerPlainText?"DesignPage.Quiz.SwitchMathToTextInput":"DesignPage.Quiz.SwitchTextToMathInput",{location:"TextField.Response",questionId:e.Id}),n.forceUpdate()}},t.prototype.setInputFieldDefault=function(){var n=this.props.Master.Question.Model,t=this.props.Master;this.props.Master.Question.ensureFieldsReady([k.MF.Schema.Id]).then((function(){if(n.IsMathQuiz){if(t.Model.Answer){var e=(0,y.d)(t.Model.Answer||"{}");if(void 0!==e.IsMath)return void(n.IsAnswerPlainText=!e.IsMath)}n.IsAnswerPlainText=!n.IsMathInputDefault}else n.IsAnswerPlainText=!0}))},t.prototype.onInputValueChange=function(n){var t=this.props.Master.Model,e=(0,S.bC)(n);t.Answer=e},t.prototype.onMathValueChange=function(n){var t=this.props.Master.Model,e={Answer:(0,S.bC)(n),IsMath:!this.props.Master.Question.Model.IsAnswerPlainText};t.Answer=JSON.stringify(e)},t.prototype.fu=function(n){var t=this.props.Master.Model,e=function(n){return!(void 0===n||/[^\u0000-\u007F]+/.test(n)||!/(4\d{3})(-?|\040*)(\d{4}(-?|\040*?)){3}/.test(n)&&!/(?!000|666)[0-8][0-9]{2}[- ](?!00)[0-9]{2}[- ](?!0000)[0-9]{4}/.test(n)&&(!/^[^\s]{8,16}$/.test(n)||!/^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*#?&])[A-Za-z\d@$!%*#?&]{8,}$/.test(n)&&!/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/.test(n)&&!/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/.test(n)))}(n);this.setState({ShowWarningMessage:e}),t.HasSensitiveInfo=e},t.prototype.validateOnBlur=function(){var n=this.props.Master.Model,t=this.props.Master.Question;if(t.Model.IsNumber){var e=n.Answer;t.verify(e)!==k.ej.Success||t.Model.IsMathQuiz||(0,R.pd)((function(){return n.Answer=(0,P.Q5)(e)}),(function(){return n.Answer=t.Model.FormsProValidationType===k.PA.Email||t.Model.FormsProValidationType===k.PA.Custom?e:(0,P.Q5)(e)}))}this.fu(n.Answer),(0,R.md)((function(){var n,e,r,o,u,s,a,c,f,l;if(null===(e=null===(n=null==t?void 0:t.Form)||void 0===n?void 0:n.Model)||void 0===e?void 0:e.Settings.PauseAndResumeSurvey){var h=(0,T.NW)().vt;if(h){var d=h.split("_")[1],m=null===(o=null===(r=null==t?void 0:t.Form)||void 0===r?void 0:r.Model)||void 0===o?void 0:o.Settings.IsAnonymous,v=null===(s=null===(u=null==t?void 0:t.Form)||void 0===u?void 0:u.Model)||void 0===s?void 0:s.Id,p=(0,_.vT)();(0,C.cr)("CVPartialResponse")&&(null===(c=null===(a=null==t?void 0:t.Form)||void 0===a?void 0:a.Model)||void 0===c?void 0:c.Settings.RecordPartialResponse)&&(p=null===(l=null===(f=null==t?void 0:t.Form)||void 0===f?void 0:f.Model)||void 0===l?void 0:l.Settings.RecordPartialResponse,(0,O.JG)({type:"CustomerVoice_PartialResponseSettingTaken",eventInfo:{Component:"PartialResponse",Value:p}})),(0,i.callIoCUpdatePRForText)(v,m,d,h,p)}}}))},t.prototype.getErrorMessageLabel=function(){var n=this,t=!0,e=this.props.Master.Model,r=this.props.Master.Question,i=e.Answer,o=r.verify(e.Answer);if(e.Answer&&o!==k.ej.Success){var u;switch(o){case k.ej.NumberValidationError:case k.ej.RegExValidationError:u=r.getNumberValidationErrorMessage(this.props.LocalizedStrings),(0,R.md)((function(){var t=n.questionLocalizedItemMaster,e=t&&t.Model;u=r.getValidationErrorMessage(n.props.LocalizedStrings,e&&e.formsprocustomplaceholder)}));break;case k.ej.MathLengthError:u=this.props.LocalizedStrings.Math_Answer_LengthLimit_Message;break;default:return}var s={className:"validation-error-message-label",role:"alert"};return(0,R.md)((function(){n.ou++,n.uu.has(o)&&n.uu.get(o)===i?t=!1:n.uu.set(o,i),n.ou%2==0&&!0===t&&(s["aria-label"]=" ")})),(0,L._)({Alert:!0,HTMLAttributes:s,key:"textquestion-errorlabel",Label:u})}},t.prototype.getCorrectnessIcon=function(n){var e=this.props.Master,i=this.props.Master.Question,u=i.Model;if(this.props.ShowQuizResult&&this.props.ShowPrintResult&&!u.Multiline&&u.IsQuiz){var s=t.isAnswerCorrect(e);if(null!==s&&(s||this.props.IsMobile)){var a=n?"student-feedback-view-short-text-math-correctness-icon-container":"student-feedback-view-short-text-correctness-icon-container";this.props.IsMobile&&(a=(0,w.j)(a,"isMobile"));var c,f=s?this.props.LocalizedStrings.Quiz_CorrectAnswer:this.props.LocalizedStrings.Quiz_WrongAnswer,l={FluentIcon:s?"Checkmark":"Dismiss",HTMLAttributes:{className:(0,w.j)("student-feedback-view-short-text-correctness-icon forms-icon-size14x14",s?"image-button-answerkey":"image-button-checked-wrong-answer"),title:f}},h=e.Model.Answer;if(c=h,!h||(0,I.Ew)(h))c=u.Placeholder||this.defaultPlaceholder;else if(i.Model.IsMathQuiz){var d=(0,y.d)(h||"{}");c=d.IsMath?(0,N.Rq)({Formula:null==d.Answer?h:d.Answer}):null==d.Answer?h:d.Answer}var m={"aria-hidden":!0,className:"student-feedback-view-short-text-hidden-text-to-position-correctness-icon",role:this.iu};return r.createElement("div",{className:a},r.createElement("span",(0,o.pi)({},m),c),(0,D.M)(l))}}},t.isAnswerCorrect=function(n){var t=n.Model;return null!=t.QuizResult?t.QuizResult.IsAnswerCorrect:new E.E(n.Question.Model).areAnyAnswersDefined()?n.Question.isCorrectAnswer(t.Answer):null},t.prototype.createCorrectAnswerList=function(){var n=this.props.Master.Question.Model,t=this.props.Master.Model.QuizResult;if(this.du()){var e=null!=t?t:n,i=new E.E(e);if(i.areAnyAnswersDefined()){var o,u=i.getAnswers();if(u.some((function(n){return n.isMath}))){for(var s=[],a=0,c=u;a<c.length;a++){var f=c[a];if(f.isMath){var l=(0,N.Rq)({Formula:f.answer});s.push(r.createElement("div",{className:"correct-answer-list-formula-element"},l))}else s.push(f.answer);s.push(this.props.LocalizedStrings.VariousLocations_ItemList_Separator)}s.pop(),o=r.createElement("div",{className:"correct-answer-list-formula-container"},s)}else o=b.map(u,(function(n){return n.answer})).join(this.props.LocalizedStrings.VariousLocations_ItemList_Separator);var h={HTMLAttributes:{"aria-hidden":!0,className:"office-form-right-answerkey various-short-text-correct-answer-list-correctness-icon",role:this.iu},IconName:""};return r.createElement("div",{className:"various-short-text-correct-answer-list",key:"answerList"},(0,D.M)(h),r.createElement("b",null,this.props.LocalizedStrings.VariousLocations_CorrectAnswerList_Label," "),o)}}},t.prototype.du=function(){var n=this.props.Master.Model,t=this.props.Master.Question.Model,e=this.props.Master.Model.QuizResult;return!(t.Multiline||!t.IsQuiz)&&(!(!this.props.ShowDesignInfo&&null==e)&&((null==e||!e.IsAnswerCorrect)&&!(null==e&&this.props.Master.Question.isCorrectAnswer(n.Answer))))},t}(e(30148).e);function A(n){var t,e=n.Master.Question.Model.Type;switch(e){case"Question.Choice":return(0,i.createChoiceQuestionRenderer)(n);case"Question.TextField":t=q;break;case"Question.Rating":return g(n);case"Question.Ranking":return v(n);case"Question.NPS":return d(n);case"Question.MatrixChoiceGroup":return l(n);case"Question.FileUpload":return(0,i.getIoCCreateFileUploadQuestionRenderer)(n);case"Question.DateTime":return c(n);case"Question.CascadeGroup":return(0,i.getIoCCreateCascadeQuestionRenderer)(n)}if(t)return r.createElement(t,n);throw Error('Type "'.concat(e,'" has not been found.'))}},55982:function(n,t,e){"use strict";e.d(t,{h:function(){return a}});var r=e(59312),i=e(87363),o=e(262),u=e(64290),s=e(3424),a=function(n){function t(t){var e=n.call(this,t)||this;return e.mu=e.mu.bind(e),e}return(0,r.ZT)(t,n),t.prototype.render=function(){var n=this,t=this.props.Choice,e=this.props.ContainerClassName;this.props.IsChecked&&this.props.IsMobile&&(e=(0,o.j)(e,"active"));var s=(0,o.j)("office-form-question-choice-row",this.props.ClassNameForLabel),a=(0,u.pd)((function(){return t.Description}),(function(){return t.Description||n.props.LocalizedStrings.Quiz_Empty_Option_Label}));return i.createElement("div",{className:e},i.createElement("div",{className:this.props.IsSingleChoice?"radio":"checkbox"},i.createElement("label",{className:s},i.createElement("input",(0,r.pi)({"aria-checked":this.props.IsChecked,"aria-label":a,checked:this.props.IsChecked,disabled:this.props.Disabled,onChange:this.mu,type:this.props.IsSingleChoice?"radio":"checkbox",value:t.Description},this.props.HTMLPropsForInput)),this.props.children,this.pu())),this.gu())},t.prototype.pu=function(){var n,t;switch(this.props.AnswerType){case"Correct":t="Checkmark",n=this.props.IsMobile&&this.props.IsChecked?"image-button-checked-answerkey-mobile office-form-answerkey":"image-button-answerkey office-form-answerkey";break;case"Wrong":n=this.props.IsMobile?"image-button-checked-wrong-answer-mobile office-form-answerkey":"",t=this.props.IsMobile?"Dismiss":""}if(t)return(0,s.M)({FluentIcon:t,HTMLAttributes:{className:(0,o.j)(n,"forms-icon-size20x20"),role:"tooltip",title:this.props.ToolTipForAnswer}})},t.prototype.gu=function(){if(this.props.AnswerHint){var n=void 0;return n="Correct"===this.props.AnswerType?this.props.IsMobile?"validation-success-mobile":"validation-success":this.props.IsMobile?"validation-error-mobile":"validation-error",n=(0,o.j)("office-form-answerhint",n),i.createElement("div",{className:n},this.props.AnswerHint)}},t.prototype.mu=function(){this.props.onChange(this.props.Choice.Description)},t}(e(23112).r)},30148:function(n,t,e){"use strict";e.d(t,{e:function(){return sn}});var r=e(59312),i=e(87363),o=e(12611),u=e(60211),s=e(29559),a=e(9947),c=e(262),f=e(81620),l=e(90710),h=e(9743),d=e(42605),m=e(49211),v=e(6787),p=e(73252),g=e(687),b=e(77356),w=e(7645),I=e(43367),y=e(72377);function S(n){return F().getCVAppliedBranchingIcon(n)}function F(){return y.Pv.Resolve("ICustomerVoiceBranchingFactory")}var C=e(54496),_=e(72467),T=e(46008),P=e(70877),N=e(61018),k=e(22768),E=e(24497),R=e(71860),O=e(72374),D=e(90819),x=e(3920),L=e(502),M=e(155),q=e(19976),A=e(64290),U=e(61533),V=e(94283),G=e(43209),B=e(77494),z=e(31442),j=e(23112);function Q(n){return i.createElement("div",{className:"image-spinner",id:n&&H(n)},i.createElement("div",{className:"common-spinner-circle"}))}function H(n){return"imageSpinner-"+n.ResourceId}var W=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.Vi=!0,t.bu=function(){return t.forceUpdate()},t.wu=function(){return t.Iu()},t}return(0,r.ZT)(t,n),t.prototype.componentDidMount=function(){var n=(0,_.Cu)().Schema,t=(0,_.BF)().Schema;this.props.ImageSettings.observe(this.bu),this.props.Image.observe(this.bu,[n.ResourceUrl,n.ContentType,n.OriginalFileName]),this.props.ImageSettings.observe(this.wu,[t.ContainerHeight,t.ContainerWidth,t.Left,t.Top]),this.props.Image.observe(this.wu,[n.AltText]),this.yu()},t.prototype.componentDidUpdate=function(){this.yu()},t.prototype.componentWillUnmount=function(){this.Vi=!1,this.props.ImageSettings.unobserve(this.bu),this.props.Image.unobserve(this.bu),this.props.ImageSettings.unobserve(this.wu),this.props.Image.unobserve(this.wu)},t.prototype.render=function(){var n=this,t=this.props.Image.Model,e=this.props.ImageSettings.validateImageSettings(!0),r=0;return i.createElement("img",{src:t.ResourceUrl,alt:t.AltText,height:e.ContainerHeight+"px",width:e.ContainerWidth+"px",style:{visibility:"hidden"},onLoad:function(){(0,z.w6)("Image.ImageOnLoad.Success",{imageType:n.props.ImageType,location:"1"}),(0,V.OE)(2,{$imageType:n.props.ImageType,$location:"RenderCard"})},onError:function(e){if(r<3&&"Response"===(0,G.C2)()){var i=U.findDOMNode(n);r++;var o=t.ResourceUrl+"?"+r;window.setTimeout((function(){$(i).attr("src",o)}),1e3)}else(0,z.$U)("Image.ImageOnLoad.Failure",{imageType:n.props.ImageType,location:"1"}),(0,V.OE)(1,{$imageType:n.props.ImageType,$location:"RenderCard"})}})},t.prototype.yu=function(){var n=this,t=this.props.Image&&this.props.Image.Model;if(t&&t.ResourceUrl&&!this.Su()){var e=U.findDOMNode(this),r=0;e&&this.props.ImageSettings&&(e.onload=function(){return n.Iu()},e.onerror=function(i){if(r<3&&"Response"===(0,G.C2)()){r++;var o=t.ResourceUrl+"?"+r;window.setTimeout((function(){$(e).attr("src",o)}),1e3)}else{(0,z.$U)("Image.CanvasOnLoad.Failure",{imageSrc:e.src,imageType:n.props.ImageType,location:"1"});var u=document.getElementById(H(t));u&&$(u).css("display","none"),$(e).css("visibility","visible")}})}},t.prototype.Iu=function(){if(this.Vi){var n=this.props.Image&&this.props.Image.Model;if(n&&n.ResourceUrl&&!this.Su()){var t=U.findDOMNode(this);if($(t).siblings("canvas").remove(),t&&this.props.ImageSettings)try{var e=document.createElement("canvas"),r=this.props.ImageSettings.validateImageSettings(!0);e.tabIndex=-1;var i=1*r.NaturalWidth/r.ActualWidth,o=Math.abs(r.Left*i);o=Math.floor(Math.min(o,r.NaturalWidth));var u=Math.abs(r.Top*i);u=Math.floor(Math.min(u,r.NaturalHeight));var s=r.ContainerWidth*i||r.NaturalWidth;s=Math.floor(Math.min(s,r.NaturalWidth));var a=r.ContainerHeight*i||r.NaturalHeight;a=Math.floor(Math.min(a,r.NaturalHeight));try{var c=isNaN(window.devicePixelRatio)?1:window.devicePixelRatio;c=Math.ceil(Math.max(c,i)),e.width=Math.floor(r.ContainerWidth*c),e.height=Math.floor(r.ContainerHeight*c),n.AltText&&(e.setAttribute("role","img"),e.setAttribute("aria-label",n.AltText)),e.getContext("2d").drawImage(t,o,u,s,a,0,0,e.width,e.height)}catch(n){$(t).css("visibility","visible");var f=n.message||void 0,l=n.stack||void 0;return void(0,z.$U)("Image.CanvasRender.Failure",{imageSrc:t.src,imageType:this.props.ImageType,location:"1",error:f+" "+l,Exception:"DrawImageCanvas"})}var h=document.getElementById(H(n));h&&$(h).css("display","none"),$(t).css("display","none"),$(t).parent().append(e),(0,z.$U)("Image.CanvasRender.Success",{imageType:this.props.ImageType,location:"1"}),(0,B.C_)()}catch(n){f=n.message||void 0,l=n.stack||void 0;throw(0,z.$U)("Image.CanvasRender.Failure",{imageSrc:t.src,imageType:this.props.ImageType,location:"1",error:"".concat(f," ").concat(l),Exception:"CreateImageCanvas"}),n}}}},t.prototype.Su=function(){return this.props.Image.Model.ImageProcessingStatus!==D.nv.Idle},t}(j.r),J=e(3424),K=e(76795);function X(n){var t,e,r,o=n.Master.Question.Model,u=n.Master.SubQuestionRuntimeMasters,s=u[u.length-1];if(n.IsStudentViewMode){if(!(l=(s||n.Master).getScore())&&!o.Point)return;var a=o.Point?o.Point:"-",c=null!=l?l:"-",f=(0,w.pm)().RuntimeView_TotalPoints_Content.format(c,a);return i.createElement("span",{className:"office-form-theme-quiz-point",key:"quizPointLabel"},(0,w.pm)().Quiz_Points_BracketsText.format(f))}if(o.IsQuiz&&!n.HiddenPoint){if(!o.Point)return;if(n.ShowDesignInfo||!n.ShowQuizResult&&!n.ShowPrintResult)return i.createElement("span",{className:"office-form-theme-quiz-point",key:"quizPointLabel"},(t=o.Point,e=(0,w.pm)().Quiz_Points_BracketsText_Singular,r=(0,w.pm)().Quiz_Points_BracketsText_Plural,(1===t?e:r).format(t)));var l;c=null!=(l=(s||n.Master).getScore())?l:"-",f=(0,w.pm)().RuntimeView_TotalPoints_Content.format(c,o.Point);return i.createElement("span",{className:"office-form-theme-quiz-point",key:"quizPointLabel"},(0,w.pm)().Quiz_Points_BracketsText.format(f))}}function Y(n){var t=n.Master.Model,e=n.Master.Question.Model,r=e.Type===K.L.getElementTypeName(),i="Question.TextField"===e.Type&&!e.Multiline,o="Question.Ranking"===e.Type,u=r||i||o;return!!(e.IsQuiz&&n.ShowQuizResult&&u&&t.QuizResult)&&!t.QuizResult.IsAnswerCorrect}var Z=e(17764),nn=e(49050),tn=e(24635),en=e(54164),rn=e(49221),on=e(93018),un=e(932),sn=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.Fu=i.createRef(),t._u=9,t.Tu=16,t.Pu=400,t.Nu=o.uniqueId("question"),t.ku=function(){var n={chunks:t.getFormattedDataForImmersiveReader(),title:""},e={uiLang:(0,v.Kc)()||navigator.language};(0,N.d8)().getImmersiveReaderToken().then((function(t){t&&ImmersiveReader&&ImmersiveReader.launchAsync(t,null,n,e)}))},t}return(0,r.ZT)(t,n),t.prototype.componentWillMount=function(){var n=this;this.update=function(){return n.forceUpdate((function(){var t=n.props.onHeightChange;t&&t()}))};var t=this.props.Master,e=[R.x.Schema.HasQuestionMedia];e=(0,I.addIoCSurveyFontToSchemas)(e),t.Question.Form.observe(this.update,e),t.observe(this.update),t.Question.observe(this.update),this.Eu=(0,q.a)(),this.Eu.observe(this.update,[this.Eu.Schema.FormsTenantSettings]);var r=(0,_.Cu)().Schema;t.Question.ImageInfoMaster.observe(this.update,[r.ResourceUrl,r.ContentType,r.OriginalFileName]),t.Question.ImageSettingsMaster.observe(this.update),this.Ru(this.props),(0,A.md)((function(){if((0,p.cr)("FormsProAnswerTag")){var t=n.questionLocalizedItemMaster,e=t&&t.Model,r=n.props.Master.Question.Model.FormsProRTQuestionTitle||n.props.Master.Question.Model.Title,i=n.props.Master.Question.Model.FormsProRTSubtitle||n.props.Master.Question.Model.Subtitle;e?(n.props.Master.Model.InitialFormsProLocalizedRuntimeTitle=e.formsprortlocaletitle||e.title||r,n.props.Master.Model.InitialFormsProLocalizedRuntimeSubtitle=e.formsprortlocalesubtitle||e.subtitle||i):(n.props.Master.Model.InitialFormsProLocalizedRuntimeTitle=void 0,n.props.Master.Model.InitialFormsProLocalizedRuntimeSubtitle=void 0)}n.props.Master.Question.Form.SettingMaster.observe(n.update)}))},t.prototype.componentWillReceiveProps=function(n){var t=this;this.Ru(n),(0,A.md)((function(){if((0,p.cr)("FormsProAnswerTag")){var n=t.questionLocalizedItemMaster,e=n&&n.Model,r=t.props.Master.Question.Model.FormsProRTQuestionTitle||t.props.Master.Question.Model.Title,i=t.props.Master.Question.Model.FormsProRTSubtitle||t.props.Master.Question.Model.Subtitle;e?(t.props.Master.Model.InitialFormsProLocalizedRuntimeTitle=e.formsprortlocaletitle||e.title||r,t.props.Master.Model.InitialFormsProLocalizedRuntimeSubtitle=e.formsprortlocalesubtitle||e.subtitle||i):(t.props.Master.Model.InitialFormsProLocalizedRuntimeTitle=void 0,t.props.Master.Model.InitialFormsProLocalizedRuntimeSubtitle=void 0)}}))},t.prototype.componentWillUnmount=function(){var n=this,t=this.props.Master;t.Question.ImageSettingsMaster.unobserve(this.update),t.Question.ImageInfoMaster.unobserve(this.update),t.Question.unobserve(this.update),t.unobserve(this.update),t.Question.Form.unobserve(this.update),this.Eu.unobserve(this.update),(0,A.md)((function(){t.Question.Form.SettingMaster.unobserve(n.update)})),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.update)},t.prototype.componentDidMount=function(){this.Ou(),(0,A.md)((function(){var n,t;null===(n=document.querySelector("table.nps-control-table.reset.enabled"))||void 0===n||n.setAttribute("aria-hidden","true"),null===(t=Array.from(document.querySelectorAll('.nps-control .nps-control-table .radio-button-item .radio-button input[type="radio"]:not([disabled])')))||void 0===t||t.forEach((function(n,t){null==n||n.setAttribute("aria-label","".concat((0,w.pm)().NPS_DefaultTitle," ").concat(t))}))}))},t.prototype.componentDidUpdate=function(n,t){this.Ou()},t.prototype.render=function(){var n=this,t={className:"__question__ office-form-question",ref:this.Fu},e="office-form-error-question";if((0,A.md)((function(){e+=" cv-office-form-error-question-focus"})),"has-error"===this.getValidationStyle()||Y(this.props)){var o=this.props.IsMobile?"office-form-error-question-mobile":e;t.className=(0,c.j)(t.className,o)}(0,A.md)((function(){if(null==n.props.Master.Model.Visible?t.hidden=!1:t.hidden=!n.props.Master.Model.Visible&&!!n.props.EnableShowHideQuestion,(0,p.cr)("FormsProQuestionVisibility")&&n.props.EnableShowHideQuestion){var e=n.props.Master.Model.Visible;t.hidden=null==e?!!n.props.Master.Question.Model.Hidden:!e}}));var u=this.Du(),s=null;return void 0!==u&&(t.className=(0,c.j)(t.className,"office-form-studentview-question"),s=i.createElement("div",{className:"office-form-feedback-marginbottom-box"})),i.createElement("div",(0,r.pi)({},t,{"data-id":this.props.Master.Question.Model.Id}),this.xu(),this.createQuestionContent(),u,s,(0,A.md)((function(){return(0,p.cr)("CVLeapFrogVisualRefresh")&&(0,I.getIoCQuestionRendererFooter)({questionId:n.props.Master.Question.Model.Id})})))},t.prototype.createWrongResultLabel=function(){return function(n){if(!n.IsMobile&&!n.ShowPrintResult&&Y(n)){var t,e=(0,J.M)({Accessible:!0,FluentIcon:"Dismiss",HTMLAttributes:{className:"validation-error-message-wrong-Icon office-form-answerkey"}});return t=[i.createElement("div",{className:"validation-error-circle-big"}),i.createElement("div",{className:"validation-error-circle-small"}),e],i.createElement.apply(i,(0,r.ev)(["div",{"aria-live":"assertive",role:"alert","aria-label":(0,w.pm)().Response_Preview_WrongReponseIcon.format(n.Ordinal)}],t,!1))}}(this.props)},t.prototype.createReactNodes=function(){throw Error("to be overridden.")},t.prototype.createQuestionTitleControls=function(){return i.createElement("div",{className:"form-question-title-controls"},(0,d.F)({Icon:"Up",IconClassName:"form-question-title-button"}),(0,d.F)({Icon:"Down",IconClassName:"form-question-title-button"}),(0,d.F)({Icon:"Copy",IconClassName:"form-question-title-button"}),(0,d.F)({Icon:"Delete",IconClassName:"form-question-title-button"}))},t.prototype.createQuestionContent=function(){var n=this,t={className:"office-form-question-content office-form-theme-focus-border"},e=this.props.HTMLAttributes;e&&(t=(0,C.p2)(e,t));var o=(0,c.j)("office-form-question-element",this.isImageLayout()?"with-image":"");(0,A.md)((function(){(0,p.cr)("CustomerVoiceCascadeQuestion")&&("Question.CascadeGroup"===n.props.Master.Question.Model.Type&&(o=(0,c.j)(o,"cv-cascade-render-dropdowns")));(0,p.cr)("CVLeapFrogChoiceQuestionNewUX")&&("Question.Choice"===n.props.Master.Question.Model.Type&&(o=(0,c.j)(o,"cv-choice-render-container")));(0,p.cr)("CVLeapFrogVisualRefresh")&&(o=(0,c.j)(o,"cv-question-render-container"))}));var u=null,s=null;return this.isRequiredQuestionError()&&(u=(0,Z._)({HTMLAttributes:{className:"validation-error-message-label",role:"alert"},Label:this.props.LocalizedStrings.Required_Question_Error_Message}),(0,A.md)((function(){(0,p.cr)("CVLeapFrogVisualRefresh")&&(s=n.Mu(),u=null)}))),i.createElement("div",(0,r.pi)({},t),this.createWrongResultLabel(),this.createTitleContainer(),s,i.createElement("div",{className:o},this.createReactNodes()),u)},t.prototype.isRequiredQuestionError=function(){if(!this.props.ShowValidationStyle)return!1;var n=this.props.Master,t=n.Question.verify(n.Model.Answer);return n.SubQuestionRuntimeMasters.forEach((function(n){n.Question.verify(n.Model.Answer)===O.ej.RequiredError&&(t=O.ej.RequiredError)})),t===O.ej.RequiredError},t.prototype.getValidationStyle=function(){if(!this.props.ShowValidationStyle)return"";var n=this.props.Master,t=n.Question.verify(n.Model.Answer);return n.SubQuestionRuntimeMasters.forEach((function(n){n.Question.verify(n.Model.Answer)===O.ej.RequiredError&&(t=O.ej.RequiredError)})),t===O.ej.Success?"has-success":"has-error"},t.prototype.getQuestionId=function(){return this.Nu},t.prototype.getRequiredId=function(){return this.props.Master.Question.Model.Required?"".concat(this.Nu,"-required"):void 0},t.prototype.getQuestionTypeId=function(){return"".concat(this.Nu,"-questiontype")},t.prototype.getElementProps=function(n){var t={"aria-describedby":this.getSubtitleId(),"aria-labelledby":(0,c.j)(this.getOrdinalId(),this.getTitleId(),this.qu(),this.getRequiredId(),this.getQuestionTypeId())};return n?(0,C.p2)(n,t):t},t.prototype.getFormattedDataForImmersiveReader=function(){var n=this.props.Master.Question.Model,t=[];if(t.push({content:"".concat(this.props.Ordinal,". ").concat(n.Title).concat(n.Required?" *":"","\n")}),n.Point){var e=X(this.props);t.push({content:"".concat(e.props.children.toString(),"\n\n")})}else t.push({content:"\n"});if(n.Subtitle){var r=n.Subtitle;if("undefined"!=typeof MathJax){var i=MathJax.Hub.getAllJax(null),u=o.find(i,(function(t){return t.originalText===n.Subtitle}));if(u){var s=u.root&&u.root.toMathML&&u.root.toMathML();s&&(s=s.replace(/\n\s*/g,""),r="\x3c!--[if mathML]&#62;".concat((0,f.F1)(s,!0),"&#60;![endif]--\x3e"))}}t.push({content:"".concat(r),mimeType:"text/html"}),t.push({content:"\n\n"})}var a=document.createElement("i");return a.textContent=(0,f.F1)(this.props.LocalizedStrings.ImmersiveReader_InputAnswer,!0),t.push({content:a.outerHTML,mimeType:"text/html"}),t},t.prototype.Mu=function(){var n=(0,Z._)({HTMLAttributes:{className:"validation-error-message-label"},Label:this.props.LocalizedStrings.Required_Question_Error_Message}),t=(0,J.M)({IconName:"Error",className:"validation-error-message-icon"});return i.createElement("div",{className:"validation-error-container"},t,n)},t.prototype.Ru=function(n){var t=n.Master,e=n.LocaleId;this.questionLocalizedItemMaster&&(this.questionLocalizedItemMaster.unobserve(this.update),this.questionLocalizedItemMaster=void 0),e&&(this.questionLocalizedItemMaster=L.k.getQuestionResourceMaster(e,t.Question.Model.Id,t.Question.Form),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.update,[M.A.Schema.title,M.A.Schema.subtitle]))},t.prototype.Du=function(){var n=this.props.Master.SubQuestionRuntimeMasters,t=n[n.length-1],e=(t&&t.Model||this.props.Master.Model).AnswerEntity,r=null==e?void 0:e.Feedback;if(this.props.IsStudentViewMode&&r){var o={FluentIcon:"Chat",HTMLAttributes:{className:(0,c.j)("feedback-icon forms-icon-size16x16",(0,s.un)()?"edge":void 0,(0,s.w1)()?"ie":void 0),role:"presentation"}};return i.createElement("div",{className:"office-form-feedback-box"},(0,J.M)(o),i.createElement("div",{className:"office-form-feedback-content"},i.createElement(nn.D,{Text:r,RenderMode:"RichText",ContainsHtml:!0})))}},t.prototype.createTitleLabel=function(){var n=this,t=this.props.Master.Question.Model,e=this.props.Master.Question.Form,r=this.questionLocalizedItemMaster,o=null==r?void 0:r.Model,u=this.props.Master.Question.Form.Model.HasQuestionMedia,s=1===t.SuspiciousEvidence||3===t.SuspiciousEvidence,a=!1,c=s&&(0,w.pm)().Phishing_Question_Level_Message_Suspicous||"",f=null;(0,A.md)((function(){a=e.SyncContext===h.y.DesignTimeForm&&(0,l.$p)().FormId&&!(0,l.$p)().TopView&&"Question.FileUpload"===t.Type&&(0,p.cr)("CustomerVoiceCDSFileUpload")&&e.isFieldReady(R.x.Schema.FileUploadStorage)&&"cds"===e.Model.FileUploadStorage,f=a&&(0,w.pm)().CDSFileUploadInfoMessage||""}));var d=(0,A.pd)((function(){return(0,E.wg)(null==o?void 0:o.title,null==o?void 0:o.formsprortlocaletitle)||(0,E.wg)(t.Title,t.FormsProRTQuestionTitle)}),(function(){return(0,p.cr)("FormsProAnswerTag")?n.props.Master.Model.FormsProRuntimeTitle||(null==o?void 0:o.formsprortlocaletitle)||(null==o?void 0:o.title)||t.FormsProRTQuestionTitle||t.Title:(null==o?void 0:o.formsprortlocaletitle)||(null==o?void 0:o.title)||t.FormsProRTQuestionTitle||t.Title}));d=(0,I.getIoCModifiedTextField)(d,!1);var v=!this.props.HideMedia&&(t.ImageInfo&&t.ImageInfo.ResourceUrl||u)?"office-form-question-title with-image":"office-form-question-title",g=(0,m.w)(e,"ResponsePage.PollView"),b=!this.props.HideOrdinal&&(0,A.pd)((function(){return!(n.isImageLayout()||g)}),(function(){return!(n.isImageLayout()||g)&&(null==e.SettingMaster.Model.ShowQuestionNumbers||e.SettingMaster.Model.ShowQuestionNumbers)})),y={className:v,id:this.getTitleId()},S=t.Required?this.props.LocalizedStrings.Accessibility_RequiredAnswer:void 0,F=S&&i.createElement("div",{key:"accessibilityNode"},i.createElement("span",{className:"accessibility-reader-no-display",id:this.getRequiredId()},S)),C=this.createImmersiveReaderButton(),_=this.createQuestionTypeHint(),T={children:[C,F,_&&i.createElement("div",{key:"questionTypeNode"},i.createElement("span",{className:"accessibility-reader-no-display",id:this.getQuestionTypeId()},_)),X(this.props)],HTMLAttributes:y,HtmlContent:!0,key:this.getQuestionId().toString(),Label:d,Ordinal:this.props.Ordinal,ShowOrdinal:b,ShowRequiredStar:t.Required,ShowWarningIcon:s,Theme:this.props.Theme,WarningIconTooltip:c};return(0,A.md)((function(){T.Ordinal=n.props.Master.Model.FormsProOrdinal||T.Ordinal,T.ShowInfoIcon=a,T.InfoIconTooltip=f})),this.getLabel(T)},t.prototype.getLabel=function(n){return(0,Z._)(n)},t.prototype.createQuestionTypeHint=function(){var n=this.props.Master.Question.Model,t="";switch(n.Type){case"Question.Choice":t=n.ChoiceType===O.T6.MultiChoice?this.props.LocalizedStrings.QuestionType_MultiChoice:this.props.LocalizedStrings.QuestionType_SingleChoice;break;case"Question.DateTime":t=this.props.LocalizedStrings.QuestionType_DateTime;break;case"Question.Rating":t=this.props.LocalizedStrings.QuestionType_Rating;break;case"Question.TextField":t=n.Multiline?this.props.LocalizedStrings.QuestionType_MultiLineText:this.props.LocalizedStrings.QuestionType_SingleLineText;break;case"Question.Ranking":t=this.props.LocalizedStrings.QuestionType_Ranking;break;case"Question.MatrixChoiceGroup":t=this.props.LocalizedStrings.QuestionType_MatrixChoiceGroup}return t},t.prototype.createTitleOrdinal=function(){return i.createElement("div",{className:"office-form-question-ordinal office-form-theme-primary-background"},i.createElement("span",{id:this.getOrdinalId()},this.props.Ordinal))},t.prototype.createTitleContainer=function(){var n,t,e,o,u,a=this,f=this.props.Master.Question,l=f.Model,h=f.Form.Model.HasQuestionMedia,d={},m="office-form-question-subtitle",v=this.props.IsMobile||(0,T.rA)(this.props.SmallScreenCutoffOverride)||l.ImageSettings.Layout===x.RZ.Horizontal&&l.ImageSettings.Size===x.h2.Large,b=f.hasValidVideoUrl(),y=v||b;if(this.props.HideMedia||b||!(l.ImageInfo&&l.ImageInfo.ResourceUrl||h||l.ImageInfo.ImageProcessingStatus===D.nv.Uploading||l.ImageInfo.ImageProcessingStatus===D.nv.Picking)){if(!this.props.HideMedia&&b){var F=(0,s.tq)();m="office-form-question-subtitle with-video";var _=l.VideoInfo;d.className=(0,c.j)(d.className,"question-title-container office-form-theme-video-question-background"),(0,P.B9)(_.Url,f.Form)?u=i.createElement(rn.k,{IsMobile:F,LocalizedStrings:this.props.LocalizedStrings,VideoUrl:_.Url}):t=i.createElement("div",{className:"office-form-question-video-container"},i.createElement("iframe",{allowFullScreen:!0,frameBorder:"0",height:this.calcVideoDisplayHeight(),sandbox:"allow-scripts allow-same-origin allow-popups allow-forms",src:_.Url,width:"100%","aria-label":(0,w.pm)().Linked_Video}))}}else{d.className="question-title-container office-form-theme-image-question-background",m="office-form-question-subtitle with-image";var N=v?"office-form-question-horizontal-large-image-container office-form-theme-image-container-border":"office-form-question-image-container office-form-theme-image-container-border";if(l.ImageInfo&&l.ImageInfo.ResourceUrl){var R=f.ImageSettingsMaster.validateImageSettings(),O={className:N,style:v?void 0:{width:"{0}px".format(R.ContainerWidth)}};l.ImageInfo.AltText&&(O=(0,C.p2)(O,{"aria-label":l.ImageInfo.AltText,id:this.qu()}));var L=Q(l.ImageInfo);t=i.createElement("div",(0,r.pi)({},O),i.createElement(W,{Image:f.ImageInfoMaster,ImageSettings:f.ImageSettingsMaster,ImageType:"Question"}),L,i.createElement(on.d,null,this.props.Master.Question.ImageInfoMaster.Model.AltText))}else if(l.ImageInfo.ImageProcessingStatus===D.nv.Uploading||l.ImageInfo.ImageProcessingStatus===D.nv.Picking){O={className:N,style:{height:"{0}px".format((0,g.w_)()),width:"{0}px".format((0,g.Rr)())}};t=i.createElement("div",(0,r.pi)({},O),Q())}}if(this.isSubtitleLayout())if(l.IsMathQuiz&&!l.IsPlainTextInMathField){var M=(0,k.Rq)({DisableLinebreaks:this.props.DisableFormulaLinebreak,Formula:l.Subtitle,onRenderComplete:this.props.onHeightChange});e=i.createElement("div",{className:"office-form-question-formula"},M)}else{var q=null===(n=this.questionLocalizedItemMaster)||void 0===n?void 0:n.Model,U=(0,A.pd)((function(){return(0,E.wg)(null==q?void 0:q.subtitle,null==q?void 0:q.formsprortlocalesubtitle)||(0,E.wg)(l.Subtitle,l.FormsProRTSubtitle)}),(function(){var n=null;return n=(0,p.cr)("FormsProAnswerTag")?a.props.Master.Model.FormsProRuntimeSubtitle||(null==q?void 0:q.formsprortlocalesubtitle)||(null==q?void 0:q.subtitle)||l.FormsProRTSubtitle||l.Subtitle:(null==q?void 0:q.formsprortlocalesubtitle)||(null==q?void 0:q.subtitle)||l.FormsProRTSubtitle||l.Subtitle,(0,p.cr)("CVLeapFrogVisualRefresh")&&!n&&(n=a.props.LocalizedStrings.Designer_PlaceholderForQuestionSubtitle,m=(0,c.j)(m,"form-question-subtitle-placeholder")),n}));U=(0,I.getIoCModifiedTextField)(U,!1),o=(0,Z._)({HTMLAttributes:{className:l.FormsProRTSubtitle?(0,c.j)(m,"textformat-font"):m,id:this.getSubtitleId()},HtmlContent:!0,Label:U})}var V="question-title-box";return(0,A.md)((function(){V=(0,c.j)(V,h?"":"simplified-title-box")})),i.createElement("div",{className:V},i.createElement("div",(0,r.pi)({},d),this.props.ShowDesignInfo&&this.showTitleOrdinal()&&!y&&(0,A.md)((function(){return!(0,p.cr)("CVLeapFrogVisualRefresh")&&S({questionId:a.props.Master.Question.Model.Id,media:!0,mediabelow:!y})})),y?void 0:t,y?void 0:u,this.showTitleOrdinal()?this.createTitleOrdinal():void 0,this.props.ShowDesignInfo&&this.showTitleOrdinal()&&y&&(0,A.md)((function(){return!(0,p.cr)("CVLeapFrogVisualRefresh")&&S({questionId:a.props.Master.Question.Model.Id,media:!0,mediabelow:y})})),this.createTitleLabel(),o,y?t:void 0,y?u:void 0,e),this.props.ShowDesignInfo&&!this.showTitleOrdinal()&&(0,A.md)((function(){return!(0,p.cr)("CVLeapFrogVisualRefresh")&&S({questionId:a.props.Master.Question.Model.Id})})),(0,A.md)((function(){return(0,p.cr)("CVLeapFrogVisualRefresh")&&a.createQuestionTitleControls()})))},t.prototype.showTitleOrdinal=function(){var n=this,t=this.props.Master.Question.Form;return(0,A.pd)((function(){return n.isImageLayout()}),(function(){return n.isImageLayout()&&(null==t.SettingMaster.Model.ShowQuestionNumbers||t.SettingMaster.Model.ShowQuestionNumbers)}))},t.prototype.createImmersiveReaderButton=function(){return(0,s.w1)()||(0,p._y)()||(0,u.x8)()||!this.props.ShouldShowImmersiveReaderButtons?null:i.createElement(un.$,{onClick:o.debounce(this.ku,this.Pu,!0),whiteIcon:!1})},t.prototype.xu=function(){var n,t=this,e=this.props.Master.Question.Model;return e.CoAuthors&&e.CoAuthors.length>0?e.CoAuthors[e.CoAuthors.length-1].userId!==(0,a.k0)().userInfo.UserId&&(n=o.map(e.CoAuthors,(function(n){if(n.userId!==(0,a.k0)().userInfo.UserId){var e={ariaLabel:t.props.LocalizedStrings.DesignPage_NavBar_CoAuthor_Screen_Reader.format(n.displayName||n.userId,t.props.Ordinal||0),displayText:(0,en.c)(n.displayName,n.firstName,n.lastName),email:n.email,isCoAuthUser:!0,key:n.userId,name:n.displayName,tooltip:n.displayName||n.userId};return i.createElement(tn.k,(0,r.pi)({},e))}}))):n=void 0,i.createElement("div",{className:"question-coAuthor-notification-container-render-mode","aria-live":"polite"},n)},t.prototype.calcVideoDisplayHeight=function(){if((0,s.tq)()){var n=$(window).width();return 0===n&&(n=document.body.scrollWidth),n/(this.Tu/this._u)}return(0,g.HR)()},t.prototype.getOrdinalId=function(){return this.isImageLayout()?"".concat(this.Nu,"-ordinal"):void 0},t.prototype.getTitleId=function(){return"".concat(this.Nu,"-title")},t.prototype.getSubtitleId=function(){return this.isSubtitleLayout()?"".concat(this.Nu,"-subtitle"):void 0},t.prototype.qu=function(){return"".concat(this.Nu,"-image")},t.prototype.isImageLayout=function(){return this.props.Master.Question.Form.Model.HasQuestionMedia&&!this.props.HideMedia},t.prototype.isSubtitleLayout=function(){var n=this.props.Master.Question.Model;return(0,p.cr)("CVLeapFrogVisualRefresh")?n.ShowSubtitle:n.ShowSubtitle&&!!n.Subtitle},t.prototype.Ou=function(){var n=$(this.Fu.current),t=n.find(".office-form-question-formula span"),e=n.find(".office-form-question-choice-formula span"),r=n.find(".design-formula-mixer span");(0,b.z)(n.find("span").not(t).not(e).not(r))},t}(j.r)},89099:function(n,t,e){"use strict";e.d(t,{b:function(){return u}});var r=e(59312),i=e(87363),o=e(262),u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return(0,r.ZT)(t,n),t.prototype.render=function(){var n="form-renderer-section-breaker";return this.props.HasTheme&&(n=(0,o.j)(n,"office-form-theme-page-background")),i.createElement("div",{className:n})},t}(e(23112).r)},20845:function(n,t,e){"use strict";e.d(t,{p:function(){return j}});var r=e(59312),i=e(87363),o=e(16717),u=e(23112),s=e(12611),a=e(29559),c=e(9947),f=e(262),l=e(687),h=e(7645),d=e(43367),m=e(54496),v=e(72467),p=e(46008),g=e(70877),b=e(24497),w=e(73293),I=e(71860),y=e(90819),S=e(3920),F=e(502),C=e(49221),_=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return(0,r.ZT)(t,n),t.prototype.render=function(){var n;return n=this.props.ShowVideoUrl?i.createElement(C.k,{InDesignMode:this.props.InDesignMode,IsMobile:this.props.IsMobile,LocalizedStrings:this.props.LocalizedStrings,VideoUrl:this.props.Url}):i.createElement("iframe",{allowFullScreen:!0,className:this.props.ClassNameForIFrame,frameBorder:"0",height:t.calcVideoDisplayHeight(),sandbox:"allow-scripts allow-same-origin allow-popups allow-forms",src:this.props.Url,width:"100%","aria-label":this.props.LocalizedStrings.Linked_Video}),i.createElement("div",(0,r.pi)({},this.props.HTMLAttributes),n,this.props.children)},t.calcVideoDisplayHeight=function(){if((0,a.tq)()){var n=$(window).width();return 0===n&&(n=document.body.scrollWidth),9*n/16}return(0,l.HR)()},t}(u.r),T=e(24635),P=e(54164),N=e(60211),k=e(6787),E=e(73252),R=e(77356),O=e(61018),D=e(32782),x=e(29295);function L(){return(0,r.mG)(this,void 0,void 0,(function(){return(0,r.Jh)(this,(function(n){switch(n.label){case 0:return[4,e.e(166).then(e.bind(e,55055))];case 1:return[2,{default:n.sent().TitleOverflowMenu}]}}))}))}function M(n){var t=(0,x.J)(M,L);return i.createElement(D.Z,null,i.createElement(t,(0,r.pi)({},n)))}var q=e(24513),A=e(64290),U=e(49050),V=e(932),G=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.Uu=i.createRef(),t.Vu=i.createRef(),t.Pu=400,t.ku=function(){var n=[];n.push({content:t.props.Title}),n.push({content:"\n"}),n.push({content:t.props.SubTitle});var e={chunks:n,title:""},r={uiLang:(0,k.Kc)()||navigator.language};(0,O.d8)().getImmersiveReaderToken().then((function(n){n&&ImmersiveReader&&ImmersiveReader.launchAsync(n,null,e,r)}))},t}return(0,r.ZT)(t,n),t.prototype.componentDidMount=function(){return(0,r.mG)(this,void 0,void 0,(function(){return(0,r.Jh)(this,(function(n){return(0,R.z)($(this.Uu.current)),(0,R.z)($(this.Vu.current)),this.Gu(),[2]}))}))},t.prototype.componentDidUpdate=function(){(0,R.z)($(this.Uu.current)),(0,R.z)($(this.Vu.current)),this.Gu()},t.prototype.render=function(){var n=s.extend({},this.props.HTMLAttributes);n.className=(0,f.j)(n.className,"office-form-title-container");var t=this.Bu(),e=(0,f.j)(this.props.TitleId,document.getElementById(q.a)&&q.a);return i.createElement("div",{className:"office-form-title-content","aria-labelledby":t?null:e,role:t?null:"group"},i.createElement("div",(0,r.pi)({},n),this.zu(),this.ju(),"Bottom"===this.props.MediaLayout?this.props.children:void 0),!this.Bu()&&i.createElement("div",{className:"office-form-title-ir-container"},this.Qu(),this.Hu()))},t.prototype.zu=function(n){var t,e="office-form-title-box";return"Bottom"!==this.props.MediaLayout&&(e="".concat(e," ").concat(this.props.MediaLayout.toLowerCase()),t=this.props.children),i.createElement("div",{className:e},t,this.$u())},t.prototype.$u=function(){var n=this,t=s.extend({},this.props.HTMLPropsForInnerElement),e=this.props.Heading||1;return t.className=(0,f.j)("office-form-title",t.className,"heading-".concat(e),2===this.props.Heading&&"office-form-theme-secondary-color",!this.props.Title&&"empty-title"),(0,A.pd)((function(){var e={RenderMode:"RichText",Text:(0,b.wg)(n.props.Title,n.props.RichTitle),ContainsHtml:!0};return i.createElement("div",(0,r.pi)({},t,{ref:n.Vu}),i.createElement(U.D,(0,r.pi)({},e)),n.Bu()&&n.Qu(),t.children)}),(function(){var e=n.props.RichTitle||n.props.Title;return i.createElement("div",(0,r.pi)({},t),i.createElement(A.Xw.RichtTextControl,{HTMLContent:e}),t.children)}))},t.prototype.Gu=function(){2===this.props.Heading&&document.getElementById(q.a)&&$(this.Vu.current).attr("aria-labelledby",q.a)},t.prototype.Hu=function(){return(0,a.w1)()||(0,N.x8)()||this.props.Heading>1?null:M({ImmersiveReaderToggleProps:(0,r.pi)({},this.props.ImmersiveReaderToggleProps)})},t.prototype.Qu=function(){var n;return(0,a.w1)()||(0,N.x8)()||(0,E._y)()||!(null===(n=this.props.ImmersiveReaderToggleProps)||void 0===n?void 0:n.ShouldShowImmersiveReaderButtons)?null:i.createElement(V.$,{onClick:s.debounce(this.ku,this.Pu,!0),whiteIcon:!this.Bu(),className:!this.Bu()&&"office-form-theme-button"})},t.prototype.ju=function(){if(this.props.SubTitle){var n={RenderMode:"RichText",Text:(0,b.wg)(this.props.SubTitle,this.props.RichSubtitle),ContainsHtml:!0};return i.createElement("div",{className:"office-form-subtitle heading-".concat(this.props.Heading||1),ref:this.Uu},i.createElement(U.D,(0,r.pi)({},n)))}},t.prototype.Bu=function(){return 2===this.props.Heading},t}(u.r),B=e(46956),z=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return(0,r.ZT)(t,n),t.prototype.componentWillMount=function(){this.Wu(this.props)},t.prototype.componentWillReceiveProps=function(n){this.Wu(n)},t.prototype.componentDidMount=function(){var n=this;this.bu=function(){return n.forceUpdate()};var t=this.props.Master,e=w.Jv.Schema;t.observe(this.bu,[e.Title,e.Subtitle,e.VideoInfo,e.CoAuthors]);var r=[I.x.Schema.HasQuestionMedia];r=(0,d.addIoCHeaderFontToSchemas)(r),t.Form.observe(this.bu,r);var i=(0,v.BF)().Schema;t.ImageSettingsMaster.observe(this.bu,[i.NaturalWidth,i.NaturalHeight,i.ContainerWidth,i.ContainerHeight,i.Size,i.Layout]);var o=(0,v.Cu)().Schema;t.ImageInfoMaster.observe(this.bu,[o.ImageProcessingStatus,o.UploadParameters]),this.Eu=(0,v.f5)(),this.Eu.observe(this.bu,[this.Eu.Schema.FormsTenantSettings])},t.prototype.componentWillUnmount=function(){var n=this.props.Master;n.unobserve(this.bu),n.ImageInfoMaster.unobserve(this.bu),n.ImageSettingsMaster.unobserve(this.bu),this.Eu.unobserve(this.bu)},t.prototype.render=function(){var n,t=this.props.Master,e="Right",o=t.Model.VideoInfo,u=t.ImageInfoMaster,c=t.ImageSettingsMaster,l=u.Model;if(!this.props.HideMedia)if(l.ErrorType||l.ImageProcessingStatus===y.nv.Idle&&!(0,y.UO)(l))t.hasValidVideoUrl()&&(e="Bottom",n=i.createElement(_,{ClassNameForIFrame:"design-question-title-video-frame",HTMLAttributes:{className:"design-question-image-title-big-horizontal"},key:"video",Url:o.Url,IsMobile:(0,a.tq)(),ShowVideoUrl:(0,g.B9)(o.Url,t.Form),LocalizedStrings:this.props.LocalizedStrings}));else{var d=this.Ju(c.Model);e=d.ImageLayout,n=i.createElement(B.z,{FullFilled:"Bottom"===e,ImageWidth:d.Width,ImageHeight:d.Height,ImageInfoMaster:u,ImageSettingMaster:c,ImageType:"Section",key:"image"})}var v=s.extend({},this.props.HTMLAttributes);v.className=(0,f.j)(v.className,"__section-title__ office-form-section-title",this.props.Master.Form.Model.HasQuestionMedia&&"office-form-theme-image-question-background with-image");var p=this.Ku(),b=p.Title||(0,h.pm)().Designer_SectionTitle;p.SubTitle&&(b="".concat(b," ").concat(p.SubTitle));var w=(0,m.p2)(v,{"aria-label":"".concat(b)});if(this.props.IsRuntime&&this.Xu(p.Title,p.SubTitle))return null;var I=i.createElement(G,(0,r.pi)({Heading:2,HTMLAttributes:w,HTMLPropsForInnerElement:{className:"office-form-theme-primary-color","aria-level":2,role:"heading"},MediaLayout:e,ImmersiveReaderToggleProps:{ShouldShowImmersiveReaderButtons:this.props.ShouldShowImmersiveReaderButtons,ToggleImmersiveReaderButtons:null}},p),n,this.Yu());return this.props.IsRuntime&&(I=i.createElement("div",{className:"form-renderer-section-title"},I)),I},t.prototype.Ku=function(){var n,t,e,r,i=this.props.Master;if(this.Zu){var o=this.Zu.Model;n=o.title,t=o.subtitle,e=o.formsprortlocaletitle,r=o.formsprortlocalesubtitle}n=n||i.Model.Title||"",t=t||i.Model.Subtitle||"";var u=w.Jv.Schema,s=i.isFieldReady(u.FormsProRTQuestionTitle)&&i.isFieldReady(u.FormsProRTSubtitle);return e=(0,b.gA)(e||s&&i.Model.FormsProRTQuestionTitle||""),r=(0,b.gA)(r||s&&i.Model.FormsProRTSubtitle||""),{Title:(0,d.getIoCModifiedTextField)(n,!0),SubTitle:(0,d.getIoCModifiedTextField)(t,!0),RichTitle:(0,d.getIoCModifiedTextField)(e,!0),RichSubtitle:(0,d.getIoCModifiedTextField)(r,!0)}},t.prototype.Xu=function(n,t){var e=this.props.Master.Model;return!(n||t||e.ImageInfo.ResourceUrl||e.VideoInfo.Url)},t.prototype.Wu=function(n){var t=n.Master,e=t.Form,r=n.LocaleId;this.Zu=r?F.k.getQuestionResourceMaster(r,t.Model.Id,e):void 0},t.prototype.Yu=function(){var n=this,t=this.props.Master.Model.CoAuthors;if(t&&t.length>0&&t[t.length-1].userId!==(0,c.k0)().userInfo.UserId)return i.createElement("div",{className:"question-coAuthor-notification-container-design-mode",key:"coAuthor"},s.map(t,(function(t){return n.ts(t)})))},t.prototype.ts=function(n){if(n.userId!==(0,c.k0)().userInfo.UserId){var t=this.props.LocalizedStrings.DesignPage_NavBar_CoAuthor_Section_Screen_Reader.format(n.displayName||n.userId,this.props.Ordinal);return i.createElement(T.k,{ariaLabel:t,displayText:(0,P.c)(n.displayName,n.firstName,n.lastName),email:n.email,key:n.userId,name:n.displayName,tooltip:n.displayName||n.userId})}},t.prototype.Ju=function(n){return this.props.IsMobile||(0,p.rA)()||n.Layout===S.RZ.Horizontal&&n.Size===S.h2.Large?{ImageLayout:"Bottom"}:{Height:n.ContainerHeight||(0,l.w_)(),ImageLayout:"Right",Width:n.ContainerWidth||(0,l.Rr)()}},t}(u.r),j=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return(0,r.ZT)(t,n),t.prototype.render=function(){var n=this;return i.createElement(o.U.Consumer,null,(function(t){t.LocalizedStrings;return i.createElement("div",{className:"form-renderer-section-container",role:"group","aria-label":n.props.SectionMaster.Model.Title,"data-id":n.props.SectionMaster.Model.Id},n.createSectionTitle(),i.createElement("div",{className:"form-renderer-section-content"},n.props.children))}))},t.prototype.createSectionTitle=function(){var n=this;return i.createElement(o.U.Consumer,null,(function(t){var e=t.LocalizedStrings;return i.createElement(z,{IsMobile:n.props.IsMobile,LocaleId:n.props.LocaleId,LocalizedStrings:e,Master:n.props.SectionMaster,ShouldShowImmersiveReaderButtons:n.props.ShouldShowImmersiveReaderButtons,IsRuntime:!0})}))},t}(u.r)},49221:function(n,t,e){"use strict";e.d(t,{k:function(){return o}});var r=e(87363),i=e(3424);function o(n){var t=r.createRef(),e=r.createRef(),o=n.IsMobile,u=n.VideoUrl,s=o?"mobile-youtube":"pc-youtube";return s=n.InDesignMode?"design-question-title-youtube-placeholder ".concat(s):"office-form-title-youtube-placeholder ".concat(s),r.createElement("div",{className:s},r.createElement("div",{className:"question-title-youtube-title"},r.createElement("a",{className:"question-title-youtube-link",href:u,rel:"noreferrer",target:"_blank"},u)),r.createElement("div",{className:"question-title-youtube-tip"},r.createElement("span",{className:"question-title-youtube-tip-text"},n.LocalizedStrings.DesignPage_Youtube_Disabled_Launch_Tip),!o&&r.createElement(i.F,{FluentIcon:"Info",HTMLAttributes:{className:"forms-icon-size12x12 question-title-youtube-tip-icon",onMouseOver:function(){var n=$(t.current&&t.current.getHtmlElement()),r=$(e.current);n&&r&&r.css({left:n.offset().left+n.width()/2,top:n.offset().top+n.width()/2})}},ref:t}),r.createElement("span",{className:"question-title-youtube-hover-tip ms-Icon",ref:e},n.LocalizedStrings.DesignPage_Youtube_Disabled_Hover_Tip)))}},63481:function(n,t,e){"use strict";e.d(t,{Vh:function(){return u},mZ:function(){return o},su:function(){return i}});var r=e(12611);e(56117);function i(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];if(n&&document.activeElement&&n.contains(document.activeElement)){var r=$(":focusable");t&&t.forEach((function(n){r=r.not((function(t,e){return n.contains(e)}))}));var i=r.index(document.activeElement);if(!(i<0)){for(var o=i+1;o<r.length;++o){var u=r[o];if(!n.contains(u)&&!a(u))return void r[o].focus()}for(o=i-1;o>=0;--o){u=r[o];if(!n.contains(u)&&!a(u))return void r[o].focus()}}}}function o(n){$(n).on("keydown",s)}function u(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];var r=$(n).find(":focusable");t&&t.forEach((function(n){r=r.not((function(t,e){return n.contains(e)}))})),r.length>0&&r[0].focus()}function s(n){if(9===n.keyCode){n.stopPropagation(),n.preventDefault();var t=$(this),e=r.union(t.filter(":focusable").toArray(),t.find(":focusable").toArray()),i=e.indexOf(document.activeElement);if(!(i<0)){var o=r.union(e.slice(i+1),e.slice(0,i));n.shiftKey&&o.reverse(),o.push(e[i]);var u=r.find(o,(function(n){return!a(n)}));u&&u.focus()}}}function a(n){var t=Number(n.getAttribute("tabindex"));return!isNaN(t)&&t<0}},73546:function(n,t,e){"use strict";e.d(t,{j:function(){return i}});var r=e(72377);function i(){return r.Pv.Resolve("ILogger")}},72377:function(n,t,e){"use strict";e.d(t,{Pv:function(){return o}});var r=function(){function n(){this.rs=!1,this.os=!1}return n.prototype.UsingSingleton=function(n){return this.us(n,!0)},n.prototype.UsingFactory=function(n){return this.us(n,!1)},n.prototype.Create=function(){return this.rs?(this.fs||(this.fs=this.ls()),this.fs):this.ls()},n.prototype.us=function(n,t){return this.rs=t,this.hs=n,this},n.prototype.ls=function(){if(this.os)throw Error("Circular dependency detected ");this.os=!0;var n=this.hs();return this.os=!1,n},n}(),i=function(){function n(){this.ds={}}return n.prototype.Add=function(n,t){this.ds[n]=t},n.prototype.Get=function(n){return this.ds[n]},n}(),o=new(function(){function n(){this.vs=new i}return n.prototype.Resolve=function(n){var t,e=this.vs.Get(n);if(!e)throw Error("Failed to resolve ".concat(n,", make sure you have registered it by calling Register()"));try{t=e.Create()}catch(t){throw Error("Exception when resolving ".concat(n,": ").concat(t))}return t},n.prototype.Register=function(n){var t=new r;return this.vs.Add(n,t),t},n}())},99243:function(n,t,e){"use strict";e.d(t,{V:function(){return r}});var r=function(){function n(){this.D365ToOfficeLanguageMap={"ar-sa":"ar","bg-bg":"bg","ca-es":"ca","cs-cz":"cs","da-dk":"da","de-de":"de","el-gr":"el","en-us":"en-us","es-es":"es-ES","et-ee":"et","eu-es":"eu","fi-fi":"fi","fr-fr":"fr-FR","gl-es":"gl","he-il":"he","hi-in":"hi","hr-hr":"hr","hu-hu":"hu","id-id":"id","it-it":"it","ja-jp":"ja","kk-kz":"kk","ko-kr":"ko","lt-lt":"lt","lv-lv":"lv","ms-my":"ms","nb-no":"nb-no","nl-nl":"nl","pl-pl":"pl","pt-br":"pt-br","pt-pt":"pt-pt","ro-ro":"ro","ru-ru":"ru","sk-sk":"sk","sl-si":"sl","sr-cyrl-cs":"sr-cyrl-rs","sr-latn-cs":"sr-latn-rs","sv-se":"sv","th-th":"th","tr-tr":"tr","uk-ua":"uk","vi-vn":"vi","zh-cn":"zh-Hans","zh-hk":"zh-Hant","zh-tw":"zh-Hant"}}return n.getSingletonInstance=function(){return this._instance||(this._instance=new this)},n.prototype.getDefaultLanguage=function(){var n=navigator.language.toLowerCase();return this.mapLanguageCode(n)},n.prototype.mapLanguageCode=function(t){var e=n.D365FallbackLangauges[t];return this.D365ToOfficeLanguageMap[e]||"en-us"},n.prototype.mapLanguageCodeOrNull=function(t){var e=n.D365FallbackLangauges[t];return this.D365ToOfficeLanguageMap[e]},n.D365FallbackLangauges={agq:"fr-fr","agq-cm":"fr-fr",ar:"ar-sa","ar-ae":"ar-sa","ar-bh":"ar-sa","ar-dz":"ar-sa","ar-eg":"ar-sa","ar-iq":"ar-sa","ar-jo":"ar-sa","ar-kw":"ar-sa","ar-lb":"ar-sa","ar-ly":"ar-sa","ar-ma":"ar-sa",arn:"es-es","arn-cl":"es-es","arn-latn":"es-es","ar-om":"ar-sa","ar-qa":"ar-sa","ar-sa":"ar-sa","ar-sy":"ar-sa","ar-tn":"ar-sa","ar-ye":"ar-sa",ast:"es-es","ast-es":"es-es",ba:"ru-ru","ba-cyrl":"ru-ru","ba-ru":"ru-ru",bas:"fr-fr","bas-cm":"fr-fr",be:"ru-ru","be-by":"ru-ru",bg:"bg-bg","bg-bg":"bg-bg",bm:"fr-fr","bm-latn":"fr-fr","bm-latn-ml":"fr-fr","bo-cn":"zh-cn",br:"fr-fr","br-fr":"fr-fr","br-latn":"fr-fr",ca:"ca-es","ca-ad":"ca-es","ca-es":"ca-es","ca-es-valencia":"es-es","ca-fr":"ca-es","ca-it":"ca-es",co:"fr-fr","co-fr":"fr-fr","co-latn":"fr-fr",cs:"cs-cz","cs-cz":"cs-cz",da:"da-dk","da-dk":"da-dk","da-gl":"da-dk",de:"de-de","de-at":"de-de","de-be":"de-de","de-ch":"de-de","de-de":"de-de","de-li":"de-de","de-lu":"de-de",dje:"fr-fr","dje-ne":"fr-fr",dsb:"de-de","dsb-de":"de-de",dua:"fr-fr","dua-cm":"fr-fr",dyo:"fr-fr","dyo-sn":"fr-fr","ee-tg":"fr-fr",el:"el-gr","el-cy":"el-gr","el-gr":"el-gr",en:"en-us","en-au":"en-us","en-ca":"en-us","en-gb":"en-us","en-ie":"en-us","en-in":"en-us","en-my":"en-us","en-nl":"en-us","en-ph":"en-us","en-sg":"en-us","en-us":"en-us","en-za":"en-us",es:"es-es","es-419":"es-es","es-ar":"es-es","es-bo":"es-es","es-cl":"es-es","es-co":"es-es","es-cr":"es-es","es-cu":"es-es","es-do":"es-es","es-ec":"es-es","es-es":"es-es","es-es_tradnl":"es-es","es-gq":"es-es","es-gt":"es-es","es-hn":"es-es","es-mx":"es-es","es-ni":"es-es","es-pa":"es-es","es-pe":"es-es","es-ph":"es-es","es-pr":"es-es","es-py":"es-es","es-sv":"es-es","es-us":"es-es","es-uy":"es-es","es-ve":"es-es",et:"et-ee","et-ee":"et-ee",eu:"eu-es","eu-es":"eu-es",ewo:"fr-fr","ewo-cm":"fr-fr",ff:"fr-fr","ff-cm":"fr-fr","ff-gn":"fr-fr","ff-latn":"fr-fr","ff-latn-cm":"fr-fr","ff-latn-gn":"fr-fr","ff-latn-sn":"fr-fr","ff-sn":"fr-fr",fi:"fi-fi","fi-fi":"fi-fi",fo:"da-dk","fo-fo":"da-dk",fr:"fr-fr","fr-be":"fr-fr","fr-bf":"fr-fr","fr-bi":"fr-fr","fr-bj":"fr-fr","fr-bl":"fr-fr","fr-ca":"fr-fr","fr-cd":"fr-fr","fr-cf":"fr-fr","fr-cg":"fr-fr","fr-ch":"fr-fr","fr-ci":"fr-fr","fr-cm":"fr-fr","fr-dj":"fr-fr","fr-dz":"fr-fr","fr-fr":"fr-fr","fr-ga":"fr-fr","fr-gf":"fr-fr","fr-gn":"fr-fr","fr-gp":"fr-fr","fr-gq":"fr-fr","fr-ht":"fr-fr","fr-km":"fr-fr","fr-lu":"fr-fr","fr-ma":"fr-fr","fr-mc":"fr-fr","fr-mf":"fr-fr","fr-mg":"fr-fr","fr-ml":"fr-fr","fr-mq":"fr-fr","fr-mr":"fr-fr","fr-mu":"fr-fr","fr-nc":"fr-fr","fr-ne":"fr-fr","fr-pf":"fr-fr","fr-pm":"fr-fr","fr-re":"fr-fr","fr-rw":"fr-fr","fr-sc":"fr-fr","fr-sn":"fr-fr","fr-sy":"fr-fr","fr-td":"fr-fr","fr-tg":"fr-fr","fr-tn":"fr-fr","fr-vu":"fr-fr","fr-wf":"fr-fr","fr-yt":"fr-fr",fur:"it-it","fur-it":"it-it",fy:"nl-nl","fy-nl":"nl-nl",gl:"gl-es","gl-es":"gl-es",gn:"es-es","gn-py":"es-es",gsw:"fr-fr","gsw-ch":"de-de","gsw-fr":"fr-fr","gsw-li":"de-de",he:"he-il","he-il":"he-il",hi:"hi-in","hi-in":"hi-in",hr:"hr-hr","hr-hr":"hr-hr",hsb:"de-de","hsb-de":"de-de",hu:"hu-hu","hu-hu":"hu-hu",id:"id-id","id-id":"id-id","ii-cn":"zh-cn","ii-yii":"zh-cn",it:"it-it","it-ch":"it-it","it-it":"it-it","it-sm":"it-it",ja:"ja-jp","ja-jp":"ja-jp",jgo:"fr-fr","jgo-cm":"fr-fr",jv:"id-id","jv-latn":"id-id","jv-latn-id":"id-id",kea:"pt-pt","kea-cv":"pt-pt",khq:"fr-fr","khq-ml":"fr-fr",kk:"kk-kz",kkj:"fr-fr","kkj-cm":"fr-fr","kk-kz":"kk-kz",kl:"da-dk","kl-gl":"da-dk",ko:"ko-kr","ko-kr":"ko-kr",ksf:"fr-fr","ksf-cm":"fr-fr",ksh:"de-de","ksh-de":"de-de","ky-cyrl":"ru-ru","ky-kg":"ru-ru",lb:"fr-fr","lb-lu":"fr-fr",lt:"lt-lt","lt-lt":"lt-lt",lu:"fr-fr","lu-cd":"fr-fr",lv:"lv-lv","lv-lv":"lv-lv",mg:"fr-fr",mgh:"pt-pt","mgh-mz":"pt-pt","mg-mg":"fr-fr",mgo:"fr-fr","mgo-cm":"fr-fr","mn-mong":"zh-cn","mn-mong-cn":"zh-cn",ms:"ms-my","ms-bn":"ms-my","ms-my":"ms-my",mua:"fr-fr","mua-cm":"fr-fr",nb:"nb-no","nb-no":"nb-no","nb-sj":"nb-no",nl:"nl-nl","nl-aw":"nl-nl","nl-be":"nl-nl","nl-bq":"nl-nl","nl-cw":"nl-nl","nl-nl":"nl-nl","nl-sr":"nl-nl","nl-sx":"nl-nl",nmg:"fr-fr","nmg-cm":"fr-fr",nn:"nb-no",nnh:"fr-fr","nnh-cm":"fr-fr","nn-no":"nb-no",no:"nb-no","oc-fr":"fr-fr","oc-latn":"fr-fr","os-ru":"ru-ru",pl:"pl-pl","pl-pl":"pl-pl",pt:"pt-pt","pt-ao":"pt-pt","pt-br":"pt-br","pt-cv":"pt-pt","pt-gw":"pt-pt","pt-mo":"pt-pt","pt-mz":"pt-pt","pt-pt":"pt-pt","pt-st":"pt-pt","pt-tl":"pt-pt","quc-latn":"es-es","quc-latn-gt":"es-es",qut:"es-es","qut-gt":"es-es",quz:"es-es","quz-bo":"es-es","quz-ec":"es-es","quz-latn":"es-es","quz-latn-bo":"es-es","quz-latn-ec":"es-es","quz-latn-pe":"es-es","quz-pe":"es-es",rm:"de-de","rm-ch":"de-de",rn:"fr-fr","rn-bi":"fr-fr",ro:"ro-ro","ro-md":"ro-ro","ro-ro":"ro-ro",ru:"ru-ru","ru-by":"ru-ru","ru-kg":"ru-ru","ru-kz":"ru-ru","ru-md":"ru-ru","ru-ru":"ru-ru",sah:"ru-ru","sah-cyrl":"ru-ru","sah-ru":"ru-ru",se:"sv-se","se-fi":"fi-fi",seh:"pt-pt","seh-mz":"pt-pt","se-no":"nb-no",ses:"fr-fr","se-se":"sv-se","ses-ml":"fr-fr",sg:"fr-fr","sg-cf":"fr-fr","shi-latn":"fr-fr","shi-latn-ma":"fr-fr","shi-tfng":"fr-fr","shi-tfng-ma":"fr-fr",sk:"sk-sk","sk-sk":"sk-sk",sl:"sl-si","sl-si":"sl-si","sma-latn":"nb-no","sma-latn-no":"nb-no","sma-latn-se":"sv-se","sma-no":"nb-no","sma-se":"sv-se","smj-latn":"sv-se","smj-latn-no":"nb-no","smj-latn-se":"sv-se","smj-no":"nb-no","smj-se":"sv-se","smn-latn":"fi-fi","smn-latn-fi":"fi-fi","sms-fi":"fi-fi","sms-latn":"fi-fi",sr:"sr-latn-rs","sr-cyrl":"sr-cyrl-rs","sr-cyrl-cs":"sr-cyrl-rs","sr-cyrl-me":"sr-cyrl-rs","sr-cyrl-rs":"sr-cyrl-rs","sr-latn":"sr-latn-rs","sr-latn-cs":"sr-latn-rs","sr-latn-me":"sr-latn-rs","sr-latn-rs":"sr-latn-rs",sv:"sv-se","sv-ax":"sv-se","sv-fi":"sv-se","sv-se":"sv-se",swc:"fr-fr","swc-cd":"fr-fr","tg-cyrl":"ru-ru","tg-cyrl-tj":"ru-ru",th:"th-th","th-th":"th-th","tk-latn":"ru-ru",tr:"tr-tr","tr-tr":"tr-tr",tt:"ru-ru","tt-cyrl":"ru-ru","tt-ru":"ru-ru",twq:"fr-fr","twq-ne":"fr-fr","tzm-latn-ma":"fr-fr","tzm-tfng":"fr-fr","tzm-tfng-ma":"fr-fr","ug-arab":"zh-cn","ug-cn":"zh-cn",uk:"uk-ua","uk-ua":"uk-ua",vi:"vi-vn","vi-vn":"vi-vn",wae:"de-de","wae-ch":"de-de","wee-de":"de-de",wo:"fr-fr","wo-latn":"fr-fr","wo-sn":"fr-fr",yav:"fr-fr","yav-cm":"fr-fr",zgh:"fr-fr","zgh-tfng":"fr-fr","zgh-tfng-ma":"fr-fr",zh:"zh-cn","zh-chs":"zh-cn","zh-cht":"zh-tw","zh-cn":"zh-cn","zh-hans":"zh-cn","zh-hans-cn":"zh-cn","zh-hans-sg":"zh-cn","zh-hant":"zh-tw","zh-hant-hk":"zh-tw","zh-hant-mo":"zh-tw","zh-hant-tw":"zh-tw","zh-hk":"zh-hk","zh-mo":"zh-tw","zh-sg":"zh-cn","zh-tw":"zh-tw"},n}()},61634:function(n,t,e){"use strict";var r,i;e.d(t,{CP:function(){return o},eG:function(){return r}}),function(n){n.Home="Home",n.AllProjects="AllProjects",n.ProjectCreation="ProjectCreation",n.SurveyDesigner="SurveyDesigner",n.ReportView="ReportView",n.SatisfactionMetricView="SatisfactionMetricView",n.AlertsView="AlertsView",n.AdminView="AdminView"}(r||(r={})),function(n){n[n[void 0]=0]="undefined",n[n.NPS=1]="NPS",n[n.CSAT=2]="CSAT",n[n.Sentiment=3]="Sentiment",n[n.Scoring=4]="Scoring"}(i||(i={}));var o,u,s;!function(n){n[n.Survey=1]="Survey",n[n.Report=2]="Report"}(o||(o={})),function(n){n[n.FetchNotStarted=0]="FetchNotStarted",n[n.Fetching=1]="Fetching",n[n.Fetched=2]="Fetched",n[n.NoData=3]="NoData"}(u||(u={})),function(n){n.Sentiment="sentiment",n.Nps="nps",n.Csat="csat",n.Scoring="scoring"}(s||(s={}))},16195:function(n,t,e){"use strict";var r=/('[^']*'|"[^"]*")/g,i=/('[^']*'|"[^"]*"|d{1,2}|M{1,2}|y{2,4}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|t{2})/g;function o(n,t){var e=n.toString();if(n<0)return e;if(t&&t>e.length)for(;t>e.length;)e="0"+e;return e}function u(n){return r.test(n)?n.substr(1,n.length-2):n}function s(n,t,e){var r={};return null==n||null==t||null==e?r:(t.split(i).forEach((function(t){var i;switch(t){case"d":case"dd":case"M":case"MM":case"h":case"hh":case"H":case"HH":case"m":case"mm":case"s":case"ss":i=2;case"yy":case"yyy":case"yyyy":i=i||4,r[t]=function(n,t){t=t||n.length;var e=n.match(/^\d+/g),r=e&&e[0];return r?r.length<=t?r:r.substr(0,t):""}(n,i),i=r[t].length;break;case"tt":i=0;var o=n.toUpperCase();o.startsWith(e.DateTimeFormat.AMDesignator.toUpperCase())?i=e.DateTimeFormat.AMDesignator.length:o.startsWith(e.DateTimeFormat.PMDesignator.toUpperCase())?i=e.DateTimeFormat.PMDesignator.length:(o.startsWith("AM")||o.startsWith("PM"))&&(i=2),r[t]=n.substr(0,i);break;default:i=0,t=u(t),n.startsWith(t)&&(i=t.length)}n=n.slice(i)})),n.length>0?{}:r)}function a(n,t){var e=parseInt(n.HH||n.H),r=parseInt(n.hh||n.h||n.time||12);if(isNaN(e)&&!isNaN(r)&&r>=1&&r<=12)if(null==n.tt)n.time||(e=0);else switch(n.tt.toUpperCase()){case"AM":case t.DateTimeFormat.AMDesignator.toUpperCase():e=r%12;break;case"PM":case t.DateTimeFormat.PMDesignator.toUpperCase():e=r%12+12}var i=parseInt(n.mm||n.m||n.time||0),o=parseInt(n.ss||n.s||0);return isNaN(e)||isNaN(i)?NaN:1e3*(60*(60*e+i)+o)}Date.prototype.toFormatString=function(n,t){var e=this;return null==e||null==n||null==t?null:n.split(i).map((function(n){switch(n){case"d":case"dd":return o(e.getDate(),n.length);case"ddd":return t.DateTimeFormat.AbbreviatedDayNames[e.getDay()];case"M":case"MM":return o(e.getMonth()+1,n.length);case"MMM":return t.DateTimeFormat.AbbreviatedMonthNames[e.getMonth()];case"yy":var r=e.getFullYear(),i=o(r,4);return r>t.Calendar.TwoDigitYearMax-100&&r<=t.Calendar.TwoDigitYearMax?i.slice(2):i;case"yyy":case"yyyy":case"yyyyy":return o(e.getFullYear(),n.length);case"H":case"HH":return o(e.getHours(),n.length);case"h":case"hh":return o((e.getHours()+11)%12+1,n.length);case"m":case"mm":return o(e.getMinutes(),n.length);case"s":case"ss":return o(e.getSeconds(),n.length);case"t":case"tt":var s=e.getHours()<12?t.DateTimeFormat.AMDesignator:t.DateTimeFormat.PMDesignator;return 1===n.length?s.charAt(0):s;default:return u(n)}})).join("")},Date.prototype.toDateShortString=function(n){return this.toFormatString(n.DateTimeFormat.ShortDatePattern,n)},Date.prototype.toTimeShortString=function(n){return this.toFormatString(n.DateTimeFormat.ShortTimePattern,n)};var c=e(9947);Date.parseDate=function(n,t,e){var r=s(n,t,e),i=parseInt(r.yyyy||r.yyy),o=parseInt(r.yy);if(isNaN(i)&&!isNaN(o))if(o>=100)i=o;else{var u=(0,c.k0)().cultureInfo.Calendar.TwoDigitYearMax%100;i=o<=u?(0,c.k0)().cultureInfo.Calendar.TwoDigitYearMax-u+o:(0,c.k0)().cultureInfo.Calendar.TwoDigitYearMax-u-100+o}var f=parseInt(r.MM||r.M),l=r.MMM;isNaN(f)&&l&&(f=e.DateTimeFormat.AbbreviatedMonthNames.indexOf(l)+1);var h=parseInt(r.dd||r.d),d=a(r,e);if(!(isNaN(i)||isNaN(f)||isNaN(h)||isNaN(d))){var m=new Date(i,f-1,h,0,0,0,d);if(m.getFullYear()===i&&m.getMonth()+1===f&&m.getDate()===h)return m}return null},Date.parseTime=function(n,t,e){var r=s(n,t,e);return r.time=!0,a(r,e)},"name"in Function.prototype||Object.defineProperty(Function.prototype,"name",{get:function(){var n=/function\s([^(]{1,})\(/.exec(this.toString());return n&&n.length>1?n[1].trim():""}});var f=e(93641),l=e.n(f);!function(){var n;if(void 0!==e.g)n=e.g;else if("undefined"!=typeof self)n=self;else try{n=Function("return this")()}catch(n){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=n.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(n){}if("[object Promise]"===r&&!t.cast&&void 0!==t.prototype.finally)return}n.Promise=l().Promise}(),String.prototype.format||(String.prototype.format=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return this.replace(/{(\d+)}/g,(function(t,e){return void 0!==n[e]?n[e]:t}))}),String.prototype.includes||(String.prototype.includes=function(n,t){return void 0===t&&(t=0),-1!==this.indexOf(n,t)}),String.prototype.startsWith=function(n){if(null==n||0===n.length)return!0;var t=this;return!(null==t||t.length<n.length)&&n===t.substr(0,n.length)},String.prototype.endsWith=function(n){if(null==n||0===n.length)return!0;var t=this;return!(null==t||t.length<n.length)&&n===t.substr(t.length-n.length,n.length)},String.prototype.replaceAll=function(n,t){return this.replace(new RegExp(n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),t)},Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(n,t){for(var e=0;e<this.length;e++)if(n.call(t,this[e],e,this))return this[e]},configurable:!0,writable:!0});window.Forms={Mru:{},PrintTemplate:{}},window.FormsPro={};var h=e(87363),d=e(61533),m=e(34221),v=e(94290),p=e(59312),g=e(72467),b=e(35564),w=e(12611),I=e.n(w),y=e(29559),S=e(7645),F=e(41040),C=e(23112),_=e(72317);var T=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.gs=void 0,t.bs=void 0,t}return(0,p.ZT)(t,n),t.prototype.componentDidMount=function(){var n=this;this.setState({Alerting:!0});var t=this.props;t.Timeout>0&&(this.gs=window.setTimeout((function(){n.setState({Timeout:!0})}),t.Timeout)),this.bs=window.setTimeout((function(){(0,_.a)().RetryingRecoverableError&&n.setState({Timeout:!0,DetailMessage:n.props.TimeoutMessage||(0,S.pm)().RetryRecoverableErrorMessage_WorkingOn})}),1e4)},t.prototype.componentWillUnmount=function(){window.clearTimeout(this.gs),window.clearTimeout(this.bs)},t.prototype.render=function(){var n,t;if(this.state.Timeout){var e=this.state.DetailMessage||(0,S.pm)().LoadingPlaceholder_Timeout_Message;n=h.createElement("div",{className:"page-loading-message-timeout"},e)}this.state.Alerting&&(t=this.props.Message);var r={ClassName:"portalPage-content-spinner",Ignorable:!1,LoadingDescription:t},i=h.createElement(F.P,(0,p.pi)({},r));return h.createElement("div",{"aria-live":"polite","aria-label":(0,S.pm)().Common_Loading_Text,className:"page-loading-messagebox",tabIndex:0},i,n)},t}(C.r),P=e(64290),N=e(3424),k=e(70642),E=e(89099),R=e(20845),O=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return(0,p.ZT)(t,n),t.prototype.render=function(){return this.props.IsResponseValid?this.ws():this.props.IsLoading?h.createElement("div",{className:"analyze-view-placerholder"},(n={Message:(0,S.pm)().Common_Loading_Text},h.createElement(T,(0,p.pi)({},n)))):h.createElement("div",{className:"analyze-view-detail-content"},h.createElement("div",{className:"analyze-view-detail-noresponses-container"},h.createElement(N.F,{FluentIcon:"Emoji Sad",HTMLAttributes:{className:"analyze-view-warning-icon"}}),h.createElement("div",{className:"analyze-view-detail-noresponse-message"},(0,S.pm)().Analysis_Page_No_Responses_Message),h.createElement("div",{className:"analyze-view-detail-noresponse-detail"},(0,S.pm)().Analysis_Page_No_Responses_Details)));var n},t.prototype.ws=function(){return h.createElement.apply(h,(0,p.ev)(["div",null],this.Is(),!1))},t.prototype.Is=function(){var n=this,t=this.props.FormRuntimeMaster,e=t.ElementManager().getAllSections();(0,P.md)((function(){e=e.filter((function(n){return!n.Section||n.Section&&t.formsProSectionVisiblityCheck(n.Section)&&n.TopQuestionMasters.filter((function(n){return t.formsProQuestionVisiblityCheck(n)})).length>0}))}));var r=(0,y.tq)(),i=[];return e.forEach((function(t){var e=n.ys(t.TopQuestionMasters);t.Section?(i.push(h.createElement(E.b,{HasTheme:!1,key:"form-section-breaker-"+t.Section.Model.Id})),i.push(h.createElement(R.p,{Disabled:!0,DisableShuffle:!0,Expaned:!0,IsMobile:r,key:"form-section-container-"+t.Section.Model.Id,SectionMaster:t.Section},e))):i.push(e)})),i},t.prototype.ys=function(n){if(n.length<=0)return null;var t,e=this.props.FormRuntimeMaster,r=(0,y.tq)();return(0,P.md)((function(){n.map((function(n){""===n.Model.Answer||e.formsProQuestionVisiblityCheck(n)||e.setVisibility(n)}))})),(0,P.pd)((function(){t=w.indexOf(e.TopQuestionRuntimeMasters(),n[0])+1}),(function(){var r=e.TopQuestionRuntimeMasters().filter((function(n){return e.formsProQuestionVisiblityCheck(n)&&e.isContainingSectionVisible(n.Question.Model.Id)}));n=n.filter((function(n){return e.formsProQuestionVisiblityCheck(n)&&e.isContainingSectionVisible(n.Question.Model.Id)})),t=w.indexOf(r,n[0])+1})),h.createElement("div",null,n.map((function(n,e){return(0,P.md)((function(){n.Model.FormsProOrdinal=t+e})),(0,k.n)({Disabled:!0,DisableShuffle:!0,EnableShowHideQuestion:(0,P.md)((function(){return!0})),HideMedia:!1,IsMobile:r,key:n.Question.Model.Id,Master:n,LocalizedStrings:(0,S.pm)(),Ordinal:e+t,PrintView:"Question.TextField"===n.Question.Model.Type,ShowQuizResult:!0,ShowValidationStyle:!0,ShowFileInfo:!0})})))},t}(C.r),D=(e(85475),e(73252)),x=e(24209),L=e(90710),M=e(28087),q=e(64092);P.Xw.submitAndOpenChainedItem=function(n,t,e,r,i){var o=(0,L.NW)(),u=o.chainedsurvey;(0,D.cr)("CVAdvBranchingImprovements")&&r&&o.parentSurveyId&&(u=o.parentSurveyId);var s=n.CurrentRuleManager();if(r&&u||s&&s.getChainedStatus()){var a=void 0;if(u){var c={id:u},f="../Pages/ResponsePage.aspx?"+jQuery.param(c);a=(0,M.WN)(f)}else a=s.getChainedUrl();if(a+=o.embed?"&embed="+o.embed:"",a+=o.compact?"&compact="+o.compact:"",s.getChainedtargetType()!=q.Lm.Url)if((0,D.cr)("CVAdvBranchingImprovements")){if(o.ctx)a+="&ctx="+encodeURIComponent(o.ctx);else if(n.Form){var l=JSON.parse(n.Form.Model.PipesDetails),h="{{0}}".format(l.map((function(n){return'"{0}":"{1}"'.format(n.pipeName,n.defaultValue?n.defaultValue:"")})).toString());a+="&ctx="+encodeURIComponent(h)}}else a+=o.ctx?"&ctx="+encodeURIComponent(o.ctx):"";a+=o.showoriginalheader?"&showoriginalheader="+o.showoriginalheader:"",a+=o.lang?"&lang="+o.lang:"",a+=o.themecolor?"&themecolor="+o.themecolor:"",a+=o.oembedocv?"&oembedocv="+o.oembedocv:"",a+=o.autosubmit?"&autosubmit="+o.autosubmit:"",a+=o.autonavigate?"&autonavigate="+o.autonavigate:"",a+=o.hostappdomain?"&hostappdomain="+o.hostappdomain:"",a+=o.disableresponsive?"&disableresponsive="+o.disableresponsive:"",a+=o.datawithevent?"&datawithevent="+o.datawithevent:"",a+=o.showcancel?"&showcancel="+o.showcancel:"";if(t&&t(void 0),(0,D.cr)("CVAdvBranchingImprovements"))if(u||(null==s?void 0:s.getChainedStatus())&&(null==s?void 0:s.getIsChainedSurvey()))r||(a+="&parentSurveyId="+s.getCurrentForm().Model.Id,a+="&parentResponseId="+e),(0,x.K)(a,"_self");else{if(!i)return(0,x.K)(a,"_blank"),!1;(0,x.K)(a,"_top")}else(0,x.K)(a,"_self");return!0}return!1};var A=e(97265),U=e(26203),V=e(81570);var G,B,z=function(){function n(n){this.Ss=null,this.Fs=null,this._s=null,this.Ts=null,this.Ss=n,this.Fs=!1,this.Ts=""}return n.prototype.fetchQuestionById=function(n){var t=U.d.convertToArray(this.Ss).map((function(n){return n.Question.Model.Id})).indexOf(n);if(t>=0)return this.Ss[t];throw Error("targetID could not be found in runtime question list")},n.prototype.fetchQuestionIndex=function(n){var t=U.d.convertToArray(this.Ss).map((function(n){return n.Question.Model.Id})).indexOf(n);if(t>=0)return t;throw Error("The given Question ID could not be found in runtime question list")},n.prototype.getChainedStatus=function(){return this.Fs},n.prototype.getChainedUrl=function(){return this.Ts},n.prototype.getIsChainedSurvey=function(){return this._s},n}(),j=e(39955),Q=e(6666),H=e(31442),W=/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;!function(n){n[n.NoTarget=0]="NoTarget",n[n.Question=1]="Question",n[n.Section=2]="Section",n[n.Page=3]="Page",n[n.EndOfSurvey=4]="EndOfSurvey",n[n.ChainedForm=5]="ChainedForm",n[n.Url=6]="Url",n[n.ThankYouMessage=7]="ThankYouMessage"}(G||(G={})),function(n){n[n.NoAction=0]="NoAction",n[n.Show=1]="Show",n[n.Hide=2]="Hide",n[n.Toggle=3]="Toggle",n[n.Navigate=4]="Navigate",n[n.HandleIsAnswered=5]="HandleIsAnswered"}(B||(B={}));var J=function(){return function(){this.actionId=(0,A.GW)(),this.actionsequence="1",this.actionType=B.NoAction,this.targetId="",this.targetType=G.NoTarget}}(),K=function(){return function(){this.failureActions=[],this.successActions=[]}}(),X=function(){return function(){this.action=null,this.backendExpression="",this.description="",this.name="",this.ruleId=(0,A.GW)(),this.isInternalRule=!1}}(),Y=function(){return function(n,t,e,r,i){this.considerNegation=null!=t&&t,this.expression=n,this.shouldShow=null!=e&&e,this.questionId=null!=r?r:null,this.finalActionProps=null!=i?i:null}}(),Z=function(){return function(n,t){this.targetType=n,this.targetId=t}}(),nn=function(){return function(n,t,e){this.qId=n,this.qIndex=t,this.type=e}}(),tn=function(){return function(n,t){this.shouldShowQuestion=n,this.isCalculatedByRules=t}}();function en(n){return parseInt(n.actionType.toString())===B.Navigate&&parseInt(n.targetType.toString())!=G.ChainedForm&&parseInt(n.targetType.toString())!=G.Url}var rn=function(){function n(n,t,e,r){var i=this;this.En=null,this.Ps=null,this.Ns=null,this.Ss=null,this.Fs=!1,this._s=!1,this.ks=null,this.Rs=G.NoTarget,this.Os={},this.Ds={},this.xs={},this.Ls=null,this.vn="isanswered",this.Ms="finalAction",this.As=!1,this.Vs=new Map,this.Fs=!1,this.ks=null,this.Rn=n,this.Ss=t,this.Ls=[];var o=this.Rn.Model.MfpBranchingData;if(this.As=!1,o){if(this.En=(0,V.Ur)(o),this.Bs(),this.zs(),this.Ps=new j.x,this.Ns=new z(t),this.initQuestionList(e),this.Rn.isFieldReady(this.Rn.Schema.PipesDetails))if(0===(0,g.f5)().Model.ResponsePipeData.length){var u;u=JSON.parse(this.Rn.Model.PipesDetails),w.forEach(u,(function(n){i.executeRulesV1(n.pipeName,r)}))}else w.forEach((0,g.f5)().Model.ResponsePipeData,(function(n){i.executeRulesV1(n.paramName,r)}));this.As=!0;for(var s=0;s<this.Ss.length;s++)this.executeRulesV1(this.Ss[s].Question.Model.Id,r);this.As=!1}}return n.prototype.getCurrentForm=function(){return this.Rn},n.prototype.performanceOptimization=function(n,t){var e,r,i,o;!1===this.Vs.has(n)&&this.Vs.set(n,{isAnswerd:!1,isEqual:new Set,notEqual:new Set});var u=!1,s=[],a=t.filter((function(t){return t.QuestionId===n}));a&&(a=a.length>0?a[0].Answer:a);for(var c=0;c<(null===(r=null===(e=this.En)||void 0===e?void 0:e.mappings)||void 0===r?void 0:r.length);c++)if(this.En.mappings[c].sourceId===n){s=this.En.mappings[c].targetRuleList;break}var f=new Map,l=[];for(c=0;c<(null===(o=null===(i=this.En)||void 0===i?void 0:i.rules)||void 0===o?void 0:o.length);c++)f.set(this.En.rules[c].ruleId,this.En.rules[c]);for(c=0;c<s.length;c++)!0===f.has(s[c])&&l.push(new Q.EP(f.get(s[c]).ruleId,f.get(s[c]).backendExpression).getConditions());for(c=0;c<l.length;c++)for(var h=l[c],d=0;d<h.length;d++)h[d].operator===Q.$M.Equal?(this.Vs.get(n).isEqual.add(h[d].answer.length),this.Vs.get(n).isEqual.add(h[d].answer.length+1),this.Vs.get(n).isEqual.add(h[d].answer.length-1)):h[d].operator===Q.$M.NotEqual?(this.Vs.get(n).notEqual.add(h[d].answer.length),this.Vs.get(n).notEqual.add(h[d].answer.length+1),this.Vs.get(n).notEqual.add(h[d].answer.length-1)):h[d].operator===Q.$M.IsAnswered&&(this.Vs.get(n).isAnswered=!0);return this.Vs.get(n).isEqual.size>0&&a&&!0===this.Vs.get(n).isEqual.has(a.length)&&(u=!0),this.Vs.get(n).notEqual.size>0&&(a&&!0===this.Vs.get(n).notEqual.has(a.length)||a&&a.length<=1||!a)&&(u=!0),!0===this.Vs.get(n).isAnswered&&(a&&a.length<=1||!a)&&(u=!0),u},n.prototype.execute=function(n,t){var e,r,i=!0,o=this.Rn.FormElementManager;(0,D.cr)("CVBranchingOptimization")&&"Question.TextField"===(null===(r=null===(e=null==o?void 0:o.getElementMasterById(n))||void 0===e?void 0:e.Model)||void 0===r?void 0:r.Type)&&(i=this.performanceOptimization(n,t)),i&&this.executeRulesV1(n,t)},n.prototype.Qs=function(n){var t=[];return this.En.mappings.forEach((function(e){-1!==e.targetRuleList.indexOf(n)&&t.push(e.sourceId)})),t},n.prototype.executeRulesV1=function(n,t){if(console.log("engine ran"),this.En){var e=U.d.convertToArray(this.Ss).filter((function(n){return n.Question.Model.GroupId}));this.$s(n,t,e)}},n.prototype.$s=function(n,t,e){var r=this.Os[n];return this.Ws(r,t,e)},n.prototype.Ws=function(n,t,e){var r=this,i=!1,o=[],u=this.Rn.FormElementManager;return n&&n.forEach((function(n){var t,e,o=u.getElementMasterById(n),s=null;if((o&&(e="Question.ColumnGroup"===o.Model.Type),e?(t=U.d.convertToArray(u.SectionMasters).map((function(n){return n.Model.Id})).indexOf(n),s=G.Section):(t=r.Js(n),s=G.Question),n===r.Ms&&(t=r.Ss.length,s=G.Url),t>=0)&&r.Ls.filter((function(n){return n.qIndex===t&&n.type===s})).length<1){var a=new nn(n,t,s);r.Ls.push(a),i=!0}})),i&&(this.Ls.sort((function(n,t){return n.qIndex-t.qIndex})),o=this.Xs(t,e)),o},n.prototype.Xs=function(n,t){for(var e,r=[],i=function(){var i=o.Ls[0],u=i.type===G.Section,s=void 0,a=void 0,c=void 0;i.qId===o.Ms?(a=null,s=!1):u?(e=o.Rn.FormElementManager.SectionMasters.filter((function(n){return n.Model.Id===i.qId})),s=(c=u&&e.length>0?e[0]:null).Model.Hidden):s=(a=u?null:o.Ns.fetchQuestionById(i.qId)).Question.Model.Hidden;var f=o.Ys(i,n,t,s);if(o.Ls=o.Ls.slice(1),i.qId!==o.Ms)if(f.isCalculatedByRules&&r.push(i.qIndex),u)c.Model.Visible=f.shouldShowQuestion;else if(a.Model.Visible=f.shouldShowQuestion,f.shouldShowQuestion){if(a.SubQuestionRuntimeMasters&&a.SubQuestionRuntimeMasters.length>0){var l=[];a.SubQuestionRuntimeMasters.forEach((function(n){l.push(n.Question.Model.Id)}));var h=o.Ws(l,n,t);r=r.concat(h)}}else a.SubQuestionRuntimeMasters.forEach((function(n){return n.Model.Visible=f.shouldShowQuestion})),o.As||(a.Model.Answer=void 0,a.SubQuestionRuntimeMasters.forEach((function(n){return n.Model.Answer=void 0})))},o=this;this.Ls.length>0;)i();return r},n.prototype.Ys=function(n,t,e,r){var i,o=this.Ds[n.qId];if(o&&o.length>0)for(var u=0;u<o.length;u++){var s=this.Ps.evaluate(o[u].expression,t,e,this.Rn);if((null!=s||null!=s)&&s!==o[u].considerNegation)return new tn(!1,!0)}var a=this.xs[n.qId];if(a&&a.length>0)for(u=a.length-1;u>=0;u--){var c=this.Ps.evaluate(a[u].expression,t,e,this.Rn);if(a[u].questionId){var f=this.Ns.fetchQuestionById(a[u].questionId);(!1===f.Model.Visible||null===f.Model.Visible&&!0===(null===(i=f.Question)||void 0===i?void 0:i.Model.Hidden))&&(c=null)}if((null!=c||null!=c)&&c!==a[u].considerNegation)return n.qId===this.Ms&&this.Zs(a[u].finalActionProps.targetType,a[u].finalActionProps.targetId),new tn(a[u].shouldShow,!0)}if(n.qId===this.Ms)return this.Fs=!1,this.ks=null,this._s=!1,new tn(!0,!1);var l=n.type===G.Section,h=l?null:this.Ns.fetchQuestionById(n.qId);if(!l&&h.Question.ParentQuestionMaster){var d=h.Question.ParentQuestionMaster.Model.Id;for(u=0;u<this.Ss.length;u++){if(this.Ss[u].Question.Model.Id==d)return new tn(this.Ss[u].Model.Visible,!1)}}return new tn(!r,!1)},n.prototype.zs=function(){var n=this;this.En&&this.En.rules&&this.En.rules.forEach((function(t){if(t&&t.action){var e=n.Qs(t.ruleId);if(e)if(e.length>1)if(t.backendExpression.indexOf("||")>0)t.action.failureActions.forEach((function(r){n.na(e,r,t,!0)})),n.ta(t.backendExpression,"||",e).forEach((function(e){var r=t;r.backendExpression=e.key,t.action.successActions.forEach((function(t){n.na(e.value,t,r,!1)}))}));else t.action.successActions.forEach((function(r){n.na(e,r,t,!1)})),n.ta(t.backendExpression,"&&",e).forEach((function(e){var r=t;r.backendExpression=e.key,t.action.failureActions.forEach((function(t){n.na(e.value,t,r,!0)}))}));else t.action.failureActions.forEach((function(r){n.na(e,r,t,!0)})),t.action.successActions.forEach((function(r){n.na(e,r,t,!1)}))}}))},n.prototype.ta=function(n,t,e){var r=[];return n.split(t).forEach((function(n){for(var t=0;t<e.length;t++)if(n.indexOf(e[t])>0){var i={key:n,value:[e[t]]};r.push(i);break}})),r},n.prototype.na=function(n,t,e,r){var i=this,o=[],u=new Y(e.backendExpression,r);e.isInternalRule&&(u.questionId=e.name),t.actionType!=B.Show&&t.actionType!=B.HandleIsAnswered||(u.shouldShow=!0);for(var s=e.backendExpression;s.indexOf(this.vn)>=0;){var a=s.indexOf(this.vn)+this.vn.length+1,c=s.substring(a,s.indexOf(")",a)),f=this.Js(c);if(f>=0&&("Question.MatrixChoiceGroup"==this.Ss[f].Question.Model.Type||"Question.CascadeGroup"==this.Ss[f].Question.Model.Type))for(var l=this.Ss[f+1].Question.Model.GroupId,h=f+1;h<this.Ss.length;h++)l&&l==this.Ss[h].Question.Model.GroupId&&n.push(this.Ss[h].Question.Model.Id);s=s.slice(a)}t.actionType!=B.Hide&&t.actionType!=B.Show&&t.actionType!=B.HandleIsAnswered||!t.targetId?en(t)?(o=this.ea(t.targetType,t.targetId,n)).forEach((function(n){void 0!==i.Ds[n]&&null!==i.Ds[n]||(i.Ds[n]=[]),i.Ds[n].push(u)})):this.ra(t)&&(o.push(this.Ms),u.finalActionProps=new Z(t.targetType,t.targetId),void 0!==this.xs[this.Ms]&&null!==this.xs[this.Ms]||(this.xs[this.Ms]=[]),this.xs[this.Ms].push(u)):(o.push(t.targetId),void 0!==this.xs[t.targetId]&&null!==this.xs[t.targetId]||(this.xs[t.targetId]=[]),this.xs[t.targetId].push(u)),n.forEach((function(n){void 0===i.Os[n]||null===i.Os[n]?i.Os[n]=o:(i.Os[n]=i.Os[n].concat(o),i.Os[n]=i.Os[n].filter((function(t,e){return i.Os[n].indexOf(t)==e})))}))},n.prototype.ea=function(n,t,e){var r,i=this,o=-1,u=-1;return e.forEach((function(n){var t=i.Js(n);r=(o=o>t?o:t)>t?r:n})),n==G.Question?u=this.Js(t):n==G.Section?u=this.ia(t):n!=G.ChainedForm&&n!=G.EndOfSurvey&&n!=G.Url||(u=this.Ss.length),n==G.Section?this.oa(r).concat(this.ua(r,u)):this.sa(o,u)},n.prototype.ua=function(n,t){var e=[];if(this.Rn){var r=this.Rn.FormElementManager,i=r.getElementMasterById(n),o=this.Rn.FormElementManager.SectionMasters,u=-1;if(i){var s=r.findContainerSection(i);o.forEach((function(n,t){n.Model.Id===s.Model.Id&&(u=t)}))}for(var a=u+1;a<t;a++)e.push(o[a].Model.Id)}return e},n.prototype.sa=function(n,t){for(var e,r=[],i=null===(e=this.Ss[n])||void 0===e?void 0:e.Question.Model.GroupId,o=n+1;o<t;o++)i&&i==this.Ss[o].Question.Model.GroupId||r.push(this.Ss[o].Question.Model.Id);return r},n.prototype.oa=function(n){var t=[];if(this.Rn){var e=this.Rn.FormElementManager,r=e.getElementMasterById(n),i=e.SectionMasters[0];r&&(i=e.findContainerSection(r));var o=e.findQuestionsInSection(i,!1);r&&(o=o.filter((function(n){return n.Model.Order>r.Model.Order}))),o.forEach((function(n){return t.push(n.Model.Id)}))}return t},n.prototype.Js=function(n){return U.d.convertToArray(this.Ss).map((function(n){return n.Question.Model.Id})).indexOf(n)},n.prototype.ia=function(n){return this.Rn.FormElementManager.SectionMasters.map((function(n){return n.Model.Id})).indexOf(n)},n.prototype.Bs=function(){for(var n,t=this,e=new Array(this.Ss.length),r=new Array(this.Ss.length),i=[],o=0;o<this.Ss.length;o++)e[o]=r[o]=!1;this.En&&this.En.rules&&this.En.rules.forEach((function(n){if(n&&n.action&&(n.action.failureActions&&n.action.failureActions.filter((function(n){return en(n)})).length>0||n.action.successActions&&n.action.successActions.filter((function(n){return en(n)})).length>0)){t.Qs(n.ruleId).forEach((function(n){var r=t.Js(n);r>=0&&!1===e[r]&&(e[r]=!0)}));for(var i=n.backendExpression;i.indexOf(t.vn)>=0;){var o=i.indexOf(t.vn)+t.vn.length+1,u=i.substring(o,i.indexOf(")",o)),s=t.Js(u);r[s]=!0,i=i.slice(o)}}}));for(o=0;o<this.Ss.length;o++)if(e[o]){var u=null===(n=this.Ss[o])||void 0===n?void 0:n.Question.Model.Id,s=this.aa(u,o,r[o]);i.push(s);for(var a=0;a<this.En.mappings.length;a++)this.En.mappings[a].sourceId===u&&this.En.mappings[a].targetRuleList.push(s.ruleId)}this.En.rules=i.concat(this.En.rules)},n.prototype.aa=function(n,t,e){var r,i=this;void 0===e&&(e=!1);var o=new X,u=new Q.Hw(Q.XG.RULE_NO_OPERATOR);u.sourceId=n,u.operator=Q.$M.IsAnswered,o.backendExpression=u.getExpression(),o.action=new K,o.isInternalRule=!0,o.name=n;for(var s=this.Rn.FormElementManager.SectionMasters,a=w.find(s,(function(n){var e;return n.Model.Order>(null===(e=i.Ss[t])||void 0===e?void 0:e.Question.Model.Order)})),c=[],f=null===(r=this.Ss[t])||void 0===r?void 0:r.Question.Model.GroupId,l=t+1;l<this.Ss.length;l++)f&&f==this.Ss[l].Question.Model.GroupId||a&&!(this.Ss[l].Question.Model.Order<a.Model.Order)||c.push(this.Ss[l].Question.Model.Id);var h=1;return c.forEach((function(n){var t=new J;t.actionType=e?B.HandleIsAnswered:B.Hide,t.targetId=n,t.targetType=G.Question,t.actionsequence=h.toString(),h++,o.action.failureActions.push(t)})),o},n.prototype.ra=function(n){return parseInt(n.actionType.toString())===B.Navigate&&(parseInt(n.targetType.toString())==G.ChainedForm||parseInt(n.targetType.toString())==G.Url)},n.prototype.Zs=function(n,t){if(n==G.ChainedForm){this.Fs=!0;var e={id:t},r="../Pages/ResponsePage.aspx?"+jQuery.param(e);this.ks=(0,M.WN)(r),this._s=!0}else n==G.Url&&(this.Fs=!0,W.test(t)?(this.ks=t,this.ks.endsWith("?")||(this.ks+="?")):((0,H.zU)("Branching Action URL Error"),this.Fs=!1),this._s=!1);this.Rs=n},n.prototype.initQuestionList=function(n){!function(n){for(var t=U.d.convertToArray(n).filter((function(n){return!n.Question.Model.GroupId})),e=1,r=0;r<t.length;r++){var i=t[r];!0===i.Model.Visible&&(i.Model.FormsProOrdinal=e++)}}(this.Ss)},n.prototype.getChainedStatus=function(){return this.Fs},n.prototype.getChainedUrl=function(){return this.ks},n.prototype.getChainedtargetType=function(){return this.Rs},n.prototype.getIsChainedSurvey=function(){return this._s},n}();FormsPro.getRuleManager=function(n,t,e,r,i){return n?(("Preview"===(0,g.f5)().Model.TopView||r||!rn.instanceRef||rn.formId!==n.Model.Id||rn.branchingData!==n.Model.MfpBranchingData)&&(delete rn.instanceRef,rn.formId=n.Model.Id,rn.branchingData=n.Model.MfpBranchingData,rn.instanceRef=new rn(n,t,e,i)),rn.instanceRef):null};var on=e(37944),un=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return(0,p.ZT)(t,n),t.prototype.render=function(){return h.createElement(on.H,{className:this.props.ClassName,$html:P.Xw.sanitizeRichTextHTML(this.props.HTMLContent)})},t}(C.r);P.Xw.RichtTextControl=un;var sn=function(n){function t(t){var e=n.call(this,t)||this;return!1===e.props.isResponseDetailsPage?e.Ri=new b.l(e.props.FormMaster,{disableShuffle:!0}):e.Ri=new b.l(e.props.FormMaster,{disableShuffle:!0,Answers:e.props.Answers}),e.Ri.Answers=e.props.Answers,e.state={ResponseId:e.props.ResponseId,isReadyForRender:!0},e.fa=e.fa.bind(e),e}return(0,p.ZT)(t,n),t.prototype.fa=function(){var n;null===(n=this.Ri)||void 0===n||n.ensureProRuleManager(!0)},t.prototype.componentDidMount=function(){var n=(0,g.f5)();n.observe(this.fa,[n.Schema.ResponsePipeData])},t.prototype.componentWillUnmount=function(){(0,g.f5)().unobserve(this.fa)},t.prototype.componentWillReceiveProps=function(n){n.ResponseId!==this.state.ResponseId&&(this.Ri.Answers=n.Answers,this.setState({ResponseId:n.ResponseId,isReadyForRender:!0}))},t.prototype.render=function(){return h.createElement("div",{className:this.props.isResponseDetailsPage?"questionanswerpage":"questionanswerpage response-url-page"},this.state.isReadyForRender&&h.createElement(O,{FormRuntimeMaster:this.Ri,IsLoading:!0,IsResponseValid:!0}))},t}(C.r),an=(e(90638),e(18045)),cn=e(15232),fn=function(n){function t(t){return n.call(this,t)||this}return(0,p.ZT)(t,n),t.prototype.render=function(){return h.createElement(cn.Fabric,null,h.createElement("div",{className:"office-form office-form-info-container"},!this.props.isLoader&&h.createElement(an.DefaultButton,{text:(0,S.pm)().LandingPage_SignIn,title:(0,S.pm)().LandingPage_SignIn,onClick:this.props.onClick,style:this.props.theme.buttons.dynamics01ExtendedSecondary,className:"ComposeNewEmailLabel"}),this.props.isLoader&&h.createElement("div",{className:"pp-page-loading-messagebox"},h.createElement("div",{className:"pp-page-loading-animation"},h.createElement("div",{className:"pp-spinner-tile-animation"})),h.createElement("div",{className:"pp-page-loading-message"},(0,S.pm)().LOADING_TEXT))))},t}(h.Component),ln=(e(98190),e(51254)),hn=(e(11040),e(63001),e(80439));var dn=function(n){function t(t){return n.call(this,t)||this}return(0,p.ZT)(t,n),t.prototype.render=function(){var n=this,t=this.props.MSRewardsDataState;if(!FormsPro.isMSRewardsFeatureEnabled()||void 0===t)return null;var e="office-form-theme-footer thank-you-page-promotion office-form-padding-align msRewardsNotification";switch(t){case hn.MQ.NotAvailable:case hn.MQ.Available:return null;case hn.MQ.NotAvailableDueToSettingChange:return h.createElement("div",{className:e+" msRewards_Text"},(0,S.pm)().RESPONSEPAGE_MICROSOFTREWARDS_NOTAVAILABLE);case hn.MQ.ExhaustedPromocodes:case hn.MQ.Failed:return h.createElement("div",{className:e+" msRewards_Text"},(0,S.pm)().RESPONSEPAGE_MSREWARDS_ERROR);case hn.MQ.NotAvailableDueToCountryAvailablity:case hn.MQ.SuccessWithNoData:return null;case hn.MQ.Success:var r=this.props.MSRewardsData,i=(0,S.pm)().RESPONSEPAGE_MICROSOFTREWARDS_AVAILABLE;i=i.format(r.promoCode,r.sweepStake,r.promoCodeValidatiy,"https://go.microsoft.com/fwlink/p/?linkid=2101223");var o="https://account.microsoft.com/rewards/redeem/redeemcode?code={0}&ref=formspro&programname=formspro".format(r.promoCode);return h.createElement("div",{className:e},h.createElement(on.H,{className:"msRewards_Text",$html:i,$as:"div"}),h.createElement("button",{className:"flex-pane-button msRewardsNotification_button",onClick:function(){(0,H.JG)({type:"MFPUI_MSRewardsRedeemPromoCode",eventInfo:{tenantId:n.props.Form.Model.OwnerTenantId,formId:n.props.Form.Model.Id,responseId:n.props.ResponseId,Component:"Response Page"}}),window.open(o)},tabIndex:0,title:(0,S.pm)().Redeem_Reward},(0,S.pm)().Redeem_Reward));default:return null}},t}(h.Component);FormsPro.createMSRewardsThanksStatus=function(n){return h.createElement(dn,n)},FormsPro.getMSRewardsDisclaimer=function(n){if(n.MSRewardsDataState===hn.MQ.Success){var t=(0,S.pm)().RESPONSEPAGE_MSREWARDS_DISCLAIMER.format(n.MSRewardsData.promoCodeValidatiy);return h.createElement("div",{className:"office-form-theme-footer thank-you-page-promotion office-form-padding-align msRewardsNotification"},h.createElement(on.H,{className:"msRewards_Text",$html:t,$as:"div"}))}return null},FormsPro.getInitilalResponseIncentiveState=function(){var n={MSRewardsDataState:hn.MQ.NotAvailable};return null!=(0,L.NW)().vt&&FormsPro.isMSRewardsFeatureEnabledToC2User()&&(n.MSRewardsDataState=hn.MQ.Available),n};var mn=e(78587),vn=e(262),pn=e(72374),gn=e(16717);function bn(n){return n<=In.minValue?["VeryDissatisfied","VerySatisfied"]:3===n?["VeryDissatisfied","Neutral","VerySatisfied"]:4===n?["VeryDissatisfied","Dissatisfied","Satisfied","VerySatisfied"]:n>=In.maxValue?["VeryDissatisfied","Dissatisfied","Neutral","Satisfied","VerySatisfied"]:void 0}function wn(n,t){var e="";switch(n){case"VeryDissatisfied":e="senti-very-negative";break;case"Dissatisfied":e="senti-negative";break;case"Neutral":e="senti-neutral";break;case"Satisfied":e="senti-positive";break;case"VerySatisfied":e="senti-very-positive"}return e+(t?"":"-grey")}var In=function(n){function t(t){var e=n.call(this,t)||this;return e.la=function(n){if(n&&("click"==n.type||"keydown"==n.type&&13==n.which)){if(e.props.Disabled)return;if(n.preventDefault(),n.stopPropagation(),e.props.onValueChange&&e.ha){var t=e.ha.indexOf(n.currentTarget.id)+1;e.props.onValueChange(t),n.currentTarget.className="smiley-images active"}}},e.ma=function(n){n&&(n.preventDefault(),n.stopPropagation())},e.va=function(n){if(n){if(e.props.Disabled)return;39===n.which||38===n.which?(n.preventDefault(),n.stopPropagation(),null==e.props.Value?e.props.onValueChange(1):e.props.Value<e.props.Model.Length&&e.props.onValueChange(e.props.Value+1)):37!==n.which&&40!==n.which||(null==e.props.Value?e.props.onValueChange(1):e.props.Value>1&&e.props.onValueChange(e.props.Value-1))}},e.ha=bn(e.props.Model.Length),e}return(0,p.ZT)(t,n),t.prototype.render=function(){var n,t=this;n=this.pa().map((function(n,e){return h.createElement("div",{key:n},h.createElement("img",{className:"smiley-images",id:t.ha[e],onClick:t.la,onMouseOver:t.ga.bind(t),onMouseOut:t.wa.bind(t),src:t.Ia(n),title:t.ya(t.ha[e])}))}));var e="smiley-container";return this.props.ContainerClass&&(e=(0,vn.j)(e,this.props.ContainerClass)),h.createElement("div",{id:"emojiContainer",className:e},h.createElement("div",{onClick:this.ma,onKeyDown:this.va,tabIndex:0,role:"presentation"},h.createElement("div",{className:"smiley-emoji-layout"},n)))},t.prototype.ga=function(n){if(n){if(this.props.Disabled)return;var t=this.ha.indexOf(n.currentTarget.id),e=wn(this.ha[t],!0);n.currentTarget.src=this.Ia(e),n.currentTarget.className="smiley-images active"}},t.prototype.wa=function(n){if(n){if(this.props.Disabled)return;var t=this.ha.indexOf(n.currentTarget.id);if(this.props.Value&&this.props.Value===t+1)return;var e=wn(this.ha[t],!1);n.currentTarget.src=this.Ia(e),n.currentTarget.className="smiley-images"}},t.prototype.pa=function(){this.ha=bn(this.props.Model.Length);var n=this.ha.map((function(n){return wn(n,!1)}));if((null!==this.props.Value||void 0!==this.props.Value)&&this.props.Value&&this.props.Value>=1&&this.props.Value<=this.props.Model.Length){var t=this.props.Value-1;n[t]=wn(this.ha[t],!0)}return n},t.prototype.ya=function(n){switch(n){case"VeryDissatisfied":return this.props.LocalizedStringContext.LocalizedStrings.SmileyControl_VeryDissatisfied;case"Dissatisfied":return this.props.LocalizedStringContext.LocalizedStrings.SmileyControl_Dissatisfied;case"Neutral":return this.props.LocalizedStringContext.LocalizedStrings.SmileyControl_Neutral;case"Satisfied":return this.props.LocalizedStringContext.LocalizedStrings.SmileyControl_Satisfied;case"VerySatisfied":return this.props.LocalizedStringContext.LocalizedStrings.SmileyControl_VerySatisfied;default:return""}},t.prototype.Ia=function(n){return(0,mn.Jn)("/Images/FormsPro/{0}.svg".format(n))},t.minValue=2,t.maxValue=5,t}(h.Component);FormsPro.createSmileyRating=function(n){return n.Model.Length<In.minValue?n.Model.Length=In.minValue:n.Model.Length>In.maxValue&&(n.Model.Length=In.maxValue),n.EditMode&&(0,H.JG)({type:"MFPUI_SmileyRatingQuestionEdit",eventInfo:{Component:"SmileyControl",pageName:"Designer",RatingControlSize:n.Model.Length}}),h.createElement(gn.U.Consumer,{children:function(t){return n.LocalizedStringContext=t,h.createElement(In,n)}})},FormsPro.getSentimentArray=bn,FormsPro.getEmojiImageName=wn,FormsPro.logTelemetrySmileyRatingSymbolChange=function(n,t){t===n||t!==pn.le.Smiley&&n!==pn.le.Smiley||(t===pn.le.Smiley?(0,H.JG)({type:"MFPUI_SmileyRatingQuestionSelected",eventInfo:{Component:"SmileyControl",pageName:"Designer"}}):(0,H.JG)({type:"MFPUI_SmileyRatingQuestionUnselected",eventInfo:{Component:"SmileyControl",pageName:"Designer"}}))};var yn=e(6787),Sn=e(82963),Fn=e(51586),Cn=e(96680);FormsPro.ProFormsMasterMixin=function(n){return function(n){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.apply(this,t)||this}return(0,p.ZT)(t,n),t.prototype.copyFormtoCDS=function(n,t,e,r){var i=this;return this.ensureFieldsReady((0,Cn.DV)()).then((function(){var o=w.clone(i.getSnapshotToCopy());return o.Title=e,o.Settings=w.clone(o.Settings),o.Settings.AllowCopy=!1,o.Settings.ShareToken=null,o.BusinessCdsId=t.TargetCdsId,o.BusinessCdsRegion=t.TargetCdsRegion,o.IsDefaultCds=String(r),(0,yn.y)()||(o.ProjectId=""),(0,Fn.jg)(o,n.IsGroupForm)}))},t.prototype.syncSampleFormResponses=function(n){var t=this,e=n.map(Sn.bi);this.bulkEdit((function(){t.Model.Responses=t.normalizeResponses(e),t.Synchronizer.onSourceDataReceived({rowCount:n.length})}))},t.prototype.ensureFieldsReady=function(t){var e=this;return this.IsSampleForm?FormsPro.MFPDataProviderAdapter.getSampleForm().then((function(n){if(!n)throw new Error;n.ownerId=(0,c.k0)().userInfo.UserId,n.ownerTenantId=(0,c.k0)().userInfo.TenantId,FormsPro.MFPDataProviderAdapter.setDefaultValuesForSampleFormData(n),e.Synchronizer.onSourceDataReceived(n),e.syncSampleFormResponses(n.responses)})):n.prototype.ensureFieldsReady.call(this,t)},t}(n)};e(39455);var _n=e(77356),Tn=e(71860),Pn=e(502),Nn=e(46956),kn=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.Uu=h.createRef(),t}return(0,p.ZT)(t,n),t.prototype.componentWillMount=function(){var n=this;En(this.props.CustomStyle,"CustomStyle"),this.bu=function(){return n.forceUpdate()};var t=Tn.x.Schema;this.props.Form.observe(this.bu,[t.Title,t.Description,t.LogoInfo,t.CustomCssFileName]),this.Sa(this.props)},t.prototype.componentWillReceiveProps=function(n){this.Sa(n)},t.prototype.componentDidMount=function(){(0,_n.z)($(this.Uu.current))},t.prototype.componentWillUnmount=function(){this.props.Form.unobserve(this.bu),this.formLocalizedItemMaster&&this.formLocalizedItemMaster.unobserve(this.bu)},t.prototype.render=function(){var n,t,e=this.props.Form,r=e.Model,i=this.formLocalizedItemMaster,o=i&&i.Model,u=o&&o.title||r.Title,s=o&&o.subtitle||r.Description;if(r.Logo&&r.Logo.ResourceUrl){var a=e.getImageMaster(Tn.x.Schema.Logo),c=e.getImageSettingsMaster(Tn.x.Schema.LogoInfo),f=c.calcLogoLayout({isMobile:this.props.IsMobile,isSlimSize:this.props.IsSlimTitle,isSmallSize:this.props.IsSmallSize});n=h.createElement("div",{className:"office-form-custom-logo"},h.createElement(Nn.z,{ImageWidth:f.ActualWidth,ImageHeight:f.ActualHeight,ImageInfoMaster:a,ImageSettingMaster:c,ImageType:"Logo"}))}return s=i&&i.Model.formsprortlocalesubtitle||(r.FormsProRTDescription?r.FormsProRTDescription:s),u=i&&i.Model.formsprortlocaletitle||(r.FormsProRTTitle?r.FormsProRTTitle:u),r.Description&&!this.props.IsSmallSize&&(t=h.createElement("div",{className:"office-form-subtitle heading-1",ref:this.Uu},h.createElement(un,{HTMLContent:s}))),h.createElement("div",{className:"customCssContainer"},h.createElement("div",{className:"office-form-custom-image"}),n,h.createElement("div",{className:"office-form-title office-form-custom-title"},h.createElement(un,{HTMLContent:u})),h.createElement("div",{className:"office-form-custom-subtitle"},t))},t.prototype.Sa=function(n){var t=this.props.Form,e=n.LocaleId;this.formLocalizedItemMaster&&(this.formLocalizedItemMaster.unobserve(this.bu),this.formLocalizedItemMaster=void 0),e&&(this.formLocalizedItemMaster=Pn.k.getFormResourceMaster(e,t),this.formLocalizedItemMaster&&this.formLocalizedItemMaster.observe(this.bu,[Pn.k.Schema.title,Pn.k.Schema.subtitle]))},t}(h.Component);function En(n,t){var e=document.getElementById(t);if(e)e.appendChild(document.createTextNode(n));else{var r=document.createElement("style");r.type="text/css",r.id=t,r.appendChild(document.createTextNode(n)),document.head.appendChild(r)}}FormsPro.CustomTitleContainer=kn,FormsPro.loadCustomCss=En,FormsPro.unloadCustomCss=function(n){var t=document.getElementById(n);t&&document.head.removeChild(t)};var Rn="0px",On="5px",Dn="20px",xn="12px",Ln="14px",Mn="15px",qn="30px",An="24px",Un="#358072",Vn="#008272",Gn="#E8F2F4",Bn="#FFFFFF";var zn=function(){return function(){this.name="",this.primaryColor="",this.secondaryColor="",this.backgroundColor="",this.backgroundImage="",this.name="",this.primaryColor="",this.secondaryColor="",this.backgroundColor="",this.backgroundImage=""}}(),jn=e(67353),Qn=e(7899),Hn=e(81620),$n=e(47393),Wn=e(30521),Jn=e(4851);new Map;function Kn(n){return new Promise((function(t){if("serviceWorker"in navigator&&navigator.serviceWorker.controller){var e=new MessageChannel;return e.port1.onmessage=function(n){var r;e.port1.close(),e.port2.close(),t(null===(r=n.data)||void 0===r?void 0:r.payload)},navigator.serviceWorker.controller.postMessage(n,[e.port2]),setTimeout((function(){e.port1.close(),e.port2.close(),t(void 0)}),2e3)}t(null)})).catch((function(){}))}var Xn=(0,Jn.Rm)((function(){self.formsModuleResolveErrorCallback=function(n){try{(0,H.zU)("Velocity_Issue_InvalidModuleId",{moduleId:n}),(t={cacheName:"StaticResource"},Kn({type:"clearcache",payload:t})).then((function(){(0,H.$U)("ServiceWorker_ClearJsCssCache")})).catch((function(){}))}catch(n){}var t}})),Yn=e(57411),Zn=e(94283),nt=e(94978),tt=e(89904),et=e(60211),rt=e(41797),it=e(42922),ot=e(65713),ut=e(37890),st=e(9754),at=e(5699),ct=e(86353),ft=e(43209),lt=e(56010),ht=e(5809),dt=e(75827),mt=e(8435),vt=e(44644),pt=e(13309);function gt(){return(0,ht.Lu)((0,c.k0)(),function(){switch((0,ft.C2)()){case"Design":return 0;case"Response":return 1;case"Analyze":return 3;case"TeamsConfig":return 4;default:return 2}}(),ot.y.getInstance().getMuid())}var bt=e(14327),wt=["anonymous_event"],It=function(){function n(n,t,r,i){var o=this;this.Fa=[],this.Ca=n,this._a=i,this.Ta=(0,st.dR)("EventCollectorUri");var u=e.e(641).then(e.bind(e,12891));this.Pa=Promise.all([u,t(),Kn({type:"version"}),ot.y.getInstance().ensureMuid()]).then((function(n){var t=n[0],e=n[1],i=n[2];o.Na=t,o.ka=e,o._a&&o._a(),o.Ea=function(){return(0,p.pi)((0,p.pi)({},r()),{SwVersion:i})},(0,et.a4)()&&!o.Ta?(0,ut.Ks)((0,it.G)(),3e4).then((function(n){o.Ta=n,o.Ra()})).catch((function(){o.track({eventType:"diagnostic_event",eventName:"WaitEventCollectorUri",properties:JSON.stringify({error:"Wait for event collector uri timeout"}),timeStamp:Date.now()}),o.Ra()})):o.Ra()}))}return n.prototype.flush=function(n){var t=this;"OneNoteUwp"===(0,vt.P)()&&n(),this.Pa.then((function(){t.Oa?t.Oa.flush(!0,n):n()}))},n.prototype.track=function(n){if("OneNoteUwp"!==(0,vt.P)()){try{n&&n.properties&&(n.properties=(0,bt.WW)(n.properties),n.properties=(0,bt.ug)(n.properties))}catch(n){}this.Oa?this.Da(n):this.Fa.length<1e3&&this.Fa.push(n)}},n.prototype.Da=function(n){var t,e;"session_start"===n.eventType&&function(n,t){var e=(0,c.k0)(),r=(0,p.pi)({BuildVersion:e.version,EcsConfigIds:(0,ct.DP)(),EcsFirstRelease:(0,dt.$O)(),FromIERedirect:"true"===(0,L.NW)().fromie||void 0,IsFirstRelease:(0,dt.$O)(),IsMobile:(0,y.tq)(),IsOwnerFirstRelease:(0,ct.$K)(),IsSwSupported:(0,mt.qI)(),JQueryLoaded:!!window.$,Referrer:document.referrer&&(0,M.Lp)(document.referrer),SwEnabled:(0,mt.eg)(),SwReload:e.IsSwReload||!1,UserAgent:navigator.userAgent},t()),i=(0,vt.P)(),o=navigator.connection,u=(0,lt.hp)();i&&(r.Origin=i),o&&(r.Connection={downLink:o.downLink||-1,effectiveType:o.effectiveType||"unsupported",rtt:o.rtt||-1}),u&&(r.StartPageRoute=u),r.IsMobile&&(r.IsMobileView=(0,y.lZ)()),n.properties?n.properties=JSON.stringify((0,p.pi)((0,p.pi)({},r),JSON.parse(n.properties))):n.properties=JSON.stringify(r)}(n,this.Ea);var r="anonymous_event"===n.eventType?((t={})[at.W1]=n.eventName,t[at.hj]=n.properties,t[at.$A]=this.ka,t):((e={})[at.KF]=n.eventCorrelationId,e[at.te]=n.duration,e[at.W1]=n.eventName,e[at.hj]=n.properties,e[at.l3]=n.timeStamp,e[at.er]=this.Ca(),e[at.$A]=this.ka,e);this.Oa.track({baseType:n.eventName,name:n.eventType,data:r})},n.prototype.Ra=function(){var n=this,t=function(n){var t;return(0,ht.kI)((0,et.kD)(),n,null===(t=(0,c.k0)().userInfo)||void 0===t?void 0:t.TenantId,(0,ft._B)(),(0,P.Sp)())}(this.Ca());this.Ta&&(t.EndpointUrl=this.Ta);var e,r=(0,ht.DY)((0,c.k0)(),(0,v.rh)(),(0,v.XF)(),(0,P.Sp)(),(0,pt.u)());!(0,et.x8)()&&(0,D.cr)("EnablePrivacyGuard")&&(e=(0,rt.b)()),this.Oa=this.Na.initializeOneDS(t,e),this.Oa.addTelemetryInitializer((function(n){wt.includes(n.name)?(n.data=(0,p.pi)((0,p.pi)({},n.data),r),delete n.data.session_id):n.data=(0,p.pi)((0,p.pi)((0,p.pi)({},gt()),r),n.data),delete n.ext.app.sesId})),this.Fa.forEach((function(t){return n.Da(t)})),this.Fa=[]},n}(),yt=function(n,t){return{name:n,value:void 0===t?-1:t,delta:0,entries:[],id:"v2-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12)}},St=function(n,t){try{if(PerformanceObserver.supportedEntryTypes.includes(n)){if("first-input"===n&&!("PerformanceEventTiming"in self))return;var e=new PerformanceObserver((function(n){return n.getEntries().map(t)}));return e.observe({type:n,buffered:!0}),e}}catch(n){}},Ft=function(n,t){var e=function e(r){"pagehide"!==r.type&&"hidden"!==document.visibilityState||(n(r),t&&(removeEventListener("visibilitychange",e,!0),removeEventListener("pagehide",e,!0)))};addEventListener("visibilitychange",e,!0),addEventListener("pagehide",e,!0)},Ct=function(n){addEventListener("pageshow",(function(t){t.persisted&&n(t)}),!0)},_t=function(n,t,e){var r;return function(i){t.value>=0&&(i||e)&&(t.delta=t.value-(r||0),(t.delta||void 0===r)&&(r=t.value,n(t)))}},Tt=-1,Pt=function(){return"hidden"===document.visibilityState?0:1/0},Nt=function(){Ft((function(n){var t=n.timeStamp;Tt=t}),!0)},kt=function(){return Tt<0&&(Tt=Pt(),Nt(),Ct((function(){setTimeout((function(){Tt=Pt(),Nt()}),0)}))),{get firstHiddenTime(){return Tt}}},Et=(new Date,{});function Rt(n){"undefined"!=typeof PerformanceObserver&&(function(n,t){var e,r=kt(),i=yt("LCP"),o=function(n){var t=n.startTime;t<r.firstHiddenTime&&(i.value=t,i.entries.push(n),e())},u=St("largest-contentful-paint",o);if(u){e=_t(n,i,t);var s=function(){Et[i.id]||(u.takeRecords().map(o),u.disconnect(),Et[i.id]=!0,e(!0))};["keydown","click"].forEach((function(n){addEventListener(n,s,{once:!0,capture:!0})})),Ft(s,!0),Ct((function(r){i=yt("LCP"),e=_t(n,i,t),requestAnimationFrame((function(){requestAnimationFrame((function(){i.value=performance.now()-r.timeStamp,Et[i.id]=!0,e(!0)}))}))}))}}(n),function(n){var t,e=yt("TTFB");t=function(){try{var t=performance.getEntriesByType("navigation")[0]||function(){var n=performance.timing,t={entryType:"navigation",startTime:0};for(var e in n)"navigationStart"!==e&&"toJSON"!==e&&(t[e]=Math.max(n[e]-n.navigationStart,0));return t}();if(e.value=e.delta=t.responseStart,e.value<0||e.value>performance.now())return;e.entries=[t],n(e)}catch(n){}},"complete"===document.readyState?setTimeout(t,0):addEventListener("load",(function(){return setTimeout(t,0)}))}(n))}var Ot=function(){function n(n,t,e,r){this.xa=(0,Jn.Rm)((function(){var n=(0,nt.QJ)("ThrottledEventNames");return n&&Array.isArray(n)?n.reduce((function(n,t){return n[t]=!0,n}),{}):{}})),Rt((function(n){var t=n.name,e=n.value,r=n.delta,i=n.id;(0,H.b6)("Perf.WebVitals",{name:t,value:e,delta:r,id:i}),(0,Zn.AC)(7,{$metricDelta:r,$metricId:i,$metricName:t,$metricValue:e})})),this.La=new It(n,t,e,r)}return n.prototype.logData=function(n){n&&n.eventName&&!this.Ma(n.eventName)&&((0,pt.u)()&&"string"==typeof n.eventName&&n.eventName.indexOf("Error.ErrorPage.Error")>-1||(n=(0,tt.$o)(n),this.La.track(n)))},n.prototype.flush=function(n){this.La.flush(n)},n.prototype.Ma=function(n){return this.xa()[n]},n}(),Dt=e(79552),xt=e(85708),Lt={anonymous_event:Mt,diagnostic_event:Mt,engagement_event:function(n){(0,y.tq)()&&(n.extraData=(0,p.pi)((0,p.pi)({},n.extraData),{IsMobileView:!0}));return Mt(n)},error_event:Mt,formspro_event:Mt,generic_event:Mt,impression_event:Mt,intelligence_event:Mt,nav_perf_event:function(n){var t=Mt(n);n.extraData&&(!function(n){if(qt){var t=0;"hidden"===qt.initialVisibility?t=qt.initializeTime.getTime():qt.visiToggleTime&&(t=qt.visiToggleTime.getTime());var e="VisiToggled";n.extraData[e]=t,qt.stop(),qt=null}}(n),t.properties=JSON.stringify(n.extraData));return t},qos_event:function(n){var t={duration:n.duration,eventCorrelationId:n.correlationId,eventName:n.eventName,eventType:n.eventType,properties:"",timeStamp:(0,xt.dg)()};n.extraData&&(t.properties=JSON.stringify(n.extraData));return t},session_start:function(n){var t;return Mt((0,p.pi)((0,p.pi)({},n),{correlationId:n.correlationId||(null===(t=(0,c.k0)().serverInfoFromPageHeaders)||void 0===t?void 0:t.serverCorrelationId)}))}};function Mt(n){var t={eventCorrelationId:n.correlationId,eventName:n.eventName,eventType:n.eventType,properties:"",timeStamp:(0,xt.dg)()};return n.extraData&&(t.properties=JSON.stringify(n.extraData)),t}var qt=new(function(){function n(){this.initialVisibility=document.visibilityState,this.initializeTime=new Date,this.qa=this.qa.bind(this),document.addEventListener("visibilitychange",this.qa)}return n.prototype.stop=function(){document.removeEventListener("visibilitychange",this.qa)},n.prototype.qa=function(){this.visiToggleTime=new Date},n}()),At=e(19194),Ut=e(70699),Vt=function(){function n(n,t){var e=this;this.logData=function(n){if(!function(n){return n.eventName=n.eventName.replace(" ",""),!n.eventName||-1!==((0,nt.Gw)("DisabledEventNames")||[]).indexOf(n.eventName)}(n)){var t=Lt[n.eventType];if(t){var r=t(n);if(r.properties=e.sanitizeLogString(r.properties),e.awtLogger.logData(r),!n.$optoutUTel&&e.Aa){var i=function(n){var t,e=Gt()[n.eventType];if(void 0===e)return null;var r=n.eventName,i=null,o=8===e?10:8,u={$extraData:n.extraData};if(0===e){var s=n;r=null!==(t=s.qosEventName)&&void 0!==t?t:r,u.$qosEventStatus=s.qosEventStatus,u.$correlationId=s.correlationId;var a={aggMode:0,count:1,duration:s.duration};switch(u.$qosEventStatus){case"Success":case"PartialSuccess":a.result={code:0};break;case"Failure":a.result={code:1,isExpected:!1};break;case"ExpectedFailure":a.result={code:1,isExpected:!0}}i={$type:0,$data:a}}return{$eventFlags:o,$eventName:r,$eventType:e,$eventContract:i,$eventData:u}}(n);i&&e.Aa.$sendTelemetryEvent(i)}}}},this.sendTelemetryEvent=function(n){e.Aa&&e.Aa.$sendTelemetryEvent(n)},this.flushAndStop=function(n){e.awtLogger&&e.awtLogger.flush((function(){e.Aa&&e.Aa.$flushAndStop(n)})),e.Aa||e.awtLogger||n()},this.awtLogger=n,this.Aa=t}return n.prototype.logFormsProEvent=function(n){},n.prototype.sendTeamsAppInitializationCompleteSignal=function(n){},n}();var Gt=(0,Jn.Rm)((function(){return{engagement_event:3,error_event:2,nav_perf_event:8,qos_event:0,diagnostic_event:2,anonymous_event:1}})),Bt=function(n){function t(t,e){return n.call(this,t,e)||this}return(0,p.ZT)(t,n),t.prototype.logFormsProEvent=function(n){n.eventInfo.timeStamp=Date.now()-60*(new Date).getTimezoneOffset()*1e3,(0,P.md)((function(){n.eventInfo.Geo=(0,Ut.sy)()}));var t={eventName:n.type,eventType:"formspro_event",extraData:n.eventInfo};this.awtLogger.logData(Mt(t))},t.prototype.sendTeamsAppInitializationCompleteSignal=function(n){(0,v.Kw)()&&(n?(0,Dt.xP)(n)?microsoftTeams.appInitialization.notifySuccess():microsoftTeams.appInitialization.notifyFailure({message:(0,At.e)(n),reason:"Other"}):microsoftTeams.appInitialization.notifySuccess())},t.prototype.sanitizeLogString=function(n){if("string"==typeof n){var t=n.toLowerCase();return t.indexOf("auth_upn=")<0&&t.indexOf("token=")<0&&t.indexOf("bearer ")<0&&t.indexOf("authorization=")<0?n:n?'{"log":"[Sanitized log]"}':""}},t}(Vt);function zt(){return{Flights:(n=(0,c.k0)(),{IsCdnEnabled:n.isCdnEnabled,IsAFDEnabled:n.isAFDEnabled,IsCandidateForLightResponsePage:n.isCandidateForLightResponsePage,NoLightReason:n.noLightReason,IsIntegration:n.isIntegration,IntegrationHost:n.isOembedSPO?"SPO":n.integrationHost,IsFirstReleaseEnabled:(0,D.g)()})};var n}var jt=e(97517);function Qt(n){return n?n[0].toUpperCase()+n.slice(1):""}var Ht=e(49690),$t=e(82195);function Wt(n,t,e,r,i,o){switch(void 0===i&&(i=!1),void 0===o&&(o=0),typeof r){case"number":case"boolean":case"string":(0,$t.a)(n,t,e,r);break;case"object":if(o<3)for(var u in r)if(i||Jt[u]){var s=i?Qt(u):Jt[u];Wt(n,(0,Ht.x)([t,e]),s,r[u],i,o+1)}}}var Jt={$correlationId:"CorrelationId",$formId:"FormId",$extraData:"ExtraData",$duration:"Duration",$error:"Error",$guid:"Guid",$imageType:"ImageType",$location:"Location",$mediaType:"MediaType",$metricDelta:"MetricDelta",$metricId:"MetricId",$metricName:"MetricName",$metricValue:"MetricValue",$qosEventStatus:"QosEventStatus",$retry:"Retry",$startTime:"StartTime"},Kt=e(83390),Xt=e(26261);var Yt=(0,Jn.Rm)((function(){var n=[];return n[0]=Xt.cS.getFields.bind(Xt.cS),n[1]=function(n){return Xt.oe.getFields("Funnel",n)},n[2]=Xt.iH.getFields,n[3]=Xt.Vw.getFields,n})),Zt=function(){function n(n,t){var e=this;this.$flushAndStop=function(n){var t;e.Aa?null===(t=e.Ua)||void 0===t||t.then((function(t){var r,i;e.Aa=null,(r=t)&&r.startWorker&&r.enabled?r.shutdown(!0):(i=t)&&i.getOneDSTelemetryEvent&&(i.flush(!1),i.shutdown()),n()})):n()},this.$sendTelemetryEvent=function(n){var t,r;if(e.Aa){e.Ua||e.ze();var i=1===n.$eventType,o=5===n.$eventType;n.$eventData=null!==(t=n.$eventData)&&void 0!==t?t:{},i||n.$eventData.$formId||(n.$eventData.$formId=e.Ca()),o&&!n.$eventData.$correlationId&&(n.$eventData.$correlationId=null===(r=(0,c.k0)().serverInfoFromPageHeaders)||void 0===r?void 0:r.serverCorrelationId);var u=[];!function(n,t){var e;for(e in t)if(Jt[e]){var r=Jt[e];Wt(n,null,r,t[e],r===Jt.$extraData)}t.$extraData instanceof Error&&Object.getOwnPropertyNames(t.$extraData).forEach((function(e){Wt(n,Jt.$extraData,Qt(e),t.$extraData[e],!0,1)}))}(u,n.$eventData);var s={name:re(n.$eventName),dataFields:[]};if(n.$eventContract&&n.$eventContract.$data){var a=function(n,t){var e=Yt()[n];if(e)return e(t)}(n.$eventContract.$type,n.$eventContract.$data);a&&(s.dataFields=a)}var f=(0,Ht.x)([at.N5,te()[n.$eventType]]);e.Aa.sendTelemetryEvent({telemetryProperties:{ariaTenantToken:at.i},eventName:f,eventFlags:ee(n.$eventFlags),eventContract:s,dataFields:u,timestamp:n.$timestamp})}};var r=(0,Kt.xW)();"OneNoteUwp"!==(0,vt.P)()&&!r&&(0,D.cr)("EnableUTelTelemetry")&&(this.Ca=n,this.Va=t,this.Aa=new jt.Dw(null,null,{disableValidation:!r,enableQueue:!0}))}return n.prototype.ze=function(){var n,t=this;this.Ua=new Promise((function(t){return n=t}));var r,i=e.e(824).then(e.bind(e,14045)),o=(0,st.dR)("EventCollectorUri");r=(0,et.a4)()&&!o?(0,ut.Ks)((0,it.G)(),ne).catch((function(){return t.$sendTelemetryEvent({$eventType:2,$eventName:"WaitEventCollectorUri",$eventData:{$error:"Wait for event collector uri timeout"}}),o})):Promise.resolve(o),Promise.all([i,r,Kn({type:"version"}),this.Va(),ot.y.getInstance().ensureMuid()]).then((function(e){var r=e[0],i=e[1],o=e[2],u=e[3];t.Aa&&r.initializeTelemetryLogger(t.Aa,i,o,u).then((function(t){return n(t)}))}))},n}(),ne=3e4,te=(0,Jn.Rm)((function(){var n=[];return n[0]="Activity",n[1]="Anonymous",n[2]="Diagnostic",n[4]="Navigation",n[8]="Perf",n[5]="SessionStart",n[6]="SystemAction",n[7]="UserAction",n[3]="Engagement",n}));function ee(n){var t={dataCategories:2,diagnosticLevel:10,samplingPolicy:1};return 2&n&&(t.dataCategories=4),4&n&&(t.diagnosticLevel=110),8&n&&(t.samplingPolicy=194),t}function re(n){return"string"==typeof n?(0,Ht.x)(n.split(".").map(Qt)):"E".concat(n)}var ie,oe=e(72377),ue=e(54740),se=e(92528),ae=function(){function n(){}return n.prototype.getFormApiToken=function(){return(0,jn.LP)()},n.prototype.handleAuthForContentPage=function(n){},n.prototype.handleAuthForAddinPage=function(){},n.prototype.hasUserLoggedIn=function(){return!!(0,c.k0)().userInfo.UserId},n.prototype.isValid=function(){return!0},n.prototype.redirectToLogin=function(){return(0,$n.mj)((0,$n.Gh)()),new Promise((function(){}))},n.prototype.refreshToken=function(){return(0,jn.g$)()},n.prototype.signIn=function(){return this.redirectToLogin()},n.prototype.signOut=function(){return(0,$n.gB)((0,c.k0)().signOutLink)},n}(),ce=function(){function n(){}return n.prototype.getFormApiToken=function(){return this.Ga().getFormApiToken()},n.prototype.handleAuthForContentPage=function(n){return this.Ga().handleAuthForContentPage(n)},n.prototype.handleAuthForAddinPage=function(){return this.Ga().handleAuthForAddinPage()},n.prototype.hasUserLoggedIn=function(){return this.Ga().hasUserLoggedIn()},n.prototype.isValid=function(){return this.Ga().isValid()},n.prototype.redirectToLogin=function(){return this.Ga().redirectToLogin()},n.prototype.refreshToken=function(){return this.Ga().refreshToken()},n.prototype.signIn=function(){return this.Ga().signIn()},n.prototype.signOut=function(){return this.Ga().signOut()},n.prototype.Ga=function(){return this.Ba||(this.Ba=new ae),this.Ba},n}(),fe=function(){function n(n){this.za=null,this.Qa=n?n.concat():[new ce]}return n.prototype.signIn=function(){return this.Ha().then((function(n){return n.signIn()}))},n.prototype.getFormApiToken=function(){return this.Ha().then((function(n){return n.getFormApiToken()}))},n.prototype.handleAuthForContentPage=function(n){return this.Ha().then((function(t){return t.handleAuthForContentPage(n)}))},n.prototype.handleAuthForAddinPage=function(){return this.Ha().then((function(n){return n.handleAuthForAddinPage()}))},n.prototype.hasUserLoggedIn=function(){var n=this.$a();return n&&n.hasUserLoggedIn()},n.prototype.redirectToLogin=function(){return this.Ha().then((function(n){return n.redirectToLogin()}))},n.prototype.refreshToken=function(){return this.Ha().then((function(n){return n.refreshToken()}))},n.prototype.signOut=function(){return this.Ha().then((function(n){return n.signOut()}))},n.prototype.Ha=function(){var n=this;if(this.za)return this.za;var t=function(e){var r=n.Qa[e];return r?r.isValid()?Promise.resolve(r):t(e+1):Promise.reject(new Error("No valid authenticator"))};return this.za=t(0),this.za},n.prototype.$a=function(){return this.Qa.filter((function(n){return n.isValid()}))[0]},n}(),le=function(){function n(n){var t=n.flights,e=void 0===t?"":t;this.Wa={},_e(),""!==e&&(this.Ja=be(e)),""===e&&(this.Ka=be((0,c.k0)().flights))}return n.prototype.isEnabled=function(n){return this.Xa(n)},n.prototype.isEnabled_Deprecated=function(n){return this.Xa(n)},n.prototype.setFlights=function(n){this.Ja=be(n)},n.prototype.Xa=function(n){var t=de[n];switch("tenant"===t&&(this.Ja||ge(n),t="environment"),t){case"environment":if(n in this.Wa)return this.Wa[n];break;case"deprecated":this.Ja||ge(n);break;default:return!1}var e=this.Ya(n);return"environment"===t&&(this.Wa[n]=e),e},n.prototype.Ya=function(n){var t=this;if(me[n]&&me[n].some((function(n){return t.Xa(n)})))return!1;if(ve[n]&&!ve[n].every((function(n){return t.Xa(n)})))return!1;var e=n.toUpperCase(),r=function(){if(we)return we;var n={};0;return we=n,n}();if(e in r)return r[e];var i=this.Ja||this.Ka;return n in i?i[n]:he[n]},n}(),he={},de={},me={},ve={};function pe(){ie=function(){switch((0,et.kD)()){case"DevHost":return 1;case"Daily":case"Drill":case"Pilot":case"Trial":case"ProDaily":case"CVDaily":return 2;case"Weekly":case"Hotfix":return 3;case"Int":case"MSInt":case"CVInt":return 4;default:return 5}}()}function ge(n){var t=new Error('Checking flight "'.concat(n,'" before ready.'));(0,H.zU)("UnstableFlightChecking",{flightName:n,flightType:de[n],stack:t.stack})}function be(n){var t={};return n&&n.split(";").forEach((function(n){"!"!==n[0]?t[n]=!0:(n=n.substr(1),t[n]=!1)})),t}var we=null;function Ie(n,t){he[n]=Fe(t),de[n]="environment"}function ye(n,t){he[n]=Fe(t),de[n]="tenant"}function Se(n,t){he[n]=Fe(t),de[n]="deprecated"}function Fe(n){return n>=(ie||pe(),ie)}var Ce=function(n,t){ve[n]=t},_e=(0,Jn.Rm)((function(){var n;Se("TestDeprecatedFlight",0),Ie("TestEnvironmentFlight",5),Ie("TestEnvironmentFlight_Blocker",0),ye("TestTenantFlight",5),ye("ResponseInApp",4),Se("FormInsight",4),Se("PartialPut",1),Ie("AutoPinWordCloudInsight",4),Ie("CustomerVoiceBlackList",0),Ie("DisableRecordNameForTenant",0),Ie("DisableRedirect",0),Ie("EnableBrandingFooter",4),Ie("EnableCustomerVoice",5),Ie("EnableSanitizedHTML",0),Ie("EnableECSInFirstRelease",0),Ie("EnableExternalSharing",4),Ie("EnablePrivacyGuard",4),Ie("EnableUTelTelemetry",4),Ie("EstimationTimeUIFix",4),Ie("FeedbackLoopComponent",4),Ie("FirstReleaseClientEnabled",0),Ie("FixEslintPostMessageError",4),Ie("FixEslintTeamsPostMessageError",4),Ie("FixFluidPollRefresh",5),Ie("FluidCategoryLoopPoll",5),Ie("FluidFormErrorView",5),Ie("FluidHistorySuggestion",0),Ie("FluidQuickAddInFPS",4),Ie("FluidWordCloudSharing",0),Ie("FluidPollRemoveResponder",5),Ie("GetDriveItemFromFormApi",5),Ie("GetInsightNewApi",0),Ie("GetInsightPerResponseChange",4),Ie("GetRealtimeInsights",4),Ie("ImageManualReload",4),Ie("IncreaseTeamsPollMaxOptionCount",5),Ie("IntelligencePollSuggestionsFPS",4),Ie("MobileQuestionCalloutBugfix",4),Ie("OutlookAddInSSOReject",5),Ie("Retry6300",4),Ie("PollChoiceResultView",4),Ie("PollOptionSuggestion",4),Ie("SearchEngineOptimization",5),Ie("SDXDataSync",0),Ie("SDXDataSyncProtection",0),Ie("SDXDataSyncAuthPrefetch",5),Ie("SDXDataSyncConsistencyCheck",0),Ie("SDXDataSyncUserChangeNotification",0),Ie("SDXDataSyncQuiz",0),Ie("SDXDataSyncShowErrorMessage",5),Ie("SDXDataSyncCheckFormOwner",0),Ie("SDXDataSyncDisconnection",0),Ie("SDXDataSyncUpnCheck",0),Ie("SDXDataSyncInPageResync",0),Ie("SDXDataSyncFixedBizBar",0),Ie("SensitiveInfoCheckForAllForms",4),Ie("SensitiveInfoCheckInResponsePage",4),Ie("ServiceWorkerEnabled",0),Ie("TeamsAddPollQuestion",0),Ie("TeamsBubbleEnableCrossEnvCheck",5),Ie("TeamsPollEnableSCActions",0),Ie("TeamsPollNPS",4),Ie("TeamsPollMESuggestion",0),Ie("TeamsPollMultiQuestionSuggestion",4),Ie("TeamsPollOptionImage",0),Ie("TeamsPollQuestionImage",4),Ie("TeamsPollLaunchFromEditor",4),Ie("TeamsPollGetOwnResponsesSw",4),Ie("TeamsPollAnonymousToken",4),Ie("TeamsPollAnonymousResultView",4),Ie("TeamsPollSignalR",4),Ie("TeamsForLifePollMESubtitle",4),Ie("TeamsForLifeAuthoringDeferSso",4),Ie("UnregisterServiceWorker",0),Ie("WordCloudPollInstruction",4),Ie("WordCloudPoll",4),Ie("EnableThrowErrorInDispatchDeadLoop",0),Ie("DaemonWorker",0),Ie("DeprecateOfficeDotComTreatment",0),Ie("SuiteHeaderLinkCSP",4),ye("AssignmentsIFrameLimitParentHeaders",4),ye("BaseProFRE",0),ye("DesignerFileUpload",2),ye("EnableAnonymousUploadLink",0),ye("FormsProAvailableTeachingCallout",0),ye("HideReportAbuse",0),ye("IntelligenceExpDemoTenantTest",0),ye("QuickPollDisableEws",0),ye("SuspiciousForm",4),ye("NextButtonLiveRegion",4),Ie("FormsPro",0),Ie("FormsProSignupInformationPage",0),Ie("FormsProTIP",0),ye("CDSFileUploadSecurityAlertText",0),ye("CKEditiorHtmlSource",0),ye("CustomerVoiceAutomation",0),ye("CustomerVoiceAutomateSurveyReminder",0),ye("CustomerVoiceCascadeLocale",0),ye("CustomerVoiceCascadeQuestion",0),ye("CustomerVoiceCDSFileDownload",0),ye("CustomerVoiceCDSFileUpload",0),ye("CustomerVoiceCDSOptimization",1),ye("CustomerVoiceCustomLanguage",0),ye("CustomerVoiceCustomLanguageNYC",0),ye("CustomerVoiceCustomLanguageV2",0),ye("CustomerVoiceMultilingualLocalesIncreasedLimit",0),ye("CustomerVoiceEmailTemplateBulkUpload",0),ye("CustomerVoiceEmbedCancelButton",0),ye("CustomerVoiceExportFromCDS",0),ye("CustomerVoiceExtendedLikert",0),ye("CustomerVoiceEventsWithData",0),ye("CustomerVoiceFileUpload",0),ye("CustomerVoiceFileUploadAnonymous",0),ye("CustomerVoiceIntegrations",1),ye("CustomerVoiceInviteBulkDelete",0),ye("CustomerVoiceInviteMigrationUI",0),ye("CustomerVoiceInviteMigrationDeletion",0),ye("CustomerVoiceLoggedInUserSendEmail",0),ye("CustomerVoiceOCVResponseToHiveBlock",0),ye("CustomerVoicePreviewEmbed",4),ye("CustomerVoiceResposnePreviewURLRedirect",0),ye("CustomerVoiceSharingV2",0),ye("CustomerVoiceSharingV2AllProject",0),ye("CustomerVoiceSharingV2AllProjectNewColumn",0),ye("CustomerVoiceSharingV2BlockSurvey",0),ye("CustomerVoiceSPOFileUpload",0),ye("CustomerVoiceSurveyMove",0),ye("CustomerVoiceSurveyReminder",0),ye("CustomerVoiceToyotaCustomFont",0),ye("CustomerVoiceToyotaCustomEmailFont",0),ye("CustomerVoiceVoluntarySurveyReminder",0),ye("CustomerVoiceUpdatePrivacyAndTou",0),ye("CVAdvBranchingImprovements",0),ye("CVAutoNavigateAutoSubmit",0),ye("CVExportProjectToOtherTenants",0),ye("CVFiltersOtherOption",0),ye("CVHighCharts",0),ye("CVSatisfactionMetricsDrilldown",0),ye("CVSatisfactionMetricsReportsRedesign",0),ye("CVFusionTextAnalytics",0),ye("CVHighChartsDateCasacde",0),ye("CVInviteStatusReason",0),ye("CVLeapFrogChoiceQuestionNewUX",0),ye("CVLeapFrogChoiceQuestionRandomization",0),ye("CVLeapFrogVisualRefresh",0),ye("CVLongTermReporting",0),ye("CVMultipleResponseDelete",0),ye("CVOptimizeHomePagePerf",0),ye("CVPartialResponse",0),ye("CVProjectLevelAggregatedValuesV2",0),ye("CVRatingQuestionSorting",0),ye("CVRestrictSurveyAccess",0),ye("CVRightRespondentDetails",0),ye("CVSectionBranchingShowHide",0),ye("CVSimplifiedBranching",0),ye("CVSMQuestionDeletion",0),ye("CVManageProjects",0),ye("DummyCascadeChart",0),ye("FormsProAnswerTag",1),ye("FormsProCSAT",0),ye("FormsProCSATSimulate",0),ye("FormsProChatDistributeChannel",0),ye("FormsProCustomCss",0),ye("FormsProCustomDomain",0),ye("FormsProCustomFooter",0),ye("FormsProCustomResponsesPage",0),ye("FormsProDemoView",0),ye("FormsProDisableAntiFishingNotice",0),ye("FormsProEmbedCodeToHive",0),ye("FormsProEmbedCompactPlus",0),ye("FormsProRemoveEmbedLink",0),ye("FormsProEnableSurveyMove",0),ye("FormsProGCC",0),ye("FormsProHideFooter",0),ye("FormsProHidePrivacyLink",0),ye("FormsProHighCharts",0),ye("FormsProInviteSingleSelection",0),ye("FormsProMSRewardsIntegration",4),ye("FormsProMultilingualLocalesIncreasedLimit",0),ye("FormsProNotifyAdmin",0),ye("FormsProQuestionVisibility",5),ye("FormsProRTECharLimit",0),ye("FormsProSampleFormOnClient",0),ye("FormsProSurveyPermissions",4),ye("FormsProTrial",0),ye("FormsProTrialExpiration",0),ye("OverSurveyManagement",0),ye("PartialResponseSettingDefaultValueOn",0),ye("PauseAndResumeSettingDefaultValueOn",0),Ce("CustomerVoiceSPOFileUpload",["CustomerVoiceFileUpload"]),Ce("CustomerVoiceCDSFileDownload",["CustomerVoiceFileUpload"]),Ce("CustomerVoiceCDSFileUpload",["CustomerVoiceFileUpload"]),Ce("CustomerVoiceFileUploadAnonymous",["CustomerVoiceFileUpload"]),Ce("PartialResponseSettingDefaultValueOn",["CVPartialResponse"]),ye("CustomerVoiceQuestionLibrary",0),ye("CVDepartmentalCapacity",0),ye("CVBranchingOptimization",0),ye("CVResponsePreviewPagePromises",0),ye("CVSurveyDeletionWithBranchingPopup",0),ye("CustomerVoiceOcvHeightNotify",0),ye("CustomerVoiceItalyA11yNotify",0),ye("CustomerVoiceDataClassification",0),ye("CdsFileUploadExceptionTelemetry",0),ye("CVHtmlTagsInTranslationTemplate",0),ye("CustomerVoiceHideSubmitButton",0),n=["TestEnvironmentFlight_Blocker"],me["TestTenantFlight"]=n,Ce("TestTenantFlight",["TestEnvironmentFlight"])})),Te=function(){function n(n){n=n||{},this.Za=new fe(n.authenticators),this.ec=new le({}),n.addinAccessTokenGetter&&(0,se.QY)(n.addinAccessTokenGetter)}return Object.defineProperty(n.prototype,"AuthContext",{get:function(){return this.Za},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"Flighting",{get:function(){return this.ec},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"RetryingRecoverableError",{get:function(){return this.rc},set:function(n){this.rc=n},enumerable:!1,configurable:!0}),n}(),Pe=e(35337);var Ne=e(9743),ke=e(39923),Ee=e(81291),Re={HeaderBackgroundImage:ke.J4.string({IsLocalField:!0}),Name:ke.J4.string(),HeaderBackgroundThumbnail:ke.J4.string({IsLocalField:!0}),BackGroundPositionX:ke.J4.string({IsLocalField:!0}),BackGroundPositionY:ke.J4.string({IsLocalField:!0}),BackGroundPositionZ:ke.J4.string({IsLocalField:!0}),LogoPositionX:ke.J4.string({IsLocalField:!0}),LogoPositionY:ke.J4.string({IsLocalField:!0}),TitlePositionX:ke.J4.string({IsLocalField:!0}),TitlePositionY:ke.J4.string({IsLocalField:!0}),LogoSize:ke.J4.string({IsLocalField:!0})},Oe=function(n){function t(t){var e=n.call(this,t)||this;if(t.MasterTreeReady){var r=Tn.x.Schema;t.MasterTreeReady.then((function(){return e.Form.fieldsReady([r.HeaderTheme])})).then((function(){return e.Form.ensureFieldsReady([r.HeaderBGImage,r.BackGroundPositionX,r.BackGroundPositionY,r.BackGroundPositionZ,r.ThemeHeaderBackgroundImageURL,r.LogoPositionX,r.LogoPositionY,r.TitlePositionX,r.TitlePositionY,r.LogoSize])})).then((function(){return e.ze()}))}return e}return(0,p.ZT)(t,n),Object.defineProperty(t.prototype,"Form",{get:function(){return this.Parent},enumerable:!1,configurable:!0}),t.prototype.getHeaderUploadedImageCustomThemeName=function(){var n=this.Form.Model;return{HeaderBackgroundImage:n.HeaderBGImage.ResourceUrl,Name:Ee.x9,HeaderBackgroundThumbnail:null,BackGroundPositionX:n.BackGroundPositionX||"0px",BackGroundPositionY:n.BackGroundPositionY||"0px",BackGroundPositionZ:n.BackGroundPositionZ||"auto",LogoPositionX:n.LogoPositionX||Ee.D4.Left,LogoPositionY:n.LogoPositionY||Ee.cL.Mid,TitlePositionX:n.TitlePositionX||Ee.D4.Left,TitlePositionY:n.TitlePositionY||Ee.cL.Mid,LogoSize:n.LogoSize||Ee.O8.Medium}},t.prototype.getNoBackGroundImageCustomThemeName=function(){var n=this.Form.Model;return{HeaderBackgroundImage:null,Name:Ee.VK,HeaderBackgroundThumbnail:null,BackGroundPositionX:n.BackGroundPositionX||"0px",BackGroundPositionY:n.BackGroundPositionY||"0px",BackGroundPositionZ:n.BackGroundPositionZ||"auto",LogoPositionX:n.LogoPositionX||Ee.D4.Left,LogoPositionY:n.LogoPositionY||Ee.cL.Mid,TitlePositionX:n.TitlePositionX||Ee.D4.Left,TitlePositionY:n.TitlePositionY||Ee.cL.Mid,LogoSize:n.LogoSize||Ee.O8.Medium}},t.prototype.getCompactHeaderCustomThemeName=function(){var n=this.Form.Model;return{HeaderBackgroundImage:n.ThemeHeaderBackgroundImageURL,Name:Ee.Ic,HeaderBackgroundThumbnail:null,BackGroundPositionX:n.BackGroundPositionX||"0px",BackGroundPositionY:n.BackGroundPositionY||"0px",BackGroundPositionZ:n.BackGroundPositionZ||"auto",LogoPositionX:n.LogoPositionX||Ee.D4.Left,LogoPositionY:n.LogoPositionY||Ee.cL.Mid,TitlePositionX:n.TitlePositionX||Ee.D4.Left,TitlePositionY:n.TitlePositionY||Ee.cL.Mid,LogoSize:n.LogoSize||Ee.O8.Medium}},t.prototype.getHeaderPredefinedImageCustomThemeName=function(){var n=this.Form.Model,t=n.HeaderTheme;return{HeaderBackgroundImage:t.HeaderBackgroundImage||n.ThemeHeaderBackgroundImageURL,Name:Ee.rV,HeaderBackgroundThumbnail:t.HeaderBackgroundThumbnail,BackGroundPositionX:t.BackGroundPositionX||n.BackGroundPositionX||"0px",BackGroundPositionY:t.BackGroundPositionY||n.BackGroundPositionY||"0px",BackGroundPositionZ:t.BackGroundPositionZ||n.BackGroundPositionZ||"auto",LogoPositionX:t.LogoPositionX||n.LogoPositionX||Ee.D4.Left,LogoPositionY:t.LogoPositionY||n.LogoPositionY||Ee.cL.Mid,TitlePositionX:t.TitlePositionX||n.TitlePositionX||Ee.D4.Left,TitlePositionY:t.TitlePositionY||n.TitlePositionY||Ee.cL.Mid,LogoSize:t.LogoSize||n.LogoSize||Ee.O8.Medium}},t.prototype.ic=function(){if(this.Form.SyncContext===Ne.y.ResponseTimeForm){var n=this.Model.HeaderBackgroundImage;n&&(n=n.indexOf("lists.office")>-1?"HiveHeaderImage":"OOBHeaderImage"),(0,H.$U)("CV_HeaderTheme.Information",{headerImage:n,isheaderON:this.Form.isFieldReady(this.Form.Schema.HeaderEnabled)?this.Form.Model.HeaderEnabled?this.Form.Model.HeaderEnabled:"true":"notReady"})}},t.prototype.ze=function(){var n=this;this.addRule({Name:"calculate header theme basing on name",onChange:function(t){t.BeingDeleted||n.uc()}});var t=Tn.x.Schema;this.Form.observe((function(){return n.uc()}),[t.HeaderBGImage.ResourceUrl,t.BackGroundPositionX,t.BackGroundPositionY,t.BackGroundPositionZ,t.LogoPositionX,t.LogoPositionY,t.TitlePositionX,t.TitlePositionY,t.LogoSize,t.ThemeHeaderBackgroundImageURL]),this.uc()},t.prototype.uc=function(){var n=this,t=this.Model.Name,e=!1;switch(t){case Ee.x9:this.setData(this.getHeaderUploadedImageCustomThemeName());break;case Ee.rV:this.setData(this.getHeaderPredefinedImageCustomThemeName());break;case Ee.Ic:this.setData(this.getCompactHeaderCustomThemeName());break;case Ee.VK:this.setData(this.getNoBackGroundImageCustomThemeName());break;default:var r=(0,c.k0)().headerThemeConfig;if(r&&"object"==typeof r&&r[t]&&"object"==typeof r[t])return void this.setData(r[t]);e=!0,this.sc(t).then((function(t){n.setData(t),n.ic()}))}e||this.ic()},t.prototype.sc=function(n){return this.Form.SyncContext!==Ne.y.ResponseTimeForm?(0,Ee.BM)(n):(0,Ee.lx)(n)},t}(U.d.createObjectMasterClass("SurveyHeaderTheme",Re));var De=function(){function n(){}return n.prototype.getMixinHeaderThemeMaster=function(){return n.HeaderThemeMasterClass||(n.HeaderThemeMasterClass=Oe),n.HeaderThemeMasterClass},n}(),xe=function(){function n(){}return n.prototype.getMixinHeaderThemeMaster=function(){return null},n}(),Le=e(64459),Me=e(37076),qe=e(916),Ae=e(41480),Ue=e(13877),Ve=e(21607),Ge=e(30777),Be=[],ze=["LastEmbedConfig","formsProConfiguredPipes","FormsProBranchRules","mfpBranchingData","formsProEmbedCode","conditionalThankyouMessage","headerOtherInfo","footerText","alias"],je=[],Qe=["FormsProSmileyList"];function He(n){var t=null;switch(n.entityType){case 1:t=(0,P.pd)((function(){return Be}),(function(){return ze}));break;case 2:t=(0,P.pd)((function(){return je}),(function(){return Qe}));break;default:return}t&&n.data&&"object"==typeof n.data&&t.forEach((function(t){n.data[t]&&(n.data["".concat(t,"@odata.type")]="#String")}))}var $e=e(99437),We=e(5892),Je="https://forms.microsoft.com/",Ke="https://forms.office.com/";var Xe=e(77209),Ye="forms",Ze="questions",nr="runtimeForms",tr="localeResource",er="runtimeresponses",rr=function(){function n(n,t){this.serviceUrl=n,this.ownerServiceUrl=t,this.partialUpdateHttpMethod=(0,_.a)().Flighting.isEnabled_Deprecated("PartialPut")?"PUT":"PATCH"}return n.getQueryParameters=function(n,t,e){if(!t)return"".concat(n,"$expand=").concat(Ze);var r="$select="+(t=w.union(["id"],t)).join(","),i={permissions:"permissions"};i.questions="".concat(Ze,"($expand=").concat("choices",")"),i.permissionTokens="permissionTokens";var o=t.map((function(n){return i[n]})).filter((function(n){return n}));return o.length&&(r+="&$expand="+o.join(",")),e&&(r+="&$filter=".concat(e.name,"+").concat(e.operator,"+").concat(e.value)),r&&n+r},n.prototype.getImmersiveReaderToken=function(){var n=(0,Yn.x_)(),t="".concat(this.getSurveyWebServiceUrl(),"decomposition/GetImmersiveReaderToken?formId=").concat(n);return this.sendRequest({method:"GET",qosEventName:"Decomposition.GetImmersiveReaderToken",requestUri:t}).then((function(n){if(n)return n;throw new Error("Failed to get ImmersiveReader token via GetTokenForResource")}))},n.prototype.getPrivacySettings=function(n,t,e){var r={};return n&&(r.ownerTenantId=n),t&&(r.currentUserTenantId=t),e&&(r.isAnonymous=e),this.sendRequest({method:"GET",qosEventName:"Function.GetPrivacy",requestUri:"".concat(this.getSurveyWebServiceUrl(),"privacy?").concat($.param(r))})},n.prototype.reportAbuse=function(n){return this.sendRequest({data:n,method:"POST",qosEventName:"OnlineSafety.ReportAbuse",qosExtraData:{Category:n.Category},requestUri:"".concat(this.getSurveyWebServiceUrl(),"contentvalidation/report").concat(window.location.search)})},n.prototype.getRuntimeResponses=function(n,t){var e=t?"&$filter=responder+eq+'".concat(encodeURIComponent(t.replace(/\'/g,"''")),"'"):"",r=this.getSurveyWebOwnerServiceUrl();return this.sendRequest({qosEventName:"RuntimeResponses.Get",requestUri:"".concat(r).concat(Ye,"('").concat(n,"')/").concat(er).concat("?$expand=comments").concat(e)})},n.prototype.getRuntimeResponse=function(n,t){var e=(0,L.NW)(),r={};return e.GetResponseToken&&(r.GetResponseToken=e.GetResponseToken),this.sendRequest({headers:r,qosEventName:"RuntimeResponse.Get",requestUri:"".concat(this.getSurveyWebOwnerServiceUrl(),"light/").concat(Ye,"('").concat(n,"')/").concat(er,"(").concat(t,")").concat("?$expand=comments")})},n.prototype.submitFormResponse=function(n,t){var e=(0,Me.kc)(n),r="AAD";return null==e.OrgId?r="Unknown":e.OrgId.toLowerCase()===(0,et.Fc)()&&(r="MSA"),this.sendRequest({data:t,method:"POST",qosEventName:"Response.Submit",qosExtraData:{OwnerSource:r},requestUri:"".concat(this.getSurveyWebOwnerServiceUrl()).concat(Ye,"('").concat(n,"')/").concat("responses")})},n.prototype.getToken=function(){return(0,_.a)().AuthContext.getFormApiToken()},n.prototype.getRuntimeForm=function(t,e){var r="".concat(this.getSurveyWebOwnerServiceUrl(),"light/").concat(nr,"('").concat(t,"')");return r+=n.getQueryParameters("?",e),this.sendRequest({qosEventName:"ResponseForm.Get",requestUri:r},{hasPrefetch:!0})},n.prototype.getResponseDetailRuntimeForm=function(t,e){var r=(0,L.NW)();if(r.GetResponseToken&&r.rid){var i={GetResponseToken:r.GetResponseToken},o="".concat(this.getSurveyWebOwnerServiceUrl(),"light/").concat("responseDetailRuntimeForms","('").concat(t,"')/").concat(r.rid);return o+=n.getQueryParameters("?",e),this.sendRequest({headers:i,qosEventName:"QosEvent.ServiceEndpoints.Form.GetResponseDetailRuntimeForm",requestUri:o})}return Promise.resolve(null)},n.prototype.getLocaleResource=function(n,t){var e="".concat(this.getMultilingualBaseUrl(n),"/'").concat(t,"'"),r=(0,P.md)((function(){return(0,L.NW)().vt}));return this.sendRequest({headers:{ValidationToken:r||""},method:"GET",qosEventName:"Locale.Get",requestUri:e})},n.prototype.createUploadSession=function(n,t,e){var r="".concat(this.getSurveyWebOwnerServiceUrl()).concat(nr,"('").concat(n,"')/").concat(Ze,"('").concat(t,"')/CreateUploadSession");return this.sendRequest({data:{value:e},method:"POST",qosEventName:"Question.CreateUploadSession",requestUri:r})},n.prototype.cancelOrDeleteUploadFile=function(n){return this.sendRequest({method:"DELETE",qosEventName:"FileUpload.CancelOrDeleteUploadFile",requestUri:n})},n.prototype.getUserInfo=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"userInfo",method:"GET",qosEventName:"Function.GetUserInfo"},{disableRequestRingHeader:!0})},n.prototype.getSharedForm=function(n){return this.sendRequest({body:'{"value" : "'.concat((0,L.NW)().sharetoken,'"}'),headers:{"Content-Type":"application/json;odata.metadata=minimal"},isSensitiveUri:!0,method:"GET",qosEventName:"SharedForm.Get",requestUri:"".concat(this.getSurveyWebOwnerServiceUrl()).concat("GetSharedForm","(formid='").concat(n,"',token='").concat((0,L.NW)().sharetoken,"')")})},n.prototype.getDataClassificationLabelDetail=function(n,t){return this.ac({method:"GET",qosEventName:"Function.GetDataClassificationLabelDetails",requestUri:"".concat(this.getSurveyWebServiceUrl(),"/dataClassificationLabelInfo/").concat(n,"/").concat(encodeURIComponent(t))})},n.prototype.getMultilingualBaseUrl=function(n){return"".concat(this.getSurveyWebOwnerServiceUrl()).concat(Ye,"('").concat(n,"')/").concat(tr)},n.prototype.getSurveyWebOwnerServiceUrl=function(){return this.ownerServiceUrl},n.prototype.getSurveyWebServiceUrl=function(){return this.serviceUrl},n.prototype.getFormApiBaseServiceUrl=function(){return"".concat(function(){var n;switch((0,et.kD)()){case"USDoDProd":n="https://forms.osi.apps.mil/";break;case"USGovProd":n="https://forms.osi.office365.us/";break;case"USGovGccProd":n=(0,et.H5)()?Je:Ke;break;case"WWProd":n=Ke;break;case"MSProd":n=Je;break;case"USNat":n="https://forms.osi.eaglex.ic.gov/";break;case"USSec":n="https://forms.osi.microsoft.scloud/";break;default:n="https://"+window.location.host+"/"}return n}(),"formapi/api")},n.prototype.sendRequest=function(n,t,e){var r=this;return this.getToken().then((function(i){return n.headers=$.extend(!0,n.headers,r.getCommonHeaders(i)),He(n),(0,Ge.lW)(n,t,e).then((function(n){return(0,We.D3)(n).value}),We.W3)}))},n.prototype.sendRequestWithCount=function(n,t,e){var r=this,i={Forms:[],TotalFormCount:0};return this.getToken().then((function(o){return n.headers=$.extend(!0,n.headers,r.getCommonHeaders(o)),He(n),(0,Ge.lW)(n,t,e).then((function(n){var t=(0,We.D3)(n);return i.Forms=t.value,i.TotalFormCount=t.count,i}),We.W3)}))},n.prototype.getCommonHeaders=function(t){var e={Accept:"application/json",AnalyzerToken:(0,L.NW)().AnalyzerToken,Authorization:(0,Xe.U)(t),ShareInvitationKey:(0,L.$p)().Token||(0,L.NW)().Token||(0,L.NW)().sharetoken,__RequestVerificationToken:(0,c.k0)().antiForgeryToken};return(0,P.md)((function(){var n={ContextParams:(0,c.k0)().contextParams,ParentSurveyId:(0,L.NW)().parentSurveyId,ParentResponseId:(0,L.NW)().parentResponseId,ValidationToken:(0,L.NW)().vt,RegardingParams:(0,L.NW)().rg};e=w.extend({},e,n)})),e=w.extend({},e,n.customizedHeaders)},n.prototype.ac=function(n,t){return n.headers=$.extend(!0,n.headers,this.getCommonHeaders("")),He(n),(0,Ge.lW)(n,t).then(We.EI,We.W3)},n.customizedHeaders={},n}(),ir="analysisForms",or="forms",ur="runtimeForms",sr="questions",ar="descriptiveQuestions",cr="choices",fr="responses",lr="comments",hr="permissions",dr="responderPermissions",mr="permissionTokens",vr="sharedWithMeForms",pr="GetAggregateQuizData",gr="GetAggregateSurveyData",br="CopyToUser";function wr(n){function t(){var n=(0,g.f5)();return!(!n||!n.Model.FormMaster||n.Model.FormMaster.Model.OwnerId!==(0,c.k0)().userInfo.UserId)}function r(){(0,H.JG)({eventInfo:{Component:"FormAPI_fetchOwnerUserType",message:"Failed to fetch user type",pageName:"DesignPage",tenantId:(0,c.k0)().userInfo.TenantId,userId:(0,c.k0)().userInfo.UserId},type:"MFPUI_UserTypeFetchFailed"})}function i(n){var t=null;if(n&&n.settings){if((0,P.md)((function(){return"survey"===n.type})))return"Survey";var e=null;try{e=JSON.parse(n.settings)}catch(n){}if("poll"===n.type||n.category&&n.category.indexOf("Poll")>=0)return"Poll";e&&void 0!==e.IsQuizMode&&(t=e.IsQuizMode?"Quiz":"Form")}return t||void 0}function o(){switch((0,v.XF)()){case"TeamsApproval":return"approval";case"TeamsReports":return"reports";default:return""}}return function(n){function u(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=n.apply(this,t)||this;return r.cc="aadFormLauncher",r.fc="msaFormLauncher",r}return(0,p.ZT)(u,n),u.addDefaultHeader=function(n,t){null===rr.customizedHeaders&&(rr.customizedHeaders={}),rr.customizedHeaders[n]=t},u.prototype.getForms=function(n,t){var e=this.getSurveyWebOwnerServiceUrl()+"light/";return e+=or+rr.getQueryParameters("?",n,t),this.sendRequest({requestUri:e,qosEventName:"Forms.Get"})},u.prototype.hardDeleteForms=function(n){var t="".concat(this.getSurveyWebOwnerServiceUrl(),"light/deleteForms");return this.sendRequest({requestUri:t,method:"POST",data:n,qosEventName:"Forms.HardDeleteForms"})},u.prototype.getFormsSharedWithCurrentUser=function(){var n=this.getSurveyWebOwnerServiceUrl()+vr;return this.sendRequest({requestUri:n,qosEventName:"Forms.Get.SharedWithMe"})},u.prototype.getFormsSharedWithCurrentUserPro=function(n,t){var e=n?"?$skip=".concat(t,"&$top=").concat((0,Ut.NA)()):"?$top=".concat((0,Ut.NA)(),"&$count=true"),r=this.getSurveyWebOwnerServiceUrl()+"light/"+vr+e;return this.sendRequestWithCount({requestUri:r,qosEventName:"Forms.Get.SharedWithMe"})},u.prototype.getCachedSimpleForms=function(n,t){var e="".concat(this.serviceUrl).concat(n,"/users/").concat(t,"/").concat("memorybasedforms");return this.sendRequest({requestUri:e,qosEventName:"Forms.GetCachedSimpleForms"})},u.prototype.getDesignForm=function(n,t){var e=this.getSurveyWebOwnerServiceUrl()+"light/";e+="forms('"+n+"')",e+=rr.getQueryParameters("?",t);var r={FormType:o()};return this.sendRequest({requestUri:e,qosEventName:"DesignForm.Get",qosExtraData:r})},u.prototype.getAnalysisTimeForm=function(n){var t="".concat(this.getSurveyWebOwnerServiceUrl(),"light/").concat(ir,"('").concat(n,"')?").concat("$expand=questions($expand=choices)");return this.sendRequest({requestUri:t,method:"GET",qosEventName:"AnalysisForm.Get"})},u.prototype.createOD4BSessionTempFolder=function(n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+ur+"('"+n+"')/Microsoft.FormServices.CreateOneDriveSessionTempFolder",method:"POST",qosEventName:"Form.CreateOD4BSessionTempFolder"}).then((function(n){return n?n.itemId:Promise.reject(new Error("Failed to create OneDriveForBusiness session temp folder."))}))},u.prototype.deleteSharedWithMeLink=function(n){var t=this.getSurveyWebServiceUrl()+"light/".concat(vr,"('").concat(n,"')");return this.sendRequest({requestUri:t,method:"DELETE",qosEventName:"Forms.DeleteSharedWithMe"})},u.prototype.changeSharingStatus=function(n,t){var e=t?"On":"Off";return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"forms('"+n+"')/Microsoft.FormServices.Turn"+e+"AllowCopySetting",method:"POST",qosEventName:t?"FormDefinition.TurnOnFormSharing":"FormDefinition.TurnOffFormSharing"})},u.prototype.createPermissionLink=function(n,t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')/"+hr,method:"POST",data:t,qosEventName:"FormDefinition.CreateFormPermissionLink",qosExtraData:{specificShare:"User"===t.type||"Group"===t.type}})},u.prototype.deletePermissionLink=function(n,t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')/"+"permissions('"+t+"')",method:"DELETE",qosEventName:"FormDefinition.DeleteFormPermissionLink"})},u.prototype.createResponderPermissionLink=function(n,t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')/"+dr,method:"POST",data:t,qosEventName:"FormDefinition.CreateResponderFormPermissionLink",qosExtraData:{type:t.type}})},u.prototype.deleteResponderPermissionLink=function(n,t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')/"+"responderPermissions('"+t+"')",method:"DELETE",qosEventName:"FormDefinition.DeleteResponderFormPermissionLink"})},u.prototype.getFormPermissions=function(n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')/"+hr,method:"GET",qosEventName:"FormDefinition.GetFormPermissions"})},u.prototype.createPermissionToken=function(n,t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')/"+mr,method:"POST",data:t,qosEventName:"FormDefinition.CreateFormPermissionToken"})},u.prototype.getOrCreateFormPermissionToken=function(n,t,e){var r={};return(0,v.Kw)()&&(r["x-ms-form-request-source"]="ms-teams"),this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')/Microsoft.FormServices.GetOrCreatePermissionToken",method:"POST",headers:r,data:{type:t,name:e},qosEventName:"Form.GetOrCreatePermissionToken"})},u.prototype.deletePermissionToken=function(n,t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')/"+"permissionTokens('"+t+"')",method:"DELETE",qosEventName:"FormDefinition.DeleteFormPermissionToken"})},u.prototype.getIdentityProviderType=function(n){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"authinfo/idptype?username="+encodeURIComponent(n),method:"GET",qosEventName:"Form.GetIdentityProviderType"}).then((function(n){return n.ProviderType}))},u.prototype.createForm=function(n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+or,method:"POST",data:n,headers:this.lc(),qosEventName:"Form.Create",entityType:1,qosExtraData:{FormType:i(n)}})},u.prototype.createFormByDefinition=function(n){return this.sendRequest({requestUri:"".concat(this.getSurveyWebOwnerServiceUrl(),"light/").concat(or),method:"POST",data:n,headers:this.lc(),qosEventName:"Form.Create",entityType:1,qosExtraData:{FormType:i(n),IsLight:!0}})},u.prototype.updateForm=function(n,e){return(0,P.md)((function(){var n=(0,A.GW)(),i=new Error;if((0,H.JG)({type:"MFPUI_PatchFormIsNull",eventInfo:{tenantId:(0,c.k0)().userInfo.TenantId,requestId:n,Component:"FormUpdate",sessionId:(0,Ae.k)(),mfpStack:i.stack,formObject:e}}),!e.ownerUserType&&t()){var o=(0,g.f5)();(0,ue.Ng)().then((function(n){n&&o.Model.FormMaster.Model.OwnerUserType!==n.toString()&&(e.ownerUserType=n.toString(),o.bulkEdit((function(t){t.FormMaster.Model.OwnerUserType=n.toString()})))})).catch((function(){r()}))}})),this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')",method:this.partialUpdateHttpMethod,data:e,qosEventName:"Form.Update",qosExtraData:{SoftDeleted:e.softDeleted},entityType:1},{disableRetry:1===e.softDeleted})},u.prototype.postFormShareAction=function(n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/"+"forms('"+n+"')/shareaction",method:"POST",qosEventName:"Form.PostShareAction"})},u.prototype.createFormImageFromUrl=function(n,t,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')/"+t,method:"POST",data:e,qosEventName:"logo"===t?"FormImage.CreateFromUrl":"ThemeImage.CreateFromUrl",qosExtraData:{FormProperty:t}})},u.prototype.deleteForm=function(n,t,e){void 0===t&&(t=""),void 0===e&&(e="");var r=(0,P.pd)((function(){}),(function(){return{BusinessCdsId:t,BusinessCdsRegion:e}}));return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')",method:"DELETE",data:r,qosEventName:"Form.Delete"})},u.prototype.dupFormForExcel=function(n,t){var e={id:n,xlWorkbookId:t};return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+or,method:"POST",data:e,qosEventName:"Excel.DuplicateFormForExcel"})},u.prototype.copyForm=function(n,t,e,r){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/"+"forms('"+n+"')/"+br,method:"POST",data:{formId:n,newOwnerId:t,newTenantId:e,isNewOwnerGroup:r},qosEventName:"Function.CopyForm",qosExtraData:{FormId:n,NewOwnerId:t,IsNewOwnerGroup:r}},{disableRetry:!0}).then((function(n){return{id:n.id,title:n.title,createdDate:n.createdDate,modifiedDate:n.modifiedDate,settings:n.settings,xlWorkbookId:n.xlWorkbookId,ownerId:n.ownerId,ownerTenantId:n.ownerTenantId,category:n.category,otherInfo:n.otherInfo,background:n.background,softDeleted:n.softDeleted,type:n.type,fileUploadFormInfo:n.fileUploadFormInfo,status:n.status,version:n.version}}))},u.prototype.copyFormWithPatchProperties=function(n,t,e,r,i){if((0,P.md)((function(){return!0}))){var o={formId:n,newOwnerId:t,newTenantId:e,isNewOwnerGroup:r};return(0,yn.y)()&&(o={formId:n,newOwnerId:t,newTenantId:e,isNewOwnerGroup:r,patchProperties:i}),this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/"+"forms('"+n+"')/"+br,method:"POST",data:o,qosEventName:"Function.CopyForm",qosExtraData:{FormId:n,NewOwnerId:t,IsNewOwnerGroup:r}},{disableRetry:!0}).then((function(n){return{id:n.id,title:n.title,createdDate:n.createdDate,modifiedDate:n.modifiedDate,settings:n.settings,xlWorkbookId:n.xlWorkbookId,ownerId:n.ownerId,ownerTenantId:n.ownerTenantId,category:n.category,otherInfo:n.otherInfo,background:n.background,softDeleted:n.softDeleted,type:n.type,fileUploadFormInfo:n.fileUploadFormInfo,status:n.status,version:n.version,cvSimplifiedBranchingSupported:n.cvSimplifiedBranchingSupported,mfpBranchingData:n.mfpBranchingData}}))}},u.prototype.copyFormBySharingLink=function(n,t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/"+"forms('"+n+"')/CopyBySharingLink",method:"POST",headers:{ShareInvitationKey:t},data:{formId:n,sharingToken:t},qosEventName:"Function.CopyBySharingLink",qosExtraData:{FormId:n}})},u.prototype.moveForm=function(n,t,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/"+"forms('"+n+"')/MoveForm",method:"POST",data:{newOwnerId:t,isNewOwnerGroup:e},qosEventName:"Function.MoveForm",qosExtraData:{FormId:n,NewOwnerId:t,IsNewOwnerGroup:e,IsDelegateMode:(0,v.lS)()}})},u.prototype.postRecentForm=function(n,t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"recent/forms/"+n,data:t,method:"POST",qosEventName:"Function.PostRecentForm"})},u.prototype.getRecentForms=function(n){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"recent/forms"+(null==n?"":"?ownerType="+encodeURIComponent(n)),method:"GET",qosEventName:"Function.GetRecentForms"})},u.prototype.removeRecentForm=function(n){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"recent/forms/"+n,method:"DELETE",qosEventName:"Function.RemoveRecentForm"})},u.prototype.updateExperienceType=function(n,t,e){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+n+"/users/"+t+"/experiencetype/"+e+"/UpdateExperienceType",method:"POST",qosEventName:"Function.UpdateExperienceType"})},u.prototype.updateLastUsedEnv=function(n,t,e){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+n+"/users/"+t+"/UpdateLastUsedEnv",data:e,method:"POST",qosEventName:"Function.UpdateLastUsedEnv"})},u.prototype.updateFormsProLicense=function(n,t){var e="";n||(e="FORMS_PRO");var r="";return r="UpdateFormsProUserLicenses(licenseNames='{0}',isOptOutAction={1})".format(e,t?"true":"false"),this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+r,method:"DELETE",qosEventName:"Function.UpdateFormsProLicense"})},u.prototype.updateRecentForm=function(n,t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"recent/forms/"+n+"?title="+encodeURIComponent(t),method:"PUT",qosEventName:"Function.UpdateRecentForm"})},u.prototype.getFormsTenantSettings=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"GetFormsTenantSettings",method:"GET",qosEventName:"Function.GetFormsTenantSettings"})},u.prototype.getUserReputationTier=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"userReputationTier",method:"GET",qosEventName:"Function.GetUserReputationTier"})},u.prototype.getFormCreatorPhotoDefinition=function(n){return this.hc({requestUri:this.getSurveyWebServiceUrl()+"light/GetFormCreatorDefinition('".concat(n,"','')"),method:"GET",qosEventName:"Function.GetFormCreatorPhotoDefinition"})},u.prototype.getFormCreatorPhotoValue=function(n){return this.hc({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+"light/GetFormCreatorPhotoValue('".concat(n,"','')/$value"),method:"GET",qosEventName:"Function.GetFormCreatorPhotoValue"})},u.prototype.getCurrentUserPhotoValue=function(){return this.hc({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+"GetCurrentUserPhotoValue",method:"GET",qosEventName:"Function.GetCurrentUserPhotoValue"})},u.prototype.getDataClassificationLabels=function(){return this.sendRequest({method:"GET",requestUri:this.getSurveyWebServiceUrl()+"GetDataClassificationLabels",qosEventName:"Function.GetDataClassificationLabels"})},u.prototype.getFormQuestion=function(n,t,e){var r=this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')/"+"questions('"+t+"')";return e&&(r=r+"?$select="+e.toString()),this.sendRequest({requestUri:r,qosEventName:"Question.Get"})},u.prototype.createFormQuestion=function(n,t,e,r){var i=this,o=(0,p.pi)({IsQuiz:t.isQuiz,QuestionId:t.id,QuestionType:t.type},e),u={requestUri:this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')/"+sr,method:"POST",data:t,qosEventName:"Question.Create",qosExtraData:o,entityType:2};return(0,P.md)((function(){i.dc(n),i.mc()})),r?this.hc(u,{},r):this.sendRequest(u)},u.prototype.createQuestionImageFromUrl=function(n,t,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')/"+"questions('"+t+"')/image",method:"POST",data:e,qosEventName:"QuestionImage.CreateFromUrl",qosExtraData:{QuestionId:t}})},u.prototype.updateFormQuestion=function(n,t,e,r,i){var o=this,u=this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')/"+"questions('"+t+"')",s=(0,p.pi)({QuestionType:e},i);return(0,P.md)((function(){o.dc(n)})),this.sendRequest({requestUri:u,method:this.partialUpdateHttpMethod,data:r,qosEventName:"Question.Update",qosExtraData:s,entityType:2},{disableLog:!0})},u.prototype.deleteFormQuestion=function(n,t,e,r){var i=this,o=(0,p.pi)({QuestionType:e,QuestionId:t},r);return(0,P.md)((function(){i.dc(n),i.mc()})),this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')/"+"questions('"+t+"')",method:"DELETE",qosEventName:"Question.Delete",qosExtraData:o})},u.prototype.mc=function(){(0,P.md)((function(){var n=(0,g.f5)().Model.FormMaster;n.SettingMaster.Model.PauseAndResumeSurvey&&n.bulkEdit((function(n){n.SurveyLastModifiedAt=(new Date).toUTCString()}))}))},u.prototype.dc=function(n){var e=this;if(n&&t()){var i=(0,g.f5)();(0,ue.Ng)().then((function(t){if(t&&i.Model.FormMaster.Model.OwnerUserType!==t.toString()){var r={};r.ownerUserType=t.toString(),i.bulkEdit((function(n){n.FormMaster.Model.OwnerUserType=t.toString()})),e.updateForm(n,r)}})).catch((function(){r()}))}},u.prototype.getFormDescriptiveElement=function(n,t,e){var r=this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')/"+"descriptiveQuestions('"+t+"')";return e&&(r=r+"?$select="+e.toString()),this.sendRequest({requestUri:r,qosEventName:"DescriptiveElement.Get"})},u.prototype.createFormDescriptiveElement=function(n,t,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')/"+ar,method:"POST",data:t,qosEventName:"DescriptiveElement.Create",qosExtraData:(0,p.pi)({QuestionId:t.id,QuestionType:t.type},e)})},u.prototype.updateFormDescriptiveElement=function(n,t,e,r,i){var o=this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')/"+"descriptiveQuestions('"+t+"')";return this.sendRequest({requestUri:o,method:this.partialUpdateHttpMethod,data:r,qosEventName:"DescriptiveElements.Update",qosExtraData:(0,p.pi)({QuestionType:e},i)},{disableLog:!0})},u.prototype.deleteFormDescriptiveElement=function(n,t,e,r){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')/"+"descriptiveQuestions('"+t+"')",method:"DELETE",qosEventName:"DescriptiveElement.Delete",qosExtraData:(0,p.pi)({QuestionType:e},r)})},u.prototype.createQuestionChoice=function(n,t,e){var r=this,i=this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')/"+"questions('"+t+"')/"+cr;return(0,P.md)((function(){r.mc()})),this.sendRequest({requestUri:i,method:"POST",data:e,qosEventName:"Choice.Create"})},u.prototype.getQuestionChoice=function(n,t,e){var r=this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')/"+"questions('"+t+"')/"+"choices("+e+")";return this.sendRequest({requestUri:r,method:"GET",qosEventName:"Choice.Get"})},u.prototype.updateQuestionChoice=function(n,t,e,r){var i=this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')/"+"questions('"+t+"')/"+"choices("+e+")";return this.sendRequest({requestUri:i,method:this.partialUpdateHttpMethod,data:r,qosEventName:"Choice.Update"})},u.prototype.deleteQuestionChoice=function(n,t,e){var r=this,i=this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')/"+"questions('"+t+"')/"+"choices("+e+")";return(0,P.md)((function(){r.mc()})),this.sendRequest({requestUri:i,method:"DELETE",qosEventName:"Choice.Delete"})},u.prototype.getFormResponses=function(n,t,e,r){var i=["$expand=comments"];t&&i.push("$filter={0}+{1}+{2}".format(t.name,t.operator,t.value)),e>=0&&r>=0&&i.push("$top={0}&$skip={1}".format(e,r));var o=i.filter((function(n){return!!n})).join("&");o=o&&"?"+o;var u=this.getSurveyWebOwnerServiceUrl()+"light/";return this.sendRequest({requestUri:u+or+"('"+n+"')/"+fr+o,qosEventName:w.any(i,(function(n){return-1===n.indexOf("$filter")}))?"Responses.Get":"Responses.Get.Filter"})},u.prototype.getAnalysisTimeResponses=function(n,t,e){var r=this.getSurveyWebOwnerServiceUrl()+ir+"('"+n+"')/"+"responses?$expand=comments";return t>=0&&e>=0&&(r+="&$top={0}&$skip={1}".format(t,e)),this.sendRequest({requestUri:r,method:"GET",qosEventName:"AnalysisTimeResponses.Get"})},u.prototype.getFormsResponseCount=function(){return this.hc({requestUri:this.getSurveyWebServiceUrl()+"light/GetRespCounts()",method:"GET",qosEventName:"Function.GetFormsResponseCount"})},u.prototype.getFormResponseCount=function(n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')/"+"responses/$count",qosEventName:"ResponseCount.Get"},{disableLog:!0})},u.prototype.deleteFormResponses=function(n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')/"+fr,method:"DELETE",qosEventName:"Responses.Delete"})},u.prototype.deleteFormResponse=function(n,t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')/"+"responses("+t+")/",method:"DELETE",qosEventName:"Response.Delete",qosExtraData:{responseId:t}})},u.prototype.deleteFormInvites=function(n,t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/"+"forms('"+n+"')/invites",method:"DELETE",data:t,qosEventName:"Invites.Delete"})},u.prototype.addFormResponseComment=function(n,t,e){var r={feedback:e.feedback,score:e.score,questionId:e.questionId};return e.id&&(r.id=e.id),this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')/"+"responses("+t+")/"+lr,method:"POST",data:r,qosEventName:"Comment.Add"})},u.prototype.addFormResponseComments=function(n,t){return this.sendRequest({requestUri:"".concat(this.getSurveyWebOwnerServiceUrl(),"batch/").concat(or,"('").concat(n,"')/").concat(lr),method:"POST",data:t,qosEventName:"Comments.Add"})},u.prototype.setResponseReleaseDate=function(n,t,e){var r={releaseDate:e};return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')/"+"responses("+t+")",method:this.partialUpdateHttpMethod,data:r,qosEventName:"Response.Update"})},u.prototype.createExportFile=function(n){var t=this;return this.getToken().then((function(e){var r,i="cdb-export-iframe",o=function(n){var t=document.getElementById(n);return t&&t.parentNode.removeChild(t),(t=document.createElement("iframe")).id=n,t.name=n,t.hidden=!0,t}(i);if((r=document.createElement("form")).style.display="none",r.method="POST",r.action=t.getSurveyWebServiceUrl()+or+"('"+n+"')/Microsoft.FormServices.CreateExportFile",r.target=i,null!==e){var u=document.createElement("input");u.type="hidden",u.name="Authorization",u.value="Bearer "+e,r.appendChild(u)}if(null!==(0,c.k0)().antiForgeryToken){var s=document.createElement("input");s.type="hidden",s.name="__RequestVerificationToken",s.value=(0,c.k0)().antiForgeryToken,r.appendChild(s)}document.body.appendChild(o),$(o).on("load",(function(){o.contentDocument.body.appendChild(r)})),r.submit()}))},u.prototype.downloadExcelFile=function(n,t,r){var i=this,o=new qe.o("Function.DownloadExcel");o.start();var u=3,s=this.lc(),a=this.vc({formid:n,timezoneOffset:s.__TimezoneOffset,__TimezoneId:s.__TimezoneId,minResponseId:t,maxResponseId:r}),c=function(){return i.getToken().then((function(n){var t=$.extend(!0,{},i.getCommonHeaders(n));t["x-correlationid"]=o.CorrelationId,t["x-usersessionid"]=(0,Ae.k)();var r=Date.now();return(0,Ge.MM)({requestUri:a,headers:t}).then((function(n){return(0,p.mG)(i,void 0,void 0,(function(){var t,r;return(0,p.Jh)(this,(function(i){switch(i.label){case 0:return(r=w.find(w.keys(n.headers),(function(n){return"content-disposition"===n.toLowerCase()})))&&(t=n.headers[r].split("filename*=UTF-8''")[1]),t?[4,e.e(424).then(e.t.bind(e,2926,23))]:[2,Promise.reject({message:"No file name in header",response:{statusCode:n.statusCode}})];case 1:return(0,i.sent().default)(n.body,decodeURIComponent(t)),o.end({resultType:"Success"}),[2]}}))}))})).catch((function(n){var t,e=n&&n.response&&n.response.body,s=n&&n.response&&n.response.statusCode;if(!e){var f=i.gc(s,n.message,a,r);throw o.end({resultType:f.failureType,extraData:{ServiceError:f}}),f}return(t=e,new Promise((function(n,e){var r=new FileReader;r.onload=function(){return n(r.result)},r.onerror=e,r.readAsText(t)}))).then((function(n){var t=i.gc(s,n,a,r);if((711===t.innerCode||701===t.innerCode)&&u>0)return u--,void(0,_.a)().AuthContext.refreshToken().then(Ve.Yq).then((function(){return c()})).catch($n.sl);throw o.end({resultType:t.failureType,extraData:{ServiceError:t}}),t}))}))}))};return c()},u.prototype.gc=function(n,t,e,r){var i="ExpectedFailure",o={statusCode:n,sourceUrl:e,innerCode:10203,innerMessage:t,failureType:"Failure"},u=(0,Le.d)(t);switch(u&&u.error&&(o.innerCode=parseInt(u.error.code),o.innerMessage=u.error.message,o.failureType=u.error["@ms.form.error.type"]),n){case 503:Date.now()-r>2e4?(o.innerMessage="ConnectionClosedByClient",o.innerCode=10210):o.innerCode=15503,o.failureType=i;break;case 429:o.innerMessage="TooManyRequest",o.innerCode=10208,o.failureType=i,t.includes("ManyRequestPerVM")&&(o.innerMessage="ManyRequestPerVM",o.innerCode=10209);case 0:case 502:case 504:o.innerMessage="GatewayTimeout",o.innerCode=15504,o.failureType=i;break;case 307:case 403:o.innerMessage="Blocked",o.innerCode=10207,o.failureType=i;break;default:if(void 0===n){t&&t.indexOf("Loading chunk")>=0&&(o.failureType=i)}}return o},u.prototype.getShellServiceInfo=function(n){var t,e=this,r=(0,Ue.G)();return(t=r.getItem(this.cc))?Promise.resolve(JSON.parse(t)):this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"GetShellServiceInfo(culture='{0}')".format(n),method:"GET",qosEventName:"Function.GetShellServiceInfo"}).then((function(n){return r.setItem(e.cc,JSON.stringify(n)),n}))},u.prototype.getConsumerShellServiceInfo=function(n){var t,e=this;return(t=(0,Ue.G)().getItem(this.fc))?Promise.resolve(JSON.parse(t)):this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"GetConsumerShellServiceInfo(culture='{0}')".format(n),method:"GET",qosEventName:"Function.GetConsumerShellServiceInfo"}).then((function(n){return window.sessionStorage.setItem(e.fc,JSON.stringify(n)),n}))},u.prototype.getShellNavBarData=function(n){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"GetShellServiceInfo(culture='{0}')".format(n),method:"GET",qosEventName:"QosEvent.ServiceEndpoints.Function.GetShellNavBarData"})},u.prototype.getOrNewExcelInOneDrive=function(n,t){var e=this.getSurveyWebOwnerServiceUrl()+"GetOrNewExcelInOneDrive(formid='"+n+"',forcereexport='"+t+"')";return this.sendRequest({requestUri:e,method:"GET",headers:this.lc(),qosEventName:"Action.OpenExcelInOneDrive"})},u.prototype.refreshUserInfo=function(){return this.sendRequest({method:"GET",requestUri:"".concat(this.getSurveyWebServiceUrl(),"refreshUserInfo"),qosEventName:"Function.RefreshUserInfo"})},u.prototype.getUserFeatureSettings=function(){return this.hc({requestUri:this.getSurveyWebServiceUrl()+"userfeaturesettings",method:"GET",qosEventName:"Function.GetUserFeatureSettings"})},u.prototype.updateUserFeatureSettings=function(n){return this.hc({data:JSON.stringify(n),requestUri:this.getSurveyWebServiceUrl()+"userfeaturesettings",method:"PATCH",qosEventName:"Function.UpdateUserFeatureSettings"})},u.prototype.getXlWorkbookId=function(n){var t=this.getSurveyWebServiceUrl()+"GetXlWorkbookId(formid='"+n+"')";return this.sendRequest({requestUri:t,method:"GET",headers:this.lc(),qosEventName:"Action.GetXlWorkbookId"})},u.prototype.isMemberOf=function(n){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"light/IsMemberOf('"+n+"')",method:"GET",qosEventName:"Function.IsMemberOf"},{disableXMsHeader:!0})},u.prototype.browseImage=function(n,t,e){var r={resourceId:n,itemCount:t,skipToken:e};return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/browseimage",method:"POST",data:r,qosEventName:"Decomposition.BrowseImage"})},u.prototype.getToken=function(){return(0,_.a)().AuthContext.getFormApiToken()},u.prototype.searchImage=function(n,t,e,r,i){var o={query:n,itemCount:e,lcid:(0,c.k0)().cultureInfo.Name.toLowerCase(),parameters:{license:t},skipToken:r.toString(),url:i};return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/searchimage",method:"POST",data:o,qosEventName:"Decomposition.SearchImage"})},u.prototype.getCdbToken=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/getTokenForResource?resourceType=CollabDB",method:"GET",qosEventName:"Decomposition.GetCdbToken"}).then((function(n){if(n)return n;throw new Error("Failed to get CDB token via GetTokenForResource")}))},u.prototype.getOD4BToken=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/getTokenForResource?resourceType=MSGraph",method:"GET",qosEventName:"Decomposition.GetOD4BToken"}).then((function(n){if(n)return"Bearer ".concat(n);throw new Error("Failed to get OneDriveForBusiness token via GetTokenForResource")}))},u.prototype.getOCPSToken=function(){var n=new qe.o("Decomposition.GetOCPSToken");return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/getTokenForResource?resourceType=OCPS",method:"GET",qosEventName:"Decomposition.GetOCPSToken"},{},n).then((function(t){if(t)return{token:"".concat(t.replace(/['"]+/g,"")),CorrelationId:n.CorrelationId};throw new Error("Failed to get OCPS token via GetTokenForResource")}))},u.prototype.getFormsProToken=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/getTokenForResource?resourceType=FormsPro",method:"GET",qosEventName:"Decomposition.GetFormsProToken"}).then((function(n){if(n)return"Bearer ".concat(n);throw new Error("Failed to get FormsPro token via GetTokenForResource")}))},u.prototype.unblockPhishingForm=function(n){return this.sendRequest({requestUri:this.bc(n)+"/unblock",method:"PATCH",qosEventName:"AdminPage.UnblockPhishingForm"})},u.prototype.confirmPhishingForm=function(n){return this.sendRequest({requestUri:this.bc(n)+"/confirmPhishing",method:"PATCH",qosEventName:"AdminPage.ConfirmPhishingForm"})},u.prototype.deleteEvilForm=function(n){return this.sendRequest({requestUri:this.bc(n),method:"DELETE",qosEventName:"AdminPage.DeleteEvilForm"})},u.prototype.getAdminPhishingReviewForm=function(n,t){var e=this.bc(n);return e+=rr.getQueryParameters("?",t),this.sendRequest({requestUri:e,method:"GET",qosEventName:"AdminPage.GetPhisingReviewForm"})},u.prototype.createAdminPhishingReviewPermissionLink=function(n,t){return this.sendRequest({requestUri:this.bc(n)+"/permissions",method:"POST",data:t,qosEventName:"AdminPage.CreateFormPermissionLink"})},u.prototype.getRestrictedUser=function(n){return this.sendRequest({requestUri:this.yc(n),method:"GET",qosEventName:"AdminPage.GetRestrictedUser"})},u.prototype.unblockRestrictedUser=function(n){return this.sendRequest({requestUri:this.yc(n),method:"DELETE",qosEventName:"AdminPage.UnblockRestrictedUser"})},u.prototype.getGroups=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"groups",method:"GET",qosEventName:"Groups.Get"})},u.prototype.getGroupId=function(n){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"groupinfo/getgroupid?onedriveweburl="+encodeURIComponent(n),method:"GET",qosEventName:"Form.GetGroupId"})},u.prototype.getGroup=function(n){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"groups('".concat(n,"')"),method:"GET",qosEventName:"Group.Get"})},u.prototype.getGroupOwners=function(n){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"groups('".concat(n,"')/owners"),method:"GET",qosEventName:"Group.GetOwners"})},u.prototype.getGroupMembers=function(n){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"groups('".concat(n,"')/members"),qosEventName:"Group.GetMembers"})},u.prototype.getGroupPhotoDefinition=function(n){return this.hc({requestUri:this.getSurveyWebServiceUrl()+"groups('".concat(n,"')/photo"),method:"GET",qosEventName:"Group.GetPhotoDefinition"})},u.prototype.getGroupPhotoValue=function(n){return this.hc({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+"groups('".concat(n,"')/photo/$value"),method:"GET",qosEventName:"Group.GetPhotoValue"})},u.prototype.getUserPhotoValue=function(n){return this.hc({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+"light/users/".concat(n,"/photo/$value"),method:"GET",qosEventName:"User.GetPhotoValue"})},u.prototype.getGroupMemberPhotoDefinition=function(n,t){return this.hc({requestUri:this.getSurveyWebServiceUrl()+"groups('".concat(n,"')/members('").concat(t,"')/photo"),method:"GET",qosEventName:"Group.GetMemberPhotoDefinition"})},u.prototype.getGroupMemberPhotoValue=function(n,t){return this.hc({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+"groups('".concat(n,"')/members('").concat(t,"')/photo/$value"),method:"GET",qosEventName:"Group.GetMemberPhotoValue"})},u.prototype.getAnalysisSurveyData=function(n,t){var e=this.getSurveyWebOwnerServiceUrl()+"".concat(or,"('").concat(n,"')/").concat(gr);return null!=t&&""!==t&&(e=this.getSurveyWebOwnerServiceUrl()+"light/".concat(or,"('").concat(n,"')/").concat(gr,"?").concat(t)),this.sendRequest({requestUri:e,qosEventName:"Analysis.AggregateSurveyData"})},u.prototype.getFilteredResponseCount=function(n,t){var e=this.getSurveyWebOwnerServiceUrl()+"light/".concat(or,"('").concat(n,"')/").concat(fr,"/$count?").concat(t);return this.sendRequest({requestUri:e,qosEventName:"Analysis.FilteredResponseCount"})},u.prototype.getAnalysisQuizData=function(n){var t=this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')/"+pr;return this.sendRequest({requestUri:t,qosEventName:"Analysis.AggregateQuizData"})},u.prototype.getResultSharingAnalysisSurveyData=function(n){var t=this.getSurveyWebOwnerServiceUrl()+ir+"('"+n+"')/"+gr;return this.sendRequest({requestUri:t,qosEventName:"Analysis.ResultSharingAggregateSurveyData"})},u.prototype.getResultSharingAnalysisQuizData=function(n){var t=this.getSurveyWebOwnerServiceUrl()+ir+"('"+n+"')/"+pr;return this.sendRequest({requestUri:t,qosEventName:"Analysis.ResultSharingAggregateQuizData"})},u.prototype.getInsights=function(n){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"insights/getinsights?formId="+encodeURIComponent(n),method:"GET",qosEventName:"Form.GetInsights"})},u.prototype.getFormsWithToken=function(n,t,e){void 0===n&&(n=!1);var r=this.getSurveyWebServiceUrl()+or+rr.getQueryParameters("?",t);return this.hc({requestUri:r,qosEventName:"Forms.Get"},{skipExpiredTokenCheck:!!e},e)},u.prototype.createFormWithToken=function(n,t){return this.hc({requestUri:this.getSurveyWebServiceUrl()+or,method:"POST",data:n,headers:this.lc(),qosEventName:"Form.Create",qosExtraData:{FormType:i(n)},entityType:1},{},t)},u.prototype.checkAnonymousAccess=function(n){var t=this.getSurveyWebOwnerServiceUrl()+"light/"+"runtimeForms('"+n+"')";return(0,Ge.lW)({requestUri:t,headers:[]},{disableLog:!0,skipExpiredTokenCheck:!0}).then((function(){return!0}),(function(n){var t=(0,$e.QX)(n);if(401===t.statusCode)return!1;throw t}))},u.prototype.getMeetingInfo=function(n){var t=this.getSurveyWebServiceUrl()+"light/meetingInfo?meetingId="+n;return this.sendRequest({requestUri:t,method:"GET",qosEventName:"MeetingInfo.GetMeetingInfo"})},u.prototype.getInactiveUserByIdOrEmail=function(n){var t=this.getSurveyWebServiceUrl()+"deleteduserinfo/byidemail/"+encodeURIComponent(n);return this.sendRequest({requestUri:t,isSensitiveUri:!0,method:"GET",qosEventName:"InactiveUserByIdOrEmail.Get"})},u.prototype.getUserSettings=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"userSettings",method:"GET",qosEventName:"UserSettings.Get"})},u.prototype.updateUserSettings=function(n){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"userSettings",method:this.partialUpdateHttpMethod,data:n,qosEventName:"UserSettings.Update"}).then((function(){return null}))},u.prototype.getAllLocaleResources=function(n){var t=this.getMultilingualBaseUrl(n);return this.sendRequest({requestUri:t,method:"GET",qosEventName:"Locale.GetAll"}).then((function(n){return n.filter((function(n){return!!n.elementValue}))}))},u.prototype.createLocaleItem=function(n,t){return this.sendRequest({requestUri:this.getMultilingualBaseUrl(n),method:"POST",data:t,qosEventName:"LocaleItem.Create"})},u.prototype.updateLocaleItem=function(n,t){var e=this.getMultilingualBaseUrl(n)+"/'"+t.locale+"'/";return e+=t.questionId?"question/'"+t.questionId+"'/'":"form/'",e+=t.elementKey+"'",this.sendRequest({requestUri:e,method:this.partialUpdateHttpMethod,data:{ElementValue:t.elementValue},qosEventName:"LocaleItem.Update"})},u.prototype.deleteLocale=function(n,t){return this.sendRequest({requestUri:this.getMultilingualBaseUrl(n)+"/'"+t+"'",method:"DELETE",qosEventName:"Locale.Delete"})},u.prototype.copyLocaleResources=function(n,t){var e=this.getSurveyWebOwnerServiceUrl()+"batch/"+"forms('"+n+"')/"+tr;return this.sendRequest({requestUri:e,method:"POST",data:t,qosEventName:"LocaleItem.Copy"})},u.prototype.getSuspiciousEvidence=function(n){var t=this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')/GetSuspiciousEvidence";return this.sendRequest({requestUri:t,method:"GET",qosEventName:"SuspiciousEvidence.Get"})},u.prototype.notifyAdminForApproval=function(n){var t=this.getSurveyWebOwnerServiceUrl()+or+"('"+n+"')/NotifyAdminForApproval";return this.sendRequest({requestUri:t,method:"POST",qosEventName:"Function.NotifyAdminForApproval"})},u.prototype.getOrCreateShortUrl=function(n,t){var e="".concat(this.getSurveyWebOwnerServiceUrl(),"light/").concat(or,"('").concat(n,"')/shortUrls/").concat(t);return this.sendRequest({requestUri:e,method:"PUT",qosEventName:"ShortUrl.GetOrCreate",qosExtraData:{LinkType:t}})},u.prototype.getCSVInfo=function(n){var t=this.Sc(n.$formId)+"GetCSVInfoList";return this.sendRequest({requestUri:t,method:"GET",headers:this.lc(),qosEventName:"ResponsesPage.GetCSVInfo"})},u.prototype.getCSVDownloadLink=function(n){var t=this.Sc(n.$formId)+"DownloadCSVFile/".concat(n.$fileName);return this.sendRequest({requestUri:t,method:"GET",headers:this.lc(),qosEventName:"ResponsesPage.GetCSVDownloadLink"})},u.prototype.deleteCSVFile=function(n){var t=this.Sc(n.$formId)+"DeleteCSVFile/".concat(n.$fileName);return this.sendRequest({requestUri:t,method:"DELETE",qosEventName:"ResponsesPage.DeleteCSVFile"})},u.prototype.generateCSVFile=function(n){var t=this.Sc(n.$formId)+"GenerateCSVFile";return this.sendRequest({requestUri:t,method:"PUT",headers:this.lc(),qosEventName:"ResponsesPage.GenerateCSVFile"})},u.prototype.getArchiveAndActiveResponseCount=function(n){var t=(0,Me.kc)(n.$formId),e=t.OwnerId,r=t.OrgId,i=t.IsGroupOwner,o="".concat(this.getFormApiBaseServiceUrl(),"/").concat(r,"/").concat(i?"groups":"users","/").concat(e,"/light/forms('").concat(n.$formId,"')/Responses/archiveandacitvecount");return this.sendRequest({requestUri:o,method:"GET",qosEventName:"Function.GetArchiveAndActiveResponseCount"})},u.prototype.hc=function(n,t,e){var r=this;return Promise.resolve(e||this.getToken()).then((function(e){return n.headers=$.extend(!0,n.headers,r.getCommonHeaders(e)),He(n),(0,Ge.lW)(n,t).then((function(n){return(0,We.EI)(n)}),We.W3)}))},u.prototype.lc=function(){var n,t="undefined"!=typeof Intl?Intl.DateTimeFormat():null,e=null===(n=null==t?void 0:t.resolvedOptions())||void 0===n?void 0:n.timeZone;return{__TimezoneOffset:(new Date).getTimezoneOffset().toString(),__TimezoneId:e||""}},u.prototype.vc=function(n){return this.Cc()+"formapi/DownloadExcelFile.ashx?"+$.param(n)},u.prototype.Cc=function(){return this.serviceUrl.slice(0,-12)},u.prototype.bc=function(n){return this.getSurveyWebOwnerServiceUrl()+"admin/"+"forms('"+n+"')"},u.prototype.yc=function(n){return this.getSurveyWebOwnerServiceUrl()+"admin/RestrictedUsers/"+n},u.prototype.Sc=function(n){var t=(0,Me.kc)(n),e=t.OwnerId,r=t.OrgId,i=t.IsGroupOwner;return"".concat(this.getFormApiBaseServiceUrl(),"/").concat(r,"/").concat(i?"groups":"users","/").concat(e,"/forms('").concat(n,"')/")},u.prototype._c=function(n,t){void 0===t&&(t=!1);var e=(0,Me.kc)(n),r=e.OwnerId,i=e.OrgId,o=e.IsGroupOwner;return"".concat(this.getFormApiBaseServiceUrl(),"/").concat(i,"/").concat(o?"groups":"users","/").concat(r,"/forms('").concat(n,"')/notificationsettings")},u.prototype.Tc=function(n,t){var e=(0,p.pi)({},t);return e.InvitationList&&(e.InvitationList=JSON.stringify(e.InvitationList)),e},u.prototype.getNotificationSettings=function(n){return this.sendRequest({requestUri:this._c(n),method:"GET",qosEventName:"SmartNotification.GetNotificationSettings"}).then((function(n){return n.InvitationList&&(n.InvitationList=(0,Le.d)(n.InvitationList)),n})).catch((function(){return null}))},u.prototype.updateNotificationSettings=function(n,t){return this.sendRequest({requestUri:this._c(n),method:"PATCH",qosEventName:"SmartNotification.PatchNotificationSettings",data:this.Tc(n,t)})},u.prototype.createNotificationSettings=function(n,t){return this.sendRequest({requestUri:this._c(n,!0),method:"POST",qosEventName:"SmartNotification.PostNotificationSettings",data:this.Tc(n,t)})},u}(n)}var Ir,yr=function(){function n(){}return n.prototype.getMixinFormApi=function(){return n.FormApiClass||(n.FormApiClass=wr(rr)),n.FormApiClass},n}();!function(n){n[n.NotStarted=0]="NotStarted",n[n.Loading=1]="Loading",n[n.Loaded=2]="Loaded",n[n.Failed=3]="Failed"}(Ir||(Ir={}));var Sr=e(61634),Fr={Action:ke.J4.reference(),AllFormList:ke.J4.collectionOf(ke.J4.reference()),AllFormListLoadState:ke.J4.reference(),AllSharedFormList:ke.J4.collectionOf(ke.J4.reference()),Analysis:ke.J4.boolean(),BranchingElementId:ke.J4.string(),CdsInfoAvailableInUrl:ke.J4.boolean(),CdsList:ke.J4.reference(),CdsValidationMap:ke.J4.reference(),CopyFormId:ke.J4.string(),CriticalError:ke.J4.reference(),CurrentProject:ke.J4.reference(),CustomerVoiceDefaultEmailTemplates:ke.J4.reference(),CustomerVoiceDefaultETsLoadState:ke.J4.reference(),CustomerVoiceEmailTemplates:ke.J4.reference(),CustomerVoiceView:ke.J4.reference(),AllProjects:ke.J4.reference(),AlertRules:ke.J4.reference(),SMList:ke.J4.reference(),ProjectMetrics:ke.J4.reference(),FilterObj:ke.J4.reference(),CurrentAggregateThemeList:ke.J4.reference(),DataIdeas:ke.J4.boolean(),DefaultCdsId:ke.J4.string(),DefaultCdsInfoLoadState:ke.J4.reference(),DefaultCdsUrl:ke.J4.string(),DelegateInactiveUser:ke.J4.reference(),EnvironmentListLoadState:ke.J4.reference(),ErrorBarMessage:ke.J4.string(),ErrorLevel:ke.J4.reference(),ExecuteDownloadExcel:ke.J4.boolean(),ExperienceType:ke.J4.reference(),FlexPane:ke.J4.reference(),ForceDesktopView:ke.J4.boolean(),FormCollectionType:ke.J4.reference(),FormId:ke.J4.string(),FormList:ke.J4.collectionOf(ke.J4.reference()),FormListLoadState:ke.J4.reference(),FormMaster:ke.J4.reference(),FormsProToken:ke.J4.string(),FormsTenantSettings:ke.J4.reference(),Grading:ke.J4.reference(),GroupMaster:ke.J4.reference(),GroupMruFormListLoadState:ke.J4.reference(),Host:ke.J4.string(),InfoBarMessageType:ke.J4.string(),IntelligenceSuggestionStatus:ke.J4.reference(),IsDefaultCds:ke.J4.boolean(),LastActiveTime:ke.J4.number(),LastUsedEnv:ke.J4.reference(),Locale:ke.J4.string(),MeetingInfo:ke.J4.reference(),pendingCalls:ke.J4.reference(),PlaceholderList:ke.J4.collectionOf(ke.J4.reference()),PopupDialog:ke.J4.reference(),Preview:ke.J4.reference(),PreviousFlexPane:ke.J4.reference(),RecycleBin:ke.J4.collectionOf(ke.J4.reference()),RelativeScrolHeight:ke.J4.number(),ResponsePipeData:ke.J4.reference(),Scenario:ke.J4.string(),SearchContent:ke.J4.string(),SectionElementId:ke.J4.string(),SelectedCdsId:ke.J4.string(),SelectedCdsRegion:ke.J4.string(),SelectedCdsUrl:ke.J4.string(),SelectedPortalForm:ke.J4.reference(),SenderList:ke.J4.reference(),SharedWithMeFormList:ke.J4.collectionOf(ke.J4.reference()),SharedWithMeFormListLoadState:ke.J4.reference(),SharingToken:ke.J4.string(),ShouldDisableAllClick:ke.J4.boolean(),ShowBlockUsingFormsWarningPage:ke.J4.boolean(),ShowExcelSurveyIntroductionDialog:ke.J4.boolean(),ShowGroupListInPortal:ke.J4.boolean(),ShowShimmer:ke.J4.boolean(),ShowXLUnsyncedDialog:ke.J4.boolean(),Store:ke.J4.boolean(),TenantCountryCode:ke.J4.string(),Title:ke.J4.string(),Token:ke.J4.string(),TopView:ke.J4.reference(),UserActivities:ke.J4.reference(),ValidationChecked:ke.J4.reference(),XlWorkbookId:ke.J4.string(),SurveyReportId:ke.J4.string(),ResponseList:ke.J4.reference(),LastPageIndex:ke.J4.number(),Designer:ke.J4.boolean(),DesignerCalloutType:ke.J4.reference(),RandomizationCalloutType:ke.J4.reference(),SidePaneVisible:ke.J4.boolean(),NavPanelOpen:ke.J4.boolean(),CurrentAlert:ke.J4.reference(),CurrentAlertlist:ke.J4.reference(),ShowCVSimplifiedEditor:ke.J4.string(),OpenBranchingPanel:ke.J4.boolean(),isAllProjectListLoaded:ke.J4.boolean(),AddSimplifiedLogic:ke.J4.reference(),RespondentList:ke.J4.reference(),ResponseMap:ke.J4.reference(),ResponseCount:ke.J4.number(),FilteredResponseCount:ke.J4.number(),DeletedResponseCount:ke.J4.number(),UserTenantLevelSetting:ke.J4.reference(),UserCVLicense:ke.J4.boolean()},Cr=function(n){function t(){var t=n.call(this)||this;return t.Pc=t.Pc.bind(t),t.bulkEdit((function(){var n=t.Model;n.Analysis=!1,n.BranchingElementId=null,n.IntelligenceSuggestionStatus={QuestionSuggestion:"Default",ThemeSuggestion:"Default",EstimatedTime:"Default"},n.DataIdeas=!1,n.IntelligeceQuestionSuggestionStatus="Default",n.PopupDialog="None",n.Store=!1,n.Grading=null,n.FormListLoadState="NotStarted",n.SharedWithMeFormListLoadState="NotStarted",n.GroupMruFormListLoadState="NotStarted",n.FormCollectionType="OwnedForms",n.MeetingInfo=null,n.SectionElementId=null,t.Model.LastActiveTime=Date.now(),(0,P.md)((function(){n.CdsList=[],n.FirstLoading=!0,n.SelectedCdsId=null,n.CdsInfoAvailableInUrl=!1,n.LastUsedEnv=null,n.CdsValidationMap={},n.IsDefaultCds=!0,n.AllFormListLoadState="NotStarted",n.DefaultCdsInfoLoadState="NotStarted",n.DefaultCdsId="",n.DefaultCdsUrl="",n.TenantCountryCode="",n.ValidationChecked="Pending",n.ResponsePipeData=[],n.UserActivities=[],n.Project=null,n.ShowShimmer=!0,n.CustomerVoiceView=Sr.eG.Home,n.CustomerVoiceDefaultEmailTemplates=[],n.CustomerVoiceDefaultETsLoadState=Ir.NotStarted,n.CustomerVoiceEmailTemplates=[],n.SurveyReportId=null,n.ResponseList=[],n.TextResponseList=[],n.LastPageIndex=0,n.Designer=!0,n.DesignerCalloutType="LeftNavigation",n.RandomizationCalloutType="RandomizationInitialTeachingDialog",n.SidePaneVisible=!!(0,D.cr)("CVHighCharts"),n.NavPanelOpen=!1,n.CurrentAlert=null,n.CurrentAlertList=[],n.CurrentAggregateThemeList=[],n.ShowCVSimplifiedEditor=null,n.OpenBranchingPanel=!1,n.AddSimplifiedLogic="None",n.RespondentList=[],n.TextRespondentList=[],n.ResponseMap=new Map,n.TextResponseMap=new Map,n.ResponseCount=0,n.FilteredResponseCount=0,n.DeletedResponseCount=0,n.isAllProjectListLoaded=!1})),n.CopyFormId=null,n.SharingToken=null,n.FormsTenantSettings={bingImageSearch:!1,externalCollaboration:!0,externalSendForm:!0,externalShareCollaboration:!0,externalShareResult:!0,externalShareTemplate:!0,InOrgSurveyIncentive:!0,recordIdentityByDefault:!0,OverSurveyManagement:!1,OverSurveyManagementDays:0,allowRecordIdentity:!0,allowFileUpload:!0,RestrictSurveyAccessEnabled:!1}})),t.Nc(),t}return(0,p.ZT)(t,n),t.getInstance=function(){return this.instance||(this.instance=new t),this.instance},t.prototype.Nc=function(){var n=this;["mousedown","keydown","touchstart"].forEach((function(t){return document.addEventListener(t,n.Pc,!0)}))},t.prototype.Pc=function(){var n=Date.now();this.Model.LastActiveTime<n-1e3&&(this.Model.LastActiveTime=Date.now())},t}(U.d.createObjectMasterClass("DesignPageUxState",Fr)),_r=e(25366),Tr=e(90819),Pr=e(3920),Nr={Action:ke.J4.reference(),Analysis:ke.J4.boolean(),BottomView:ke.J4.reference(),DesignerView:ke.J4.reference(),CopyFormId:ke.J4.string(),CriticalError:ke.J4.reference(),ErrorBarMessage:ke.J4.string(),ErrorLevel:ke.J4.reference(),FormCollectionType:ke.J4.reference(),FormId:ke.J4.string(),FormList:ke.J4.collectionOf(ke.J4.reference()),FormListLoadState:ke.J4.reference(),FormMaster:ke.J4.reference(),FormsTenantSettings:ke.J4.reference(),InfoBarMessageType:ke.J4.string(),LastActiveTime:ke.J4.number(),Locale:ke.J4.string(),QuestionId:ke.J4.string(),QuestionInDesign:ke.J4.reference(),SelectedPortalForm:ke.J4.reference(),SharingToken:ke.J4.string(),ShouldDisableAllClick:ke.J4.boolean(),ShowHeadBar:ke.J4.boolean(),ShowSavingSpinner:ke.J4.boolean({IsLocalField:!0}),SurveyResults:ke.J4.boolean(),Title:ke.J4.string(),Token:ke.J4.string()},kr=function(n){function t(){var t=n.call(this)||this;return t.Pc=t.Pc.bind(t),t.bulkEdit((function(n){n.Action="None",n.BottomView="None",n.DesignerView="None",n.FormListLoadState="NotStarted",n.FormCollectionType="OwnedForms",n.QuestionId=null,n.ShowHeadBar=!0,n.ShowSavingSpinner=!1,t.Model.LastActiveTime=Date.now(),n.FormsTenantSettings={bingImageSearch:!1,externalCollaboration:!0,externalSendForm:!0,externalShareCollaboration:!0,externalShareResult:!0,externalShareTemplate:!0,InOrgSurveyIncentive:!0,recordIdentityByDefault:!0,OverSurveyManagement:!1,OverSurveyManagementDays:0,allowRecordIdentity:!0,allowFileUpload:!0,RestrictSurveyAccessEnabled:!1}})),t.addRule({InterestedFields:[t.Schema.FormMaster],Name:"ClearRouting",onChange:function(n){t.Model.FormMaster||t.Ec()}}),t.addRule({InterestedFields:[t.Schema.QuestionInDesign],Name:"DesignQuestion",onChange:function(n){t.Model.QuestionInDesign?t.Model.QuestionId=t.Model.QuestionInDesign.Model.Id:t.Model.QuestionId=null}}),t.Nc(),t}return(0,p.ZT)(t,n),t.getInstance=function(){return this.instance||(this.instance=new t),this.instance},t.prototype.Ec=function(){var n=this;this.bulkEdit((function(){var t=n.Model;t.FormMaster=void 0,t.Analysis=!1,t.BottomView="None",t.DesignerView="None",t.QuestionId=null,t.ShowHeadBar=!0,t.SurveyResults=!1}))},t.prototype.Nc=function(){var n=this;["mousedown","keydown","touchstart"].forEach((function(t){return document.addEventListener(t,n.Pc,!0)}))},t.prototype.Pc=function(){var n=Date.now();this.Model.LastActiveTime<n-1e3&&(this.Model.LastActiveTime=Date.now())},t}(U.d.createObjectMasterClass("MobileDesignPageUxState",Nr)),Er=e(40554),Rr=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return(0,p.ZT)(t,n),t.prototype.render=function(){var n={ButtonsProps:[{ClassName:"upload-question-cancel-continue-button",ConveyDescription:!0,GlyphButtonStyle:"Horizontal",Key:"deleteItem",onClick:this.props.clickContinueButton,Text:(0,S.pm)().UploadFile_Dialog_Continue_Button,Title:(0,S.pm)().UploadFile_Dialog_Continue_Text}],ClassName:"upload-question-button-container",Description:this.props.description,FluentIcon:"Folder",IconClassName:"forms-icon-size36x36 upload-question-icon-class",ShowDialog:!0,TrapFocus:!1};return h.createElement("div",{className:"upload-question-confirm-dialog"},(0,Er.s)(n))},t}(C.r);function Or(n){return function(n){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=n.apply(this,t)||this;return r.initializing?r.initializing.resolve():(0,H.$U)("ResponsePage.FormMasterMixin.initializing.undefined",{formMasterAttrs:Object.keys(r),isBasicLoaded:!(!window.$||!window._)}),r}return(0,p.ZT)(t,n),t}(n)}var Dr=e(48333);var xr,Lr=e(41293),Mr=e(41350),qr=e(46008);function Ar(){return xr||(xr=new Ur)}var Ur=function(){function n(){this.Rc=new Mr.Y,this.Oc={}}return n.isValidUser=function(n){return!!(n&&n.userId&&n.displayName)},n.prototype.registerUsersStateChange=function(n){this.Rc.register(n)},n.prototype.unregisterUsersStateChange=function(n){this.Rc.unregister(n)},n.prototype.getUser=function(n){return w.clone(this.Oc[n])},n.prototype.getAllUsers=function(){return w.values((0,qr.I8)(this.Oc))},n.prototype.getUserCount=function(){return w.keys(this.Oc).length},n.prototype.addOrUpdateUser=function(t){if(n.isValidUser(t)){var e=this.Oc[t.userId];if(null!=e){if(n.isValidUser(e))return;w.extend(e,t)}else this.Oc[t.userId]=t;this.Rc.trigger()}},n.prototype.removeUser=function(n){delete this.Oc[n.userId]&&this.Rc.trigger()},n.prototype.removeAllUsers=function(){this.getUserCount()>0&&(this.Oc={},this.Rc.trigger())},n}(),Vr=e(63795),Gr=e(20987),Br=e(61018),zr=function(){function n(){this.Dc={}}return n.createNotificationProvider=function(t,e,r){return this.notificationProvider||(this.notificationProvider=new n),this.notificationProvider},n.prototype.close=function(n){this.Dc[n]&&(this.Dc[n].close(),delete this.Dc[n])},n.prototype.open=function(n,t){if(!n)return Promise.reject("PushNotification has no formId.");this.close(n);var e=(0,Me.kc)(n);return this.xc(n,t,e)},n.prototype.xc=function(n,t,e,r){return this.Dc[n]=new jr(Br.VY.getInstance().getCollabDBServiceUrl(),e.OrgId,e.OwnerId,e.TableId,e.IsGroupOwner,e.ContainerId,r),this.Dc[n].open(t)},n}(),jr=function(){function n(n,t,e,r,i,o,u){this.Lc=(0,A.GW)(),this.Mc=!0,this.qc=null,this.Uc=0,this.Vc=Qr.MaxRetryCount;var s=(0,Vr.Ee)(n,"/");u&&(s=Qr.ComposedCDBRealtimeSliceFormat.format(u,s)),this.Gc=!1;var a=(0,nt.vj)("RealtimeAzureConnectionPercentage",0);if(a>=0&&a<=100){var c=this.Bc(e+r);this.Gc=Math.abs(c)%100<a}this.Gc?this.zc=(i?Qr.CDBRealtimeAzureUrlForGroupsFormat:Qr.CDBRealtimeAzureUrlForUsersFormat).format(s,t,e,r):this.zc=(i?Qr.CDBRealtimeUrlForGroupsFormat:Qr.CDBRealtimeUrlForUsersFormat).format(s,t,e,r),this.jc=o}return n.prototype.reconnect=function(){this.qc.stop(),this.qc.start()},n.prototype.close=function(){var n=this;this.Mc=!0;var t=function(){4!==n.qc.state&&n.Qc(Qr.UserHubName,Qr.Leave).finally((function(){n.qc.stop(!0,!0)}))};null!=this.qc&&(0===this.qc.state||2===this.qc.state?this.qc.stateChanged(t):t())},n.prototype.open=function(n){var t,e=this;return this.Hc(this.zc),(n=w.clone(n)).onFormUpdated&&this.$c(Qr.TableDefinitionHubName,Qr.TableUpdated,(function(t,e){n.onFormUpdated(Hr.toFormUpdatePayload(e),Hr.toUserPayload(e._modifiedBy))})),n.onFormElementAdded&&this.$c(Qr.TableDefinitionHubName,Qr.ColumnAdded,(function(t,e){"Comments"!==t.propertyName&&"ReleaseDate"!==t.propertyName&&"FormsProData"!==t.propertyName&&n.onFormElementAdded(Hr.toFormElementPayload(e),Hr.toUserPayload(e._modifiedBy))})),n.onFormElementDeleted&&this.$c(Qr.TableDefinitionHubName,Qr.ColumnDeleted,(function(t,e){n.onFormElementDeleted(t.propertyName,Hr.toUserPayload(e._modifiedBy))})),n.onFormElementUpdated&&this.$c(Qr.TableDefinitionHubName,Qr.ColumnUpdated,(function(t,e){n.onFormElementUpdated(t.propertyName,Hr.toFormElementUpdatePayload(e),Hr.toUserPayload(e._modifiedBy))})),n.onChoiceAdded&&this.$c(Qr.TableDefinitionHubName,Qr.ChoiceAdded,(function(t,e){n.onChoiceAdded(t.propertyName,Hr.toChoicePayload(t,e),Hr.toUserPayload(e._modifiedBy))})),n.onChoiceDeleted&&this.$c(Qr.TableDefinitionHubName,Qr.ChoiceDeleted,(function(t,e){n.onChoiceDeleted(t.propertyName,t.choiceId,Hr.toUserPayload(e._modifiedBy))})),n.onChoiceUpdated&&this.$c(Qr.TableDefinitionHubName,Qr.ChoiceUpdated,(function(t,e){n.onChoiceUpdated(t.propertyName,t.choiceId,Hr.toChoicePayload(t,e),Hr.toUserPayload(e._modifiedBy))})),n.onResponseAdded&&this.$c(Qr.TableDataHubName,Qr.RowAdded,(function(t,e){n.onResponseAdded(Hr.toResponsePayload(e))})),n.onResponseDeleted&&this.$c(Qr.TableDataHubName,Qr.RowDeleted,(function(t,e){n.onResponseDeleted(Number(t._id),{modifiedBy:Hr.toUserPayload(e._modifiedBy),modifiedDateTime:new Date(e._modifiedBy.ModifiedDateTime)})})),n.onResponsesAllDeleted&&this.$c(Qr.TableDataHubName,Qr.RowsAllDeleted,(function(t,e){n.onResponsesAllDeleted({modifiedBy:Hr.toUserPayload(e._modifiedBy),modifiedDateTime:new Date(e._modifiedBy.ModifiedDateTime)})})),n.onResponseUpdated&&this.$c(Qr.TableDataHubName,Qr.RowUpdated,(function(t,e){n.onResponseUpdated(Number(t._id),Hr.toResponseUpdatePayload(e))})),n.onCommentAdded&&this.$c(Qr.TableDataHubName,Qr.RelatedRecordAdded,(function(t,e,r){Hr.isCommentPayload(t)&&n.onCommentAdded(Number(t.rowId),Hr.toCommentPayload(r),{modifiedBy:Hr.toUserPayload(e.modifiedBy),modifiedDateTime:new Date(e.modifiedDateTime)})})),n.onCommentDeleted&&this.$c(Qr.TableDataHubName,Qr.RelatedRecordDeleted,(function(t,e,r){Hr.isCommentPayload(t)&&n.onCommentDeleted(Number(t.rowId),Number(t.id),{modifiedBy:Hr.toUserPayload(e.modifiedBy),modifiedDateTime:new Date(e.modifiedDateTime)})})),n.onLocaleResourceAdded&&this.$c(Qr.TableDefinitionHubName,Qr.LocaleResourceAdded,(function(t,r){if(r){var i=r.localeResources;i.forEach((function(n){n.elementKey=e.Wc(n.elementKey)})),n.onLocaleResourceAdded(i,Hr.toUserPayload(r._modifiedBy))}})),n.onLocaleResourceUpdated&&this.$c(Qr.TableDefinitionHubName,Qr.LocaleResourceUpdated,(function(t,r){if(r){var i=w.clone(r);delete i._modifiedBy,i.elementKey=e.Wc(i.elementKey),n.onLocaleResourceUpdated(i,Hr.toUserPayload(r._modifiedBy))}})),n.onLocaleResourceDeleted&&this.$c(Qr.TableDefinitionHubName,Qr.LocaleResourceDeleted,(function(t,e){e&&n.onLocaleResourceDeleted(e,Hr.toUserPayload(e._modifiedBy))})),n.onUserConnected&&this.$c(Qr.UserHubName,Qr.UserConnected,(function(t,e){n.onUserConnected(Hr.toUserPayload(t))})),n.onUserDisconnected&&this.$c(Qr.UserHubName,Qr.UserDisconnected,(function(t,e){n.onUserDisconnected(Hr.toUserPayload(t))})),this.$c(Qr.TableDefinitionHubName,Qr.ForceReconnect,(function(){e.reconnect()})),this.qc.starting((function(){(0,H.RF)("DataProvider.RealtimeClient.Connection.Starting",{clientId:e.getClientId(),connectionId:e.qc.id,host:(0,M.Lp)(e.zc),azureSignalr:e.Gc})})),this.qc.connectionSlow((function(){(0,H.RF)("DataProvider.RealtimeClient.Connection.Slow",{clientId:e.getClientId(),connectionId:e.qc.id,host:(0,M.Lp)(e.zc),azureSignalr:e.Gc}),n.onConnectionSlow&&n.onConnectionSlow()})),this.qc.error((function(r){(0,H.RF)("DataProvider.RealtimeClient.Connection.Error",{clientId:e.getClientId(),connectionId:e.qc.id,host:(0,M.Lp)(e.zc),azureSignalr:e.Gc,error:e.Jc(r)}),t={errorObject:r},n.onConnectionError&&n.onConnectionError(r)})),this.qc.reconnecting((function(){(0,H.RF)("DataProvider.RealtimeClient.Connection.Reconnecting",{clientId:e.getClientId(),connectionId:e.qc.id,host:(0,M.Lp)(e.zc),azureSignalr:e.Gc}),n.onConnectionReconnecting&&n.onConnectionReconnecting()})),this.qc.reconnected((function(){(0,H.RF)("DataProvider.RealtimeClient.Connection.Reconnected",{clientId:e.getClientId(),connectionId:e.qc.id,host:(0,M.Lp)(e.zc),azureSignalr:e.Gc}),n.onConnectionReconnected&&n.onConnectionReconnected(void 0)})),this.qc.disconnected((function(){if((0,H.RF)("DataProvider.RealtimeClient.Connection.Disconnected",{clientId:e.getClientId(),connectionId:e.qc.id,remainingRetryCount:e.Vc,host:(0,M.Lp)(e.zc),azureSignalr:e.Gc,lastError:t&&e.Jc(t.errorObject)}),e.Vc-- >0){e.Uc++;var r={reconnectingCount:e.Uc,refreshToken:t&&t.errorObject&&t.errorObject.context&&401===t.errorObject.context.status,retryCount:Qr.MaxRetryCount-e.Vc,onSuccess:n.onConnectionReconnected,onError:n.onConnectionFailed};e.Xc(r).then((function(){t=void 0})).catch((function(){}))}else(0,H.RF)("DataProvider.RealtimeClient.Connection.Failed",{clientId:e.getClientId(),connectionId:e.qc.id,lastError:t&&e.Jc(t.errorObject),host:(0,M.Lp)(e.zc),azureSignalr:e.Gc}),n.onConnectionDisconnected&&n.onConnectionDisconnected()})),(0,Gr.Au)()&&(this.qc.logging=!0,this.qc.received((function(n){var t=new Date;console.log("[%s] %s: Received message: {%s}",t.toTimeString(),e.Lc,JSON.stringify(n))}))),this.Mc=!1,this.Xc({onSuccess:n.onConnectionStarted,onError:n.onConnectionFailed})},n.prototype.getClientId=function(){return this.Lc},n.prototype.Bc=function(n){return n.split("").reduce((function(n,t){return(n<<5)-n+t.charCodeAt(0)|0}),0)},n.prototype.Wc=function(n){switch(n){case"thankyoumessage":return"thankYouMessage";case"formclosemessage":return"formCloseMessage";case"leftdescription":return"leftDescription";case"rightdescription":return"rightDescription";case"formsprortlocaleldescription":return"formsprortlocaleldescription";case"formsprortlocalerdescription":return"formsprortlocalerdescription";case"formsprocustomplaceholder":return"formsprocustomplaceholder";case"footertext":return"footerText";case"conditionalthankyoumessage":return"conditionalThankyouMessage";default:return n}},n.prototype.Hc=function(n){this.qc=$.hubConnection(n,{useDefaultPath:!1}),this.qc.createHubProxy(Qr.TableDefinitionHubName),this.qc.createHubProxy(Qr.TableDataHubName),this.qc.createHubProxy(Qr.UserHubName),this.qc.qs={},this.Yc()},n.prototype.Zc=function(n){if(null==this.qc)throw Error("Realtime connection has not been created yet.");var t=this.qc.proxies[n.toLocaleLowerCase()];if(null==t)throw Error("Cannot find hub proxy {0}".format(n));return t},n.prototype.nf=function(n){var t=this;return Br.VY.getInstance().createDataProvider().getCdbToken().then((function(n){var e=n,r="Bearer ";e&&e.startsWith(r)&&(e=e.substring(r.length)),t.qc.accessToken=e}))},n.prototype.Yc=function(){this.jc&&"0"!==this.jc&&(this.qc.qs=(0,p.pi)((0,p.pi)({},this.qc.qs),{ContainerId:this.jc}))},n.prototype.Qc=function(n,t){for(var e,r=this,i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];if(this.tf()){var u=new qe.o("Connection.InvokeRemoteMethod");return u.start(),(0,ut.Px)((e=this.Zc(n)).invoke.apply(e,(0,p.ev)([t],i,!1))).then((function(n){return u.end({resultType:"Success",extraData:{clientId:r.getClientId(),connectionId:r.qc.id,host:(0,M.Lp)(r.zc),azureSignalr:r.Gc,methodName:t}}),n}),(function(n){return u.end({resultType:r.tf()?"Failure":"ExpectedFailure",extraData:{clientId:r.getClientId(),connectionId:r.qc.id,host:(0,M.Lp)(r.zc),azureSignalr:r.Gc,methodName:t,error:r.Jc(n)}}),n}))}return Promise.reject("Realtime connection has not been established yet.")},n.prototype.tf=function(){return null!=this.qc&&1===this.qc.state},n.prototype.$c=function(n,t,e){e&&this.Zc(n).on(t,e)},n.prototype.Jc=function(n){return n&&JSON.stringify(n,["message","description","transport"])},n.prototype.Xc=function(n){var t=this;if(this.Mc)return Promise.reject("Connection disposed");var e=new Promise((function(e,r){var i=new qe.o("Connection.ConnectToCDBSignalR"),o=function(){i.end({resultType:"Success",extraData:{clientId:t.getClientId(),connectionId:t.qc.id,host:(0,M.Lp)(t.zc),azureSignalr:t.Gc,reconnectingCount:n.reconnectingCount,retryCount:n.retryCount}}),t.Vc=Qr.MaxRetryCount,t.Qc(Qr.UserHubName,Qr.Join),t.Qc(Qr.UserHubName,Qr.GetActiveUsers).then((function(n){e(n)}),(function(n){r(n)}))},u=function(e){i.end({resultType:"Failure",extraData:{clientId:t.getClientId(),connectionId:t.qc.id,host:(0,M.Lp)(t.zc),azureSignalr:t.Gc,reconnectingCount:n.reconnectingCount,retryCount:n.retryCount,connectionError:e.source?t.Jc(e):void 0,serviceError:e.source?void 0:JSON.stringify(e,["message","statusCode","statusText","innerCode"])}}),r(e)};i.start(),t.nf(n.refreshToken).then((function(){return t.qc.start().then(o,u)}),(function(n){u(n),(0,H.RF)("DataProvider.RealtimeClient.Connection.Failed",{clientId:t.getClientId(),connectionId:t.qc.id,host:(0,M.Lp)(t.zc),azureSignalr:t.Gc,lastError:t.Jc(n)})}))}));return n.onSuccess&&e.then((function(t){return n.onSuccess(t)})),n.onError&&e.catch((function(t){return n.onError(t)})),e},n}(),Qr=function(){function n(){}return n.TableDefinitionHubName="TableDefinitionChangeHub",n.TableDataHubName="TableChangeHub",n.UserHubName="TableActivityHub",n.TableUpdated="tableDefinitionUpdated",n.ColumnAdded="columnDefinitionAdded",n.ColumnDeleted="columnDefinitionDeleted",n.ColumnUpdated="columnDefinitionUpdated",n.ChoiceAdded="choiceAdded",n.ChoiceUpdated="choiceUpdated",n.ChoiceDeleted="choiceDeleted",n.RowAdded="rowAdded",n.RowDeleted="rowDeleted",n.RowsAllDeleted="rowsAllDeleted",n.RowUpdated="rowUpdated",n.RelatedRecordAdded="relatedRecordAdded",n.RelatedRecordDeleted="relatedRecordDeleted",n.LocaleResourceAdded="localeResourceAdded",n.LocaleResourceUpdated="localeResourceUpdated",n.LocaleResourceDeleted="localeResourceDeleted",n.ForceReconnect="forceReconnect",n.UserConnected="userConnected",n.UserDisconnected="userDisconnected",n.GetActiveUsers="GetActiveUsers",n.Join="Join",n.Leave="Leave",n.MaxRetryCount=3,n.ComposedCDBRealtimeSliceFormat="{0}.{1}:797",n.ComposedCDBRealtimeAzureSliceFormat="{0}.{1}:779",n.CDBRealtimeUrlForUsersFormat="https://{0}/realtime/beta/{1}/users/{2}/tables/{3}/$notifications",n.CDBRealtimeUrlForGroupsFormat="https://{0}/realtime/beta/{1}/groups/{2}/tables/{3}/$notifications",n.CDBRealtimeAzureUrlForUsersFormat="https://{0}/realtimeazure/beta/{1}/users/{2}/tables/{3}/$azurenotifications",n.CDBRealtimeAzureUrlForGroupsFormat="https://{0}/realtimeazure/beta/{1}/groups/{2}/tables/{3}/$azurenotifications",n}(),Hr=function(){function n(){}return n.toFormUpdatePayload=function(t){return t&&n.normalize({id:void 0,tableId:t.id,title:t.displayName,createdBy:t.createBy,modifiedDate:t.dateTimeLastUpdated,description:t.description,settings:t.formSettings,otherInfo:t.otherInfo,questions:void 0,header:n.toImagePayload(t.header),logo:n.toImagePayload(t.logo),background:n.toImagePayload(t.background),thankYouMessage:t.thankYouMessage,version:t.version,xlWorkbookId:t.xlWorkbookId,xlExportingTag:t.xlExportingTag,xlFileUnSynced:t.xlFileUnSynced,xlUnsyncedReason:t.xlUnsyncedReason,permissionTokens:n.toPermissionTokenPayload(t.permissionTokens),onlineSafetyLevel:t.onlineSafetyLevel,reputationTier:n.toReputationTier(t.onlineSafetyLevel),formsProRTTitle:t.formsProRTTitle,formsProRTDescription:t.formsProRTDescription})},n.toFormElementPayload=function(t){return t&&{id:t.propertyName,title:t.description||t.title||t.displayName,defaultValue:t.defaultValue,subtitle:t.subtitle,required:t.required,type:t.questionType,questionInfo:t.questionInfo,order:t.order,version:void 0,modifiedDate:t.questionModifiedDate,status:t.status,image:n.toImagePayload(t.image),isQuiz:t.isQuiz,titleHasPhishingKeywords:t.titleHasPhishingKeywords,subtitleHasPhishingKeywords:t.subtitleHasPhishingKeywords,formsProRTQuestionTitle:t.formsProRTQuestionTitle,formsProRTSubtitle:t.formsProRTSubtitle,choices:t.choices,groupId:t.columnGroupName,fileUploadSPOInfo:t.fileUploadSPOInfo&&JSON.parse(t.fileUploadSPOInfo),questionTagForIntelligence:t.questionTagForIntelligence,insightsInfo:t.insightsInfo,isFromSuggestion:t.isFromSuggestion}},n.toChoicePayload=function(t,e){return e&&n.normalize({id:t.choiceId,customProperties:e.customProperties,description:e.description,displayText:e.displayText,formsProDisplayRTText:e.formsProDisplayRTText,key:e.key,order:e.order})},n.toFormElementUpdatePayload=function(t){return n.normalize(n.toFormElementPayload(t))},n.toUserPayload=function(n){return{userId:n.Id||n.userId,displayName:n.DisplayName||n.displayName,firstName:n.FirstName||n.firstName,lastName:n.LastName||n.lastName,email:n.Email||n.email}},n.toImagePayload=function(n){return n?null==n.ResourceId||null!=n.ResourceUrl?{altText:n.AltText,contentType:n.ContentType,fileIdentifier:n.FileIdentifier,originalFileName:n.OriginalFileName,resourceId:n.ResourceId,resourceUrl:n.ResourceUrl}:void(0,H.zU)("InvalidCdbImagePayload"):n},n.toPermissionTokenPayload=function(n){return n?JSON.parse(n).map((function(n){return{principalId:n.PrincipalId,name:n.Name,type:n.Type}})):n},n.toResponsePayload=function(t){return null==t?t:{id:null==t._id?void 0:Number(t._id),startDate:t.StartDate,submitDate:t.SubmitDate,responder:t.Responder,responderName:t.ResponderName,answers:n.toAnswers(t),quizResult:void 0,releaseDate:t.ReleaseDate}},n.toAnswers=function(n){var t=w.difference(Object.keys(n).filter((function(n){return"_"!==n[0]})),["SubmitDate","ResponderName","Responder","StartDate","Comments_comments","Comments","ReleaseDate"]);return JSON.stringify(t.map((function(t){return{questionId:t,answer1:n[t]}})))},n.toResponseUpdatePayload=function(t){var e=n.normalize(n.toResponsePayload(t));return delete e.answers,e},n.isCommentPayload=function(n){return n&&"Comments_comments"===n.propertyName},n.toCommentPayload=function(t){return t&&{id:t.id,feedback:t.text,score:t.number,questionId:t.columnReference,createdDateTime:t.createdDateTime,createdBy:n.toUserPayload(t.createdBy)}},n.toReputationTier=function(n){return 0===n?1:80&n?4:8&n?0:2&n||16&n?3:128&n?2:1},n.normalize=function(n){var t=n;for(var e in t)void 0===t[e]&&delete t[e];return t},n}(),$r=e(73293),Wr=e(93271),Jr=e(91091);var Kr=e(687);function Xr(n,t,e,r){return void 0===e&&(e="GET"),void 0===r&&(r=null),(0,ln.d6)((function(i){var o={body:r,headers:{Authorization:i,"Content-Type":"application/json"},isSensitiveUri:!0,method:e,qosEventName:ln.WW+t,requestUri:n};return(0,Ge.lW)(o,{disableLog:!0,disableXMsHeader:!0,skipExpiredTokenCheck:!0})})).then((function(n){return(0,Le.d)(n)}))}var Yr=e(81380),Zr=e(66097),ni=e(82205),ti=e(79849);function ei(n){return function(n){function t(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var i=n.apply(this,e)||this;return i.ef(),i.$r(),i.Model.YouTubeMessageBarState=null,t.DesignOnlyRules.forEach((function(n){return i.addRule(n)})),(0,Pr.CU)(i,Tn.x.Schema.Logo,Tn.x.Schema.LogoInfo),i}return(0,p.ZT)(t,n),t.prototype.isCurrentUserFormOwnerOrGroupMember=function(){return this.rf},t.prototype.ensureReadyToDesign=function(){var n=this;return this.ensureFieldsReady((0,Cn.E3)()).then((function(t){return null==n.rf&&n.if(),t}))},t.prototype.ensureReadyToAdminPhishingReview=function(){var n=(0,Cn.Co)();return n.push(this.Schema.CreatedBy),this.ensureFieldsReady(n)},t.prototype.reachedQuestionNumberLimitation=function(){return this.formElementManager.QuestionMasters.filter((function(n){return"Question.MatrixChoiceGroup"!=n.Model.Type})).length>=(0,Kr.gX)()},t.prototype.searchResponseById=function(n){var t=this,e={name:"id",operator:"eq",value:n};return this.Synchronizer.existingInDataSource().then((function(){return(0,Sn.aj)(t,1,0,e)})).then((function(n){return n&&n[0]}))},t.prototype.syncFormResponses=function(){var n=this;return this.responsesQueryJob&&this.responsesQueryJob.states()===ut.Cb.Pending||(this.responsesQueryJob=new ut.bC(this.Synchronizer.existingInDataSource().then((function(){var t=[Tn.x.Schema.Questions];t.push(Tn.x.Schema.Settings);var e=n.ensureFieldsReady(t);return Promise.all([(0,Sn.aj)(n),e]).then((function(t){var e=t[0];t[1];n.updatingResponsesFromServer=!0,n.bulkEdit((function(){n.Model.Responses=n.normalizeResponses(e),n.Synchronizer.onSourceDataReceived({rowCount:e.length})})),n.updatingResponsesFromServer=!1}))})))),this.responsesQueryJob.promise()},t.prototype.syncFormResponsesByPaging=function(n,t){var e=this;return this.getFormResponsesByPaging(n,t).then((function(n){e.updatingResponsesFromServer=!0,e.Model.BufferResponses=n,e.updatingResponsesFromServer=!1}))},t.prototype.getFormResponsesByPaging=function(n,t){var e=this,r=[Tn.x.Schema.Questions];r.push(Tn.x.Schema.Settings);var i=this.ensureFieldsReady(r),o=this.Synchronizer.existingInDataSource().then((function(){return(0,Sn.aj)(e,n,t)}));return Promise.all([o,i]).then((function(n){var t=n[0];n[1];return e.normalizeResponses(t)}))},t.prototype.getFormResponsesCountByAPICall=function(){var n=this;return this.Synchronizer.existingInDataSource().then((function(){return(0,Yr.rl)(n)})).then((function(t){n.Model.ResponsesCount=t}))},t.prototype.deleteAllResponses=function(){var n=this;return this.Synchronizer.existingInDataSource().then((function(){return(0,Sn._n)(n)})).then((function(){var t={Responses:[],ResponsesCount:0};n.updatingResponsesFromServer=!0,n.setData(t),n.updatingResponsesFromServer=!1}))},t.prototype.deleteBufferResponse=function(n){var t=this;return this.Synchronizer.existingInDataSource().then((function(){return(0,Sn.q4)(t.Model.Id,[n])})).then((function(){var e=U.d.getCollectionMasterFromModel(t.Model.BufferResponses),r=e.getItemWithKeyFields({Id:n});r&&t.bulkEdit((function(){e.itemsDeletedInSource([r]),--t.Model.ResponsesCount}))}))},t.prototype.resetBranchInfo=function(){this.FormElementManager.AllElementMasters.forEach((function(n){return n.resetBranchInfo()}))},t.prototype.formOwnedByMe=function(){return this.Model.OwnerId&&this.Model.OwnerId===(0,c.k0)().userInfo.UserId},t.prototype.fileUploadAnonymousDisabled=function(){return!(0,D.cr)("EnableAnonymousUploadLink")&&!!w.find(this.Model.Questions,(function(n){return"Question.FileUpload"===n.Type}))},t.prototype.$r=function(){var n=this;(0,ni.vG)(this),this.sf="Idle",this.af="Idle",this.cf="Idle",this.fieldsReady([Tn.x.Schema.Questions]).then((function(){var t=U.d.getCollectionMasterFromModel(n.Model.Questions);(0,ni.v)(t,t.Schema[0].IntegratedSavingState,(function(t){n.sf=t,n.updateIntegratedSavingState()}))})),this.fieldsReady([Tn.x.Schema.DescriptiveElements]).then((function(){var t=U.d.getCollectionMasterFromModel(n.Model.DescriptiveElements);(0,ni.v)(t,t.Schema[0].IntegratedSavingState,(function(t){n.cf=t,n.updateIntegratedSavingState()}))}));var t=U.d.getCollectionMasterFromModel(this.Model.ResponseModels);(0,ni.v)(t,t.Schema[0].IntegratedSavingState,(function(t){n.af=t,n.updateIntegratedSavingState()})),this.updateIntegratedSavingState()},t.prototype.updateIntegratedSavingState=function(){var n=this;if(this.syncBlocker.states()===ut.Cb.Pending)return this.Model.IntegratedSavingState="NotStarted",void this.syncBlocker.promise().then((function(){return n.updateIntegratedSavingState()}));var t=[this.Model.SavingState,this.sf,this.af],e=Tn.x.Schema;this.isFieldReady(e.DescriptiveElements)&&t.push(this.cf),this.isFieldReady(e.Logo)&&t.push(this.Model.Logo.SavingState),this.isFieldReady(e.Background)&&t.push(this.Model.Background.SavingState),(0,P.md)((function(){n.isFieldReady(e.HeaderBGImage)&&t.push(n.Model.HeaderBGImage.SavingState)})),this.Model.IntegratedSavingState=(0,ni.IM)(t)},Object.defineProperty(t,"DesignOnlyRules",{get:function(){if(!t.designOnlyRules){var n=Tn.x.Schema,e=U.d.getSubFieldSchemas(n).filter((function(n){return!U.d.getFieldSchemaInfo(n).Attributes.IsLocalField})),r=[n.Background.SavingState,n.Logo.SavingState,n.SavingState];(0,P.md)((function(){r=[n.Background.SavingState,n.Logo.SavingState,n.HeaderBGImage.SavingState,n.SavingState]})),t.designOnlyRules=[{Name:"IntegrateSavingState",InterestedFields:r,onChange:function(n){return n.Master.updateIntegratedSavingState()}},{Name:"Modified",InterestedFields:w.without(e,n.SoftDeleted),onChange:function(t){if(!t.BeingDeleted&&!w.contains(t.FieldSchemas,n.Modified)){var r=t.Master;if(w.contains(t.FieldSchemas,n.ModifiedDate))r.Model.Modified=r.Model.ModifiedDate;else if(r.isFieldReady(n.Modified))w.intersection(t.FieldSchemas,e).map(U.d.getFieldSchemaInfo).map((function(n){return n.Name})).some((function(n){return n in t.OldValues}))&&(r.Model.Modified=(new Date).toISOString())}}},{Name:"RowCount",InterestedFields:[n.RowCount],onChange:function(n){if(!n.BeingDeleted){var t=n.Master.Model;t.ResponsesCount=t.RowCount}}},{Name:"SerializeSettings",InterestedFields:[Tn.x.Schema.Settings],onChange:function(n){if(!n.BeingDeleted){var t=n.Master.Model;t.SerializedSettings=Zr.w.serialize(t.Settings)}}},{Name:"SerializePredefinedResponses",InterestedFields:[Tn.x.Schema.PredefinedResponses],onChange:function(n){if(!n.BeingDeleted){var t=n.Master.Model;t.SerializedPredefinedResponses=(0,Cn.eT)(t.PredefinedResponses)}}},{Name:"DeleteResponseModels",InterestedFields:[n.Responses],onChange:function(n){var t=n.Master,e=U.d.getCollectionMasterFromModel(t.Model.Responses),r=[],i=[];n.SubChanges.filter((function(n){return n.Master===e})).forEach((function(n){return n.RemovedModels.forEach((function(n){var e=t.getResponseModelById(n.Id);e?r.push(e):i.push(n.Id)}))}));var o=U.d.getCollectionMasterFromModel(t.Model.ResponseModels);t.updatingResponsesFromServer?o.itemsDeletedInSource(r):(o.deleteItems(r),(0,ti.q4)(t,i))}},{Name:"ResponsesCount",InterestedFields:[n.ResponsesCount],onChange:function(t){var e=t.Master;e.isFieldReady(n.ResponsesCount)&&-1===e.Model.ResponsesCount&&(e.Model.ResponsesCount=null)}},{Name:"ResponseModel Change",InterestedFields:[n.ResponseModels],onChange:function(n){var t=n.Master,e=U.d.getCollectionMasterFromModel(t.Model.ResponseModels),r=U.d.getCollectionMasterFromModel(t.Model.Responses);n.SubChanges.filter((function(n){return n.Master===e})).forEach((function(n){n.SubChanges.forEach((function(n){var t=w.indexOf(r.Model,n.Master.Model);t>=0&&r.markAsChanged(t)}))}))}}]}return t.designOnlyRules},enumerable:!1,configurable:!0}),t.prototype.ef=function(){this.isFieldReady(Tn.x.Schema.RowCount)&&(this.Model.ResponsesCount=this.Model.RowCount)},t.prototype.if=function(){var n,t=this;this.rf=this.Model.Permissions&&this.Model.Permissions.length<=1||!this.isGroupForm&&this.formOwnedByMe(),this.isGroupForm&&!this.rf&&(n=this.Model.OwnerId,Xr("".concat((0,yn.HA)(),"/me/checkMemberGroups"),"CheckMemberGroups","POST",'{"groupIds": ["'.concat(n,'"] }'))).then((function(n){t.rf=n.value.length>0}))},t}(n)}e(39271);var ri,ii=e(85866),oi=e(50434);!function(n){n[n.None=0]="None",n[n.MoveInProgress=1]="MoveInProgress",n[n.CvsScanAllowed=2]="CvsScanAllowed"}(ri||(ri={}));var ui=function(){function n(n,t,e,r){this.xi=n,this.lf=t,this.hf=e,this.mf=r}return Object.defineProperty(n.prototype,"Id",{get:function(){return this.xi},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"DisplayName",{get:function(){return this.lf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"UserPrincipalName",{get:function(){return this.hf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"Mail",{get:function(){return this.mf},enumerable:!1,configurable:!0}),n}();function si(n,t){return function(n,t){var e=ai[t];if(!e){var r="User"===n?(o=t,Xr("".concat((0,yn.HA)(),"/users/").concat(o),"GetUser")):(i=t,Xr("".concat((0,yn.HA)(),"/groups/").concat(i),"GetGroup"));e=Promise.resolve(r).then((function(n){return new ui(t,n.displayName,n.userPrincipalName,n.mail)})),ai[t]=e}var i;var o;return e}(n,t)}var ai={},ci=e(64966),fi=e(20469);var li=e(22617);var hi=e(84358),di=e(1014),mi=e(46211);function vi(){var n,t,e=Tn.x;return(0,P.md)((function(){e=FormsPro.ProFormsMasterMixin(Tn.x)})),n="exporting",t=3e5,e=function(e){function r(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var r=e.apply(this,n)||this;return r.observe((function(){r.ensureFieldsReady([Tn.x.Schema.XlExportingTag]).then((function(){return r.Model.XlExportingLocalTag=r.Model.XlExportingTag.toLocaleLowerCase()}))}),[Tn.x.Schema.XlExportingTag]),r}return(0,p.ZT)(r,e),r.prototype.downloadExcelFile=function(n,t){return(0,Yr.lb)(this,n,t)},r.prototype.SetToExporting=function(){var t=this;this.ensureFieldsReady([Tn.x.Schema.XlExportingLocalTag]).then((function(){t.Model.XlExportingLocalTag=n}))},r.prototype.IsExporting=function(){var e,r=this,i=0;if(this.isFieldReady(Tn.x.Schema.XlExportingLocalTag)&&this.Model.XlExportingLocalTag&&this.Model.XlExportingLocalTag.indexOf(n)>=0)try{var o=JSON.parse(this.Model.XlExportingLocalTag),u=Date.parse(o.starttime.toUpperCase());e=(i=(new Date).getTime()-u)<t}catch(n){e=!0}else e=!1;return e?this.vf=this.vf||window.setTimeout((function(){r.Model.XlExportingLocalTag="timeout"}),t-i):window.clearTimeout(this.vf),e},r.prototype.IsExportingFailed=function(){return this.Model.XlExportingLocalTag.toLocaleLowerCase().indexOf("failed")>=0},r}(e),e=function(n){return function(n){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=n.apply(this,t)||this;return r.gf=[],r.wf=Promise.resolve(),r}return(0,p.ZT)(t,n),t.prototype.startReceivingNotifications=function(){var n=this,t=Tn.x.Schema;return this.Model.RtcStatus=1,this.ensureFieldsReady([t.Id,t.OwnerId,t.OwnerTenantId,t.TableId]).then((function(){2!=n.Model.RtcStatus&&n.If()}))},t.prototype.stopReceivingNotifications=function(){var n=this;this.existingOnServerSide().then((function(){zr.createNotificationProvider(n.DataProviderType,n.Model.OwnerTenantId,n.Model.OwnerId).close(n.Model.Id),n.Model.RtcStatus=3,n.responsesQueryJob=null,Ar().removeAllUsers()}))},t.prototype.refreshFormResponsesCount=function(){var n=this;return this.Synchronizer.query([Tn.x.Schema.ResponsesCount]).then((function(){n.Model.LastSyncTime=Date.now()}))},t.prototype.yf=function(n,t){if(Ur.isValidUser(t)){var e=this.getElementById(n);e&&e.updateCoAuthors(t)}},t.prototype.If=function(){var n=this,t=zr.createNotificationProvider(this.DataProviderType,this.Model.OwnerTenantId,this.Model.OwnerId),e=0,r=Promise.resolve(),i=function(){var t=++e;r.then((function(){t===e&&(r=n.refreshFormResponsesCount())}))},o=(0,nt.vj)("GetAggregateInterval",2e4),u=!1,s=function(){u||(u=!0,window.setTimeout((function(){u=!1,n.refreshFormResponsesCount()}),o))},a=function(){n.Synchronizer.query((0,Cn.E3)())},c=(0,Yn.M5)(),f={onConnectionStarted:function(t){n.Sf(t),t&&t.length>1&&a(),n.Model.RtcStatus=2,n.Model.LastSyncTime=Date.now()},onConnectionFailed:function(t){n.Model.LastSyncTime=Date.now()},onConnectionReconnected:function(t){n.Sf(t),t&&t.length>1&&a(),n.Model.LastSyncTime=Date.now()},onConnectionDisconnected:function(){n.Model.RtcStatus=3,n.Model.LastSyncTime=Date.now()},onResponseAdded:function(t){n.bulkEdit((function(){n.Model.Settings.IsQuizMode?s():i()}))},onResponseDeleted:function(t){n.bulkEdit((function(){n.Model.Settings.IsQuizMode?s():i()}))},onResponsesAllDeleted:function(){n.bulkEdit((function(){n.Model.Settings.IsQuizMode?s():i()}))},onFormElementAdded:c?null:function(t,e){var r=n.getElementById(t.id);if(r instanceof(0,g.zE)()){var i=t;i.choices||(i.choices=[]),r.Synchronizer.onSourceDataReceived(t)}else r instanceof $r.Jv?r.Synchronizer.onSourceDataReceived(t):n.wf=(0,ut.Bx)(n.wf.then((function(){_r.H.isDescriptiveElement(t.type)?U.d.Collection.itemsAddedInSource(n.Model.DescriptiveElements,[U.d.convertFromSourceData(t,$r.Jv.Schema)]):U.d.Collection.itemsAddedInSource(n.Model.Questions,[U.d.convertFromSourceData(t,(0,g.zE)().Schema)])})));n.yf(t.id,e),n.Sf([e])},onFormElementDeleted:c?null:function(t,e){n.wf=(0,ut.Bx)(n.wf.then((function(){var e=n.getElementById(t);if(e instanceof pn.MF){var r=e.SubQuestionMasters.concat(e);U.d.Collection.itemsDeletedInSource(n.Model.Questions,r.map((function(n){return n.Model})))}else e instanceof $r.Jv&&U.d.Collection.itemsDeletedInSource(n.Model.DescriptiveElements,[e.Model])}))),n.Sf([e])},onFormElementUpdated:c?null:function(t,e,r){var i=n.getElementById(t);i&&((i instanceof pn.MF||i instanceof $r.Jv)&&i.Synchronizer.onSourceDataReceived(e),n.yf(t,r),n.Sf([r]))},onChoiceAdded:c?null:function(t,e,r){var i=n.getQuestionById(t);if(i){var o;if(e.key){if(!i.getChoiceByKey(e.key)){var u=U.d.convertFromSourceData(e,Wr.r.Schema);U.d.Collection.itemsAddedInSource(i.Model.ChoiceGroup,[u])}o=Promise.resolve()}else{var s=w.map(i.Model.ChoiceGroup,(function(n){return U.d.getObjectMasterFromModel(n).Synchronizer.existingInDataSource()}));o=Promise.all(s).then((function(){if(!i.getChoiceById(e.id)&&-1===U.d.Collection.getIndexWithKeyFields(i.Model.ChoiceGroup,{Id:e.id})){var n=U.d.convertFromSourceData(e,Wr.r.Schema);U.d.Collection.itemsAddedInSource(i.Model.ChoiceGroup,[n])}}))}o.then((function(){n.yf(t,r),n.Sf([r])}))}},onChoiceDeleted:c?null:function(t,e,r){var i=n.getQuestionById(t);if(i){var o=i.getChoiceById(e);o&&(o.Synchronizer.onDeletedInDataSource(),n.Sf([r]))}},onChoiceUpdated:c?null:function(t,e,r,i){var o=n.getQuestionById(t);if(o){var u=o.getChoiceById(e);u&&(u.Synchronizer.onSourceDataReceived(r),n.yf(t,i),n.Sf([i]))}},onUserConnected:c?null:function(t){n.Sf([t])},onUserDisconnected:c?null:function(t){n.Ff([t])},onFormUpdated:function(t,e){var r=w.map(n.Model.PermissionTokens,(function(n){return U.d.getObjectMasterFromModel(n).Synchronizer.existingInDataSource()}));Promise.all(r).then((function(){n.Synchronizer.onSourceDataReceived(t),n.Sf([e])}))},onLocaleResourceAdded:c?null:function(t,e){n.bulkEdit((function(){w.forEach(t,(function(t){if("localename"===t.elementKey){var e={localeId:t.locale,localeName:t.elementValue};-1===U.d.Collection.getIndexWithKeyFields(n.Model.LocaleList,{localeId:e.localeId})&&(U.d.Collection.itemsAddedInSource(n.Model.LocaleList,[e]),(0,Jr.an)(e,n))}else n.Cf(t)})),e&&n.Sf([e])}))},onLocaleResourceUpdated:c?null:function(t,e){var r=U.d.Collection.getItemWithKeyFields(n.Model.LocaleList,{localeId:t.locale});if(r){if("localename"===t.elementKey){var i={localeName:t.elementValue};U.d.getObjectMasterFromModel(r).Synchronizer.onSourceDataReceived(i);var o=U.d.Collection.getItemWithKeyFields(n.Model.LocalizedResources,{localeId:t.locale});o&&U.d.getObjectMasterFromModel(o).Synchronizer.onSourceDataReceived(i)}else n.Cf(t);e&&n.Sf([e])}},onLocaleResourceDeleted:c?null:function(t,e){if(t.hasOwnProperty("locale")){var r=t.locale,i=U.d.Collection.getItemWithKeyFields(n.Model.LocaleList,{localeId:r});i&&U.d.Collection.itemsDeletedInSource(n.Model.LocaleList,[i])}else if(t.hasOwnProperty("propertyName")){var o=t.propertyName;w.forEach(n.Model.LocalizedResources,(function(n){var t=U.d.Collection.getItemWithKeyFields(n.questionResources,{questionId:o});t&&U.d.getObjectMasterFromModel(t).Synchronizer.onDeletedInDataSource()}))}else(0,Lr._y)("Not supposed to happen.");e&&n.Sf([e])}};t.open(this.Model.Id,f)},t.prototype.Cf=function(n){if(n.elementKey.startsWith("choiceid_")){var t=w.find(this.Model.LocalizedResources,(function(t){return t.localeId==n.locale}));if(t){var e=w.find(t.questionResources,(function(t){return t.questionId==n.propertyName}));if(e){var r=U.d.getObjectMasterFromModel(e),i=n.elementKey.substring("choiceid_".length),o=r.getChoiceLocalizedMaster(i),u={choiceId:i,description:n.elementValue,key:o.Model.key};o.Synchronizer.onSourceDataReceived(u)}}}else switch(n.elementKey){case"title":case"subtitle":case"formsprortlocaletitle":case"formsprortlocalesubtitle":"_id"===n.propertyName?this._f(n.locale,n.elementKey,n.elementValue):this.Tf(n.locale,n.propertyName,n.elementKey,n.elementValue);break;case"thankYouMessage":case"formCloseMessage":case"footerText":case"conditionalThankyouMessage":"_id"===n.propertyName?this._f(n.locale,n.elementKey,n.elementValue):(0,Lr._y)("Not supposed to happen. Should be form level property.");break;case"leftDescription":case"rightDescription":case"formsprortlocaleldescription":case"formsprortlocalerdescription":case"formsprocustomplaceholder":case"option":"_id"===n.propertyName?(0,Lr._y)("Not supposed to happen. Should be question level property."):this.Tf(n.locale,n.propertyName,n.elementKey,n.elementValue);break;default:(0,Lr._y)("Not supposed to happen. Unknown element key")}},Object.defineProperty(t.prototype,"DataProviderType",{get:function(){return this.isGroupForm?3:2},enumerable:!1,configurable:!0}),t.prototype._f=function(n,t,e){var r=w.find(this.Model.LocalizedResources,(function(t){return t.localeId==n}));if(r){var i=U.d.getObjectMasterFromModel(r),o={localeId:n};o[t]=e,i.Synchronizer.onSourceDataReceived(o)}},t.prototype.Tf=function(n,t,e,r){var i=w.find(this.Model.LocalizedResources,(function(t){return t.localeId==n}));if(i){var o=w.find(i.questionResources,(function(n){return n.questionId==t}));if(o){var u=U.d.getObjectMasterFromModel(o),s={localeId:n};s[e]=r,u.Synchronizer.onSourceDataReceived(s)}}},t.prototype.getQuestionSyncBlocker=function(n){return this.gf.push((0,ut.Bx)(n)),this.wf},t.prototype.existingOnServerSide=function(){return this.Synchronizer.existingInDataSource()},t.prototype.Sf=function(n){var t=this;n&&n.length>0&&n.forEach((function(n){Ar().addOrUpdateUser(n),t.Model.CoAuthors=null}))},t.prototype.Ff=function(n){var t=this;n.length>0&&n.forEach((function(n){Ar().removeUser(n),t.Model.CoAuthors=null}))},t}(n)}(e),e=function(n){return function(n){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=n.apply(this,t)||this;r.Pf=!1;var i=r.Synchronizer;return i.observe((function(n){var t=i.Model.UpdateError;t&&r.Nf(t)}),[i.Schema.UpdateError]),r}return(0,p.ZT)(t,n),t.prototype.duplicateForm=function(n,t){var e=this;return this.ensureFieldsReady((0,Cn.DV)()).then((function(){var r=w.clone(e.getSnapshotToCopy());return r.OwnerId=n.OwnerId,r.OwnerTenantId=n.OwnerTenantId,r.Title=t,r.Settings=w.clone(r.Settings),r.Settings.AllowCopy=!1,r.Settings.ShareToken=null,(0,Fn.jg)(r,n.IsGroupForm)}))},t.prototype.ensureCreationDone=function(){var n=this,t=this.getImageMaster(Tn.x.Schema.Background),e=this.getImageMaster(Tn.x.Schema.Logo),r=this.getImageMaster(Tn.x.Schema.HeaderBGImage),i=(0,p.ev)([t.Synchronizer.flush(),e.Synchronizer.flush().then((function(){return n.Synchronizer.flush()}))],this.formElementManager.AllElementMasters.map((function(n){return n.ensureCreationDone()})),!0);return(0,P.md)((function(){i=(0,p.ev)([t.Synchronizer.flush(),r.Synchronizer.flush(),e.Synchronizer.flush().then((function(){return n.Synchronizer.flush()}))],n.formElementManager.AllElementMasters.map((function(n){return n.ensureCreationDone()})),!0)})),Promise.all(i).then((function(){}))},t.prototype.ensureReadyForMruCard=function(){var n=Tn.x.Schema;return this.ensureFieldsReady([n.Title,n.ModifiedDate,n.Settings,n.XlWorkbookId,n.OwnerId,n.OwnerTenantId,n.Category,n.OtherInfo,n.Theme,n.RowCount,n.SoftDeleted])},t.prototype.moveToRecycleBin=function(){var n=this;return this.bulkEdit((function(){n.Model.MovingToRecycleBin=!0,n.Model.SoftDeleted=ii.d.SoftDeleted})),this.Synchronizer.flush().then((function(){n.Model.MovingToRecycleBin=!1}))},t.prototype.kf=function(n){var t=this;this.Model.MovingToRecycleBin&&this.isSoftDeleted()&&(0,Dt.xP)(n)&&(6102===n.innerCode||6100===n.innerCode)&&this.bulkEdit((function(){return t.Model.SoftDeleted=ii.d.Normal}))},t.prototype.isNotSoftDeleted=function(){return!this.isFieldReady(this.Schema.SoftDeleted)||this.Model.SoftDeleted===ii.d.Normal},t.prototype.isSoftDeleted=function(){return!!this.isFieldReady(this.Schema.SoftDeleted)&&this.Model.SoftDeleted===ii.d.SoftDeleted},t.prototype.getQuestionError=function(){return(0,oi.KR)(this)},Object.defineProperty(t.prototype,"IsSharedForm",{get:function(){return this.Pf},set:function(n){this.Pf=n},enumerable:!1,configurable:!0}),t.prototype.Nf=function(n){this.kf(n)},t}(n)}(e),e=function(n){return function(n){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.apply(this,t)||this}return(0,p.ZT)(t,n),t.prototype.triggerShareAction=function(){if(!this.Ef&&(0,c.k0)().userInfo.IsMsa&&0==(this.Model.Flags&ri.CvsScanAllowed)){this.Ef=!0,Br.VY.getInstance().createDataProvider().postFormShareAction(this.Model.Id);var n=JSON.parse(this.Model.OtherInfo);n&&n.hasOwnProperty("TemplateId")&&(0,H.f)("MyTemplate.PostShare",{TemplateTitle:n.TemplateId})}},t.prototype.appendPermission=function(n){for(var t=this.Model.Permissions,e=function(e){if("OrgLink"===t[e].Type||"Link"===t[e].Type||"ShareToPeople"===t[e].Type){var r=t[e],i=(0,ci.pg)(r),o=i.Model.Type;return i.Model.Type=n,{value:i.Synchronizer.flush().then((function(){return r.PrincipalId})).catch((function(n){throw i.Model.Type=o,n}))}}},r=0;r<t.length;r++){var i=e(r);if("object"==typeof i)return i.value}var o=U.d.Collection.addItems(t,[(0,ci.yN)(n)]),u=(0,ci.pg)(o[0]);return u.Synchronizer.existingInDataSource().then((function(){return u.Model.PrincipalId}))},t.prototype.appendSpecificPeoplePermissions=function(n){var t=this.Model.Permissions,e=U.d.Collection.addItems(t,n).map(ci.pg).map((function(n){return n.Synchronizer.existingInDataSource().catch((function(e){var r=w.find(t,(function(t){return t.PrincipalId===n.Model.PrincipalId}));throw U.d.Collection.deleteItems(t,[r]),e}))}));return Promise.all(e).then((function(){}))},t.prototype.removeLinkPermission=function(){var n=this.Rf();return this.removePermissions(n)},t.prototype.removePermissions=function(n){U.d.Collection.deleteItems(this.Model.Permissions,n);var t=n.map(ci.pg).map((function(n){return n.Synchronizer.deletedFromDataSource()}));return Promise.all(t).then((function(){}))},t.prototype.canEditPermissionTokenByCoauthor=function(){return!w.some(this.Model.Permissions,(function(n){return"ShareToPeople"===n.Type}))},t.prototype.getPermissionToken=function(){var n=this;return this.Synchronizer.existingInDataSource().then((function(){var t=n.Rf().map(ci.pg);return 0!==t.length?t[0].Synchronizer.existingInDataSource().then((function(){return t[0].Model.PrincipalId})):null}))},t.prototype.refreshPermissions=function(){var n=this;return new Promise((function(t,e){return n.Synchronizer.query([Tn.x.Schema.Permissions]).then(t,e)}))},t.prototype.getUserOrGroupPermissions=function(){return w.filter(this.Model.Permissions,(function(n){return"Failed"!==n.SavingState&&("User"===n.Type||"Group"===n.Type)}))},t.prototype.refreshResponderPermissions=function(){var n=this;return new Promise((function(t,e){return n.Synchronizer.query([Tn.x.Schema.ResponderPermissions]).then(t,e)}))},t.prototype.appendResponderPermissionLink=function(){var n=this.Model.ResponderPermissions,t=U.d.Collection.addItems(n,[(0,fi.kF)("SpecificResponder")]),e=(0,fi.cp)(t[0]);return e.Synchronizer.existingInDataSource().then((function(){return e.Model.PrincipalId}))},t.prototype.appendSpecificResponderPermissions=function(n){var t=this.Model.ResponderPermissions,e=U.d.Collection.addItems(t,n).map(fi.cp).map((function(n){return n.Synchronizer.existingInDataSource().catch((function(e){var r=w.find(t,(function(t){return t.PrincipalId===n.Model.PrincipalId}));throw U.d.Collection.deleteItems(t,[r]),e}))}));return Promise.all(e).then((function(){}))},t.prototype.getUserOrGroupPermissionsInResponder=function(){return w.filter(this.Model.ResponderPermissions,(function(n){return"Failed"!==n.SavingState&&("User"===n.Type||"Group"===n.Type)}))},t.prototype.getResponderPersonas=function(){var n=this.getUserOrGroupPermissionsInResponder();return n=w.filter(n,(function(n){return(0,fi.cp)(n).isFieldReady(fi.Qq.Schema.PrincipalName)})),w.map(n,(function(n){return{id:n.PrincipalId,optionalText:n.Type,primaryText:n.PrincipalName,secondaryText:n.PrincipalEmailAddress}}))},t.prototype.getResponderEmailList=function(){if(2!==this.getResponseCollectionType())return Promise.resolve(null);var n=U.d.convertToArray(this.getUserOrGroupPermissionsInResponder()).map((function(n){return si("User"===n.Type?"User":"Group",n.PrincipalId)}));return Promise.all(n).then((function(n){return encodeURIComponent(n.filter((function(n){return n.Mail})).map((function(n){return n.Mail})).join(";"))})).catch((function(){return null}))},t.prototype.removeResponderPermissionLink=function(){var n=this,t=this.Of();return this.removeResponderPermissions(t).then((function(){return n.refreshResponderPermissions()}))},t.prototype.removeResponderPermissions=function(n){U.d.Collection.deleteItems(this.Model.ResponderPermissions,n);var t=n.map(fi.cp).map((function(n){return n.Synchronizer.deletedFromDataSource()}));return Promise.all(t).then((function(){}))},t.prototype.getResponseCollectionType=function(){var n=this.SettingMaster.Model,t=(0,g.f5)().Model.FormsTenantSettings,e=n.IsAnonymous,r=t&&!t.externalSendForm,i=0;if((!e||r)&&this.isFieldReady(Tn.x.Schema.ResponderPermissions)){var o=this.Model.ResponderPermissions;i=w.find(o,(function(n){return"SpecificResponder"===n.Type}))?2:1}return i},t.prototype.Of=function(){return w.filter(this.Model.ResponderPermissions,(function(n){return"SpecificResponder"===n.Type}))},t.prototype.Rf=function(){return w.filter(this.Model.Permissions,(function(n){return"Link"===n.Type||"OrgLink"===n.Type||"ShareToPeople"===n.Type}))},t}(n)}(e),e=function(n){return function(n){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.apply(this,t)||this}return(0,p.ZT)(t,n),t.prototype.setResponseComment=function(n,t){var e=this.Df(n);e&&(e.Model.Feedback=t,this.xf(e.Model))},t.prototype.setAnswerGrading=function(n,t,e,r){var i=this.Df(n);i&&(i.setAnswerGrading(t,e,r),this.xf(i.Model))},t.prototype.setReleaseDate=function(n,t){var e=this.Df(n);e&&(e.Model.ReleaseDate=t,this.xf(e.Model))},t.prototype.Df=function(n){var t=this,e=this.getResponseModelById(n);if(!e){var r=this.Model.Responses,i=w.findIndex(r,(function(t){return t.Id===n}));if(i<0)return!1;this.bulkEdit((function(){e=U.d.Collection.itemsAddedInSource(t.Model.ResponseModels,[r[i]])[0],r[i]=e}))}return(0,ti._p)(e)},t.prototype.xf=function(n){if((0,v.GF)()&&(0,v.CE)()&&this.IsAssignmentForm&&(0,D.cr)("AssignmentsIFrameLimitParentHeaders")){var t=w.reduce(n.Answers,(function(n,t){return n+(t.Score||0)}),0);(0,D.cr)("FixEslintTeamsPostMessageError")?window.parent.postMessage({eventName:"FormGradingChangePerformed",responseId:n.Id,responder:n.Responder,responseScore:t,feedback:n.Feedback,isReturned:"0001-01-01T00:00:00Z"!==n.ReleaseDateAsString},"https://assignments.onenote.com"):window.parent.postMessage({eventName:"FormGradingChangePerformed",responseId:n.Id,responder:n.Responder,responseScore:t,feedback:n.Feedback,isReturned:"0001-01-01T00:00:00Z"!==n.ReleaseDateAsString},"*")}},t}(n)}(e),e=function(n){return function(n){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.apply(this,t)||this}return(0,p.ZT)(t,n),t.prototype.createLocale=function(n,t){var e={localeId:n,localeName:t};U.d.Collection.addItems(this.Model.LocaleList,[e]),(0,Jr.an)(e,this)},t.prototype.deleteLocale=function(n){var t=U.d.Collection.getItemWithKeyFields(this.Model.LocaleList,{localeId:n});t&&(U.d.Collection.deleteItems(this.Model.LocaleList,[t]),(0,Jr.tc)(n,this))},t.prototype.getAllLocaleResources=function(){return(0,Yr.o7)(this.Model.Id).getAllLocaleResources(this.Model.Id).then((function(n){return(0,Jr.n$)(n)}))},t}(n)}(e),e=Or(e=ei(e))}function pi(){return Or(function(n){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=n.apply(this,t)||this,i=r.originalInitialData;return r.duplicatingImage&&r.Synchronizer.existingInDataSource().then((function(){return r.Lf(i)})),r}return(0,p.ZT)(t,n),t.prototype.addImage=function(n){var t,e,r=this,i=new qe.o("Image.Add");if(i.start(),n.File)e="File",t=function(){return r.Mf(n.File,(0,Kr.vM)(),(0,Kr.HJ)())};else{if(!n.FromUrl)throw Error("Invalid picked image result.");e="FromUrl",t=function(){return r.qf(n.FromUrl.Url,n.FromUrl.Size,n.FromUrl.Width,n.FromUrl.Height)}}return this.Model.ImageProcessingStatus=Tr.nv.Picking,this.Synchronizer.existingInDataSource().then(t).then((function(){r.Model.AltText=null,i.end({resultType:"Success",extraData:{imageSource:e}})})).catch((function(){i.end({resultType:"Failure",extraData:{imageSource:e}})}))},t.prototype.getImageErrorMessage=function(){switch(this.Model.ErrorType){case Tr.dL.NoError:return null;case Tr.dL.SizeTooLarge:return(0,S.pm)().Error_Message_5208;case Tr.dL.InvalidType:return(0,S.pm)().Error_Message_5209;case Tr.dL.BrokenImage:return(0,S.pm)().ImagePicker_Broken_Image;case Tr.dL.ServerError:return this.Af();case Tr.dL.DeleteFailError:return(0,S.pm)().Image_Delete_Fail}},t.prototype.clear=function(){var n=this,t=this.Model;return t.ResourceUrl?t.IsPredefined?(this.setData({AltText:null,ContentType:null,FileIdentifier:null,OriginalFileName:null,ResourceId:null,ResourceUrl:null,IsPredefined:!1,UploadParameters:null,ErrorType:Tr.dL.NoError,ResponseError:null,ImageProcessingStatus:Tr.nv.Idle,Width:null,Height:null}),Promise.resolve()):(this.bulkEdit((function(){t.ImageProcessingStatus=Tr.nv.Deleting,t.UploadParameters={Delete:!0}})),this.Uf((function(){return n.setData((0,Tr.w9)())}))):Promise.resolve()},t.prototype.updateSettings=function(n,t){this.getSettingsMaster()&&this.getSettingsMaster().updateWith(this.Model,n,t)},t.prototype.Lf=function(n){var t=this;if(this.Model.ResourceUrl){var e=n.AltText,r=this.getSettingsMaster(),i={};r&&(i=w.clone(r.getSnapshot())),this.Synchronizer.existingInDataSource().then((function(){return t.qf(n.ResourceUrl,0,i?i.NaturalWidth:(0,Kr.vM)(),i?i.NaturalHeight:(0,Kr.HJ)())})).then((function(){t.Model.AltText=e,r&&(delete i.NaturalHeight,delete i.NaturalWidth,r.setData(i))}))}},t.prototype.qf=function(n,t,e,r){var i=this;(0,H.$U)("DesignPage.ImageLayout.ImageSize",{width:e,height:r});var o=this.Model;return this.bulkEdit((function(){var u=(0,Tr.bN)(e,r,800,600);return o.ErrorType=i.Vf(t),o.ErrorType!==Tr.dL.NoError?(o.ImageProcessingStatus=Tr.nv.Idle,Promise.reject(o.ErrorType)):(i.resetStatus(Tr.nv.Picking),o.UploadParameters={Url:n,Size:t},i.Uf(void 0,u.width,u.height))}))},t.prototype.Mf=function(n,t,e){var r=this,i=this.Model;return this.bulkEdit((function(){var t=r.Vf(n.size,n.type);return t===Tr.dL.NoError?(r.resetStatus(Tr.nv.Uploading),i.UploadParameters={ImageFile:n},r.Uf()):(i.ErrorType=t,i.ImageProcessingStatus=Tr.nv.Idle,Promise.reject(i.ErrorType))}))},t.prototype.Uf=function(n,t,e){var r=this;return this.Synchronizer.flush().finally((function(){return r.Model.ImageProcessingStatus=Tr.nv.Idle})).catch((function(){})).then(n).then((function(){return r.updateSettings(t,e)})).catch((function(n){r.Gf()}))},t.prototype.Af=function(){var n=this.Model,t=n.ResponseError&&n.ResponseError.innerCode;return(0,li.D)("".concat(t))||(0,S.pm)().Image_Upload_Fail},t.prototype.Vf=function(n,t,e,r){var i=Tr.dL.NoError;return n>(0,Kr.yi)()&&(i=Tr.dL.SizeTooLarge),t&&$.inArray(t,["image/bmp","image/gif","image/jpeg","image/png"])<0&&(i=Tr.dL.InvalidType),i},t.prototype.Gf=function(){this.setData((0,Tr.w9)(),U.d.getSubFieldSchemas(Tr.Xf.Schema)),this.updateSettings()},t}(Tr.Xf))}function gi(){return Or(function(n){function t(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var i=n.apply(this,e)||this;return(0,ni.vG)(i),i.updateIntegratedSavingState(),t.DesignOnlyRules.forEach((function(n){return i.addRule(n)})),i}return(0,p.ZT)(t,n),Object.defineProperty(t,"DesignOnlyRules",{get:function(){if(!t.designOnlyRules){var n=pn.MF.Schema;t.designOnlyRules=[{Name:"block id changes",InterestedFields:[n.Id],onChange:function(n){var t,e=n.Master.Model,r=e.Id,i=n.OldValues.Id;e.Id=i;try{throw Error("Changing question id")}catch(n){t=n}(0,H.zU)("UpdatingQuestionId",{newId:r,oldId:i,stack:t.stack})}},{Name:"update CombinedTitle",InterestedFields:[n.Title,n.IsMathQuiz,n.Subtitle],onChange:function(n){return(0,mi.k)(n.Master.Model)}},{Name:"update Title",InterestedFields:[n.CombinedTitle],onChange:function(n){return(0,mi.S)(n.Master.Model)}},{Name:"IntegrateSavingState",InterestedFields:[n.ImageInfo.SavingState,n.SavingState],onChange:function(n){return n.Master.updateIntegratedSavingState()}},{Name:"IsQuiz",InterestedFields:[n.IsQuiz],onChange:function(n){var t=n.Master.Model;t.IsQuiz||(t.IsMathQuiz=null,U.d.convertToArray(t.Choices).forEach((function(n){n.IsAnswerKey=null})))}},{Name:"IsMathQuiz",InterestedFields:[n.IsMathQuiz],onChange:function(n){var t=n.Master.Model;t.IsMathQuiz||(t.IsMathQuiz=null,t.IsPlainTextInMathField=null,t.IsMathInputDefault=null,t.InputSwitcherDisabled=null,t.LastMathMLFormula=null,t.MathAriaLabels=null,t.MathTemplateID=null)}},{Name:"NumberValidationRule",InterestedFields:[n.IsNumber],onChange:function(n){var t=n.Master.Model;t.IsNumber?null==t.NumberValidationRule&&(t.NumberValidationRule=pn.pW.None):(t.NumberValidationRule=null,(0,P.md)((function(){t.FormsProValidationType=null})))}},{Name:"JustifyNumberBoundaries",InterestedFields:[n.NumberValidationRule],onChange:function(n){return n.Master.justifyNumberBoundaries()}}]}return t.designOnlyRules},enumerable:!1,configurable:!0}),t.prototype.ensureCreationDone=function(){var n=this;return this.ImageInfoMaster.Synchronizer.flush().then((function(){return n.Synchronizer.flush()}))},t.prototype.setVideoUrl=function(n,t){var e=this.Model.VideoInfo;U.d.getObjectMasterFromModel(e).bulkEdit((function(){e.Url=(0,di.Qn)(n,(0,Ae.k)()),e.Title="",e.Author="",e.Thumbnail_url="",e.OriginalWidth=459,e.OriginalHeight=256,e.ShowWarningBar=t&&(0,hi.M4)(n)}))},t.prototype.clearVideoInfo=function(){this.Model.VideoInfo={}},t.prototype.addSubQuestion=function(n){n.GroupId=this.Model.Id,n.Required=this.Model.Required,this.Form.FormElementManager.insertElementAfter(n,this)},t.prototype.deleteSubQuestion=function(n){this.Form.getQuestionById(n).Deleted=!0},t.prototype.updateCoAuthors=function(n){var t=this,e=U.d.getCollectionMasterFromModel(this.Model.CoAuthors),r=w.filter(this.Model.CoAuthors,(function(t){return n.userId===t.userId}))[0],i=function(){r&&e.deleteItems([r]),n.userId in t.coAuthorTimers&&(clearTimeout(t.coAuthorTimers[n.userId]),delete t.coAuthorTimers[n.userId])};e.bulkEdit((function(){i(),r=U.d.Collection.addItems(t.Model.CoAuthors,[n])[0]})),this.coAuthorTimers[n.userId]=window.setTimeout(i,1e4)},t.prototype.hasSectionBranching=function(){var n=this.Model;return w.map(n.Choices,(function(n){return n.BranchInfo})).concat([n.BranchInfo,n.BranchInfoForOtherChoice]).map(U.d.getObjectMasterFromModel).some((function(n){return n.hasSectionBranching()}))},t.prototype.needObserveSettings=function(){return"Question.FileUpload"===this.Model.Type},t.prototype.getErrorMessage=function(){var n=this,t=this.Model.FileUploadSPOInfo;return(0,P.md)((function(){(0,D.cr)("CustomerVoiceCDSFileUpload")&&n.Form.isFieldReady(Tn.x.Schema.FileUploadStorage)&&"cds"===n.Form.Model.FileUploadStorage&&(t=null)})),this.Synchronizer.Model.CreationError?this.getCreationError():(null==t?void 0:t.errorCode)?(0,oi.nX)(t.errorCode):(null==t?void 0:t.linkInfo)?(0,oi.uV)(Number(t.linkInfo),!1):(null==t?void 0:t.anonymousLinkInfo)&&this.Form.SettingMaster.Model.IsAnonymous?(0,oi.uV)(Number(t.anonymousLinkInfo),!0):void 0},t.prototype.getCreationError=function(){var n,t=null===(n=this.Synchronizer.Model)||void 0===n?void 0:n.CreationError,e=null==t?void 0:t.innerMessage,r=null==t?void 0:t.innerCode;if("6614"==r){var i=e.match(/disableReason:([-0-9]*);/);if(i){var o=Number(i[1]);return(0,oi.uV)(o,!1)}}else if(r)return(0,oi.nX)(r);return null},t.prototype.updateIntegratedSavingState=function(){this.isFieldReady(pn.MF.Schema.ImageInfo)?this.Model.IntegratedSavingState=(0,ni.IM)([this.Model.ImageInfo.SavingState,this.Model.SavingState]):this.Model.IntegratedSavingState=this.Model.SavingState},t}(pn.MF))}function bi(){return function(n){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.apply(this,t)||this}return(0,p.ZT)(t,n),t.prototype.appendElement=function(n,t){var e=this,r=[];n.Id||((n=w.clone(n)).Id=this.Bf());var i=this.getAllElements(),o=i.length>0?i[i.length-1].Order:_r.H.QuestionOrderFloor;if(n.Order=o+_r.H.QuestionOrderDefaultStep,t&&(r=t.map((function(t,r){return(t=w.clone(t)).Id=e.Bf(),t.GroupId=n.Id,t.Order=n.Order+(r+1)*_r.H.QuestionOrderDefaultStep,t}))),_r.H.isDescriptiveElement(n.Type)){var u=U.d.Collection.addItems(this.formMaster.Model.DescriptiveElements,[n]);return(0,$r.PQ)(u[0])}var s=[n];return s=s.concat(r),u=U.d.Collection.addItems(this.formMaster.Model.Questions,s),(0,pn.vV)(u[0])},t.prototype.duplicateElement=function(n){var t=n.getSnapshotWithoutBranchInfo();delete t.Id;var e=n.SubQuestionMasters.map((function(n){var t=n.getSnapshotWithoutBranchInfo();return delete t.Id,delete t.GroupId,delete t.QuestionInfo,t}));return this.insertElementAfter(t,n,e)},t.prototype.duplicateSectionAndSubElements=function(n){var t=this,e=this.findQuestionsInSection(n,!0),r=w.find(this.SectionMasters,(function(t){return t.Model.Order>n.Model.Order})),i=n.Model.Order,o=n.Model.Order+_r.H.QuestionOrderDefaultStep*(e.length+1);e.length>0&&(i=w.last(e).Model.Order),r&&(o=r.Model.Order);var u=(o-i)/(e.length+2),s=w.clone(n.getSnapshot());s.Id=this.Bf(),s.Order=i+u,s.FormsProRTQuestionTitle&&(s.FormsProRTQuestionTitle=(0,S.pm)().Title_For_Duplicate_Section.format(s.FormsProRTQuestionTitle)),s.Title=(0,S.pm)().Title_For_Duplicate_Section.format(s.Title);var a,c=[{newId:s.Id,oldId:n.Model.Id}],f=[];return e&&e.forEach((function(n,e){var r=w.clone(n.getSnapshot());switch(r.Id=t.Bf(),r.Order=s.Order+u*(e+1),f.push(r),r.Type){case"Question.MatrixChoiceGroup":a=r.Id;break;case"Question.MatrixChoice":r.GroupId=a}c.push({newId:r.Id,oldId:n.Model.Id})})),this.formMaster.bulkEdit((function(){U.d.Collection.addItems(t.formMaster.Model.DescriptiveElements,[s]),U.d.Collection.addItems(t.formMaster.Model.Questions,f)})),(0,Jr.fK)(n.Form.Model.LocalizedResources,c),this.getDescriptiveElementMasterById(s.Id)},t.prototype.deleteFormQuestion=function(n){U.d.Collection.itemsDeletedInSource(n.Form.Model.Questions,n.SubQuestionMasters.map((function(n){return n.Model}))),n.Deleted=!0},t.prototype.deleteSectionAndSubElements=function(n){var t=this,e=this.findQuestionsInSection(n);this.formMaster.bulkEdit((function(){e.forEach((function(n){return t.deleteFormQuestion(n)})),n.Deleted=!0}))},t.prototype.moveElementDown=function(n){var t=this,e=this.TopElementMasters,r=w.indexOf(e,n);if(r!==e.length-1){var i=e[r+1],o=i instanceof pn.MF&&i.SubQuestionMasters.length>0?i.SubQuestionMasters[i.SubQuestionMasters.length-1].Model.Order:i.Model.Order,u=o+_r.H.QuestionOrderDefaultStep;r+1<e.length-1&&(u=e[r+2].Model.Order);var s=n.SubQuestionMasters.map((function(n){return n.Model}));this.formMaster.bulkEdit((function(){return t.zf(n.Model,s,o,u)}))}},t.prototype.moveElementUp=function(n){var t=this,e=this.TopElementMasters,r=w.indexOf(e,n);if(!(r<=0)){var i=_r.H.QuestionOrderFloor,o=e[r-1],u=w.indexOf(this.AllElementMasters,o);u>0&&(i=this.AllElementMasters[u-1].Model.Order);var s=e[r-1].Model.Order,a=n.SubQuestionMasters.map((function(n){return n.Model}));this.formMaster.bulkEdit((function(){return t.zf(n.Model,a,i,s)}))}},t.prototype.moveSectionTo=function(n,t){var e,r=this,i=_r.H.QuestionOrderFloor,o=this.SectionMasters,u=w.indexOf(o,n),s=w.indexOf(o,t),a=w.last(this.HeaderTopQuestionMasters);a&&(i=a.Model.Order);var c=this.findQuestionsInSection(n,!0).map((function(n){return n.Model}));if(u>s)e=t.Model.Order,s>0&&(i=o[s-1].Model.Order,(f=this.findQuestionsInSection(o[s-1])).length>0&&(i=w.max(w.map(f,(function(n){return n.Model.Order})))));else{if(!(u<s))return;var f=this.findQuestionsInSection(t);i=o[s].Model.Order,f.length>0&&(i=w.max(w.map(f,(function(n){return n.Model.Order})))),e=i+_r.H.QuestionOrderDefaultStep*(c.length+1),s+1<o.length&&(e=o[s+1].Model.Order)}this.formMaster.bulkEdit((function(){return r.jf(n.Model,c,i,e)}))},t.prototype.insertElementAfter=function(n,t,e){var r=this;n=w.clone(n);var i=[];e&&(i=e.map(w.clone));var o=this.getAllElements(),u=_r.H.QuestionOrderFloor,s=u+_r.H.QuestionOrderDefaultStep;if(t){t instanceof pn.MF&&t.SubQuestionMasters.length>0&&(t=t.SubQuestionMasters[t.SubQuestionMasters.length-1]);var a=w.indexOf(o,t.Model);a!==o.length-1?(u=t.Model.Order,s=o[a+1].Order):(u=t.Model.Order,s=t.Model.Order+_r.H.QuestionOrderDefaultStep)}else o.length>0&&(s=o[0].Order);if(this.zf(n,i,u,s),n.Id||(n.Id=this.Bf(),i.forEach((function(t){t.Id=r.Bf(),t.GroupId=n.Id}))),_r.H.isDescriptiveElement(n.Type)){var c=U.d.Collection.addItems(this.formMaster.Model.DescriptiveElements,[n]);return(0,$r.PQ)(c[0])}var f=[n];return f=f.concat(i),c=U.d.Collection.addItems(this.formMaster.Model.Questions,f),(0,pn.vV)(c[0])},t.prototype.Bf=function(){return"r"+(0,A.GW)().replace(/-/g,"")},t.prototype.zf=function(n,t,e,r){var i=this,o=(r-e)/(t.length+2);n.Order=e+o,t.forEach((function(t,e){t.Order=n.Order+o*(e+1)})),(0,P.md)((function(){var n;(null===(n=i.formMaster)||void 0===n?void 0:n.SettingMaster.Model.PauseAndResumeSurvey)&&i.formMaster.bulkEdit((function(n){n.SurveyLastModifiedAt=(new Date).toUTCString()}))}))},t.prototype.jf=function(n,t,e,r){var i=(r-e)/(t.length+2);n.Order=e+i,t.forEach((function(t,e){t.Order=n.Order+i*(e+1)}))},t}(_r.H)}function wi(){return function(n){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.apply(this,t)||this}return(0,p.ZT)(t,n),t.prototype.updateWith=function(n,t,e){var r=this;this.bulkEdit((function(){r.clear(),r.initImageSetting(n,t,e)}))},t.prototype.initImageSetting=function(n,t,e){var r=this,i=this.Model;this.bulkEdit((function(){null==i.Layout&&(n.ResourceUrl||n.ImageProcessingStatus!==Tr.nv.Idle?(i.NaturalWidth=n.Width||t,i.NaturalHeight=n.Height||e,r.Qf(),r.Hf()):r.clear())}))},t.prototype.onImageStyleChange=function(n){var t=this,e=this.Model;e.Size!==n&&this.bulkEdit((function(){e.Size=n,t.Hf()}))},t.prototype.clear=function(){return this.setData({},U.d.getSubFieldSchemas(this.Schema))},t.prototype.Qf=function(){var n=this.Model;if(this.IsFormLogo)n.Size=Pr.h2.Small;else{var t=n.NaturalHeight/n.NaturalWidth;n.Layout=t>1?Pr.RZ.Vertical:t<1?Pr.RZ.Horizontal:Pr.RZ.Square,n.Size=t<.5?Pr.h2.Large:Pr.h2.Small}},t.prototype.Hf=function(){var n=this.Model,t=this.getDefaultImageSettings();for(var e in t)n[e]=Math.round(t[e])},t}(Pr.Vj)}function Ii(){return function(n){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=n.apply(this,t)||this;return r.addRule({InterestedFields:[r.Schema.FormMaster],Name:"ClearRouting",onChange:function(n){r.Model.FormMaster||r.Ec()}}),r.addRule({InterestedFields:[r.Schema.FlexPane],Name:"RecordFlexPaneType",onChange:function(n){r.Model.PreviousFlexPane=n.OldValues.FlexPane}}),r}return(0,p.ZT)(t,n),t.getInstance=function(){return this.instance||(this.instance=new t),this.instance},t.prototype.designForm=function(n){var e=t.getInstance(),r=e.Model;(0,H.$U)("DesignPage.Form.Navigate",{isGroupForm:n.IsGroupForm,myForm:n.Model.OwnerId===(0,c.k0)().userInfo.UserId}),e.bulkEdit((function(){r.Analysis=!1,r.Grading=null,r.FormId=null,r.FormMaster=n,n.IsGroupForm||(r.GroupMaster=null),n.existingOnServerSide().then((function(){r.FormMaster===n&&(r.FormId=n.Model.Id)}))}))},t.prototype.copyBySharingLinkFinished=function(n){var t=this;window.history.replaceState({},"","#FormId=".concat(n.Model.Id)),this.bulkEdit((function(){var e=t.Model;e.CopyFormId=null,e.SharingToken=null,e.FormId=null==n?void 0:n.Model.Id,e.FormMaster=n}))},t.prototype.shouldShowDesignView=function(){var n=this.Model;return!!(n.FormId||n.CopyFormId||n.FormMaster)},t.prototype.showTopView=function(n,t){this.Model.TopView=n,this.topViewCloseCallback=t},t.prototype.hideTopView=function(){this.Model.TopView="None"},t.prototype.resetTopViewCloseCallback=function(){var n=this.topViewCloseCallback;return this.topViewCloseCallback=void 0,n},t.prototype.collapseFlexPaneIfNeeded=function(n){var e=t.getInstance().Model,r=e.FlexPane;if("None"!==r){var i="flex-pane-container-"+r,o=document.getElementById(i);o&&!o.contains(n)&&(e.FlexPane="None")}},t.prototype.getUniqueFormName=function(n,e){void 0===e&&(e=!1);var r=t.getInstance(),i=[];if(e)i=r.Model.GroupMaster.FormMasters.filter((function(n){return!n.Deleted})).map((function(n){return n.Model.Title}));else{i=U.d.convertToArray(r.Model.FormList).map((function(n){return n.Model.Title}));var o=U.d.convertToArray(r.Model.PlaceholderList).map((function(n){return n.Title}));i=i.concat(o)}return(0,Dr.o)(n,(0,S.pm)().Designer_Title_autoRenameFormat,i)},t.prototype.Ec=function(){var n=this;this.bulkEdit((function(){var t=n.Model;t.FormMaster=void 0,t.DataIdeas=!1,t.Analysis=!1,t.BranchingElementId=null,t.SectionElementId=null,t.Store=!1,t.Grading=null,t.Preview=null,t.FlexPane="None"}))},t}(Cr)}var yi=function(){function n(){}return n.prototype.getMixinFormMaster=function(){return n.FormMasterClass||(n.FormMasterClass=vi()),n.FormMasterClass},n.prototype.getMixinImageInfoMaster=function(){return n.ImageInfoMasterClass||(n.ImageInfoMasterClass=pi()),n.ImageInfoMasterClass},n.prototype.getMixinQuestionMaster=function(){return n.QuestionMasterClass||(n.QuestionMasterClass=gi()),n.QuestionMasterClass},n.prototype.getMixinFormApi=function(){return n.FormApiClass||(n.FormApiClass=wr(rr)),n.FormApiClass},n.prototype.getMixinFormElementManager=function(){return n.FormElementManagerClass||(n.FormElementManagerClass=bi()),n.FormElementManagerClass},n.prototype.getMixinImageSettingsMaster=function(){return n.ImageSettingsMasterClass||(n.ImageSettingsMasterClass=wi()),n.ImageSettingsMasterClass},n.prototype.getMixinDesignPageUxStateMaster=function(){return n.DesignPageUxStateMasterClass||(n.DesignPageUxStateMasterClass=Ii()),n.DesignPageUxStateMasterClass},n.prototype.getMobileDesignPageUxStateMaster=function(){return kr},n.prototype.getFileUploadConfirmDialog=function(){return Rr},n}(),Si=function(){function n(){this.$f=new Mr.Y,this.Wf=!1}return n.prototype.addBootCompleteListener=function(n){this.Wf?n():this.$f.register(n)},n.prototype.raiseBootComplete=function(){this.Wf=!0,this.$f.trigger(),this.$f.clear()},n}();var Fi=e(99243),Ci=e(49050),_i=e(31699),Ti=e.n(_i),Pi=e(32782),Ni=e(29295);function ki(){return(0,p.mG)(this,void 0,void 0,(function(){return(0,p.Jh)(this,(function(n){switch(n.label){case 0:return[4,e.e(245).then(e.bind(e,99508))];case 1:return[2,{default:n.sent().SurveyVariables}]}}))}))}function Ei(n){var t=(0,Ni.J)(Ei,ki);return h.createElement(Pi.Z,null,h.createElement(t,(0,p.pi)({},n)))}var Ri=e(20572);P.Xw.createTextFieldWithCKEditor=function(n,t,e,r,i,o,u,s,a){return void 0===e&&(e=!1),void 0===r&&(r=!1),void 0===i&&(i=null),void 0===o&&(o=null),void 0===u&&(u=null),void 0===s&&(s=null),void 0===a&&(a=!1),n.Value=P.Xw.sanitizeRichTextHTML(n.Value),h.createElement(Oi,(0,p.pi)({Form:t,PipesNeeded:e,addLink:r,onFocus:i,onBlur:o,onKeyDownChoiceOption:u,onPasteChoiceOption:s,blockEnter:a},n))};var Oi=function(n){function t(t){var e=n.call(this,t)||this;return e.Jf=[],e.Ro=h.createRef(),e.Kf=function(){(0,g.f5)().Model.FlexPane="CustomData"},e.Yf=function(){e.setState({isPanelOpen:!0})},e.Zf=e.Zf.bind(e),e.tl=e.tl.bind(e),e.state={isPanelOpen:!1},e}return(0,p.ZT)(t,n),t.prototype.Zf=function(n){var t=P.Xw.sanitizeRichTextHTML(n);this.props.onValueChange(t)},t.prototype.focus=function(){this.Ro.current&&this.Ro.current.focus()},t.prototype.componentDidMount=function(){return(0,p.mG)(this,void 0,void 0,(function(){var n,t,e,r,i,o,u,s,a,c,f,l=this;return(0,p.Jh)(this,(function(h){switch(h.label){case 0:return CKEDITOR?(n=d.findDOMNode(this),t=(0,yn.cT)()?document.getElementById("form-designer-container"):document.getElementById("body-scrollable-content"),e=document.getElementById("reactshellheader"),r=(0,yn.cT)()?document.getElementById("content-root-project"):document.getElementById("content-root"),i=document.getElementsByClassName("muliti-lingual-page-padding"),CKEDITOR.disableAutoInline=!0,this.props.Form?[4,this.props.Form.ensureFieldsReady([Tn.x.Schema.PipesDetails])]:[3,2]):[2];case 1:if(h.sent(),o=this.props.Form.Model.PipesDetails,u=JSON.parse(o)){for(s=void 0,s=0;s<u.length;s++)this.Jf.push(u[s].pipeName);if(this.Jf.length>0){for(a=[],c=0;c<this.Jf.length;c++)f={value:"{{"+this.Jf[c]+"}}",name:this.Jf[c]},a.push(f);CKEDITOR.config.pipeinsert_strings=a,CKEDITOR.config.pipeinsert_button_label=(0,S.pm)().DistributePage_Variables_Label,CKEDITOR.config.pipeinsert_button_title=(0,S.pm)().DESIGNPAGE_PIPE_DROPDOWN_TOOLTIP,CKEDITOR.config.pipeinsert_button_voice=(0,S.pm)().DESIGNPAGE_PIPE_DROPDOWN_TOOLTIP,CKEDITOR.config.pipeinsert_addnew_option_text=(0,S.pm)().SettingsPane_SurveyVariable_Add,CKEDITOR.config.pipeinsert_addnew_option_text_colour=(0,yn.cT)()?" #2266E3":" #008272",CKEDITOR.config.pipeinsert_addnew_option_callBack=(0,yn.cT)()?this.Yf:this.Kf}}(0,D.cr)("FormsProAnswerTag")&&this.props.Form.ensureFieldsReady([Tn.x.Schema.FormsProAnswerTagMap]).then((function(){var n=U.d.convertToArray(l.props.Form.Model.FormsProAnswerTagMap);n.length>0?(CKEDITOR.config.answertag_strings=n,CKEDITOR.config.answertag_button_label=(0,S.pm)().DESIGNPAGE_ANSWERTAG_CKEDITOR_MENU_LABEL,CKEDITOR.config.answertag_button_title=(0,S.pm)().DESIGNPAGE_ANSWERTAG_DROPDOWN_TOOLTIP,CKEDITOR.config.answertag_button_voice=(0,S.pm)().DESIGNPAGE_ANSWERTAG_DROPDOWN_TOOLTIP):CKEDITOR.config.answertag_strings=void 0})),h.label=2;case 2:return $(n).find("textarea").each((function(n,o){if(t){var u=[t,e,r];l.il(o,u,l.props.PipesNeeded)}else if(null!=i&&i.length>0){var s=[i[0]];l.il(o,s,l.props.PipesNeeded)}})),[2]}}))}))},t.prototype.il=function(n,t,e){var r=this;this.ol=CKEDITOR.inline(n,{removePlugins:"elementspath,magicline,liststyle,tableselection,tabletools,tableresize,contextmenu",fontSize_defaultLabel:"14px",skin:"moono-lisa",disallowedContent:"script",startupFocus:1==this.props.AutoFocus&&"start",startupShowBorders:!1,protectedSource:[/\n/g],enterMode:CKEDITOR.ENTER_BR,floatSpaceDockedOffsetY:2,title:!1,basicEntities:!1,fillEmptyBlocks:!1,tabSpaces:0,htmlEncodeOutput:!1,entities:!1,ignoreEmptyParagraph:!1,extraAllowedContent:["a(*)[*]"],baseFloatZIndex:1e7}),this.ol.config.extraPlugins="confighelper",this.ol.config.placeholder=this.props.Placeholder;var i=[{name:"basicstyles",items:["Bold","Italic","Underline"]},{name:"colors",items:["TextColor"]}];i=(0,yn.cT)()?i.concat({name:"styles",items:["FontSize"]}):i.concat({name:"styles",items:["Font","FontSize"]});var o="richcombo,confighelper";if(e){var u=!1,s=!1;null!=CKEDITOR.config.pipeinsert_strings&&null!=CKEDITOR.config.pipeinsert_strings.length&&CKEDITOR.config.pipeinsert_strings.length>0&&(u=!0),null!=CKEDITOR.config.answertag_strings&&null!=CKEDITOR.config.answertag_strings.length&&CKEDITOR.config.answertag_strings.length>0&&(s=!0),(u||s)&&(o="richcombo,confighelper",u&&(o+=",pipeinsert"),s&&(o+=",answertag")),i=this.al(u,s,i)}else this.props.addLink&&(i=i.concat({name:"Link",items:["Link"]}));(0,D.cr)("FormsProRTECharLimit")&&(o+=",wordcount"),this.ol.config.extraPlugins=o,this.ol.config.toolbar=i,(0,yn.cT)()&&(this.ol.config.allowedContent="strong em u;span{!font-family};span{!color};span{!font-size};",this.props.addLink&&(this.ol.config.allowedContent=this.ol.config.allowedContent+"a[!href];")),(0,D.cr)("FormsProRTECharLimit")&&(this.ol.config.wordcount={countHTML:!1,countLineBreaks:!0,countBytesAsChars:!1,countSpacesAsChars:!0,maxCharCount:this.props.MaxLength-1}),this.ol.on("change",(function(n){r.Zf(r.ol.getData()),r.props.onFocus&&r.props.onFocus()})),this.ol.on("key",(function(n){r.props.onKeyDownChoiceOption&&13===n.data.keyCode&&(r.props.onKeyDownChoiceOption(),n.cancel())})),this.ol.on("paste",(function(n){if(r.props.onPasteChoiceOption){if("html"===n.data.type){n.data.dataValue=n.data.dataValue.replaceAll("<tr><td>",""),n.data.dataValue=n.data.dataValue.replaceAll("</td></tr>","\n");var t=Ti().sanitize(n.data.dataValue,{ALLOWED_ATTR:["style"],ALLOWED_TAGS:["span","strong","em","u","a"]});n.data.dataValue=t?t.toString():t}var e=n.data.dataValue;if(e=e.replaceAll("<br />","\n"))e.replace(/\r/g,"").split("\n").map((function(n){return n.trim()})).filter((function(n){return!!n})).length>1&&(r.props.onPasteChoiceOption(n),n.cancel())}})),this.ol.on("focus",(function(n){if($("#"+n.editor.name+"TBdiv").show(),r.ol.execCommand("selectAll"),r.props.onFocus){var t=n.editor;if(t){var e=t.document.getElementsByTag("a").toArray();(e=e.filter((function(n){return n.hasClass("cke_combo_button")||n.hasClass("cke_button__textcolor")})))&&e.length&&w.forEach(e,(function(n){n.on("click",(function(n){r.props.onFocus()}))}))}}})),CKEDITOR.on("dialogDefinition",(function(n){var t=n.data.definition.dialog;t.on("show",(function(){var n=document.getElementsByClassName("muliti-lingual-page-padding"),t=$("input.cke_dialog_ui_input_text[type=text]");if(t)for(var e=0;e<t.length;e++)t[e].labels&&t[e].labels.length>0&&"Display Text"===t[e].labels[0].innerText&&t[e].focus();if(n)if(0===$(".ms-Layer--fixed.lang-edit-layout-main").length){$(".ms-Layer--fixed.lang-edit-layout-clone").remove();var r=$(".ms-Layer--fixed").has(".cv-lang-edit-container"),i=$(".cke_dialog_background_cover:visible"),o=r.clone();if(0!==o.length&&0!==o.length&&0!=i.length){r.slice(0,1),o.slice(0,1),i.slice(0,1);var u=r[0].className,s=o[0].className;o[0].className=s+" lang-edit-layout-clone",r[0].className=u+" lang-edit-layout-main",o.insertAfter(i),$(".ms-Layer--fixed.lang-edit-layout-clone")[0].style.display="block",$(".ms-Layer--fixed.lang-edit-layout-main")[0].style.display="none"}}else 1===$(".ms-Layer--fixed.lang-edit-layout-clone").length&&($(".ms-Layer--fixed.lang-edit-layout-clone")[0].style.display="block",$(".ms-Layer--fixed.lang-edit-layout-main")[0].style.display="none")})),t.on("hide",(function(){document.getElementsByClassName("muliti-lingual-page-padding")&&($(".ms-Layer--fixed.lang-edit-layout-clone").remove(),$(".ms-Layer--fixed.lang-edit-layout-main").removeClass("lang-edit-layout-main").css("display","block"))}))})),this.ol.on("blur",(function(n){if($("#"+n.editor.name+"TBdiv").hide(),r.props.onFocus){var t=n.editor;if(t){var e=t.document.getElementsByTag("a").toArray();e&&e.length&&w.forEach(e,(function(n){n.removeAllListeners()}))}}r.props.onBlur&&r.props.onBlur()})),this.ol.on("instanceReady",(function(){if((0,yn.cT)()){var n=null,t=null,e=(0,g.f5)();e&&e.Model&&e.Model.FormMaster&&(n=e.Model.FormMaster.Model.SurveyFont,t=e.Model.FormMaster.Model.HeaderFont);var r=this.element.$.parentElement.parentElement.className,i=$(this.element.$).attr("aria-label"),o=$(this.element.$).attr("placeholder"),u="font-family";t&&r&&w.contains(["title-designer-title-editor","multi-lingual-title-editon-text","title-designer-subtitle-editor","multi-lingual-subtitle-edition-box"],r)&&i&&w.contains([(0,S.pm)().Designer_FormTitle,(0,S.pm)().Designer_FormSubtitle,(0,S.pm)().Designer_SectionTitle,(0,S.pm)().Designer_SectionSubtitle],i)?$(d.findDOMNode(this.element.$.parentElement)).find(".cke_editable_inline")[0].style[u]=t:n&&($(d.findDOMNode(this.element.$.parentElement)).find(".cke_editable_inline")[0].style[u]=n);var s=$(d.findDOMNode(this.element.$.parentElement)).find(".cke_editable_inline")[0];s&&i&&"false"===s.getAttribute("aria-label")&&(o?s.setAttribute("aria-label",o):s.setAttribute("aria-label",i))}if(CKEDITOR.env.ie||CKEDITOR.env.edge){var a=this,c=a.editable(),f=a.getSnapshot();c.on("compositionstart",l),c.on("compositionupdate",l),c.on("compositionend",l)}function l(){var n=a.getSnapshot();n!==f&&(f=n,a.fire("change"))}})),t&&w.forEach(t,(function(n){n&&n.addEventListener("click",(function(n){var t=n.target;!t||"form-designer-container"!==t.id&&"form-designer"!==t.id||r.ol.focusManager.blur(!0),"string"==typeof $(n.target)[0].className&&""!==$(n.target)[0].className.trim()&&$(n.target)[0].className.indexOf("cke_textarea_inline")<0&&$(n.target)[0].parentElement.className.indexOf("cke_textarea_inline")<0&&r.ol.focusManager.blur(!0)}))})),this.ol.on("key",(function(n){!r.props.blockEnter||13!==n.data.keyCode&&40!==n.data.keyCode||n.cancel()}))},t.prototype.al=function(n,t,e){return t&&n?(e=(e=e.concat({name:"custompipes",items:["pipeinsert"]})).concat({name:"answertags",items:["answertag"]}),this.props.addLink&&(e=e.concat({name:"Link",items:["Link"]}))):t?(e=e.concat({name:"answertags",items:["answertag"]}),this.props.addLink&&(e=e.concat({name:"Link",items:["Link"]}))):n&&(e=e.concat({name:"custompipes",items:["pipeinsert"]}),this.props.addLink&&(e=e.concat({name:"Link",items:["Link"]}))),e},t.prototype.render=function(){var n=w.clone(this.props);return n.ref=this.Ro,h.createElement(h.Fragment,null,this.state.isPanelOpen&&Ei({onDismissSaveDialogue:this.tl,isPanelOpen:this.state.isPanelOpen}),h.createElement(h.Fragment,null,(0,Ri.ZA)(n)))},t.prototype.tl=function(){this.setState({isPanelOpen:!1})},t}(C.r);var Di={ur:"اُردو",ht:"Kreyòl ayisyen",bn:"বাংলা","bn-IN":"বাংলা"};function xi(){return(0,p.mG)(this,void 0,void 0,(function(){return(0,p.Jh)(this,(function(n){switch(n.label){case 0:return[4,e.e(346).then(e.bind(e,31440))];case 1:return[2,{default:n.sent().CascadeRenderer}]}}))}))}function Li(n){var t=(0,Ni.J)(Li,xi);return h.createElement(Pi.Z,null,h.createElement(t,(0,p.pi)({},n)))}function Mi(){return(0,p.mG)(this,void 0,void 0,(function(){return(0,p.Jh)(this,(function(n){switch(n.label){case 0:return[4,e.e(745).then(e.bind(e,32726))];case 1:return[2,{default:n.sent().ConditionalThankyouContainer}]}}))}))}function qi(n){if(!n.formLocalizedItemMaster||!n.formMaster.Model.ConditionalThankyouMessage)return null;var t=(0,Ni.J)(qi,Mi);return h.createElement(Pi.Z,null,h.createElement(t,(0,p.pi)({},n)))}function Ai(){return(0,p.mG)(this,void 0,void 0,(function(){return(0,p.Jh)(this,(function(n){switch(n.label){case 0:return[4,e.e(963).then(e.bind(e,41963))];case 1:return[2,{default:n.sent().CVChoiceRenderer}]}}))}))}function Ui(n){var t=(0,Ni.J)(Ui,Ai);return h.createElement(Pi.Z,null,h.createElement(t,(0,p.pi)({},n)))}function Vi(){return(0,p.mG)(this,void 0,void 0,(function(){return(0,p.Jh)(this,(function(n){switch(n.label){case 0:return[4,e.e(274).then(e.bind(e,34301))];case 1:return[2,{default:n.sent().FileUploadRenderer}]}}))}))}function Gi(n){var t=(0,Ni.J)(Gi,Vi);return h.createElement(Pi.Z,null,h.createElement(t,(0,p.pi)({},n)))}function Bi(){return(0,p.mG)(this,void 0,void 0,(function(){return(0,p.Jh)(this,(function(n){switch(n.label){case 0:return[4,e.e(264).then(e.bind(e,41936))];case 1:return[2,{default:n.sent().HeaderThemeRender}]}}))}))}function zi(n){var t=(0,Ni.J)(zi,Bi);return h.createElement(Pi.Z,null,h.createElement(t,(0,p.pi)({},n)))}function ji(){return(0,p.mG)(this,void 0,void 0,(function(){return(0,p.Jh)(this,(function(n){switch(n.label){case 0:return[4,e.e(532).then(e.bind(e,46532))];case 1:return[2,{default:n.sent().CVQuestionRendererFooter}]}}))}))}function Qi(n){var t=(0,Ni.J)(Qi,ji);return h.createElement(Pi.Z,null,h.createElement(t,(0,p.pi)({},n)))}var Hi=e(76795),$i=e(58680),Wi=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return(0,p.ZT)(t,n),t.getElementTypeName=function(){return"Question.DateTime"},t.createDefaultDefinition=function(){return{Type:t.getElementTypeName(),Title:(0,S.pm)().Question_DefaultTitle,Date:!0,Time:!1,QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1}},t.supportMobileDesign=function(n){return!t.hasInvalidSettingOnMobile(n)},t.prototype.verify=function(n){return this.Model.Required&&!n?pn.ej.RequiredError:pn.ej.Success},t.prototype.getTypeDisplayName=function(){return(0,S.pm)().QuestionType_DateTime},t}($i.P),Ji=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return(0,p.ZT)(t,n),t.getElementTypeName=function(){return"Question.FileUpload"},t.createDefaultDefinition=function(){return{Type:t.getElementTypeName(),Title:(0,S.pm)().Question_DefaultTitle,HasSpecificFileType:!1,FileTypes:{Word:!0,Excel:!0,PowerPoint:!0,PDF:!0,Image:!0,Video:!0,Audio:!0},QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1,MaxFileCount:1,MaxFileSize:oi.EE[Object.keys(oi.EE)[0]]}},t.prototype.verify=function(n){return this.Model.Required&&!n?pn.ej.RequiredError:pn.ej.Success},t.prototype.getTypeDisplayName=function(){return(0,S.pm)().QuestionType_UploadFile},t}($i.P),Ki=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return(0,p.ZT)(t,n),t.getElementTypeName=function(){return"Question.MatrixChoice"},t.prototype.verify=function(n){return!this.Model.Required||n&&0!==n.length?pn.ej.Success:pn.ej.RequiredError},t.prototype.getTypeDisplayName=function(){return"MatrixChoice"},t.prototype.getNormalizedAnswer=function(n){return n},t}($i.P),Xi=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return(0,p.ZT)(t,n),t.getElementTypeName=function(){return"Question.MatrixChoiceGroup"},t.createDefaultDefinition=function(){var n=[{Description:(0,S.pm)().Designer_Choices_DefaultDescription.format(1),IsGenerated:!0,Id:1,Order:1},{Description:(0,S.pm)().Designer_Choices_DefaultDescription.format(2),IsGenerated:!0,Id:2,Order:2},{Description:(0,S.pm)().Designer_Choices_DefaultDescription.format(3),IsGenerated:!0,Id:3,Order:3},{Description:(0,S.pm)().Designer_Choices_DefaultDescription.format(4),IsGenerated:!0,Id:4,Order:4},{Description:(0,S.pm)().Designer_Choices_DefaultDescription.format(5),IsGenerated:!0,Id:5,Order:5}];return{Type:t.getElementTypeName(),Title:(0,S.pm)().Question_DefaultTitle,ChoiceGroup:n,QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1}},t.createSubQuestionsDefinition=function(){return[{Title:(0,S.pm)().Desinger_Likert_DefaultDescription.format(1),Type:"Question.MatrixChoice"},{Title:(0,S.pm)().Desinger_Likert_DefaultDescription.format(2),Type:"Question.MatrixChoice"}]},t.prototype.verify=function(n){return pn.ej.Success},t.prototype.getTypeDisplayName=function(){return(0,S.pm)().QuestionType_Likert},t.prototype.hasAnswer=function(){return!1},t}($i.P),Yi=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return(0,p.ZT)(t,n),t.getElementTypeName=function(){return"Question.NPS"},t.createDefaultDefinition=function(){return{Type:t.getElementTypeName(),Title:(0,S.pm)().NPS_DefaultTitle,LeftDescription:(0,S.pm)().NPS_LeftDescription,RightDescription:(0,S.pm)().NPS_RightDescription,QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1}},t.prototype.verify=function(n){return this.Model.Required&&!n&&0!==n?pn.ej.RequiredError:pn.ej.Success},t.prototype.getTypeDisplayName=function(){return(0,S.pm)().QuestionType_NPS},t.prototype.isNumberType=function(){return!0},t}($i.P),Zi=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return(0,p.ZT)(t,n),t.getElementTypeName=function(){return"Question.Ranking"},t.createDefaultDefinition=function(){var n=[{Description:(0,S.pm)().Designer_Choices_DefaultDescription.format(1),Order:1,Key:(0,A.GW)()},{Description:(0,S.pm)().Designer_Choices_DefaultDescription.format(2),Order:2,Key:(0,A.GW)()},{Description:(0,S.pm)().Designer_Choices_DefaultDescription.format(3),Order:3,Key:(0,A.GW)()}];return{Type:t.getElementTypeName(),Title:(0,S.pm)().Question_DefaultTitle,AllowMultipleValues:!0,ChoiceGroup:n,QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1}},t.prototype.verify=function(n){return!this.Model.Required||n&&0!==n.length?pn.ej.Success:pn.ej.RequiredError},t.prototype.getTypeDisplayName=function(){return(0,S.pm)().QuestionType_Ranking},t.prototype.isCorrectAnswer=function(n){var t=this;if(!n)return!1;var e,r=JSON.parse(this.Model.GradingBasis);e=w.isString(n)?JSON.parse(n):w.map(w.sortBy(n,(function(n){return n.answerOrder})),(function(n){return n.id}));var i=w.map(r,(function(n){return w.findWhere(t.Model.ChoiceGroup,{Key:n}).Id}));return e.length===i.length&&w.isEqual(i,e)},t.prototype.createQuizResult=function(n){if(this.Model.IsQuiz)return{IsAnswerCorrect:this.isCorrectAnswer(n),GradingBasis:this.Model.GradingBasis}},t.prototype.autoGradeAnswer=function(n){var t=this.Model.Point||0;n.Score=this.isCorrectAnswer(n.Answer)?t:0,n.IsAutoGraded=!0},t.prototype.autoGradeWithQuizResult=function(n,t){return t?t.IsAnswerCorrect?this.Model.Point:0:null},t.prototype.getNormalizedAnswer=function(n){return n||[]},t.prototype.hasCorrectAnswers=function(n){return!0},t.prototype.redressGradingBasis=function(){var n=this;this.Master.fieldsReady([(0,g.zE)().Schema.ChoiceGroup,(0,g.zE)().Schema.GradingBasis]).then((function(){var t=U.d.convertToArray(n.Master.Model.ChoiceGroup).sort((function(n,t){return n.Order-t.Order})).map((function(n){return n.Key}));n.Master.Model.GradingBasis=JSON.stringify(t)}))},t}($i.P),no=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return(0,p.ZT)(t,n),t.getElementTypeName=function(){return"Question.Rating"},t.createDefaultDefinition=function(){return{Type:t.getElementTypeName(),Title:(0,S.pm)().Question_DefaultTitle,Length:5,RatingShape:pn.le.Star,LeftDescription:"",RightDescription:"",MinRating:1,QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1}},t.supportMobileDesign=function(n){return!t.hasInvalidSettingOnMobile(n)&&!n.ShowRatingLabel},t.prototype.verify=function(n){return this.Model.Required&&!n?pn.ej.RequiredError:pn.ej.Success},t.prototype.getTypeDisplayName=function(){return(0,S.pm)().QuestionType_Rating},t.prototype.isNumberType=function(){return!0},t}($i.P);var to=e(13886),eo=e(91367);var ro=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return(0,p.ZT)(t,n),t.getElementTypeName=function(){return"Question.TextField"},t.createDefaultDefinition=function(){return t.createDefaultSingleLineDefinition()},t.createDefaultSingleLineDefinition=function(){var n={Type:t.getElementTypeName(),Title:(0,S.pm)().Question_DefaultTitle,Multiline:!1,QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1};return(0,P.md)((function(){n.FormsProCalculateSentiment=!1})),n},t.supportMobileDesign=function(n){return!t.hasInvalidSettingOnMobile(n)&&!n.IsNumber},t.prototype.verify=function(n){var t=n;if(this.Model.IsMathQuiz&&t){var e=(0,Le.d)(n);if((t=null==e.Answer?n:e.Answer).length>(0,Kr.xZ)())return pn.ej.MathLengthError}if(this.Model.Required&&!t)return pn.ej.RequiredError;if(t&&this.Model.HasTFRestrictionForPro&&(pn.PA.Email===this.Model.FormsProValidationType||pn.PA.Custom===this.Model.FormsProValidationType)){var r=pn.PA.Email===this.Model.FormsProValidationType?(0,Kr.FT)():new RegExp(this.Model.FormsProCustomRegEx),i=pn.PA.Email===this.Model.FormsProValidationType?t.trim():t;if(!this.fl(i,r)||""===i&&t!==i)return pn.ej.RegExValidationError}else if(t&&this.Model.IsNumber&&!this.ll(t))return pn.ej.NumberValidationError;return pn.ej.Success},t.prototype.getTypeDisplayName=function(){return this.Model.Multiline?(0,S.pm)().QuestionType_MultiLineText:this.Model.IsNumber?(0,S.pm)().Common_Number_Text:(0,S.pm)().QuestionType_SingleLineText},t.prototype.isNumberType=function(){return!!this.Model.IsNumber},t.prototype.justifyNumberBoundaries=function(){var n=this;this.Master.bulkEdit((function(){var t=n.Master.Model,e=(0,to.Q5)(t.NumberMinBoundary)||"1",r=(0,to.Q5)(t.NumberMaxBoundary)||"10";switch(t.NumberValidationRule){case pn.pW.Greater:case pn.pW.GreaterOrEqual:case pn.pW.Equal:case pn.pW.NotEqual:r=null;break;case pn.pW.Less:case pn.pW.LessOrEqual:e=null;break;case pn.pW.Between:case pn.pW.NotBetween:if(parseFloat(e)>parseFloat(r)){var i=e;e=r,r=i}}t.NumberMinBoundary=e,t.NumberMaxBoundary=r}))},t.prototype.getValidationErrorMessage=function(n,t){var e,r=this;return(0,P.md)((function(){var i=null!=n?n:(0,S.pm)();switch(r.Model.FormsProValidationType){case pn.PA.Email:e=i.EmailValidFormatError;break;case pn.PA.Custom:e=t||r.Model.FormsProCustomPlaceholder||i.CustomValidFormatError;break;default:e=r.getNumberValidationErrorMessage(i)}})),e},t.prototype.getNumberValidationErrorMessage=function(n){var t=this.Model.NumberValidationRule;if(null!=t){var e=function(n,t){var e=null!=t?t:(0,S.pm)();switch(n){case"Between":return e.NumberValidation_ErrorMessage_Between;case"Equal":return e.NumberValidation_ErrorMessage_Equal;case"Greater":return e.NumberValidation_ErrorMessage_Greater;case"GreaterOrEqual":return e.NumberValidation_ErrorMessage_GreaterOrEqual;case"Less":return e.NumberValidation_ErrorMessage_Less;case"LessOrEqual":return e.NumberValidation_ErrorMessage_LessOrEqual;case"None":return e.NumberValidation_ErrorMessage_None;case"NotBetween":return e.NumberValidation_ErrorMessage_NotBetween;case"NotEqual":return e.NumberValidation_ErrorMessage_NotEqual;default:return""}}(pn.pW[t],n);return null==e?void 0:e.format(this.Model.NumberMinBoundary,this.Model.NumberMaxBoundary)}},t.prototype.hasCorrectAnswers=function(n){return!(!this.Model.IsQuiz||this.Model.Multiline)&&new eo.E(n||this.Model).areAnyAnswersDefined()},t.prototype.isCorrectAnswer=function(t){return this.Model.IsQuiz&&!this.Model.Multiline?new eo.E(this.Model).isCorrect(t):n.prototype.isCorrectAnswer.call(this,t)},t.prototype.createQuizResult=function(n){if(new eo.E(this.Model).areAnyAnswersDefined()&&this.Model.IsQuiz)return{IsAnswerCorrect:this.isCorrectAnswer(n),GradingBasis:this.Model.GradingBasis}},t.prototype.autoGradeAnswer=function(t){if(this.Model.IsQuiz&&!this.Model.Multiline){var e=new eo.E(this.Model);if(e.areAnyAnswersDefined()){var r=this.Model.Point?this.Model.Point:0;t.Score=e.isCorrect(t.Answer)?r:0,t.IsAutoGraded=!0}else n.prototype.autoGradeAnswer.call(this,t)}else n.prototype.autoGradeAnswer.call(this,t)},t.prototype.autoGradeWithQuizResult=function(t,e){return e?this.Model.IsQuiz&&!this.Model.Multiline?e.IsAnswerCorrect?this.Model.Point:0:n.prototype.autoGradeWithQuizResult.call(this,t,e):null},t.prototype.fl=function(n,t){return void 0===n||""===n||!!t.test(n)},t.prototype.ll=function(n){if(void 0===n||""===n)return!0;if(!(0,to.ZR)(n))return!1;var t=parseFloat((0,to.Q5)(n)),e=parseFloat(this.Model.NumberMinBoundary),r=parseFloat(this.Model.NumberMaxBoundary);switch(this.Model.NumberValidationRule){case pn.pW.None:return!0;case pn.pW.Between:return t>=e&&t<=r;case pn.pW.NotBetween:return!(t>=e&&t<=r);case pn.pW.Greater:return t>e;case pn.pW.GreaterOrEqual:return t>=e;case pn.pW.Less:return t<r;case pn.pW.LessOrEqual:return t<=r;case pn.pW.Equal:return t===e;case pn.pW.NotEqual:return t!==e;default:return!0}},t.prototype.deserializeAnswer=function(n){if(this.Model.IsMathQuiz&&n&&""!=n){var t=(0,Le.d)(n);return this.Model.IsAnswerPlainText=!t.IsMath,null==t.Answer?n:t.Answer}return n},t}($i.P),io=e(18145),oo=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return(0,p.ZT)(t,n),t.getElementTypeName=function(){return"Question.CascadeGroup"},t.createDefaultDefinition=function(){return{Type:t.getElementTypeName(),Title:(0,S.pm)().Question_DefaultTitle,QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1,CascadeFileName:""}},t.createSubQuestionsDefinition=function(){var n,t=[];for(n=1;n<=(0,io.hu)();++n){var e={Title:(0,S.pm)().Desinger_Cascade_DefaultDescription.format(n),Type:"Question.CascadeLevel",CascadeLevel:n};t.push(e)}return t},t.supportMobileDesign=function(n){return!t.hasInvalidSettingOnMobile(n)},t.prototype.verify=function(n){return this.Model.Required&&!n?pn.ej.RequiredError:pn.ej.Success},t.prototype.getTypeDisplayName=function(){return(0,S.pm)().QuestionCategory_Cascade},t}($i.P),uo=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return(0,p.ZT)(t,n),t.getElementTypeName=function(){return"Question.CascadeLevel"},t.prototype.verify=function(n){return!this.Model.Required||n&&0!==n.length?pn.ej.Success:pn.ej.RequiredError},t.prototype.getTypeDisplayName=function(){return"CascadeLevel"},t.prototype.getNormalizedAnswer=function(n){return n},t}($i.P);var so=e(58537),ao=e(42605);var co=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.dl=h.createRef(),t}return(0,p.ZT)(t,n),t.prototype.render=function(){var n=w.extend({},this.props.HTMLAttributes,{id:"preview-setting-pane",role:"tablist",onKeyUp:this.ml.bind(this)});return n.className=(0,vn.j)("preview-setting-pane",n.className),h.createElement("div",n,this.createViewModeButtons())},t.prototype.createViewModeButtons=function(){return[this.vl(so.w.Desktop,"Desktop",(0,S.pm)().Response_Preview_DeviceType_Desktop,(0,S.pm)().Response_Preview_DeviceType_Desktop_ScreenReader),this.vl(so.w.Mobile,"Phone",(0,S.pm)().Response_Preview_DeviceType_Mobile,(0,S.pm)().Response_Preview_DeviceType_Mobile_ScreenReader)]},t.prototype.vl=function(n,t,e,r){var i=this,o="preview-mode-button office-form-theme-button-color office-form-theme-select-color",u=n===this.props.Value,s={"aria-label":r,className:u?"".concat(o," ").concat("active"):o,onClick:function(){i.props.onValueChange(n),(0,H.$U)("DesignPage.PreView.Navigate",{previewMode:so.w[n]})},"aria-selected":u,role:"tab",ref:u?null:this.dl};return(0,ao.F)({ButtonStyle:1,HTMLAttributes:s,FluentIcon:t,IconClassName:(0,v.QR)()?"forms-icon-size16x16":"forms-icon-size20x20",key:so.w[n],Text:e,TextClassName:"preview-mode-button-text"})},t.prototype.ml=function(n){var t;switch(n.keyCode){case 37:case 38:case 39:case 40:this.props.Value===so.w.Desktop?this.props.onValueChange(so.w.Mobile):this.props.onValueChange(so.w.Desktop),null===(t=this.dl.current)||void 0===t||t.focus()}},t}(C.r);var fo=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return(0,p.ZT)(t,n),t.prototype.createViewModeButtons=function(){var n=(0,D.cr)("CVLeapFrogVisualRefresh"),t=[this.bl(so.w.Desktop,!n&&"TVMonitor",(0,S.pm)().CustomerVoice_Preview_DeviceType_Desktop,(0,S.pm)().CustomerVoice_Preview_DeviceType_Desktop_ScreenReader,n&&"Desktop"),this.bl(so.w.Mobile,!n&&"MobileSelected",(0,S.pm)().Response_Preview_DeviceType_Mobile,(0,S.pm)().Response_Preview_DeviceType_Mobile_ScreenReader,n&&"Phone")];return(0,D.cr)("CustomerVoicePreviewEmbed")&&t.push(this.bl(so.w.Embed,"Info",(0,S.pm)().PIVOT_LABEL_EMBED,(0,S.pm)().PIVOT_LABEL_EMBED_TOOLTIP)),t},t.prototype.bl=function(n,t,e,r,i){var o=this,u={ButtonStyle:1,HTMLAttributes:{"aria-label":r,className:"cvpreview-mode-button",onClick:function(){o.props.onValueChange(n),(0,H.$U)("DesignPage.PreView.Navigate",{previewMode:so.w[n]})},"aria-selected":n===this.props.Value,role:"tab"},Icon:t,FluentIcon:i,IconClassName:"forms-icon-size20x20  cvpreview-mode-button-icon",key:so.w[n],Text:e,TextClassName:"preview-mode-button-text"};if((0,D.cr)("CVLeapFrogVisualRefresh")){var s=n===this.props.Value;u.IconClassName=(0,vn.j)("forms-icon-size20x20",s&&"office-form-theme-primary-color"),u.TextClassName=(0,vn.j)("cv-preview-mode-button-text",s&&"office-form-theme-primary-color")}return(0,ao.F)(u)},t}(co),lo=function(){function n(){}return n.setLocaleItem=function(n,t,e,r){n&&(this.localeItem=n!==t?w.find(r,(function(t){return t.localeId===n})):{localeId:n,localeName:e})},n.updatePausedResponseForTextQuestion=function(n,t,e,r,i){var o=t?(0,Ue.G)():(0,Ue.$o)(),u=o.getItem("officeforms.answermap.".concat(n,".").concat((0,c.k0)().userInfo.UserId)),s=null;if(u){var a=JSON.parse(u);Array.isArray(a)&&(s=a)}if(s){var f=o.getItem("officeforms.activesection".concat(n,".").concat((0,c.k0)().userInfo.UserId));this.callUpdatePausedResponse(s,n,f,e,r,i)}},n.callUpdatePausedResponse=function(n,t,e,r,i,o){if(t&&r){var u=document.getElementById("form-container");if(null!=u){var s=(new Date).toUTCString();!function(n,t,e){var r=0,i=(0,A.GW)();(0,H.JG)({type:"CustomerVoice_UpsertPausedResponseStart",eventInfo:{Component:"PauseResumeSurvey",requestId:i,inviteId:t}}),new Promise((function(o,u){var s=function(){r++,(0,Ge.lW)({requestUri:"".concat((0,Ut.nL)(),"api/upsertpausedresponse/forms/").concat(n,"/invites/").concat(t),method:"POST",body:JSON.stringify(e),headers:{__RequestVerificationToken:(0,c.k0)().antiForgeryToken,Accept:"application/json"},qosEventName:"upsertPausedResponse"}).then((function(){(0,H.JG)({type:"CustomerVoice_UpsertPausedResponseSuccess",eventInfo:{Component:"PauseResumeSurvey",requestId:i,inviteId:t}}),o(null)})).catch((function(n){r>3?((0,H.JG)({type:"CustomerVoice_UpsertPausedResponseFailed",eventInfo:{Component:"PauseResumeSurvey",requestId:i,inviteId:t,failureReasonMessage:null==n?void 0:n.message,failureReasonHeaders:null==n?void 0:n.headers,failureReasonResponse:null==n?void 0:n.response}}),o(null)):s()}))};s()}))}(t,r,{formId:t,inviteId:r,answers:JSON.stringify(n),activeSection:e,modifiedDate:s,langCode:this.localeItem&&JSON.stringify(this.localeItem),validationToken:i,expiryDuration:o})}}},n}();var ho=e(77309),mo=function(n){function t(t){var e=n.call(this,t)||this;return e.nu=h.createRef(),e.wl="",e.Il="",e.yl=function(){if(e.wl=e.props.ConfirmText,e.Il=e.props.Message,e.props.FormMaster){var n=e.props.FormMaster;if(n.isFieldReady(n.Schema.PipesDetails)&&n.Model.PipesDetails){var t;t=JSON.parse(n.Model.PipesDetails),w.forEach(t,(function(n){n.defaultValue&&(e.wl=e.wl.replace("{{".concat(n.pipeName,"}}"),n.defaultValue),e.Il=e.Il.replace("{{".concat(n.pipeName,"}}"),n.defaultValue))}))}}},e.wl=t.ConfirmText,e.Il=t.Message,e}return(0,p.ZT)(t,n),t.prototype.componentDidMount=function(){(0,_n.z)($(this.nu.current))},t.prototype.render=function(){var n;this.yl();var t=this.Il;n={RenderMode:"RichText",Text:this.Il,ContainsHtml:!0},t=(0,Ci.q)(n);var e=(0,Ci.q)({ContainsHtml:!0,RenderMode:"RichText",Text:this.wl});return h.createElement(ho.L,{Role:"Log",LazyRendering:!1},h.createElement("div",{className:"thank-you-page-confirm"},h.createElement("span",{className:"custom-thank-you-page-comfirm-text"},e)),h.createElement("div",{className:"thank-you-page-container thank-you-page-message",ref:this.nu,tabIndex:-1},t))},t}(C.r),vo=function(){function n(){}return n.prototype.createPreviewSettingPane=function(n){return function(n){return h.createElement(fo,n)}(n)},n.prototype.addHeaderFontToSchemas=function(n){var t=[Tn.x.Schema.HeaderFont];return n.push.apply(n,t),n},n.prototype.addSurveyFontToSchemas=function(n){var t=[Tn.x.Schema.SurveyFont];return n.push.apply(n,t),n},n.prototype.getModifiedTextField=function(n,t){if(!n||""===n.trim())return n;var e=(0,g.f5)();if(e&&e.Model&&e.Model.FormMaster){var r=e.Model.FormMaster;if(r&&t&&r.isFieldReady(r.Schema.HeaderFont)||!t&&r.isFieldReady(r.Schema.SurveyFont)){var i=function(n,t,e){void 0===e&&(e=null);var r=n;if(!t)return n;if("Segoe UI"===t){if(n&&n.indexOf("font-family")>0){var i=n.indexOf("font-family"),o=(s=n.slice(i+12)).indexOf('"'),u=s.slice(0,o);r=(r=(r=n.replace(u,"")).replace('<span style="font-family:">',"")).slice(0,r.length-7)}}else if(n)if(n.indexOf("font-family")>0){var s;i=n.indexOf("font-family"),o=(s=n.slice(i+12)).indexOf('"'),u=s.slice(0,o),r=n.replace(u,t)}else r='<span style="font-family:'+t+'">'+n+"</span>";else e&&(r='<span style="font-family:'+t+'">'+e+"</span>");return r}(n,t?r.Model.HeaderFont:r.Model.SurveyFont,null);n=P.Xw.sanitizeRichTextHTML(i)}}return n},n.prototype.getFooterElement=function(n){if("string"==typeof n){var t=this.getModifiedTextField(n,!1);return(0,Ci.q)({ContainsHtml:!0,RenderMode:"RichText",Text:t})}return n},n.prototype.getLazyLoadThemes=function(){return e.e(93).then(e.t.bind(e,89676,19)).then((function(n){return n.default}))},n.prototype.getDefaultTheme=function(){return{BackgroundColor:"#E9F0FE",BackgroundImage:null,Name:"CV_Blue",PrimaryColor:"#2266E3",SecondaryColor:"#1F5BCC",Thumbnail:(0,mn.Jn)("/Images/CustomerVoice/blue-thumbnail.png")}},n.prototype.getThemeBackground=function(n){var t,e;return(null===(e=null===(t=(0,g.f5)())||void 0===t?void 0:t.Model)||void 0===e?void 0:e.FormMaster)?(0,g.f5)().Model.FormMaster.Model.Background.ResourceUrl:n},n.prototype.getThemeStyle=function(n){var t="";return n&&n.PrimaryColor?(t+=".cv-design-theme-footer-edit-style { border-top-color:".concat(n.PrimaryColor,"; }"),t+=".form-designer-title-view:hover { background-color:".concat(n.SecondaryColor,"; }"),t+=".form-designer-title-view:active { background-color:".concat(n.SecondaryColor,"; }"),t+=".form-designer-title-view:focus { background-color:".concat(n.SecondaryColor,"; }"),(0,D.cr)("CVLeapFrogVisualRefresh")?t+=".office-form-textfield .cke_textarea_inline { outline: none; }\n                       .office-form-textfield .cke_textarea_inline:focus { border-bottom: 2px solid ".concat(n.PrimaryColor,"; }"):t+=".office-form-textfield .cke_textarea_inline { outline: 1px solid ".concat(n.PrimaryColor,"; }"),t+=".form-control:not([disabled]):focus { border-color: ".concat(n.PrimaryColor,"; }"),t+=".condition-tku-body .design-time-editing { border-color: ".concat(n.PrimaryColor,"; }"),t+=".inlinebr-select-control:active, .inlinebr-select-control:focus { border-color: ".concat(n.PrimaryColor,"; }"),t+=".inlinebr-textreader-anchor:active, .inlinebr-textreader-anchor:focus { border-color: ".concat(n.PrimaryColor,"; }")):t},n.prototype.getMediaPickerPaneText=function(){return h.createElement("span",{className:"media-select-text"},(0,S.pm)().ImagePicker_Insert_Media_Text)},n.prototype.areImageUploadButtonsEnabled=function(){return!1},n.prototype.getMediaPickerPaneTitle=function(){var n;return n="MediaSelect"===(0,g.f5)().Model.PreviousFlexPane?(0,S.pm)().ImagePicker_Insert_Mdeia_button:(0,S.pm)().Logo_Panel_Title,h.createElement("div",{className:"image-picker-panel-title"},n)},n.prototype.getMediaPickerPaneInfoContent=function(){if("MediaSelect"!==(0,g.f5)().Model.PreviousFlexPane){var n=(0,S.pm)().Logo_Panel_Content;return h.createElement("div",{className:"image-picker-panel-info-content"},n)}return null},n.prototype.getImagePickerLocalContainerClassName=function(){return"cv-image-picker-local-switch-button"},n.prototype.getFlexPaneWidth=function(){return 480},n.prototype.getErrorPage=function(){return(0,p.mG)(this,void 0,Promise,(function(){return(0,p.Jh)(this,(function(n){switch(n.label){case 0:return[4,e.e(653).then(e.bind(e,95586))];case 1:return[2,{default:n.sent().ErrorPage}]}}))}))},n.prototype.callUpdatePR=function(n,t,e,r,i,o){lo.callUpdatePausedResponse(t,e,r,n,i,o)},n.prototype.callGetPausedResponse=function(n,t){return function(n,t){var e=0,r=(0,A.GW)();return(0,H.JG)({type:"CustomerVoice_FetchPausedResponseStart",eventInfo:{Component:"PauseResumeSurvey",requestId:r,inviteId:t}}),new Promise((function(i,o){var u=function(){e++,(0,Ge.lW)({requestUri:"".concat((0,Ut.nL)(),"api/fetchpausedresponse/forms/").concat(n,"/invites/").concat(t),method:"GET",headers:{__RequestVerificationToken:(0,c.k0)().antiForgeryToken,Accept:"application/json",qosEventName:"getPausedResponse"}}).then((function(n){(0,H.JG)({type:"CustomerVoice_FetchPausedResponseSuccess",eventInfo:{Component:"PauseResumeSurvey",requestId:r,inviteId:t}}),i(n)})).catch((function(n){e>3?((0,H.JG)({type:"CustomerVoice_FetchPausedResponseFailed",eventInfo:{Component:"PauseResumeSurvey",requestId:r,inviteId:t,failureReasonMessage:null==n?void 0:n.message,failureReasonHeaders:null==n?void 0:n.headers,failureReasonResponse:null==n?void 0:n.response}}),i(null)):u()}))};u()}))}(n,t)},n.prototype.callSetLocaleItem=function(n,t,e,r){lo.setLocaleItem(n,t,e,r)},n.prototype.callDeletePausedResponse=function(n,t){!function(n,t){var e=0,r=(0,A.GW)();(0,H.JG)({type:"CustomerVoice_DeletePausedResponseStart",eventInfo:{Component:"PauseResumeSurvey",requestId:r,inviteId:t}}),new Promise((function(i,o){var u=function(){e++,(0,Ge.lW)({requestUri:"".concat((0,Ut.nL)(),"api/deletepausedresponse/forms/").concat(n,"/invites/").concat(t),method:"DELETE",headers:{__RequestVerificationToken:(0,c.k0)().antiForgeryToken,Accept:"application/json"},qosEventName:"deletePausedResponse"}).then((function(){(0,H.JG)({type:"CustomerVoice_DeletePausedResponseSuccess",eventInfo:{Component:"PauseResumeSurvey",requestId:r,inviteId:t}}),i(null)})).catch((function(n){e>3?((0,H.JG)({type:"CustomerVoice_DeletePausedResponseFailed",eventInfo:{Component:"PauseResumeSurvey",requestId:r,inviteId:t,failureReasonMessage:null==n?void 0:n.message,failureReasonHeaders:null==n?void 0:n.headers,failureReasonResponse:null==n?void 0:n.response}}),i(null)):u()}))};u()}))}(n,t)},n.prototype.callUpdatePRForTextQuestion=function(n,t,e,r,i){lo.updatePausedResponseForTextQuestion(n,t,e,r,i)},n.prototype.getConditionalThankyouControl=function(n){return qi(n)},n.prototype.derivedThankYouMessageKey=function(n,t,r){return(0,p.mG)(this,void 0,Promise,(function(){var i;return(0,p.Jh)(this,(function(o){switch(o.label){case 0:return[4,e.e(653).then(e.bind(e,51229))];case 1:return i=o.sent().default,[2,Promise.resolve(i(n,t,r))]}}))}))},n.prototype.getMessageContent=function(n){return h.createElement(mo,n)},n.prototype.createHeaderThemeRenderer=function(n){return zi(n)},n.prototype.createFileUploadQuestionRenderer=function(n){return Gi(n)},n.prototype.createCascadeQuestionRenderer=function(n){return Li(n)},n.prototype.createChoiceQuestionRenderer=function(n){return Ui(n)},n.prototype.getQuestionDelegatorClass=function(n){return function(n){switch(n){case"Question.Choice":return Hi.L;case"Question.TextField":return ro;case"Question.DateTime":return Wi;case"Question.Rating":return no;case"Question.Ranking":return Zi;case"Question.MatrixChoice":return Ki;case"Question.MatrixChoiceGroup":return Xi;case"Question.NPS":return Yi;case"Question.FileUpload":return Ji;case"Question.CascadeLevel":return uo;case"Question.CascadeGroup":return oo;default:throw Error(n+" is not supported")}}(n)},n.prototype.getCustomLanguageFriendlyName=function(n){return Di[t=n]||t;var t},n.prototype.getQuestionRendererFooter=function(n){return Qi(n)},n.prototype.handleSubmitButtonClick=function(n,t){return(0,p.mG)(this,void 0,void 0,(function(){return(0,p.Jh)(this,(function(r){switch(r.label){case 0:return[4,e.e(653).then(e.bind(e,66796))];case 1:return[2,(0,r.sent().default)(n,t)]}}))}))},n.prototype.cvOnlyLanguageUtility=function(){return Fi.V.getSingletonInstance()},n}();var po,go=e(66676),bo=e(83830);function wo(n,t){return(0,_.a)().AuthContext.getFormApiToken().then((function(e){var r;return n.headers=$.extend(!0,n.headers,(r=e||"",{__RequestVerificationToken:(0,c.k0)().antiForgeryToken,Accept:"application/json",Authorization:(0,Xe.U)(r),"Content-Type":"application/json"})),(0,Ge.lW)(n,t).then((function(n){return n?(0,We.EI)(n):Promise.reject("Data is null.")}),We.W3)}))}function Io(n,t,e){void 0===e&&(e="");var r="".concat((0,bo.v)(),"intelligence/api/")+"forms(".concat(n,")/LogUserActionSigsSignals"),i={UserActionSigsSignals:t,FormContent:e,Locale:(0,go.K)()};return wo({body:JSON.stringify(i),method:"POST",qosEventName:"Intelligence.LogUserActionSigsSignals",requestUri:r})}!function(n){n[n.Form=0]="Form",n[n.Question=1]="Question",n[n.Response=2]="Response",n[n.ThemeSuggestion=3]="ThemeSuggestion",n[n.QuestionSuggestion=4]="QuestionSuggestion",n[n.HistorySuggestion=5]="HistorySuggestion",n[n.EstimatedTime=6]="EstimatedTime",n[n.Insights=7]="Insights"}(po||(po={}));var yo=function(){function n(){this.Sl=[],this.Fl="",this.Cl=""}return n.prototype.addUserActionSignal=function(n,t,e,r){var i=this;if(void 0===r&&(r=!1),!(0,et.x8)()){var o=(0,Yn.x_)();if(o){var u={UserActionName:n,UserActionType:t,InteractiveContent:e?JSON.stringify(e):"",SessionId:(0,Ae.k)()},s=(0,g.f5)().Model;if(s&&s.FormMaster&&s.FormMaster.Model)(function(n){return n.fieldsReady([Tn.x.Schema.Title,Tn.x.Schema.Questions]).then((function(){var t,e=U.d.convertToArray(n.Model.Questions)||[],r=[];e.forEach((function(n){var t=[],e=n.ChoiceGroup;(U.d.convertToArray(e).map(Wr.k)||[]).forEach((function(n){if(n.isFieldReady(n.Schema.Id)&&n.isFieldReady(n.Schema.Description)&&n.isFieldReady(n.Schema.Order)){var e={DisplayText:n.Model.Description,ChoiceId:n.Model.Id.toString(),ChoiceOrder:n.Model.Order};t.push(e)}}));var i={QuestionId:n.Id,QuestionTitle:n.Title,QuestionType:n.Type,QuestionInfo:n.QuestionInfo,QuestionOrder:n.Order,QuestionSubtitle:n.Subtitle,Choices:t,Required:n.Required,IsQuiz:n.IsQuiz};r.push(i)}));var i=null===(t=n.FormElementManager)||void 0===t?void 0:t.SectionMasters;i&&i.length>0&&i.forEach((function(n){r.push({QuestionId:n.Model.Id,QuestionTitle:n.Model.Title,QuestionType:n.Model.Type,QuestionInfo:n.Model.QuestionInfo,QuestionOrder:n.Model.Order,QuestionSubtitle:n.Model.Subtitle})}));var o={FormTitle:n.Model.Title,FormType:n.Model.Type,FormDescription:n.Model.Description,Questions:r};return JSON.stringify(o)}))})(s.FormMaster).then((function(n){var t,s,a=(0,nt.vj)("UserActionSignalMaxQueueLength",10),c=(new Date).toUTCString();if(u.UpdateActionUTCTime=[],i.Fl===o||""===i.Fl){var f=i._l(u),l=null!=e&&((null===(t=e.AdoptedCandidates)||void 0===t?void 0:t.length)>0||(null===(s=e.Candidates)||void 0===s?void 0:s.length)>0);if(f&&!l){var h=f.UpdateActionUTCTime;h.push(c),u.UpdateActionUTCTime=h}else u.UpdateActionUTCTime.push(c),i.Sl.push(u);var d=0;i.Sl.forEach((function(n){d+=n.UpdateActionUTCTime.length})),i.Fl=o,i.Cl=n,(r||d>=a)&&(Io(o,i.Sl,n),i.Tl())}else Io(i.Fl,i.Sl,i.Cl),i.Tl(o,n,[]),u.UpdateActionUTCTime.push(c),i.Sl.push(u)}))}}},n.prototype.Tl=function(n,t,e){void 0===n&&(n=""),void 0===t&&(t=""),void 0===e&&(e=[]),this.Fl=n,this.Cl=t,this.Sl=e},n.prototype._l=function(n){return this.Sl&&I().find(this.Sl,(function(t){return t.UserActionName===n.UserActionName&&t.UserActionType===n.UserActionType}))},n}();var So=e(80820),Fo=e(46407);function Co(){return(0,p.mG)(this,void 0,void 0,(function(){return(0,p.Jh)(this,(function(n){switch(n.label){case 0:return[4,e.e(274).then(e.bind(e,89925))];case 1:return[2,{default:n.sent().FileUploadRenderer}]}}))}))}function _o(n){var t=(0,Ni.J)(_o,Co);return h.createElement(Pi.Z,null,h.createElement(t,(0,p.pi)({},n)))}var To=e(24742),Po=e(92575),No=e(29952),ko=e(49211),Eo=e(43367),Ro=e(48186),Oo=e(22768),Do=e(24497),xo=e(155),Lo=e(22530),Mo=e(17764),qo=e(61111),Ao=e(55982),Uo=e(30148),Vo="6c660282-db72-436c-87bb-8272cba504d3",Go=function(n){function t(t){var e=n.call(this,t)||this;e.Pl=h.createRef(),e.Nl=(0,A.GW)();var r=e.El(),i=e.Rl(),o=e.Dl();return e.state={ChoiceOptions:i,IsOtherOptionSelected:!!r.OtherAnswer,LocalizedOptions:e.questionLocalizedItemMaster&&e.questionLocalizedItemMaster.Model.option,OptionsOrder:o,OrderedChoices:w.map(o,(function(n){return i[n]})),OtherOptionText:r.OtherAnswer,ReachMaxLengthLimit:!1,SelectedOptions:r.SelectedOptions},e.qo=e.qo.bind(e),e.xl=e.xl.bind(e),e.Ll=e.Ll.bind(e),e.ql=e.ql.bind(e),e.Al=e.Al.bind(e),e.Ul=e.Ul.bind(e),e}return(0,p.ZT)(t,n),t.prototype.componentDidMount=function(){var t=this;n.prototype.componentDidMount.call(this),this.props.Master.Question.observe(this.Ll),(this.props.ShowQuizResult||this.props.IncrementalLoadFormsEnabled)&&this.props.Master.observe(this.Al,[Lo.r.Schema.Answer]),(0,P.md)((function(){t.props.Master.observe(t.Al,[Lo.r.Schema.Answer])})),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.ql,[xo.A.Schema.choicesV1]);var e=[];e=(0,Eo.addIoCSurveyFontToSchemas)(e),this.props.Master.Question.Form.observe(this.update,e)},t.prototype.componentWillUnmount=function(){var t=this;this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.ql),this.props.Master.Question.Form.unobserve(this.update),this.props.Master.Question.unobserve(this.Ll),(this.props.ShowQuizResult||this.props.IncrementalLoadFormsEnabled)&&this.props.Master.unobserve(this.Al,[Lo.r.Schema.Answer]),(0,P.md)((function(){t.props.Master.unobserve(t.Al,[Lo.r.Schema.Answer])})),n.prototype.componentWillUnmount.call(this)},t.prototype.componentWillReceiveProps=function(t){var e=this;this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.ql),n.prototype.componentWillReceiveProps.call(this,t),this.questionLocalizedItemMaster&&(this.questionLocalizedItemMaster.observe(this.ql,[xo.A.Schema.choicesV1]),(0,P.md)((function(){e.Vl(e.props.Master.Model.Answer)})))},t.prototype.shouldComponentUpdate=function(n,t){var e=!w.isEqual(n,this.props),r=!w.isEqual(t,this.state);return e||r},t.prototype.createReactNodes=function(){var n=this.props.Master.Question,t=n.Model,e=t.ChoiceType===pn.T6.SingleChoice;return this.props.IsPrintViewDesignTime||this.props.ExpandAll||!n.showAsDropdown()||t.IsQuiz&&this.props.ShowQuizResult?[this.createChoices(e),this.getErrorMessageLabel()]:[this.Gl()]},t.prototype.getFormattedDataForImmersiveReader=function(){var t=n.prototype.getFormattedDataForImmersiveReader.call(this),e=null,r=document.createElement("ul");return w.forEach(this.state.OrderedChoices,(function(n){var t=document.createElement("li"),i=null;if(n.IsMathOption&&"undefined"!=typeof MathJax){e=e||MathJax.Hub.getAllJax(null);var o=w.find(e,(function(t){return t.originalText===n.Description}));if(o){var u=o.root&&o.root.toMathML&&o.root.toMathML();u&&(u=u.replace(/\n\s*/g,""),i="\x3c!--[if mathML]&#62;".concat((0,Hn.F1)(u,!0),"&#60;![endif]--\x3e"))}}if(i)(0,Po.p)(t,i);else{var s=document.createTextNode(n.Description);t.appendChild(s)}r.appendChild(t)})),r.appendChild(document.createElement("br")),t.splice(t.length-1,0,{content:r.outerHTML,mimeType:"text/html"}),t},t.prototype.Al=function(){var n=this.El(),t=!!n.OtherAnswer,e=this.props.Master.Question.Model.ChoiceType===pn.T6.SingleChoice;(0,P.hl)((function(){e&&(t=!!n.OtherAnswer&&0===n.SelectedOptions.length)})),this.setState({IsOtherOptionSelected:t,OtherOptionText:n.OtherAnswer,SelectedOptions:n.SelectedOptions})},t.prototype.Vl=function(n){if((0,D.cr)("FormsProAnswerTag")){var t=w.findIndex(this.props.Master.Question.Model.Choices,(function(t){return t.Description===n}));if(t>-1){var e=this.questionLocalizedItemMaster,r=void 0;if(e){var i=e.getChoiceV1LocalizedMaster(t);r=i&&i.Model.description,r=i.Model.formsProDisplayRTText||r,this.props.Master.Model.SelectedChoice=r}else this.props.Master.Model.SelectedChoice=n}}},t.prototype.Bl=function(){var n,t=this,e=[],r=this.props.Master.Question.Model.ChoiceType===pn.T6.SingleChoice,i=this.state.SelectedOptions;i&&i.forEach((function(n){return e.push(n)}));var o=this.state.OtherOptionText;if((0,P.pd)((function(){t.state.IsOtherOptionSelected&&o&&-1===e.indexOf(o)&&e.push(o)}),(function(){t.state.IsOtherOptionSelected&&!(0,Ro.l)(o)&&-1===e.indexOf(o)&&e.push(o)})),r)n=e[0];else if(e.length){var u=this.zl(e);n=JSON.stringify(u)}(0,P.md)((function(){t.Vl(n)})),this.props.Master.Model.Answer=n},t.prototype.createChoices=function(n){var e=this,r=this.props.Master.Question.Model,i=this.state.OrderedChoices.length+(r.AllowOtherAnswer?1:0),o=this.props.Master.Question.Form,u=(0,ko.w)(o,"ResponsePage.PollView"),s=(0,vn.j)(this.props.IsMobile&&!u?"office-form-question-choice-mobile office-form-theme-page-background-active":"office-form-question-choice"),a=this.state.OrderedChoices.map((function(r,o){var u,a,c=-1!==e.state.SelectedOptions.indexOf(r.Description),f=e.props.Master.Question.Model.IsQuiz?"office-form-question-choice-quiz-row":"";if(e.props.Master.Question.Model.IsMathQuiz&&r.IsMathOption){var l=(0,Oo.Rq)({DisableLinebreaks:e.props.DisableFormulaLinebreak,Formula:r.Description,onRenderComplete:e.props.onHeightChange}),d="office-form-question-choice-formula";(0,y.vh)()&&(d+=" formula-renderer-container-safari9"),a=h.createElement("div",{className:d},l)}else{f=(0,vn.j)(f,"office-form-question-choice-text-row");var m=null===(u=e.questionLocalizedItemMaster)||void 0===u?void 0:u.getChoiceV1LocalizedMaster(e.state.OptionsOrder[o]),v=(0,Do.wg)(r.Description,r.FormsProDisplayRTText);m&&(v=(0,Do.wg)(m.Model.description,m.Model.formsProDisplayRTText)||v),(0,P.md)((function(){e.questionLocalizedItemMaster||(e.props.Master.Model.SelectedChoice=e.props.Master.Model.Answer)}));var p={Text:(0,Eo.getIoCModifiedTextField)(v,!1),ContainsHtml:!0,RenderMode:"RichText"};a=h.createElement("span",{className:"office-form-question-choice-text-span"},(0,Ci.q)(p))}var g,b=t.getAnswerKeyMark(e.props,r,c);switch(b){case"Correct":g=e.props.LocalizedStrings.Quiz_CorrectAnswer;break;case"Wrong":g=e.props.LocalizedStrings.Quiz_WrongAnswer}var I={name:e.Nl};return n&&w.extend(I,{"aria-posinset":o+1,"aria-setsize":i}),h.createElement(Ao.h,{AnswerHint:t.getAnswerHintLabel(e.props,r,c),AnswerType:b,ToolTipForAnswer:g,Choice:r,ClassNameForLabel:f,ContainerClassName:s,Disabled:e.props.Disabled,HTMLPropsForInput:I,IsChecked:c,IsMobile:e.props.IsMobile,IsSingleChoice:n,key:o,LocalizedStrings:e.props.LocalizedStrings,onChange:e.qo},a)})),c=this.getElementProps({key:"choicequestion-choices",role:n?"radiogroup":"group"});return h.createElement("div",(0,p.pi)({},c),a,this.jl(n))},t.prototype.jl=function(n){var t=this.props.Master.Question.Form,e=(0,ko.w)(t,"ResponsePage.PollView");if(this.props.Master.Question.Model.AllowOtherAnswer){var r={className:this.props.IsMobile&&!e?"office-form-other-answer-mobile":"office-form-other-answer",key:"other-answer"};return h.createElement("div",(0,p.pi)({},r),h.createElement("div",{className:"radio"},h.createElement("label",null,this.Ql(n),this.Hl())))}},t.prototype.Ql=function(n){var t=this.state.ChoiceOptions,e={"aria-label":this.props.LocalizedStrings.Response_Page_OtherAnswerTitle,checked:this.state.IsOtherOptionSelected,disabled:this.props.Disabled,name:n?this.Nl:void 0,onChange:this.xl,ref:"otherAnswerInput",role:"checkbox",type:"checkbox",value:this.state.OtherOptionText||""};return n&&(e.role="radio",e.type="radio",e["aria-posinset"]=t.length+1,e["aria-setsize"]=t.length+1,(0,P.md)((function(){e["aria-checked"]=e.checked}))),h.createElement("input",(0,p.pi)({},e))},t.prototype.xl=function(){var n=this,t=this.state.IsOtherOptionSelected,e=w.clone(this.state.SelectedOptions);if(!t){this.props.Master.Question.Model.ChoiceType===pn.T6.SingleChoice&&(e=[]);var r=this.Pl.current;r&&r.focus()}this.setState({IsOtherOptionSelected:!t,SelectedOptions:e},(function(){return n.Bl()}))},t.prototype.Hl=function(){var n={"aria-label":this.props.LocalizedStrings.Response_Page_OtherAnswerTitle,className:"office-form-other-answer-textbox"},t=this.props.IsPrintViewDesignTime?"":this.props.LocalizedStrings.Designer_OtherAnswer,e={AutoSelection:!0,Disabled:this.props.Disabled,HTMLAttributes:{className:"inline-display office-form-other-answer-margin-left-mobile"},MaxLength:(0,Kr.kA)(),onValueChange:this.Ul,Options:{HTMLPropsForInnerElement:n},Placeholder:t,ref:this.Pl,Value:this.state.OtherOptionText||""},r=this.props.IsPrintViewDesignTime&&h.createElement("div",{className:"print-choice-other-answer-hint"},this.props.LocalizedStrings.Designer_OtherAnswer);return h.createElement("div",{className:"office-form-other-answer-inline"},(0,Ri.ZA)(e),r)},t.prototype.Ul=function(n){var t=this,e=this.state.SelectedOptions;this.props.Master.Question.Model.ChoiceType===pn.T6.SingleChoice&&(e=[]),this.setState({IsOtherOptionSelected:!!n,OtherOptionText:n,SelectedOptions:e},(function(){return t.Bl()}))},t.prototype.Ll=function(){var n=this.El();this.setState({ChoiceOptions:this.Rl(),OptionsOrder:this.Dl(),OrderedChoices:this.$l(),OtherOptionText:n.OtherAnswer,SelectedOptions:n.SelectedOptions})},t.prototype.ql=function(){this.setState({LocalizedOptions:this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.Model.option})},t.prototype.qo=function(n){var t=this,e=w.clone(this.state.SelectedOptions),r=this.props.Master.Question.Model.ChoiceType===pn.T6.SingleChoice,i=this.state.IsOtherOptionSelected,o=!1;if(r){if(n===e[0])return;i=!1,e=[n]}else{var u=e.indexOf(n);-1===u?e.push(n):e.splice(u,1),o=JSON.stringify(e).length>Hi.L.MaxAnswerLength}this.setState({IsOtherOptionSelected:i,ReachMaxLengthLimit:o,SelectedOptions:e,OtherOptionText:r?"":this.state.OtherOptionText},(function(){return t.Bl()}))},t.prototype.getErrorMessageLabel=function(){if(this.state.ReachMaxLengthLimit)return(0,Mo._)({Alert:!0,HTMLAttributes:{className:"validation-error-message-label",role:"alert"},key:"textquestion-errorlabel",Label:this.props.LocalizedStrings.Error_Message_Question_Reach_Limit})},t.prototype.Gl=function(){var n,t,e=this,r=this.props.Master,i=r.Question.Model,o=this.state.OrderedChoices.map((function(n,t){var r,i=null===(r=e.questionLocalizedItemMaster)||void 0===r?void 0:r.getChoiceV1LocalizedMaster(e.state.OptionsOrder[t]);return{DisplayName:(0,Do.wg)(null==i?void 0:i.Model.description,null==i?void 0:i.Model.formsProDisplayRTText)||(0,Do.wg)(n.Description,n.FormsProDisplayRTText),Key:U.d.getObjectMasterFromModel(n).getInstanceId(),Value:n.Description}})),u=r.Model.Answer;i.AllowOtherAnswer&&o.push(this.Wl()),this.state.IsOtherOptionSelected&&(u=Vo),!this.props.ShowDesignInfo&&this.state.IsOtherOptionSelected&&(n=this.Jl()),t=function(n){return e.Kl(n)};var s=(0,No.Oy)()?this.props.LocalizedStrings.Question_Choice_Placeholder:this.props.LocalizedStrings.Dropdown_DefaultHint,a=(0,qo.E)({AllowWrap:!0,HTMLAttributes:this.getElementProps({className:"office-form-question-dropdown",disabled:this.props.Disabled,title:i.Hint||s}),Label:i.Hint||s,key:"choicequestion-dropdown",onValueChange:t,Placeholder:i.Hint||s,SelectOptions:o,Value:u,NeedScroll:this.props.IsMobile});return h.createElement("div",{className:this.getValidationStyle()},a,n)},t.prototype.Kl=function(n){var t=this,e=n===Vo,r=e?[]:[n];(0,P.pd)((function(){t.setState({IsOtherOptionSelected:e,SelectedOptions:r},(function(){return t.Bl()}))}),(function(){t.setState({IsOtherOptionSelected:e,OtherOptionText:t.state.OtherOptionText||(e?"":void 0),SelectedOptions:r},(function(){return t.Bl()}))}))},t.prototype.Wl=function(){return{DisplayName:this.props.LocalizedStrings.Designer_OtherAnswer,Key:Vo,Value:Vo}},t.prototype.Jl=function(){var n=this,t=(0,No.Oy)()?this.props.LocalizedStrings.Question_TextFiled_Placeholder:this.props.LocalizedStrings.TextField_DefaultPlaceholder,e={"aria-label":t,className:"office-form-other-answer-textbox"},r={AutoFocus:!0,Disabled:this.props.Disabled,HTMLAttributes:{className:"office-form-other-answer office-form-dropdown-other-answer"},onValueChange:function(t){n.setState({OtherOptionText:t,SelectedOptions:[]},(function(){return n.Bl()}))},Options:{HTMLPropsForInnerElement:e},Placeholder:t,ref:this.Pl,Value:this.state.OtherOptionText};return(0,Ri.ZA)(r)},t.prototype.zl=function(n){var t=this.props.Master.Question.Model.Choices,e=w.map(t,(function(n){return n.Description}));return n.sort((function(n,t){return e.indexOf(n)-e.indexOf(t)}))},t.isQuizResultAnswerKey=function(n,t){if(!n||!n.IsAnswerKeys)return!1;var e=n.Choices;return!!e&&n.IsAnswerKeys[e.indexOf(t.Description)]},t.getAnswerKeyMark=function(n,e,r){var i=n.Master,o=i.Model.QuizResult,u=i.Question,s=t.isQuizResultAnswerKey(o,e);return e.IsAnswerKey&&n.ShowDesignInfo&&u.Model.IsQuiz||s?"Correct":r&&o&&o.IsAnswerKeys&&o.IsAnswerKeys.some((function(n){return n}))&&!s?"Wrong":"Normal"},t.getAnswerHintLabel=function(n,t,e){var r=n.Master.Model.QuizResult;if(!n.ShowDesignInfo&&e&&r){var i=r.Choices,o=i?i.indexOf(t.Description):-1;return r.AnswerHints&&r.AnswerHints[o]}},t.prototype.Rl=function(){var n=this.props.Master.Question.Model;return this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.getChoiceV1LocalizedMaster(n.Choices.length-1),U.d.convertToArray(n.Choices)},t.prototype.$l=function(){var n=this;return w.map(this.state.OptionsOrder,(function(t){return n.state.ChoiceOptions[t]}))},t.prototype.Dl=function(){for(var n=this.props.Master.Question.Model,t=[],e=0;e<n.Choices.length;e++)t[e]=e;return this.props.ShowQuizResult||!n.ShuffleOptions||this.props.DisableShuffle?t:w.shuffle(t)},t.prototype.El=function(){var n,t=this.props.Master,e=t.Model,r=t.Question.Model,i=r.ChoiceType===pn.T6.SingleChoice,o=[],u=(0,Hi.P)(e.Answer,r).SelectedOptions;u.length>0&&(i?[e.Answer]:u).forEach((function(t){-1!==w.findIndex(r.Choices,(function(n){return n.Description===t}))?o.push(t):r.AllowOtherAnswer&&(n=t)}));return{OtherAnswer:n,SelectedOptions:o}},t}(Uo.e),Bo=function(){function n(){}return n.prototype.createPreviewSettingPane=function(n){return function(n){return h.createElement(co,n)}(n)},n.prototype.addHeaderFontToSchemas=function(n){return n},n.prototype.addSurveyFontToSchemas=function(n){return n},n.prototype.getModifiedTextField=function(n,t){return n},n.prototype.getFooterElement=function(n){return n},n.prototype.getLazyLoadThemes=function(){return e.e(985).then(e.t.bind(e,79881,19)).then((function(n){return n.default}))},n.prototype.getDefaultTheme=function(){return{BackgroundColor:So.lP,BackgroundImage:null,Name:Fo.kC,PrimaryColor:So.tu,SecondaryColor:So.oc,Thumbnail:(0,mn.Jn)("/Images/Theme/new-teal-thumbnail.png")}},n.prototype.getThemeBackground=function(n){return n},n.prototype.getThemeStyle=function(n){return""},n.prototype.getMediaPickerPaneText=function(){return null},n.prototype.areImageUploadButtonsEnabled=function(){return!0},n.prototype.getMediaPickerPaneTitle=function(){return null},n.prototype.getMediaPickerPaneInfoContent=function(){return null},n.prototype.getImagePickerLocalContainerClassName=function(){return null},n.prototype.getFlexPaneWidth=function(){return 600},n.prototype.getErrorPage=function(){return(0,p.mG)(this,void 0,void 0,(function(){return(0,p.Jh)(this,(function(n){switch(n.label){case 0:return[4,e.e(653).then(e.bind(e,6399))];case 1:return[2,{default:n.sent().ErrorPage}]}}))}))},n.prototype.callUpdatePR=function(n,t,e,r,i,o){return null},n.prototype.callGetPausedResponse=function(n,t){return Promise.resolve(null)},n.prototype.callSetLocaleItem=function(n,t,e,r){return null},n.prototype.callDeletePausedResponse=function(n,t){return null},n.prototype.callUpdatePRForTextQuestion=function(n,t,e,r,i){return null},n.prototype.getConditionalThankyouControl=function(n){return null},n.prototype.createHeaderThemeRenderer=function(n){return null},n.prototype.derivedThankYouMessageKey=function(n,t,e){return(0,p.mG)(this,void 0,Promise,(function(){return(0,p.Jh)(this,(function(n){return[2,Promise.resolve("")]}))}))},n.prototype.getMessageContent=function(n){return h.createElement(To.E,n)},n.prototype.createFileUploadQuestionRenderer=function(n){return _o(n)},n.prototype.createCascadeQuestionRenderer=function(n){return null},n.prototype.getQuestionDelegatorClass=function(n){return function(n){switch(n){case"Question.Choice":return Hi.L;case"Question.TextField":return ro;case"Question.DateTime":return Wi;case"Question.Rating":return no;case"Question.Ranking":return Zi;case"Question.MatrixChoice":return Ki;case"Question.MatrixChoiceGroup":return Xi;case"Question.NPS":return Yi;case"Question.FileUpload":return Ji;default:throw Error(n+" is not supported")}}(n)},n.prototype.getCustomLanguageFriendlyName=function(n){return n},n.prototype.createChoiceQuestionRenderer=function(n){return h.createElement(Go,n)},n.prototype.getQuestionRendererFooter=function(n){return null},n.prototype.handleSubmitButtonClick=function(n,t){return(0,p.mG)(this,void 0,void 0,(function(){return(0,p.Jh)(this,(function(r){switch(r.label){case 0:return[4,e.e(653).then(e.bind(e,32286))];case 1:return[2,(0,r.sent().default)(n,t)]}}))}))},n.prototype.cvOnlyLanguageUtility=function(){return null},n}();function zo(){return e.e(514).then(e.t.bind(e,50964,19)).then((function(n){return n.default})).then((function(n){var t={},e=[];return Object.keys(n).map((function(t){return n[t].Questions})).forEach((function(n){w.forEach(n,(function(n){var r=w.find(e,(function(t){return t.GroupId===n.GroupId&&t.Title===n.Title}));n.GroupId&&"Question.MatrixChoice"===n.Type&&!r&&e.push(n),!!n.QuestionTagForIntelligence&&"Subjective"!==n.QuestionTagForIntelligence&&"Unknown"!==n.QuestionTagForIntelligence&&(t[n.QuestionTagForIntelligence]=n)}))})),{Item_1:t,Item_2:e}})).catch((function(n){return console.error(n),null}))}var jo,Qo,Ho,$o,Wo,Jo=e(45862);function Ko(){var n=(0,L.NW)(),t=n.FormId,e=n.ResponseId;if(t&&"string"==typeof t&&e&&"string"==typeof e){var r=(0,Qn.m)(["combined-design"]),i=(0,S.ay)(),o=t,u=e,s=(0,Fn.ZP)({Id:o},!1);if((0,P.Sp)()&&(0,D.cr)("CVResponsePreviewPagePromises"))return Promise.all([s.ensureReadyToResponse(),s.syncFormResponses(),r,i]).then((function(){(0,P.md)((function(){var n=(0,g.f5)();s&&!n.Model.FormMaster&&(n.Model.FormMaster=s)}));var n=Number(u),t=U.d.Collection.getItemWithKeyFields(s.Model.BufferResponses,{Id:n})||U.d.Collection.getItemWithKeyFields(s.Model.Responses,{Id:n});d.render(h.createElement(sn,{FormId:o,ResponseId:u,FormMaster:s,Answers:t.Answers,isResponseDetailsPage:!1}),document.getElementById("content-root"))}));Promise.all([s.ensureReadyToResponse(),s.syncFormResponses(),r,i]).then((function(){(0,P.md)((function(){var n=(0,g.f5)();s&&!n.Model.FormMaster&&(n.Model.FormMaster=s)}));var n=Number(u),t=U.d.Collection.getItemWithKeyFields(s.Model.BufferResponses,{Id:n})||U.d.Collection.getItemWithKeyFields(s.Model.Responses,{Id:n});d.render(h.createElement(sn,{FormId:o,ResponseId:u,FormMaster:s,Answers:t.Answers,isResponseDetailsPage:!1}),document.getElementById("content-root"))}),(function(n){var t=n;if(t&&639===t.innerCode){var e=(0,Hn.y)(window.location.href,"FormId",t.innerMessage);e!==window.location.href&&(0,$n.gB)(e)}}))}else!function(n,t){var e="Error: ".concat(jo[n]);t&&t.innerMessage&&(e+=" Message: ".concat(t.innerMessage));window.console.error(e),(0,S.ay)().then((function(){d.render((0,Wn.a)({Error:t}),document.getElementById("content-root"))}))}(jo.InvalidUrlParameter,{})}function Xo(n){!function(n){(0,Jo.P)(n)}(n)}function Yo(){var n,t=(n=new zn,{buttons:{Button01Primary:{fontSize:Ln,backgroundColor:""==n.primaryColor?Un:n.primaryColor,color:Bn,lineHeight:qn,verticalAlign:"middle",marginLeft:On,fontWeight:400,fontFamily:"Segoe UI",fontStyle:"Regular"},dynamics01Primary:{fontSize:Mn,backgroundColor:Vn,color:Bn,lineHeight:qn,verticalAlign:"middle",marginRight:Dn,fontWeight:400,fontFamily:"Segoe UI",fontStyle:"Regular",height:"40px",width:"120px"},dynamics01PrimaryDisabled:{fontSize:Mn,backgroundColor:"#DADADA",color:Bn,lineHeight:qn,verticalAlign:"middle",marginRight:Dn,fontWeight:400,fontFamily:"Segoe UI",fontStyle:"Regular",height:"40px",width:"120px"},dynamics02Primary:{fontSize:Mn,backgroundColor:Vn,color:Bn,lineHeight:qn,paddingLeft:Rn,paddingRight:Rn,fontWeight:400,fontFamily:"Segoe UI",fontStyle:"Regular",height:"40px",width:"130px"},dynamics02PrimaryDisabled:{fontSize:Mn,backgroundColor:"#DADADA",color:Bn,lineHeight:qn,paddingLeft:Rn,paddingRight:Rn,fontWeight:400,fontFamily:"Segoe UI",fontStyle:"Regular",height:"40px",width:"130px"},dynamics01Secondary:{fontSize:Mn,backgroundColor:Vn,color:Bn,lineHeight:qn,verticalAlign:"middle",marginRight:Dn,fontWeight:400,fontFamily:"Segoe UI",fontStyle:"Regular",height:"40px",minWidth:"150px"},dynamics01SecondaryDisabled:{fontSize:Mn,backgroundColor:"#DADADA",color:Bn,lineHeight:qn,verticalAlign:"middle",marginRight:Dn,fontWeight:400,fontFamily:"Segoe UI",fontStyle:"Regular",height:"40px",minWidth:"150px"},dynamics01ExtendedSecondary:{fontSize:Mn,backgroundColor:Vn,color:Bn,lineHeight:qn,verticalAlign:"middle",marginRight:Dn,fontWeight:400,fontFamily:"Segoe UI",fontStyle:"Regular",height:"48px",width:"200px"},Button02Primary:{lineHeight:qn,verticalAlign:"middle",marginLeft:On,fontWeight:400,fontFamily:"Segoe UI",fontStyle:"Regular",backgroundColor:"white"},Button02Secondary:{lineHeight:qn,verticalAlign:"middle",marginLeft:On,fontWeight:400,fontFamily:"Segoe UI",fontStyle:"Regular",backgroundColor:"#F2F2F2"},Button03Primary:{fontSize:Ln,backgroundColor:Vn,color:Bn,lineHeight:qn,verticalAlign:"middle",marginLeft:Dn,fontWeight:400,fontFamily:"Segoe UI",fontStyle:"Regular"}},links:{TouchTarget:{fontSize:xn,paddingLeft:An,color:Un,lineHeight:qn}},colors:{primaryColorCSS:{color:""==n.primaryColor?Un:n.primaryColor},secondaryColorCSS:{color:""==n.secondaryColor?Gn:n.secondaryColor},iconColorCSS:{color:"#666666"},primaryColor:""==n.primaryColor?Un:n.primaryColor,secondaryColor:""==n.secondaryColor?Gn:n.secondaryColor,backgroundColor:""===n.backgroundColor?Gn:n.backgroundColor,dynamicsColorCSS:{color:Vn},dynamicsColor:Vn},backgroundImage:{backgroundImage:n.backgroundImage}});(0,S.ay)().then((function(){d.render(h.createElement(fn,{onClick:Zo,theme:t}),document.getElementById("content-root"))}))}function Zo(){var n=function(n,t){void 0===t&&(t="Default");var e=v.A9,r=(0,M.WN)("./PopupLoginPage.aspx?".concat(e,"=").concat(n));null!=t&&"Default"!==t&&(r="".concat(r,"&").concat(v.gx,"=").concat(t));return r}("Window","OrgId"),t=window.open(n,"_blank","location=yes,height=700,width=520,scrollbars=yes,status=yes");null!=t&&window.addEventListener("message",(function(n){n.origin===window.location.origin&&(t.close(),(0,D.cr)("CustomerVoiceResposnePreviewURLRedirect")&&nu(window.location.href),d.render(h.createElement(fn,{isLoader:!0}),document.getElementById("content-root")),(0,c.cm)((0,c.k0)()),(0,_.a)().Flighting.setFlights((0,c.k0)().flights),(0,_.a)().AuthContext.handleAuthForContentPage(!1).then(Ko).catch(Xo))}))}function nu(n){var t,e=new URL(n),r=(t=e.hostname).indexOf("forms.microsoft-int.com")>=0||t.indexOf("forms.office-int.com")>=0?"customervoice.microsoft-int.com":t.indexOf("forms.microsoft.com")>=0||t.indexOf("forms.office.com")>=0?"customervoice.microsoft.com":null;null!=r&&(e.hostname=r,window.location.replace(e.href))}!function(n){n[n.InvalidResult=0]="InvalidResult",n[n.InvalidUrlParameter=1]="InvalidUrlParameter",n[n.FailedToCallAPI=2]="FailedToCallAPI"}(jo||(jo={})),(0,m.n)(38),oe.Pv.Register("IPageContext").UsingSingleton((function(){return new Te(Qo)})),oe.Pv.Register("ILogger").UsingSingleton((function(){return new Bt(new Ot(Yn.x_,ue.Ng,zt),new Zt(Yn.x_,ue.Ng))})),oe.Pv.Register("ILazyLoadResourceStringsFunc").UsingSingleton((function(){return Pe.f})),Xn(),(0,_.a)().Flighting.setFlights((0,c.k0)().flights),oe.Pv.Register("IMixin").UsingSingleton((function(){return new yi})),oe.Pv.Register("IFormApiMixin").UsingSingleton((function(){return new yr})),Ho=new Si,oe.Pv.Register("IBootEvent").UsingSingleton((function(){return Ho})),$o=Promise.resolve($),Wo=function(){return $o},oe.Pv.Register("IThirdPartyRateIt").UsingSingleton(Wo),oe.Pv.Register("IThirdPartyLinkify").UsingSingleton(Wo),oe.Pv.Register("IThirdPartyDateTimePicker").UsingSingleton(Wo),oe.Pv.Register("IFormUserContextActionSignal").UsingSingleton((function(){return new yo})),oe.Pv.Register("ITemplateQuestions").UsingSingleton(zo),(0,yn.cT)()?(oe.Pv.Register("ICustomerVoiceUxFactory").UsingSingleton((function(){return new vo})),oe.Pv.Register("ICVMixin").UsingSingleton((function(){return new De}))):(oe.Pv.Register("ICustomerVoiceUxFactory").UsingSingleton((function(){return new Bo})),oe.Pv.Register("ICVMixin").UsingSingleton((function(){return new xe}))),(0,jn.l8)("Aad").then((function(n){n?((0,D.cr)("CustomerVoiceResposnePreviewURLRedirect")&&nu(window.location.href),(0,_.a)().AuthContext.handleAuthForContentPage(!1).then(Ko).catch(Xo)):Yo()})).catch(Yo)},59312:function(n,t,e){"use strict";e.d(t,{Jh:function(){return c},ZT:function(){return i},_T:function(){return u},ev:function(){return f},gn:function(){return s},mG:function(){return a},pi:function(){return o}});var r=function(n,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])},r(n,t)};function i(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=n}r(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}var o=function(){return o=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n},o.apply(this,arguments)};function u(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]])}return e}function s(n,t,e,r){var i,o=arguments.length,u=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,e,r);else for(var s=n.length-1;s>=0;s--)(i=n[s])&&(u=(o<3?i(u):o>3?i(t,e,u):i(t,e))||u);return o>3&&u&&Object.defineProperty(t,e,u),u}function a(n,t,e,r){return new(e||(e=Promise))((function(i,o){function u(n){try{a(r.next(n))}catch(n){o(n)}}function s(n){try{a(r.throw(n))}catch(n){o(n)}}function a(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(u,s)}a((r=r.apply(n,t||[])).next())}))}function c(n,t){var e,r,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;u;)try{if(e=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,r=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(i=u.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1],i=o;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(o);break}i[2]&&u.ops.pop(),u.trys.pop();continue}o=t.call(n,u)}catch(n){o=[6,n],r=0}finally{e=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}Object.create;function f(n,t,e){if(e||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return n.concat(r||Array.prototype.slice.call(t))}Object.create},87363:function(n){"use strict";n.exports=React},61533:function(n){"use strict";n.exports=ReactDOM},12611:function(n){"use strict";n.exports=_}},__webpack_module_cache__={},deferred,leafPrototypes,getProto,inProgress,policy,chunkToChildrenMap;function __webpack_require__(n){var t=__webpack_module_cache__[n];if(void 0!==t)return t.exports;var e=__webpack_module_cache__[n]={exports:{}};return __webpack_modules__[n]||self.formsModuleResolveErrorCallback&&self.formsModuleResolveErrorCallback(n),__webpack_modules__[n].call(e.exports,e,e.exports,__webpack_require__),e.exports}function patchJsonpScriptSrc(n){try{if("function"!=typeof replaceChunkSrc)throw new Error("WebpackRequireFrom: 'replaceChunkSrc' is not a function or not available at runtime. See https://github.com/agoldis/webpack-require-from#troubleshooting");var t=replaceChunkSrc(n);if(!t||"string"!=typeof t)throw new Error("WebpackRequireFrom: 'replaceChunkSrc' does not return string. See https://github.com/agoldis/webpack-require-from#troubleshooting");return t}catch(t){return n}}if(__webpack_require__.m=__webpack_modules__,deferred=[],__webpack_require__.O=function(n,t,e,r){if(!t){var i=1/0;for(a=0;a<deferred.length;a++){t=deferred[a][0],e=deferred[a][1],r=deferred[a][2];for(var o=!0,u=0;u<t.length;u++)(!1&r||i>=r)&&Object.keys(__webpack_require__.O).every((function(n){return __webpack_require__.O[n](t[u])}))?t.splice(u--,1):(o=!1,r<i&&(i=r));if(o){deferred.splice(a--,1);var s=e();void 0!==s&&(n=s)}}return n}r=r||0;for(var a=deferred.length;a>0&&deferred[a-1][2]>r;a--)deferred[a]=deferred[a-1];deferred[a]=[t,e,r]},__webpack_require__.F={},__webpack_require__.E=function(n){Object.keys(__webpack_require__.F).map((function(t){__webpack_require__.F[t](n)}))},__webpack_require__.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return __webpack_require__.d(t,{a:t}),t},getProto=Object.getPrototypeOf?function(n){return Object.getPrototypeOf(n)}:function(n){return n.__proto__},__webpack_require__.t=function(n,t){if(1&t&&(n=this(n)),8&t)return n;if("object"==typeof n&&n){if(4&t&&n.__esModule)return n;if(16&t&&"function"==typeof n.then)return n}var e=Object.create(null);__webpack_require__.r(e);var r={};leafPrototypes=leafPrototypes||[null,getProto({}),getProto([]),getProto(getProto)];for(var i=2&t&&n;"object"==typeof i&&!~leafPrototypes.indexOf(i);i=getProto(i))Object.getOwnPropertyNames(i).forEach((function(t){r[t]=function(){return n[t]}}));return r.default=function(){return n},__webpack_require__.d(e,r),e},__webpack_require__.d=function(n,t){for(var e in t)__webpack_require__.o(t,e)&&!__webpack_require__.o(n,e)&&Object.defineProperty(n,e,{enumerable:!0,get:t[e]})},__webpack_require__.f={},__webpack_require__.e=function(n){return Promise.all(Object.keys(__webpack_require__.f).reduce((function(t,e){return __webpack_require__.f[e](n,t),t}),[]))},__webpack_require__.u=function(n){return"response-preview-page.chunk."+({42:"question.nps",66:"question.rating",93:"json_cv_themes",166:"ir",173:"utel_1ds",245:"branchingpanel",264:"cvheadertheme",274:"question.fileupload",305:"json_intelligence_scenario_templates",346:"question.cascade",362:"cvsearchboxcontrol",410:"json_intelligence_useractionsignals",424:"file-saver",514:"json_templates",535:"json_teams_featured_templates",541:"quiz",600:"math",641:"1ds",647:"question.likert",653:"postsubmit",678:"shareform",708:"json_msa_templates",745:"cv_condtku",757:"ribbon_editor",778:"fluent",824:"utel",852:"phishing",920:"lrp_ext",967:"question.ranking",969:"question.datetime",985:"json_themes"}[n]||n)+"."+{42:"231289d",66:"8124464",93:"24632b3",166:"900e609",173:"e80bfcf",245:"7ec23df",264:"ce657fb",274:"f80de7b",305:"4aa610c",346:"6a5e8fe",362:"3912a5e",410:"11a95de",424:"dc6172a",514:"afb4e09",532:"dc057d2",535:"7ec20ca",541:"086c1a2",600:"81069ff",641:"3e2aaf1",647:"875f5b2",653:"3345fd3",678:"3f4616d",708:"2c37bcf",745:"1585924",757:"16c2b01",778:"07212b0",824:"94589c2",852:"c21d87f",920:"e675ba7",963:"b322131",967:"5b214ef",969:"177cf6e",985:"a365876"}[n]+".js"},__webpack_require__.miniCssF=function(n){},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(n){if("object"==typeof window)return window}}(),__webpack_require__.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},inProgress={},__webpack_require__.l=function(n,t,e,r){if(inProgress[n])inProgress[n].push(t);else{var i,o;if(void 0!==e)for(var u=document.getElementsByTagName("script"),s=0;s<u.length;s++){var a=u[s];if(a.getAttribute("src")==n){i=a;break}}i||(o=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,__webpack_require__.nc&&i.setAttribute("nonce",__webpack_require__.nc),i.src=__webpack_require__.tu(n)),inProgress[n]=[t];var c=function(t,e){i.onerror=i.onload=null,clearTimeout(f);var r=inProgress[n];if(delete inProgress[n],i.parentNode&&i.parentNode.removeChild(i),r&&r.forEach((function(n){return n(e)})),t)return t(e)},f=setTimeout(c.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=c.bind(null,i.onerror),i.onload=c.bind(null,i.onload),o&&document.head.appendChild(i)}},__webpack_require__.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},__webpack_require__.tt=function(){if(void 0===policy&&(policy={createScriptURL:function(n){return n}},"undefined"!=typeof trustedTypes&&trustedTypes.createPolicy))try{policy=trustedTypes.createPolicy("formsScriptSrc#webpack",policy)}catch(n){console.warn('Could not create trusted-types policy "formsScriptSrc#webpack"')}return policy},__webpack_require__.tu=function(n){return __webpack_require__.tt().createScriptURL(n)},__webpack_require__.p="",void 0!==__webpack_require__){var originalwebpackRequireU=__webpack_require__.u;__webpack_require__.u=function(n){return patchJsonpScriptSrc(originalwebpackRequireU(n))}}!function(){if(void 0!==__webpack_require__){var n=__webpack_require__.u,t=__webpack_require__.e,e=new Map,r=new Map;__webpack_require__.u=function(t){var r=n(t),i=r.indexOf("?")>-1;return r+(e.has(t)?(i?"&":"?")+e.get(t):"")},__webpack_require__.e=function(i){return t(i).catch((function(t){var o=r.has(i)?r.get(i):2;if(o<1){var u=n(i);throw t.message="Loading chunk "+i+" failed after 2 retries.\n("+u+")",t.request=u,t}return new Promise((function(n){setTimeout((function(){var t="cache-bust=true"+("&retry-attempt="+(2-o+1));e.set(i,t),r.set(i,o-1),n(__webpack_require__.e(i))}),0)}))}))}}}(),void 0!==__webpack_require__&&Object.defineProperty(__webpack_require__,"p",{get:function(){try{if("function"!=typeof getChunkPath)throw new Error("WebpackRequireFrom: 'getChunkPath' is not a function or not available at runtime. See https://github.com/agoldis/webpack-require-from#troubleshooting");return getChunkPath()}catch(n){return""}},set:function(n){console.warn("WebpackRequireFrom: something is trying to override webpack public path. Ignoring the new value"+n+".")}}),function(){var n={190:0};__webpack_require__.f.j=function(t,e){var r=__webpack_require__.o(n,t)?n[t]:void 0;if(0!==r)if(r)e.push(r[2]);else{var i=new Promise((function(e,i){r=n[t]=[e,i]}));e.push(r[2]=i);var o=__webpack_require__.p+__webpack_require__.u(t),u=new Error;__webpack_require__.l(o,(function(e){if(__webpack_require__.o(n,t)&&(0!==(r=n[t])&&(n[t]=void 0),r)){var i=e&&("load"===e.type?"missing":e.type),o=e&&e.target&&e.target.src;u.message="Loading chunk "+t+" failed.\n("+i+": "+o+")",u.name="ChunkLoadError",u.type=i,u.request=o,r[1](u)}}),"chunk-"+t,t)}},__webpack_require__.F.j=function(t){if(!__webpack_require__.o(n,t)||void 0===n[t]){n[t]=null;var e=document.createElement("link");__webpack_require__.nc&&e.setAttribute("nonce",__webpack_require__.nc),e.rel="prefetch",e.as="script",e.href=__webpack_require__.p+__webpack_require__.u(t),document.head.appendChild(e)}},__webpack_require__.O.j=function(t){return 0===n[t]};var t=function(t,e){var r,i,o=e[0],u=e[1],s=e[2],a=0;if(o.some((function(t){return 0!==n[t]}))){for(r in u)__webpack_require__.o(u,r)&&(__webpack_require__.m[r]=u[r]);if(s)var c=s(__webpack_require__)}for(t&&t(e);a<o.length;a++)i=o[a],__webpack_require__.o(n,i)&&n[i]&&n[i][0](),n[i]=0;return __webpack_require__.O(c)},e=self.webpackChunk=self.webpackChunk||[];e.forEach(t.bind(null,0)),e.push=t.bind(null,e.push.bind(e))}(),chunkToChildrenMap={653:[653,541]},__webpack_require__.f.prefetch=function(n,t){Promise.all(t).then((function(){var t=chunkToChildrenMap[n];Array.isArray(t)&&t.map(__webpack_require__.E)}))},__webpack_require__.O(0,[190],(function(){__webpack_require__.E(653)}),5),__webpack_require__.O(void 0,[117,527],(function(){return __webpack_require__(78606)})),__webpack_require__.O(void 0,[117,527],(function(){return __webpack_require__(219)}));var __webpack_exports__=__webpack_require__.O(void 0,[117,527],(function(){return __webpack_require__(16195)}));__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/response-preview-page.min.98b8ba6.js.map/a5966eacc77ae88c74d942694c8238d3988c4703da80d815342a03e0ccba77f9/response-preview-page.min.98b8ba6.js.map